"use strict";(self.webpackChunkweedcobot_angular=self.webpackChunkweedcobot_angular||[]).push([[179],{562:(Ts,Kn,ke)=>{ke.d(Kn,{$:()=>my,A:()=>ae,G:()=>Ct,K:()=>XT,L:()=>Ja,N:()=>mi,P:()=>vd,R:()=>By,U:()=>ve,V:()=>rp,W:()=>td,X:()=>Oi,Y:()=>Rs,Z:()=>_i,_:()=>ru,a:()=>xs,a0:()=>op,a1:()=>od,a2:()=>hp,a3:()=>Ey,a4:()=>rC,a5:()=>hr,a6:()=>su,a7:()=>Iy,a8:()=>Il,a9:()=>iC,aA:()=>Je,aB:()=>Mt,aC:()=>se,aD:()=>Os,aE:()=>K,aF:()=>Fe,aG:()=>xl,aH:()=>zy,aI:()=>pu,aJ:()=>hn,aN:()=>kn,aQ:()=>Qs,aa:()=>me,ab:()=>sn,ac:()=>rs,ad:()=>Cr,ae:()=>ou,af:()=>ze,ag:()=>wy,ah:()=>xn,ak:()=>wl,al:()=>Ao,am:()=>Ys,ap:()=>_y,aq:()=>Cl,as:()=>xM,at:()=>VM,au:()=>Kt,av:()=>De,aw:()=>U,ax:()=>ot,ay:()=>mu,az:()=>Zy,b:()=>oC,c:()=>Ro,d:()=>qy,e:()=>vC,f:()=>IC,g:()=>gr,h:()=>It,i:()=>md,j:()=>ks,k:()=>sv,l:()=>mC,m:()=>xC,p:()=>Ut,r:()=>_C,s:()=>jy,u:()=>Gt});var A=ke(861),Z=ke(58),F=ke(534),Ae=ke(879),_t=ke(582),Xt=ke(537);const Ut={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ae={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Ct=function be(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Zn=function We(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ct=new Z.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),He=new Ae.Yd("@firebase/auth");function vn(p,...c){He.logLevel<=Ae.in.ERROR&&He.error(`Auth (${F.SDK_VERSION}): ${p}`,...c)}function ot(p,...c){throw Xe(p,...c)}function Mt(p,...c){return Xe(p,...c)}function ci(p,c,h){const g=Object.assign(Object.assign({},Zn()),{[c]:h});return new Z.LL("auth","Firebase",g).create(c,{appName:p.name})}function Un(p,c,h){if(!(c instanceof h))throw h.name!==c.constructor.name&&ot(p,"argument-error"),ci(p,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xe(p,...c){if("string"!=typeof p){const h=c[0],g=[...c.slice(1)];return g[0]&&(g[0].appName=p.name),p._errorFactory.create(h,...g)}return ct.create(p,...c)}function se(p,c,...h){if(!p)throw Xe(c,...h)}function pt(p){const c="INTERNAL ASSERTION FAILED: "+p;throw vn(c),new Error(c)}function Kt(p,c){p||pt(c)}function En(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.href)||""}function In(){return"http:"===Yi()||"https:"===Yi()}function Yi(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.protocol)||null}class Wr{constructor(c,h){this.shortDelay=c,this.longDelay=h,Kt(h>c,"Short delay should be less than long delay!"),this.isMobile=(0,Z.uI)()||(0,Z.b$)()}get(){return function Xi(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(In()||(0,Z.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Cs(p,c){Kt(p.emulator,"Emulator should always be set here");const{url:h}=p.emulator;return c?`${h}${c.startsWith("/")?c.slice(1):c}`:h}class ${static initialize(c,h,g){this.fetchImpl=c,h&&(this.headersImpl=h),g&&(this.responseImpl=g)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const G={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},z=new Wr(3e4,6e4);function B(p,c){return p.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:p.tenantId}):c}function J(p,c,h,g){return Y.apply(this,arguments)}function Y(){return(Y=(0,A.Z)(function*(p,c,h,g,y={}){return ce(p,y,(0,A.Z)(function*(){let w={},M={};g&&("GET"===c?M=g:w={body:JSON.stringify(g)});const j=(0,Z.xO)(Object.assign({key:p.config.apiKey},M)).slice(1),re=yield p._getAdditionalHeaders();return re["Content-Type"]="application/json",p.languageCode&&(re["X-Firebase-Locale"]=p.languageCode),$.fetch()(vt(p,p.config.apiHost,h,j),Object.assign({method:c,headers:re,referrerPolicy:"no-referrer"},w))}))})).apply(this,arguments)}function ce(p,c,h){return it.apply(this,arguments)}function it(){return(it=(0,A.Z)(function*(p,c,h){p._canInitEmulator=!1;const g=Object.assign(Object.assign({},G),c);try{const y=new Bt(p),w=yield Promise.race([h(),y.promise]);y.clearNetworkTimeout();const M=yield w.json();if("needConfirmation"in M)throw en(p,"account-exists-with-different-credential",M);if(w.ok&&!("errorMessage"in M))return M;{const j=w.ok?M.errorMessage:M.error.message,[re,Ee]=j.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===re)throw en(p,"credential-already-in-use",M);if("EMAIL_EXISTS"===re)throw en(p,"email-already-in-use",M);if("USER_DISABLED"===re)throw en(p,"user-disabled",M);const xe=g[re]||re.toLowerCase().replace(/[_\s]+/g,"-");if(Ee)throw ci(p,xe,Ee);ot(p,xe)}}catch(y){if(y instanceof Z.ZR)throw y;ot(p,"network-request-failed",{message:String(y)})}})).apply(this,arguments)}function de(p,c,h,g){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,A.Z)(function*(p,c,h,g,y={}){const w=yield J(p,c,h,g,y);return"mfaPendingCredential"in w&&ot(p,"multi-factor-auth-required",{_serverResponse:w}),w})).apply(this,arguments)}function vt(p,c,h,g){const y=`${c}${h}?${g}`;return p.config.emulator?Cs(p.config,y):`${p.config.apiScheme}://${y}`}function Jt(p){switch(p){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bt{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((h,g)=>{this.timer=setTimeout(()=>g(Mt(this.auth,"network-request-failed")),z.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function en(p,c,h){const g={appName:p.name};h.email&&(g.email=h.email),h.phoneNumber&&(g.phoneNumber=h.phoneNumber);const y=Mt(p,c,g);return y.customData._tokenResponse=h,y}function Bn(p){return void 0!==p&&void 0!==p.getResponse}function Qn(p){return void 0!==p&&void 0!==p.enterprise}class sr{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const h of this.recaptchaEnforcementState)if(h.provider&&h.provider===c)return Jt(h.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function xi(){return(xi=(0,A.Z)(function*(p){return(yield J(p,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function bs(p,c){return gt.apply(this,arguments)}function gt(){return(gt=(0,A.Z)(function*(p,c){return J(p,"GET","/v2/recaptchaConfig",B(p,c))})).apply(this,arguments)}function As(){return(As=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function es(){return(es=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function di(){return(di=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function hi(p){if(p)try{const c=new Date(Number(p));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function xt(){return(xt=(0,A.Z)(function*(p,c=!1){const h=(0,Z.m9)(p),g=yield h.getIdToken(c),y=wn(g);se(y&&y.exp&&y.auth_time&&y.iat,h.auth,"internal-error");const w="object"==typeof y.firebase?y.firebase:void 0,M=w?.sign_in_provider;return{claims:y,token:g,authTime:hi(Zr(y.auth_time)),issuedAtTime:hi(Zr(y.iat)),expirationTime:hi(Zr(y.exp)),signInProvider:M||null,signInSecondFactor:w?.sign_in_second_factor||null}})).apply(this,arguments)}function Zr(p){return 1e3*Number(p)}function wn(p){const[c,h,g]=p.split(".");if(void 0===c||void 0===h||void 0===g)return vn("JWT malformed, contained fewer than 3 sections"),null;try{const y=(0,Z.tV)(h);return y?JSON.parse(y):(vn("Failed to decode base64 JWT payload"),null)}catch(y){return vn("Caught error parsing JWT payload as JSON",y?.toString()),null}}function tn(p,c){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,A.Z)(function*(p,c,h=!1){if(h)return c;try{return yield c}catch(g){throw g instanceof Z.ZR&&function ts({code:p}){return"auth/user-disabled"===p||"auth/user-token-expired"===p}(g)&&p.auth.currentUser===p&&(yield p.auth.signOut()),g}})).apply(this,arguments)}class ki{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var h;if(c){const g=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),g}{this.errorBackoff=3e4;const y=(null!==(h=this.user.stsTokenManager.expirationTime)&&void 0!==h?h:0)-Date.now()-3e5;return Math.max(0,y)}}schedule(c=!1){var h=this;if(!this.isRunning)return;const g=this.getInterval(c);this.timerId=setTimeout((0,A.Z)(function*(){yield h.iteration()}),g)}iteration(){var c=this;return(0,A.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(h){return void("auth/network-request-failed"===h?.code&&c.schedule(!0))}c.schedule()})()}}class ns{constructor(c,h){this.createdAt=c,this.lastLoginAt=h,this._initializeTime()}_initializeTime(){this.lastSignInTime=hi(this.lastLoginAt),this.creationTime=hi(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Yn(p){return jn.apply(this,arguments)}function jn(){return jn=(0,A.Z)(function*(p){var c;const h=p.auth,g=yield p.getIdToken(),y=yield tn(p,function cr(p,c){return di.apply(this,arguments)}(h,{idToken:g}));se(y?.users.length,h,"internal-error");const w=y.users[0];p._notifyReloadListener(w);const M=null!==(c=w.providerUserInfo)&&void 0!==c&&c.length?function vo(p){return p.map(c=>{var{providerId:h}=c,g=(0,_t._T)(c,["providerId"]);return{providerId:h,uid:g.rawId||"",displayName:g.displayName||null,email:g.email||null,phoneNumber:g.phoneNumber||null,photoURL:g.photoUrl||null}})}(w.providerUserInfo):[],j=function Xa(p,c){return[...p.filter(g=>!c.some(y=>y.providerId===g.providerId)),...c]}(p.providerData,M),xe=!!p.isAnonymous&&!(p.email&&w.passwordHash||j?.length),ht={uid:w.localId,displayName:w.displayName||null,photoURL:w.photoUrl||null,email:w.email||null,emailVerified:w.emailVerified||!1,phoneNumber:w.phoneNumber||null,tenantId:w.tenantId||null,providerData:j,metadata:new ns(w.createdAt,w.lastLoginAt),isAnonymous:xe};Object.assign(p,ht)}),jn.apply(this,arguments)}function pi(){return(pi=(0,A.Z)(function*(p){const c=(0,Z.m9)(p);yield Yn(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function Ss(){return(Ss=(0,A.Z)(function*(p,c){const h=yield ce(p,{},(0,A.Z)(function*(){const g=(0,Z.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:y,apiKey:w}=p.config,M=vt(p,y,"/v1/token",`key=${w}`),j=yield p._getAdditionalHeaders();return j["Content-Type"]="application/x-www-form-urlencoded",$.fetch()(M,{method:"POST",headers:j,body:g})}));return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}})).apply(this,arguments)}function S(){return(S=(0,A.Z)(function*(p,c){return J(p,"POST","/v2/accounts:revokeToken",B(p,c))})).apply(this,arguments)}class I{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){se(c.idToken,"internal-error"),se(typeof c.idToken<"u","internal-error"),se(typeof c.refreshToken<"u","internal-error");const h="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function ml(p){const c=wn(p);return se(c,"internal-error"),se(typeof c.exp<"u","internal-error"),se(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,h)}getToken(c,h=!1){var g=this;return(0,A.Z)(function*(){return se(!g.accessToken||g.refreshToken,c,"user-token-expired"),h||!g.accessToken||g.isExpired?g.refreshToken?(yield g.refresh(c,g.refreshToken),g.accessToken):null:g.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,h){var g=this;return(0,A.Z)(function*(){const{accessToken:y,refreshToken:w,expiresIn:M}=yield function sa(p,c){return Ss.apply(this,arguments)}(c,h);g.updateTokensAndExpiration(y,w,Number(M))})()}updateTokensAndExpiration(c,h,g){this.refreshToken=h||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*g}static fromJSON(c,h){const{refreshToken:g,accessToken:y,expirationTime:w}=h,M=new I;return g&&(se("string"==typeof g,"internal-error",{appName:c}),M.refreshToken=g),y&&(se("string"==typeof y,"internal-error",{appName:c}),M.accessToken=y),w&&(se("number"==typeof w,"internal-error",{appName:c}),M.expirationTime=w),M}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new I,this.toJSON())}_performRefresh(){return pt("not implemented")}}function C(p,c){se("string"==typeof p||typeof p>"u","internal-error",{appName:c})}class E{constructor(c){var{uid:h,auth:g,stsTokenManager:y}=c,w=(0,_t._T)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ki(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=h,this.auth=g,this.stsTokenManager=y,this.accessToken=y.accessToken,this.displayName=w.displayName||null,this.email=w.email||null,this.emailVerified=w.emailVerified||!1,this.phoneNumber=w.phoneNumber||null,this.photoURL=w.photoURL||null,this.isAnonymous=w.isAnonymous||!1,this.tenantId=w.tenantId||null,this.providerData=w.providerData?[...w.providerData]:[],this.metadata=new ns(w.createdAt||void 0,w.lastLoginAt||void 0)}getIdToken(c){var h=this;return(0,A.Z)(function*(){const g=yield tn(h,h.stsTokenManager.getToken(h.auth,c));return se(g,h.auth,"internal-error"),h.accessToken!==g&&(h.accessToken=g,yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)),g})()}getIdTokenResult(c){return function dr(p){return xt.apply(this,arguments)}(this,c)}reload(){return function Or(p){return pi.apply(this,arguments)}(this)}_assign(c){this!==c&&(se(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(h=>Object.assign({},h)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const h=new E(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return h.metadata._copy(this.metadata),h}_onReload(c){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,h=!1){var g=this;return(0,A.Z)(function*(){let y=!1;c.idToken&&c.idToken!==g.stsTokenManager.accessToken&&(g.stsTokenManager.updateFromServerResponse(c),y=!0),h&&(yield Yn(g)),yield g.auth._persistUserIfCurrent(g),y&&g.auth._notifyListenersIfCurrent(g)})()}delete(){var c=this;return(0,A.Z)(function*(){const h=yield c.getIdToken();return yield tn(c,function Ds(p,c){return As.apply(this,arguments)}(c.auth,{idToken:h})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,h){var g,y,w,M,j,re,Ee,xe;const ht=null!==(g=h.displayName)&&void 0!==g?g:void 0,Ur=null!==(y=h.email)&&void 0!==y?y:void 0,eo=null!==(w=h.phoneNumber)&&void 0!==w?w:void 0,Vl=null!==(M=h.photoURL)&&void 0!==M?M:void 0,av=null!==(j=h.tenantId)&&void 0!==j?j:void 0,vu=null!==(re=h._redirectEventId)&&void 0!==re?re:void 0,No=null!==(Ee=h.createdAt)&&void 0!==Ee?Ee:void 0,uv=null!==(xe=h.lastLoginAt)&&void 0!==xe?xe:void 0,{uid:Md,emailVerified:qp,isAnonymous:Eu,providerData:zp,stsTokenManager:Dr}=h;se(Md&&Dr,c,"internal-error");const LC=I.fromJSON(this.name,Dr);se("string"==typeof Md,c,"internal-error"),C(ht,c.name),C(Ur,c.name),se("boolean"==typeof qp,c,"internal-error"),se("boolean"==typeof Eu,c,"internal-error"),C(eo,c.name),C(Vl,c.name),C(av,c.name),C(vu,c.name),C(No,c.name),C(uv,c.name);const Xn=new E({uid:Md,auth:c,email:Ur,emailVerified:qp,displayName:ht,isAnonymous:Eu,photoURL:Vl,phoneNumber:eo,tenantId:av,stsTokenManager:LC,createdAt:No,lastLoginAt:uv});return zp&&Array.isArray(zp)&&(Xn.providerData=zp.map(Gp=>Object.assign({},Gp))),vu&&(Xn._redirectEventId=vu),Xn}static _fromIdTokenResponse(c,h,g=!1){return(0,A.Z)(function*(){const y=new I;y.updateFromServerResponse(h);const w=new E({uid:h.localId,auth:c,stsTokenManager:y,isAnonymous:g});return yield Yn(w),w})()}}const R=new Map;function K(p){Kt(p instanceof Function,"Expected a class definition");let c=R.get(p);return c?(Kt(c instanceof p,"Instance stored in cache mismatched with class"),c):(c=new p,R.set(p,c),c)}const ve=(()=>{class p{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,A.Z)(function*(){return!0})()}_set(h,g){var y=this;return(0,A.Z)(function*(){y.storage[h]=g})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=g.storage[h];return void 0===y?null:y})()}_remove(h){var g=this;return(0,A.Z)(function*(){delete g.storage[h]})()}_addListener(h,g){}_removeListener(h,g){}}return p.type="NONE",p})();function Fe(p,c,h){return`firebase:${p}:${c}:${h}`}class Et{constructor(c,h,g){this.persistence=c,this.auth=h,this.userKey=g;const{config:y,name:w}=this.auth;this.fullUserKey=Fe(this.userKey,y.apiKey,w),this.fullPersistenceKey=Fe("persistence",y.apiKey,w),this.boundEventHandler=h._onStorageEvent.bind(h),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,A.Z)(function*(){const h=yield c.persistence._get(c.fullUserKey);return h?E._fromJSON(c.auth,h):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var h=this;return(0,A.Z)(function*(){if(h.persistence===c)return;const g=yield h.getCurrentUser();return yield h.removeCurrentUser(),h.persistence=c,g?h.setCurrentUser(g):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,h,g="authUser"){return(0,A.Z)(function*(){if(!h.length)return new Et(K(ve),c,g);const y=(yield Promise.all(h.map(function(){var Ee=(0,A.Z)(function*(xe){if(yield xe._isAvailable())return xe});return function(xe){return Ee.apply(this,arguments)}}()))).filter(Ee=>Ee);let w=y[0]||K(ve);const M=Fe(g,c.config.apiKey,c.name);let j=null;for(const Ee of h)try{const xe=yield Ee._get(M);if(xe){const ht=E._fromJSON(c,xe);Ee!==w&&(j=ht),w=Ee;break}}catch{}const re=y.filter(Ee=>Ee._shouldAllowMigration);return w._shouldAllowMigration&&re.length?(w=re[0],j&&(yield w._set(M,j.toJSON())),yield Promise.all(h.map(function(){var Ee=(0,A.Z)(function*(xe){if(xe!==w)try{yield xe._remove(M)}catch{}});return function(xe){return Ee.apply(this,arguments)}}())),new Et(w,c,g)):new Et(w,c,g)})()}}function ge(p){const c=p.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(oa(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(Ft(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(x(c))return"Blackberry";if(ie(c))return"Webos";if(Re(c))return"Safari";if((c.includes("chrome/")||or(c))&&!c.includes("edge/"))return"Chrome";if(U(c))return"Android";{const g=p.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===g?.length)return g[1]}return"Other"}function Ft(p=(0,Z.z$)()){return/firefox\//i.test(p)}function Re(p=(0,Z.z$)()){const c=p.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function or(p=(0,Z.z$)()){return/crios\//i.test(p)}function oa(p=(0,Z.z$)()){return/iemobile/i.test(p)}function U(p=(0,Z.z$)()){return/android/i.test(p)}function x(p=(0,Z.z$)()){return/blackberry/i.test(p)}function ie(p=(0,Z.z$)()){return/webos/i.test(p)}function De(p=(0,Z.z$)()){return/iphone|ipad|ipod/i.test(p)||/macintosh/i.test(p)&&/mobile/i.test(p)}function Je(p=(0,Z.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(p)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(p)}function Mn(p=(0,Z.z$)()){return De(p)||U(p)||ie(p)||x(p)||/windows phone/i.test(p)||oa(p)}function st(p,c=[]){let h;switch(p){case"Browser":h=ge((0,Z.z$)());break;case"Worker":h=`${ge((0,Z.z$)())}-${p}`;break;default:h=p}const g=c.length?c.join(","):"FirebaseCore-web";return`${h}/JsCore/${F.SDK_VERSION}/${g}`}class _l{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,h){const g=w=>new Promise((M,j)=>{try{M(c(w))}catch(re){j(re)}});g.onAbort=h,this.queue.push(g);const y=this.queue.length-1;return()=>{this.queue[y]=()=>Promise.resolve()}}runMiddleware(c){var h=this;return(0,A.Z)(function*(){if(h.auth.currentUser===c)return;const g=[];try{for(const y of h.queue)yield y(c),y.onAbort&&g.push(y.onAbort)}catch(y){g.reverse();for(const w of g)try{w()}catch{}throw h.auth._errorFactory.create("login-blocked",{originalMessage:y?.message})}})()}}function zf(){return(zf=(0,A.Z)(function*(p,c={}){return J(p,"GET","/v2/passwordPolicy",B(p,c))})).apply(this,arguments)}class gi{constructor(c){var h,g,y,w;const M=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(h=M.minPasswordLength)&&void 0!==h?h:6,M.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=M.maxPasswordLength),void 0!==M.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=M.containsLowercaseCharacter),void 0!==M.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=M.containsUppercaseCharacter),void 0!==M.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=M.containsNumericCharacter),void 0!==M.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=M.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(y=null===(g=c.allowedNonAlphanumericCharacters)||void 0===g?void 0:g.join(""))&&void 0!==y?y:"",this.forceUpgradeOnSignin=null!==(w=c.forceUpgradeOnSignin)&&void 0!==w&&w,this.schemaVersion=c.schemaVersion}validatePassword(c){var h,g,y,w,M,j;const re={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,re),this.validatePasswordCharacterOptions(c,re),re.isValid&&(re.isValid=null===(h=re.meetsMinPasswordLength)||void 0===h||h),re.isValid&&(re.isValid=null===(g=re.meetsMaxPasswordLength)||void 0===g||g),re.isValid&&(re.isValid=null===(y=re.containsLowercaseLetter)||void 0===y||y),re.isValid&&(re.isValid=null===(w=re.containsUppercaseLetter)||void 0===w||w),re.isValid&&(re.isValid=null===(M=re.containsNumericCharacter)||void 0===M||M),re.isValid&&(re.isValid=null===(j=re.containsNonAlphanumericCharacter)||void 0===j||j),re}validatePasswordLengthOptions(c,h){const g=this.customStrengthOptions.minPasswordLength,y=this.customStrengthOptions.maxPasswordLength;g&&(h.meetsMinPasswordLength=c.length>=g),y&&(h.meetsMaxPasswordLength=c.length<=y)}validatePasswordCharacterOptions(c,h){let g;this.updatePasswordCharacterOptionsStatuses(h,!1,!1,!1,!1);for(let y=0;y<c.length;y++)g=c.charAt(y),this.updatePasswordCharacterOptionsStatuses(h,g>="a"&&g<="z",g>="A"&&g<="Z",g>="0"&&g<="9",this.allowedNonAlphanumericCharacters.includes(g))}updatePasswordCharacterOptionsStatuses(c,h,g,y,w){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=h)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=g)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=y)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=w))}}class CM{constructor(c,h,g,y){this.app=c,this.heartbeatServiceProvider=h,this.appCheckServiceProvider=g,this.config=y,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new KT(this),this.idTokenSubscription=new KT(this),this.beforeStateQueue=new _l(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ct,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=y.sdkClientVersion}_initializeWithPersistence(c,h){var g=this;return h&&(this._popupRedirectResolver=K(h)),this._initializationPromise=this.queue((0,A.Z)(function*(){var y,w;if(!g._deleted&&(g.persistenceManager=yield Et.create(g,c),!g._deleted)){if(null!==(y=g._popupRedirectResolver)&&void 0!==y&&y._shouldInitProactively)try{yield g._popupRedirectResolver._initialize(g)}catch{}yield g.initializeCurrentUser(h),g.lastNotifiedUid=(null===(w=g.currentUser)||void 0===w?void 0:w.uid)||null,!g._deleted&&(g._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,A.Z)(function*(){if(c._deleted)return;const h=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||h){if(c.currentUser&&h&&c.currentUser.uid===h.uid)return c._currentUser._assign(h),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(h,!0)}})()}initializeCurrentUser(c){var h=this;return(0,A.Z)(function*(){var g;const y=yield h.assertedPersistence.getCurrentUser();let w=y,M=!1;if(c&&h.config.authDomain){yield h.getOrInitRedirectPersistenceManager();const j=null===(g=h.redirectUser)||void 0===g?void 0:g._redirectEventId,re=w?._redirectEventId,Ee=yield h.tryRedirectSignIn(c);(!j||j===re)&&Ee?.user&&(w=Ee.user,M=!0)}if(!w)return h.directlySetCurrentUser(null);if(!w._redirectEventId){if(M)try{yield h.beforeStateQueue.runMiddleware(w)}catch(j){w=y,h._popupRedirectResolver._overrideRedirectResult(h,()=>Promise.reject(j))}return w?h.reloadAndSetCurrentUserOrClear(w):h.directlySetCurrentUser(null)}return se(h._popupRedirectResolver,h,"argument-error"),yield h.getOrInitRedirectPersistenceManager(),h.redirectUser&&h.redirectUser._redirectEventId===w._redirectEventId?h.directlySetCurrentUser(w):h.reloadAndSetCurrentUserOrClear(w)})()}tryRedirectSignIn(c){var h=this;return(0,A.Z)(function*(){let g=null;try{g=yield h._popupRedirectResolver._completeRedirectFn(h,c,!0)}catch{yield h._setRedirectUser(null)}return g})()}reloadAndSetCurrentUserOrClear(c){var h=this;return(0,A.Z)(function*(){try{yield Yn(c)}catch(g){if("auth/network-request-failed"!==g?.code)return h.directlySetCurrentUser(null)}return h.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function Ze(){if(typeof navigator>"u")return null;const p=navigator;return p.languages&&p.languages[0]||p.language||null}()}_delete(){var c=this;return(0,A.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var h=this;return(0,A.Z)(function*(){const g=c?(0,Z.m9)(c):null;return g&&se(g.auth.config.apiKey===h.config.apiKey,h,"invalid-user-token"),h._updateCurrentUser(g&&g._clone(h))})()}_updateCurrentUser(c,h=!1){var g=this;return(0,A.Z)(function*(){if(!g._deleted)return c&&se(g.tenantId===c.tenantId,g,"tenant-id-mismatch"),h||(yield g.beforeStateQueue.runMiddleware(c)),g.queue((0,A.Z)(function*(){yield g.directlySetCurrentUser(c),g.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,A.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var h=this;return this.queue((0,A.Z)(function*(){yield h.assertedPersistence.setPersistence(K(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var h=this;return(0,A.Z)(function*(){h._getPasswordPolicyInternal()||(yield h._updatePasswordPolicy());const g=h._getPasswordPolicyInternal();return g.schemaVersion!==h.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(h._errorFactory.create("unsupported-password-policy-schema-version",{})):g.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,A.Z)(function*(){const h=yield function TM(p){return zf.apply(this,arguments)}(c),g=new gi(h);null===c.tenantId?c._projectPasswordPolicy=g:c._tenantPasswordPolicies[c.tenantId]=g})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new Z.LL("auth","Firebase",c())}onAuthStateChanged(c,h,g){return this.registerStateListener(this.authStateSubscription,c,h,g)}beforeAuthStateChanged(c,h){return this.beforeStateQueue.pushCallback(c,h)}onIdTokenChanged(c,h,g){return this.registerStateListener(this.idTokenSubscription,c,h,g)}authStateReady(){return new Promise((c,h)=>{if(this.currentUser)c();else{const g=this.onAuthStateChanged(()=>{g(),c()},h)}})}revokeAccessToken(c){var h=this;return(0,A.Z)(function*(){if(h.currentUser){const g=yield h.currentUser.getIdToken(),y={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:g};null!=h.tenantId&&(y.tenantId=h.tenantId),yield function N(p,c){return S.apply(this,arguments)}(h,y)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,h){var g=this;return(0,A.Z)(function*(){const y=yield g.getOrInitRedirectPersistenceManager(h);return null===c?y.removeCurrentUser():y.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var h=this;return(0,A.Z)(function*(){if(!h.redirectPersistenceManager){const g=c&&K(c)||h._popupRedirectResolver;se(g,h,"argument-error"),h.redirectPersistenceManager=yield Et.create(h,[K(g._redirectPersistence)],"redirectUser"),h.redirectUser=yield h.redirectPersistenceManager.getCurrentUser()}return h.redirectPersistenceManager})()}_redirectUserForId(c){var h=this;return(0,A.Z)(function*(){var g,y;return h._isInitialized&&(yield h.queue((0,A.Z)(function*(){}))),(null===(g=h._currentUser)||void 0===g?void 0:g._redirectEventId)===c?h._currentUser:(null===(y=h.redirectUser)||void 0===y?void 0:y._redirectEventId)===c?h.redirectUser:null})()}_persistUserIfCurrent(c){var h=this;return(0,A.Z)(function*(){if(c===h.currentUser)return h.queue((0,A.Z)(function*(){return h.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,h;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const g=null!==(h=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==h?h:null;this.lastNotifiedUid!==g&&(this.lastNotifiedUid=g,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,h,g,y){if(this._deleted)return()=>{};const w="function"==typeof h?h:h.next.bind(h);let M=!1;const j=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(j,this,"internal-error"),j.then(()=>{M||w(this.currentUser)}),"function"==typeof h){const re=c.addObserver(h,g,y);return()=>{M=!0,re()}}{const re=c.addObserver(h);return()=>{M=!0,re()}}}directlySetCurrentUser(c){var h=this;return(0,A.Z)(function*(){h.currentUser&&h.currentUser!==c&&h._currentUser._stopProactiveRefresh(),c&&h.isProactiveRefreshEnabled&&c._startProactiveRefresh(),h.currentUser=c,c?yield h.assertedPersistence.setCurrentUser(c):yield h.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=st(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,A.Z)(function*(){var h;const g={"X-Client-Version":c.clientVersion};c.app.options.appId&&(g["X-Firebase-gmpid"]=c.app.options.appId);const y=yield null===(h=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getHeartbeatsHeader();y&&(g["X-Firebase-Client"]=y);const w=yield c._getAppCheckToken();return w&&(g["X-Firebase-AppCheck"]=w),g})()}_getAppCheckToken(){var c=this;return(0,A.Z)(function*(){var h;const g=yield null===(h=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getToken();return g?.error&&function ir(p,...c){He.logLevel<=Ae.in.WARN&&He.warn(`Auth (${F.SDK_VERSION}): ${p}`,...c)}(`Error while retrieving App Check token: ${g.error}`),g?.token})()}}function hn(p){return(0,Z.m9)(p)}class KT{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,Z.ne)(h=>this.observer=h)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function ay(p){return new Promise((c,h)=>{const g=document.createElement("script");g.setAttribute("src",p),g.onload=c,g.onerror=y=>{const w=Mt("internal-error");w.customData=y,h(w)},g.type="text/javascript",g.charset="UTF-8",function aa(){var p,c;return null!==(c=null===(p=document.getElementsByTagName("head"))||void 0===p?void 0:p[0])&&void 0!==c?c:document}().appendChild(g)})}function ZT(p){return`__${p}${Math.floor(1e6*Math.random())}`}class YT{constructor(c){this.type="recaptcha-enterprise",this.auth=hn(c)}verify(c="verify",h=!1){var g=this;return(0,A.Z)(function*(){function w(){return w=(0,A.Z)(function*(j){if(!h){if(null==j.tenantId&&null!=j._agentRecaptchaConfig)return j._agentRecaptchaConfig.siteKey;if(null!=j.tenantId&&void 0!==j._tenantRecaptchaConfigs[j.tenantId])return j._tenantRecaptchaConfigs[j.tenantId].siteKey}return new Promise(function(){var re=(0,A.Z)(function*(Ee,xe){bs(j,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ht=>{if(void 0!==ht.recaptchaKey){const Ur=new sr(ht);return null==j.tenantId?j._agentRecaptchaConfig=Ur:j._tenantRecaptchaConfigs[j.tenantId]=Ur,Ee(Ur.siteKey)}xe(new Error("recaptcha Enterprise site key undefined"))}).catch(ht=>{xe(ht)})});return function(Ee,xe){return re.apply(this,arguments)}}())}),w.apply(this,arguments)}function M(j,re,Ee){const xe=window.grecaptcha;Qn(xe)?xe.enterprise.ready(()=>{xe.enterprise.execute(j,{action:c}).then(ht=>{re(ht)}).catch(()=>{re("NO_RECAPTCHA")})}):Ee(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((j,re)=>{(function y(j){return w.apply(this,arguments)})(g.auth).then(Ee=>{if(!h&&Qn(window.grecaptcha))M(Ee,j,re);else{if(typeof window>"u")return void re(new Error("RecaptchaVerifier is only supported in browser"));ay("https://www.google.com/recaptcha/enterprise.js?render="+Ee).then(()=>{M(Ee,j,re)}).catch(xe=>{re(xe)})}}).catch(Ee=>{re(Ee)})})})()}}function uy(p,c,h){return ly.apply(this,arguments)}function ly(){return(ly=(0,A.Z)(function*(p,c,h,g=!1){const y=new YT(p);let w;try{w=yield y.verify(h)}catch{w=yield y.verify(h,!0)}const M=Object.assign({},c);return Object.assign(M,g?{captchaResp:w}:{captchaResponse:w}),Object.assign(M,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(M,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),M})).apply(this,arguments)}function wr(p,c,h,g){return Le.apply(this,arguments)}function Le(){return Le=(0,A.Z)(function*(p,c,h,g){var y;if(null!==(y=p._getRecaptchaConfig())&&void 0!==y&&y.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const w=yield uy(p,c,h,"getOobCode"===h);return g(p,w)}return g(p,c).catch(function(){var w=(0,A.Z)(function*(M){if("auth/missing-recaptcha-token"===M.code){console.log(`${h} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const j=yield uy(p,c,h,"getOobCode"===h);return g(p,j)}return Promise.reject(M)});return function(M){return w.apply(this,arguments)}}())}),Le.apply(this,arguments)}function XT(p,c,h){const g=hn(p);se(g._canInitEmulator,g,"emulator-config-failed"),se(/^https?:\/\//.test(c),g,"invalid-emulator-scheme");const y=!!h?.disableWarnings,w=Cn(c),{host:M,port:j}=function Gc(p){const c=Cn(p),h=/(\/\/)?([^?#/]+)/.exec(p.substr(c.length));if(!h)return{host:"",port:null};const g=h[2].split("@").pop()||"",y=/^(\[[^\]]+\])(:|$)/.exec(g);if(y){const w=y[1];return{host:w,port:dy(g.substr(w.length+1))}}{const[w,M]=g.split(":");return{host:w,port:dy(M)}}}(c);g.config.emulator={url:`${w}//${M}${null===j?"":`:${j}`}/`},g.settings.appVerificationDisabledForTesting=!0,g.emulatorConfig=Object.freeze({host:M,port:j,protocol:w.replace(":",""),options:Object.freeze({disableWarnings:y})}),y||function hy(){function p(){const c=document.createElement("p"),h=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",h.position="fixed",h.width="100%",h.backgroundColor="#ffffff",h.border=".1em solid #000000",h.color="#b50000",h.bottom="0px",h.left="0px",h.margin="0px",h.zIndex="10000",h.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p())}()}function Cn(p){const c=p.indexOf(":");return c<0?"":p.substr(0,c+1)}function dy(p){if(!p)return null;const c=Number(p);return isNaN(c)?null:c}class Ja{constructor(c,h){this.providerId=c,this.signInMethod=h}toJSON(){return pt("not implemented")}_getIdTokenResponse(c){return pt("not implemented")}_linkToIdToken(c,h){return pt("not implemented")}_getReauthenticationResolver(c){return pt("not implemented")}}function yl(p,c){return eu.apply(this,arguments)}function eu(){return(eu=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:resetPassword",B(p,c))})).apply(this,arguments)}function Wc(){return(Wc=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function JT(p,c){return rt.apply(this,arguments)}function rt(){return(rt=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function Kc(){return(Kc=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",B(p,c))})).apply(this,arguments)}function Qr(p,c){return Zc.apply(this,arguments)}function Zc(){return(Zc=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPassword",B(p,c))})).apply(this,arguments)}function Zf(p,c){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:sendOobCode",B(p,c))})).apply(this,arguments)}function fy(){return(fy=(0,A.Z)(function*(p,c){return Zf(p,c)})).apply(this,arguments)}function le(p,c){return vl.apply(this,arguments)}function vl(){return(vl=(0,A.Z)(function*(p,c){return Zf(p,c)})).apply(this,arguments)}function Qf(p,c){return Qc.apply(this,arguments)}function Qc(){return(Qc=(0,A.Z)(function*(p,c){return Zf(p,c)})).apply(this,arguments)}function Xf(){return(Xf=(0,A.Z)(function*(p,c){return Zf(p,c)})).apply(this,arguments)}function py(){return(py=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}function gy(){return(gy=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}class Yc extends Ja{constructor(c,h,g,y=null){super("password",g),this._email=c,this._password=h,this._tenantId=y}static _fromEmailAndPassword(c,h){return new Yc(c,h,"password")}static _fromEmailAndCode(c,h,g=null){return new Yc(c,h,"emailLink",g)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c;if(h?.email&&h?.password){if("password"===h.signInMethod)return this._fromEmailAndPassword(h.email,h.password);if("emailLink"===h.signInMethod)return this._fromEmailAndCode(h.email,h.password,h.tenantId)}return null}_getIdTokenResponse(c){var h=this;return(0,A.Z)(function*(){switch(h.signInMethod){case"password":return wr(c,{returnSecureToken:!0,email:h._email,password:h._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Qr);case"emailLink":return function Jf(p,c){return py.apply(this,arguments)}(c,{email:h._email,oobCode:h._password});default:ot(c,"internal-error")}})()}_linkToIdToken(c,h){var g=this;return(0,A.Z)(function*(){switch(g.signInMethod){case"password":return wr(c,{idToken:h,returnSecureToken:!0,email:g._email,password:g._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",JT);case"emailLink":return function PM(p,c){return gy.apply(this,arguments)}(c,{idToken:h,email:g._email,oobCode:g._password});default:ot(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function Eo(p,c){return ua.apply(this,arguments)}function ua(){return(ua=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithIdp",B(p,c))})).apply(this,arguments)}class mi extends Ja{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const h=new mi(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(h.idToken=c.idToken),c.accessToken&&(h.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(h.nonce=c.nonce),c.pendingToken&&(h.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(h.accessToken=c.oauthToken,h.secret=c.oauthTokenSecret):ot("argument-error"),h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y}=h,w=(0,_t._T)(h,["providerId","signInMethod"]);if(!g||!y)return null;const M=new mi(g,y);return M.idToken=w.idToken||void 0,M.accessToken=w.accessToken||void 0,M.secret=w.secret,M.nonce=w.nonce,M.pendingToken=w.pendingToken||null,M}_getIdTokenResponse(c){return Eo(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,Eo(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,Eo(c,h)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const h={};this.idToken&&(h.id_token=this.idToken),this.accessToken&&(h.access_token=this.accessToken),this.secret&&(h.oauth_token_secret=this.secret),h.providerId=this.providerId,this.nonce&&!this.pendingToken&&(h.nonce=this.nonce),c.postBody=(0,Z.xO)(h)}return c}}function tp(){return(tp=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:sendVerificationCode",B(p,c))})).apply(this,arguments)}function Xc(){return(Xc=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c))})).apply(this,arguments)}function np(){return(np=(0,A.Z)(function*(p,c){const h=yield de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c));if(h.temporaryProof)throw en(p,"account-exists-with-different-credential",h);return h})).apply(this,arguments)}const Io={USER_NOT_FOUND:"user-not-found"};function W(){return(W=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,Object.assign(Object.assign({},c),{operation:"REAUTH"})),Io)})).apply(this,arguments)}class wo extends Ja{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,h){return new wo({verificationId:c,verificationCode:h})}static _fromTokenResponse(c,h){return new wo({phoneNumber:c,temporaryProof:h})}_getIdTokenResponse(c){return function tC(p,c){return Xc.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,h){return function tu(p,c){return np.apply(this,arguments)}(c,Object.assign({idToken:h},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function nC(p,c){return W.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:h,verificationId:g,verificationCode:y}=this.params;return c&&h?{temporaryProof:c,phoneNumber:h}:{sessionInfo:g,code:y}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}=c;return g||h||y||w?new wo({verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}):null}}class la{constructor(c){var h,g,y,w,M,j;const re=(0,Z.zd)((0,Z.pd)(c)),Ee=null!==(h=re.apiKey)&&void 0!==h?h:null,xe=null!==(g=re.oobCode)&&void 0!==g?g:null,ht=function pe(p){switch(p){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(y=re.mode)&&void 0!==y?y:null);se(Ee&&xe&&ht,"argument-error"),this.apiKey=Ee,this.operation=ht,this.code=xe,this.continueUrl=null!==(w=re.continueUrl)&&void 0!==w?w:null,this.languageCode=null!==(M=re.languageCode)&&void 0!==M?M:null,this.tenantId=null!==(j=re.tenantId)&&void 0!==j?j:null}static parseLink(c){const h=function Jc(p){const c=(0,Z.zd)((0,Z.pd)(p)).link,h=c?(0,Z.zd)((0,Z.pd)(c)).deep_link_id:null,g=(0,Z.zd)((0,Z.pd)(p)).deep_link_id;return(g?(0,Z.zd)((0,Z.pd)(g)).link:null)||g||h||c||p}(c);try{return new la(h)}catch{return null}}}let rp=(()=>{class p{constructor(){this.providerId=p.PROVIDER_ID}static credential(h,g){return Yc._fromEmailAndPassword(h,g)}static credentialWithLink(h,g){const y=la.parseLink(g);return se(y,"argument-error"),Yc._fromEmailAndCode(h,y.code,y.tenantId)}}return p.PROVIDER_ID="password",p.EMAIL_PASSWORD_SIGN_IN_METHOD="password",p.EMAIL_LINK_SIGN_IN_METHOD="emailLink",p})();class Zs{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class nu extends Zs{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class _i extends nu{static credentialFromJSON(c){const h="string"==typeof c?JSON.parse(c):c;return se("providerId"in h&&"signInMethod"in h,"argument-error"),mi._fromParams(h)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return se(c.idToken||c.accessToken,"argument-error"),mi._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return _i.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return _i.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:h,oauthAccessToken:g,oauthTokenSecret:y,pendingToken:w,nonce:M,providerId:j}=c;if(!g&&!y&&!h&&!w||!j)return null;try{return new _i(j)._credential({idToken:h,accessToken:g,nonce:M,pendingToken:w})}catch{return null}}}let td=(()=>{class p extends nu{constructor(){super("facebook.com")}static credential(h){return mi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.FACEBOOK_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.FACEBOOK_SIGN_IN_METHOD="facebook.com",p.PROVIDER_ID="facebook.com",p})(),Oi=(()=>{class p extends nu{constructor(){super("google.com"),this.addScope("profile")}static credential(h,g){return mi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GOOGLE_SIGN_IN_METHOD,idToken:h,accessToken:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:g,oauthAccessToken:y}=h;if(!g&&!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.GOOGLE_SIGN_IN_METHOD="google.com",p.PROVIDER_ID="google.com",p})(),Rs=(()=>{class p extends nu{constructor(){super("github.com")}static credential(h){return mi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GITHUB_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.GITHUB_SIGN_IN_METHOD="github.com",p.PROVIDER_ID="github.com",p})();class Qs extends Ja{constructor(c,h){super(c,c),this.pendingToken=h}_getIdTokenResponse(c){return Eo(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,Eo(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,Eo(c,h)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y,pendingToken:w}=h;return g&&y&&w&&g===y?new Qs(g,w):null}static _create(c,h){return new Qs(c,h)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ru extends Zs{constructor(c){se(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return ru.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return ru.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const h=Qs.fromJSON(c);return se(h,"argument-error"),h}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:h,providerId:g}=c;if(!h||!g)return null;try{return Qs._create(g,h)}catch{return null}}}let my=(()=>{class p extends nu{constructor(){super("twitter.com")}static credential(h,g){return mi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.TWITTER_SIGN_IN_METHOD,oauthToken:h,oauthTokenSecret:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthAccessToken:g,oauthTokenSecret:y}=h;if(!g||!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.TWITTER_SIGN_IN_METHOD="twitter.com",p.PROVIDER_ID="twitter.com",p})();function Ps(p,c){return ca.apply(this,arguments)}function ca(){return(ca=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signUp",B(p,c))})).apply(this,arguments)}class yi{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,h,g,y=!1){return(0,A.Z)(function*(){const w=yield E._fromIdTokenResponse(c,g,y),M=sp(g);return new yi({user:w,providerId:M,_tokenResponse:g,operationType:h})})()}static _forOperation(c,h,g){return(0,A.Z)(function*(){yield c._updateTokensIfNecessary(g,!0);const y=sp(g);return new yi({user:c,providerId:y,_tokenResponse:g,operationType:h})})()}}function sp(p){return p.providerId?p.providerId:"phoneNumber"in p?"phone":null}function op(p){return nd.apply(this,arguments)}function nd(){return(nd=(0,A.Z)(function*(p){var c;const h=hn(p);if(yield h._initializationPromise,null!==(c=h.currentUser)&&void 0!==c&&c.isAnonymous)return new yi({user:h.currentUser,providerId:null,operationType:"signIn"});const g=yield Ps(h,{returnSecureToken:!0}),y=yield yi._fromIdTokenResponse(h,"signIn",g,!0);return yield h._updateCurrentUser(y.user),y})).apply(this,arguments)}class El extends Z.ZR{constructor(c,h,g,y){var w;super(h.code,h.message),this.operationType=g,this.user=y,Object.setPrototypeOf(this,El.prototype),this.customData={appName:c.name,tenantId:null!==(w=c.tenantId)&&void 0!==w?w:void 0,_serverResponse:h.customData._serverResponse,operationType:g}}static _fromErrorAndOperation(c,h,g,y){return new El(c,h,g,y)}}function iu(p,c,h,g){return("reauthenticate"===c?h._getReauthenticationResolver(p):h._getIdTokenResponse(p)).catch(w=>{throw"auth/multi-factor-auth-required"===w.code?El._fromErrorAndOperation(p,w,c,g):w})}function ap(p){return new Set(p.map(({providerId:c})=>c).filter(c=>!!c))}function _y(p,c){return up.apply(this,arguments)}function up(){return up=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p);yield id(!0,h,c);const{providerUserInfo:g}=yield function Ji(p,c){return es.apply(this,arguments)}(h.auth,{idToken:yield h.getIdToken(),deleteProvider:[c]}),y=ap(g||[]);return h.providerData=h.providerData.filter(w=>y.has(w.providerId)),y.has("phone")||(h.phoneNumber=null),yield h.auth._persistUserIfCurrent(h),h}),up.apply(this,arguments)}function rd(p,c){return lp.apply(this,arguments)}function lp(){return(lp=(0,A.Z)(function*(p,c,h=!1){const g=yield tn(p,c._linkToIdToken(p.auth,yield p.getIdToken()),h);return yi._forOperation(p,"link",g)})).apply(this,arguments)}function id(p,c,h){return vi.apply(this,arguments)}function vi(){return(vi=(0,A.Z)(function*(p,c,h){yield Yn(c);const y=!1===p?"provider-already-linked":"no-such-provider";se(ap(c.providerData).has(h)===p,c.auth,y)})).apply(this,arguments)}function yy(p,c){return sd.apply(this,arguments)}function sd(){return(sd=(0,A.Z)(function*(p,c,h=!1){const{auth:g}=p,y="reauthenticate";try{const w=yield tn(p,iu(g,y,c,p),h);se(w.idToken,g,"internal-error");const M=wn(w.idToken);se(M,g,"internal-error");const{sub:j}=M;return se(p.uid===j,g,"user-mismatch"),yi._forOperation(p,y,w)}catch(w){throw"auth/user-not-found"===w?.code&&ot(g,"user-mismatch"),w}})).apply(this,arguments)}function vy(p,c){return cp.apply(this,arguments)}function cp(){return(cp=(0,A.Z)(function*(p,c,h=!1){const g="signIn",y=yield iu(p,g,c),w=yield yi._fromIdTokenResponse(p,g,y);return h||(yield p._updateCurrentUser(w.user)),w})).apply(this,arguments)}function od(p,c){return dp.apply(this,arguments)}function dp(){return(dp=(0,A.Z)(function*(p,c){return vy(hn(p),c)})).apply(this,arguments)}function hp(p,c){return fp.apply(this,arguments)}function fp(){return(fp=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p);return yield id(!1,h,c.providerId),rd(h,c)})).apply(this,arguments)}function Ey(p,c){return pp.apply(this,arguments)}function pp(){return(pp=(0,A.Z)(function*(p,c){return yy((0,Z.m9)(p),c)})).apply(this,arguments)}function gp(){return(gp=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithCustomToken",B(p,c))})).apply(this,arguments)}function rC(p,c){return mp.apply(this,arguments)}function mp(){return mp=(0,A.Z)(function*(p,c){const h=hn(p),g=yield function To(p,c){return gp.apply(this,arguments)}(h,{token:c,returnSecureToken:!0}),y=yield yi._fromIdTokenResponse(h,"signIn",g);return yield h._updateCurrentUser(y.user),y}),mp.apply(this,arguments)}class nn{constructor(c,h){this.factorId=c,this.uid=h.mfaEnrollmentId,this.enrollmentTime=new Date(h.enrolledAt).toUTCString(),this.displayName=h.displayName}static _fromServerResponse(c,h){return"phoneInfo"in h?_p._fromServerResponse(c,h):"totpInfo"in h?ad._fromServerResponse(c,h):ot(c,"internal-error")}}class _p extends nn{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,h){return new _p(h)}}class ad extends nn{constructor(c){super("totp",c)}static _fromServerResponse(c,h){return new ad(h)}}function Ve(p,c,h){var g;se((null===(g=h.url)||void 0===g?void 0:g.length)>0,p,"invalid-continue-uri"),se(typeof h.dynamicLinkDomain>"u"||h.dynamicLinkDomain.length>0,p,"invalid-dynamic-link-domain"),c.continueUrl=h.url,c.dynamicLinkDomain=h.dynamicLinkDomain,c.canHandleCodeInApp=h.handleCodeInApp,h.iOS&&(se(h.iOS.bundleId.length>0,p,"missing-ios-bundle-id"),c.iOSBundleId=h.iOS.bundleId),h.android&&(se(h.android.packageName.length>0,p,"missing-android-pkg-name"),c.androidInstallApp=h.android.installApp,c.androidMinimumVersionCode=h.android.minimumVersion,c.androidPackageName=h.android.packageName)}function Tr(p){return dt.apply(this,arguments)}function dt(){return(dt=(0,A.Z)(function*(p){const c=hn(p);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function hr(p,c,h){return fr.apply(this,arguments)}function fr(){return(fr=(0,A.Z)(function*(p,c,h){const g=hn(p),y={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};h&&Ve(g,y,h),yield wr(g,y,"getOobCode",le)})).apply(this,arguments)}function su(p,c,h){return Fr.apply(this,arguments)}function Fr(){return Fr=(0,A.Z)(function*(p,c,h){yield yl((0,Z.m9)(p),{oobCode:c,newPassword:h}).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&Tr(p),y});return function(y){return g.apply(this,arguments)}}())}),Fr.apply(this,arguments)}function Iy(p,c){return ud.apply(this,arguments)}function ud(){return ud=(0,A.Z)(function*(p,c){yield function Kf(p,c){return Kc.apply(this,arguments)}((0,Z.m9)(p),{oobCode:c})}),ud.apply(this,arguments)}function Il(p,c){return yp.apply(this,arguments)}function yp(){return(yp=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p),g=yield yl(h,{oobCode:c}),y=g.requestType;switch(se(y,h,"internal-error"),y){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":se(g.newEmail,h,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":se(g.mfaInfo,h,"internal-error");default:se(g.email,h,"internal-error")}let w=null;return g.mfaInfo&&(w=nn._fromServerResponse(hn(h),g.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.newEmail:g.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.email:g.newEmail)||null,multiFactorInfo:w},operation:y}})).apply(this,arguments)}function iC(p,c){return rn.apply(this,arguments)}function rn(){return(rn=(0,A.Z)(function*(p,c){const{data:h}=yield Il((0,Z.m9)(p),c);return h.email})).apply(this,arguments)}function me(p,c,h){return qe.apply(this,arguments)}function qe(){return(qe=(0,A.Z)(function*(p,c,h){const g=hn(p),M=yield wr(g,{returnSecureToken:!0,email:c,password:h,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ps).catch(re=>{throw"auth/password-does-not-meet-requirements"===re.code&&Tr(p),re}),j=yield yi._fromIdTokenResponse(g,"signIn",M);return yield g._updateCurrentUser(j.user),j})).apply(this,arguments)}function sn(p,c,h){return od((0,Z.m9)(p),rp.credential(c,h)).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&Tr(p),y});return function(y){return g.apply(this,arguments)}}())}function rs(p,c,h){return da.apply(this,arguments)}function da(){return(da=(0,A.Z)(function*(p,c,h){const g=hn(p),y={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function w(M,j){se(j.handleCodeInApp,g,"argument-error"),j&&Ve(g,M,j)})(y,h),yield wr(g,y,"getOobCode",Qf)})).apply(this,arguments)}function Cr(p,c){const h=la.parseLink(c);return"EMAIL_SIGNIN"===h?.operation}function ou(p,c,h){return fn.apply(this,arguments)}function fn(){return(fn=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),y=rp.credentialWithLink(c,h||En());return se(y._tenantId===(g.tenantId||null),g,"tenant-id-mismatch"),od(g,y)})).apply(this,arguments)}function bo(){return(bo=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:createAuthUri",B(p,c))})).apply(this,arguments)}function ze(p,c){return ha.apply(this,arguments)}function ha(){return ha=(0,A.Z)(function*(p,c){const g={identifier:c,continueUri:In()?En():"http://localhost"},{signinMethods:y}=yield function Co(p,c){return bo.apply(this,arguments)}((0,Z.m9)(p),g);return y||[]}),ha.apply(this,arguments)}function wy(p,c){return Do.apply(this,arguments)}function Do(){return Do=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p),y={requestType:"VERIFY_EMAIL",idToken:yield p.getIdToken()};c&&Ve(h.auth,y,c);const{email:w}=yield function RM(p,c){return fy.apply(this,arguments)}(h.auth,y);w!==p.email&&(yield p.reload())}),Do.apply(this,arguments)}function xn(p,c,h){return fa.apply(this,arguments)}function fa(){return fa=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),w={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield p.getIdToken(),newEmail:c};h&&Ve(g.auth,w,h);const{email:M}=yield function Yf(p,c){return Xf.apply(this,arguments)}(g.auth,w);M!==p.email&&(yield p.reload())}),fa.apply(this,arguments)}function Fi(){return(Fi=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function wl(p,c){return ld.apply(this,arguments)}function ld(){return ld=(0,A.Z)(function*(p,{displayName:c,photoURL:h}){if(void 0===c&&void 0===h)return;const g=(0,Z.m9)(p),w={idToken:yield g.getIdToken(),displayName:c,photoUrl:h,returnSecureToken:!0},M=yield tn(g,function au(p,c){return Fi.apply(this,arguments)}(g.auth,w));g.displayName=M.displayName||null,g.photoURL=M.photoUrl||null;const j=g.providerData.find(({providerId:re})=>"password"===re);j&&(j.displayName=g.displayName,j.photoURL=g.photoURL),yield g._updateTokensIfNecessary(M)}),ld.apply(this,arguments)}function Ao(p,c){return uu((0,Z.m9)(p),c,null)}function Ys(p,c){return uu((0,Z.m9)(p),null,c)}function uu(p,c,h){return pa.apply(this,arguments)}function pa(){return pa=(0,A.Z)(function*(p,c,h){const{auth:g}=p,w={idToken:yield p.getIdToken(),returnSecureToken:!0};c&&(w.email=c),h&&(w.password=h);const M=yield tn(p,function Wf(p,c){return Wc.apply(this,arguments)}(g,w));yield p._updateTokensIfNecessary(M,!0)}),pa.apply(this,arguments)}class Tl{constructor(c,h,g={}){this.isNewUser=c,this.providerId=h,this.profile=g}}class cd extends Tl{constructor(c,h,g,y){super(c,h,g),this.username=y}}class Ty extends Tl{constructor(c,h){super(c,"facebook.com",h)}}class Ns extends cd{constructor(c,h){super(c,"github.com",h,"string"==typeof h?.login?h?.login:null)}}class dd extends Tl{constructor(c,h){super(c,"google.com",h)}}class lu extends cd{constructor(c,h,g){super(c,"twitter.com",h,g)}}function Cl(p){const{user:c,_tokenResponse:h}=p;return c.isAnonymous&&!h?{providerId:null,isNewUser:!1,profile:null}:function at(p){var c,h;if(!p)return null;const{providerId:g}=p,y=p.rawUserInfo?JSON.parse(p.rawUserInfo):{},w=p.isNewUser||"identitytoolkit#SignupNewUserResponse"===p.kind;if(!g&&p?.idToken){const M=null===(h=null===(c=wn(p.idToken))||void 0===c?void 0:c.firebase)||void 0===h?void 0:h.sign_in_provider;if(M)return new Tl(w,"anonymous"!==M&&"custom"!==M?M:null)}if(!g)return null;switch(g){case"facebook.com":return new Ty(w,y);case"github.com":return new Ns(w,y);case"google.com":return new dd(w,y);case"twitter.com":return new lu(w,y,p.screenName||null);case"custom":case"anonymous":return new Tl(w,null);default:return new Tl(w,g,y)}}(h)}class ma{constructor(c,h,g){this.type=c,this.credential=h,this.user=g}static _fromIdtoken(c,h){return new ma("enroll",c,h)}static _fromMfaPendingCredential(c){return new ma("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var h,g;if(c?.multiFactorSession){if(null!==(h=c.multiFactorSession)&&void 0!==h&&h.pendingCredential)return ma._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(g=c.multiFactorSession)&&void 0!==g&&g.idToken)return ma._fromIdtoken(c.multiFactorSession.idToken)}return null}}class by{constructor(c,h,g){this.session=c,this.hints=h,this.signInResolver=g}static _fromError(c,h){const g=hn(c),y=h.customData._serverResponse,w=(y.mfaInfo||[]).map(j=>nn._fromServerResponse(g,j));se(y.mfaPendingCredential,g,"internal-error");const M=ma._fromMfaPendingCredential(y.mfaPendingCredential);return new by(M,w,function(){var j=(0,A.Z)(function*(re){const Ee=yield re._process(g,M);delete y.mfaInfo,delete y.mfaPendingCredential;const xe=Object.assign(Object.assign({},y),{idToken:Ee.idToken,refreshToken:Ee.refreshToken});switch(h.operationType){case"signIn":const ht=yield yi._fromIdTokenResponse(g,h.operationType,xe);return yield g._updateCurrentUser(ht.user),ht;case"reauthenticate":return se(h.user,g,"internal-error"),yi._forOperation(h.user,h.operationType,xe);default:ot(g,"internal-error")}});return function(re){return j.apply(this,arguments)}}())}resolveSignIn(c){var h=this;return(0,A.Z)(function*(){return h.signInResolver(c)})()}}function xM(p,c){var h;const g=(0,Z.m9)(p),y=c;return se(c.customData.operationType,g,"argument-error"),se(null===(h=y.customData._serverResponse)||void 0===h?void 0:h.mfaPendingCredential,g,"argument-error"),by._fromError(g,y)}class Dy{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(h=>{h.mfaInfo&&(this.enrolledFactors=h.mfaInfo.map(g=>nn._fromServerResponse(c.auth,g)))})}static _fromUser(c){return new Dy(c)}getSession(){var c=this;return(0,A.Z)(function*(){return ma._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,h){var g=this;return(0,A.Z)(function*(){const y=c,w=yield g.getSession(),M=yield tn(g.user,y._process(g.user.auth,w,h));return yield g.user._updateTokensIfNecessary(M),g.user.reload()})()}unenroll(c){var h=this;return(0,A.Z)(function*(){const g="string"==typeof c?c:c.uid,y=yield h.user.getIdToken();try{const w=yield tn(h.user,function LM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:withdraw",B(p,c))}(h.user.auth,{idToken:y,mfaEnrollmentId:g}));h.enrolledFactors=h.enrolledFactors.filter(({uid:M})=>M!==g),yield h.user._updateTokensIfNecessary(w),yield h.user.reload()}catch(w){throw w}})()}}const Ay=new WeakMap;function VM(p){const c=(0,Z.m9)(p);return Ay.has(c)||Ay.set(c,Dy._fromUser(c)),Ay.get(c)}const wp="__sak";class sC{constructor(c,h){this.storageRetriever=c,this.type=h}_isAvailable(){try{return this.storage?(this.storage.setItem(wp,"1"),this.storage.removeItem(wp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,h){return this.storage.setItem(c,JSON.stringify(h)),Promise.resolve()}_get(c){const h=this.storage.getItem(c);return Promise.resolve(h?JSON.parse(h):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const oC=(()=>{class p extends sC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(h,g)=>this.onStorageEvent(h,g),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Sy(){const p=(0,Z.z$)();return Re(p)||De(p)}()&&function Ce(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Mn(),this._shouldAllowMigration=!0}forAllChangedKeys(h){for(const g of Object.keys(this.listeners)){const y=this.storage.getItem(g),w=this.localCache[g];y!==w&&h(g,w,y)}}onStorageEvent(h,g=!1){if(!h.key)return void this.forAllChangedKeys((j,re,Ee)=>{this.notifyListeners(j,Ee)});const y=h.key;if(g?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const j=this.storage.getItem(y);if(h.newValue!==j)null!==h.newValue?this.storage.setItem(y,h.newValue):this.storage.removeItem(y);else if(this.localCache[y]===h.newValue&&!g)return}const w=()=>{const j=this.storage.getItem(y);!g&&this.localCache[y]===j||this.notifyListeners(y,j)},M=this.storage.getItem(y);!function L(){return(0,Z.w1)()&&10===document.documentMode}()||M===h.newValue||h.newValue===h.oldValue?w():setTimeout(w,10)}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g&&JSON.parse(g))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((h,g,y)=>{this.onStorageEvent(new StorageEvent("storage",{key:h,oldValue:g,newValue:y}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(h,g){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[h]||(this.listeners[h]=new Set,this.localCache[h]=this.storage.getItem(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(h,g){var y=()=>super._set,w=this;return(0,A.Z)(function*(){yield y().call(w,h,g),w.localCache[h]=JSON.stringify(g)})()}_get(h){var g=()=>super._get,y=this;return(0,A.Z)(function*(){const w=yield g().call(y,h);return y.localCache[h]=JSON.stringify(w),w})()}_remove(h){var g=()=>super._remove,y=this;return(0,A.Z)(function*(){yield g().call(y,h),delete y.localCache[h]})()}}return p.type="LOCAL",p})(),xs=(()=>{class p extends sC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(h,g){}_removeListener(h,g){}}return p.type="SESSION",p})();let jM=(()=>{class p{constructor(h){this.eventTarget=h,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(h){const g=this.receivers.find(w=>w.isListeningto(h));if(g)return g;const y=new p(h);return this.receivers.push(y),y}isListeningto(h){return this.eventTarget===h}handleEvent(h){var g=this;return(0,A.Z)(function*(){const y=h,{eventId:w,eventType:M,data:j}=y.data,re=g.handlersMap[M];if(!re?.size)return;y.ports[0].postMessage({status:"ack",eventId:w,eventType:M});const Ee=Array.from(re).map(function(){var ht=(0,A.Z)(function*(Ur){return Ur(y.origin,j)});return function(Ur){return ht.apply(this,arguments)}}()),xe=yield function BM(p){return Promise.all(p.map(function(){var c=(0,A.Z)(function*(h){try{return{fulfilled:!0,value:yield h}}catch(g){return{fulfilled:!1,reason:g}}});return function(h){return c.apply(this,arguments)}}()))}(Ee);y.ports[0].postMessage({status:"done",eventId:w,eventType:M,response:xe})})()}_subscribe(h,g){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[h]||(this.handlersMap[h]=new Set),this.handlersMap[h].add(g)}_unsubscribe(h,g){this.handlersMap[h]&&g&&this.handlersMap[h].delete(g),(!g||0===this.handlersMap[h].size)&&delete this.handlersMap[h],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return p.receivers=[],p})();function kn(p="",c=10){let h="";for(let g=0;g<c;g++)h+=Math.floor(10*Math.random());return p+h}class hd{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,h,g=50){var y=this;return(0,A.Z)(function*(){const w=typeof MessageChannel<"u"?new MessageChannel:null;if(!w)throw new Error("connection_unavailable");let M,j;return new Promise((re,Ee)=>{const xe=kn("",20);w.port1.start();const ht=setTimeout(()=>{Ee(new Error("unsupported_event"))},g);j={messageChannel:w,onMessage(Ur){const eo=Ur;if(eo.data.eventId===xe)switch(eo.data.status){case"ack":clearTimeout(ht),M=setTimeout(()=>{Ee(new Error("timeout"))},3e3);break;case"done":clearTimeout(M),re(eo.data.response);break;default:clearTimeout(ht),clearTimeout(M),Ee(new Error("invalid_response"))}}},y.handlers.add(j),w.port1.addEventListener("message",j.onMessage),y.target.postMessage({eventType:c,eventId:xe,data:h},[w.port2])}).finally(()=>{j&&y.removeMessageHandler(j)})})()}}function Rt(){return window}function fd(){return typeof Rt().WorkerGlobalScope<"u"&&"function"==typeof Rt().importScripts}function pd(){return(pd=(0,A.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const gd="firebaseLocalStorageDb",bl="firebaseLocalStorage",bp="fbase_key";class du{constructor(c){this.request=c}toPromise(){return new Promise((c,h)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{h(this.request.error)})})}}function _a(p,c){return p.transaction([bl],c?"readwrite":"readonly").objectStore(bl)}function So(){const p=indexedDB.open(gd,1);return new Promise((c,h)=>{p.addEventListener("error",()=>{h(p.error)}),p.addEventListener("upgradeneeded",()=>{const g=p.result;try{g.createObjectStore(bl,{keyPath:bp})}catch(y){h(y)}}),p.addEventListener("success",(0,A.Z)(function*(){const g=p.result;g.objectStoreNames.contains(bl)?c(g):(g.close(),yield function Dl(){const p=indexedDB.deleteDatabase(gd);return new du(p).toPromise()}(),c(yield So()))}))})}function Dp(p,c,h){return xy.apply(this,arguments)}function xy(){return(xy=(0,A.Z)(function*(p,c,h){const g=_a(p,!0).put({[bp]:c,value:h});return new du(g).toPromise()})).apply(this,arguments)}function ky(){return(ky=(0,A.Z)(function*(p,c){const h=_a(p,!1).get(c),g=yield new du(h).toPromise();return void 0===g?null:g.value})).apply(this,arguments)}function Oy(p,c){const h=_a(p,!0).delete(c);return new du(h).toPromise()}const md=(()=>{class p{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var h=this;return(0,A.Z)(function*(){return h.db||(h.db=yield So()),h.db})()}_withRetries(h){var g=this;return(0,A.Z)(function*(){let y=0;for(;;)try{const w=yield g._openDb();return yield h(w)}catch(w){if(y++>3)throw w;g.db&&(g.db.close(),g.db=void 0)}})()}initializeServiceWorkerMessaging(){var h=this;return(0,A.Z)(function*(){return fd()?h.initializeReceiver():h.initializeSender()})()}initializeReceiver(){var h=this;return(0,A.Z)(function*(){h.receiver=jM._getInstance(function My(){return fd()?self:null}()),h.receiver._subscribe("keyChanged",function(){var g=(0,A.Z)(function*(y,w){return{keyProcessed:(yield h._poll()).includes(w.key)}});return function(y,w){return g.apply(this,arguments)}}()),h.receiver._subscribe("ping",function(){var g=(0,A.Z)(function*(y,w){return["keyChanged"]});return function(y,w){return g.apply(this,arguments)}}())})()}initializeSender(){var h=this;return(0,A.Z)(function*(){var g,y;if(h.activeServiceWorker=yield function Ny(){return pd.apply(this,arguments)}(),!h.activeServiceWorker)return;h.sender=new hd(h.activeServiceWorker);const w=yield h.sender._send("ping",{},800);w&&null!==(g=w[0])&&void 0!==g&&g.fulfilled&&null!==(y=w[0])&&void 0!==y&&y.value.includes("keyChanged")&&(h.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(h){var g=this;return(0,A.Z)(function*(){if(g.sender&&g.activeServiceWorker&&function Tp(){var p;return(null===(p=navigator?.serviceWorker)||void 0===p?void 0:p.controller)||null}()===g.activeServiceWorker)try{yield g.sender._send("keyChanged",{key:h},g.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,A.Z)(function*(){try{if(!indexedDB)return!1;const h=yield So();return yield Dp(h,wp,"1"),yield Oy(h,wp),!0}catch{}return!1})()}_withPendingWrite(h){var g=this;return(0,A.Z)(function*(){g.pendingWrites++;try{yield h()}finally{g.pendingWrites--}})()}_set(h,g){var y=this;return(0,A.Z)(function*(){return y._withPendingWrite((0,A.Z)(function*(){return yield y._withRetries(w=>Dp(w,h,g)),y.localCache[h]=g,y.notifyServiceWorker(h)}))})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=yield g._withRetries(w=>function $M(p,c){return ky.apply(this,arguments)}(w,h));return g.localCache[h]=y,y})()}_remove(h){var g=this;return(0,A.Z)(function*(){return g._withPendingWrite((0,A.Z)(function*(){return yield g._withRetries(y=>Oy(y,h)),delete g.localCache[h],g.notifyServiceWorker(h)}))})()}_poll(){var h=this;return(0,A.Z)(function*(){const g=yield h._withRetries(M=>{const j=_a(M,!1).getAll();return new du(j).toPromise()});if(!g)return[];if(0!==h.pendingWrites)return[];const y=[],w=new Set;for(const{fbase_key:M,value:j}of g)w.add(M),JSON.stringify(h.localCache[M])!==JSON.stringify(j)&&(h.notifyListeners(M,j),y.push(M));for(const M of Object.keys(h.localCache))h.localCache[M]&&!w.has(M)&&(h.notifyListeners(M,null),y.push(M));return y})()}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g)}startPolling(){var h=this;this.stopPolling(),this.pollTimer=setInterval((0,A.Z)(function*(){return h._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(h,g){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[h]||(this.listeners[h]=new Set,this._get(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return p.type="LOCAL",p})(),Al=1e12;class Fy{constructor(c){this.auth=c,this.counter=Al,this._widgets=new Map}render(c,h){const g=this.counter;return this._widgets.set(g,new dC(c,this.auth.name,h||{})),this.counter++,g}reset(c){var h;const g=c||Al;null===(h=this._widgets.get(g))||void 0===h||h.delete(),this._widgets.delete(g)}getResponse(c){var h;return(null===(h=this._widgets.get(c||Al))||void 0===h?void 0:h.getResponse())||""}execute(c){var h=this;return(0,A.Z)(function*(){var g;return null===(g=h._widgets.get(c||Al))||void 0===g||g.execute(),""})()}}class dC{constructor(c,h,g){this.params=g,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const y="string"==typeof c?document.getElementById(c):c;se(y,"argument-error",{appName:h}),this.container=y,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function hC(p){const c=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let g=0;g<p;g++)c.push(h.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":h}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,h)try{h()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Sp=ZT("rcb"),Ly=new Wr(3e4,6e4);class Vy{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=Rt().grecaptcha)||void 0===c||!c.render)}load(c,h=""){return se(function pC(p){return p.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(p)}(h),c,"argument-error"),this.shouldResolveImmediately(h)&&Bn(Rt().grecaptcha)?Promise.resolve(Rt().grecaptcha):new Promise((g,y)=>{const w=Rt().setTimeout(()=>{y(Mt(c,"network-request-failed"))},Ly.get());Rt()[Sp]=()=>{Rt().clearTimeout(w),delete Rt()[Sp];const j=Rt().grecaptcha;if(!j||!Bn(j))return void y(Mt(c,"internal-error"));const re=j.render;j.render=(Ee,xe)=>{const ht=re(Ee,xe);return this.counter++,ht},this.hostLanguage=h,g(j)},ay(`https://www.google.com/recaptcha/api.js??${(0,Z.xO)({onload:Sp,render:"explicit",hl:h})}`).catch(()=>{clearTimeout(w),y(Mt(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var h;return!(null===(h=Rt().grecaptcha)||void 0===h||!h.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class GM{load(c){return(0,A.Z)(function*(){return new Fy(c)})()}clearedOneInstance(){}}const Uy="recaptcha",Li={theme:"light",type:"image"};class By{constructor(c,h,g=Object.assign({},Li)){this.parameters=g,this.type=Uy,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=hn(c),this.isInvisible="invisible"===this.parameters.size,se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const y="string"==typeof h?document.getElementById(h):h;se(y,this.auth,"argument-error"),this.container=y,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new GM:new Vy,this.validateStartingState()}verify(){var c=this;return(0,A.Z)(function*(){c.assertNotDestroyed();const h=yield c.render(),g=c.getAssertedRecaptcha();return g.getResponse(h)||new Promise(w=>{const M=j=>{j&&(c.tokenChangeListeners.delete(M),w(j))};c.tokenChangeListeners.add(M),c.isInvisible&&g.execute(h)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){se(!this.parameters.sitekey,this.auth,"argument-error"),se(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return h=>{if(this.tokenChangeListeners.forEach(g=>g(h)),"function"==typeof c)c(h);else if("string"==typeof c){const g=Rt()[c];"function"==typeof g&&g(h)}}}assertNotDestroyed(){se(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,A.Z)(function*(){if(yield c.init(),!c.widgetId){let h=c.container;if(!c.isInvisible){const g=document.createElement("div");h.appendChild(g),h=g}c.widgetId=c.getAssertedRecaptcha().render(h,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,A.Z)(function*(){se(In()&&!fd(),c.auth,"internal-error"),yield function gC(){let p=null;return new Promise(c=>{"complete"!==document.readyState?(p=()=>c(),window.addEventListener("load",p)):c()}).catch(c=>{throw p&&window.removeEventListener("load",p),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const h=yield function Kr(p){return xi.apply(this,arguments)}(c.auth);se(h,c.auth,"internal-error"),c.parameters.sitekey=h})()}getAssertedRecaptcha(){return se(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Rp{constructor(c,h){this.verificationId=c,this.onConfirmation=h}confirm(c){const h=wo._fromVerification(this.verificationId,c);return this.onConfirmation(h)}}function jy(p,c,h){return _d.apply(this,arguments)}function _d(){return(_d=(0,A.Z)(function*(p,c,h){const g=hn(p),y=yield Rl(g,c,(0,Z.m9)(h));return new Rp(y,w=>od(g,w))})).apply(this,arguments)}function mC(p,c,h){return Sl.apply(this,arguments)}function Sl(){return(Sl=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);yield id(!1,g,"phone");const y=yield Rl(g.auth,c,(0,Z.m9)(h));return new Rp(y,w=>hp(g,w))})).apply(this,arguments)}function _C(p,c,h){return Vi.apply(this,arguments)}function Vi(){return(Vi=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),y=yield Rl(g.auth,c,(0,Z.m9)(h));return new Rp(y,w=>Ey(g,w))})).apply(this,arguments)}function Rl(p,c,h){return yd.apply(this,arguments)}function yd(){return yd=(0,A.Z)(function*(p,c,h){var g;const y=yield h.verify();try{let w;if(se("string"==typeof y,p,"argument-error"),se(h.type===Uy,p,"argument-error"),w="string"==typeof c?{phoneNumber:c}:c,"session"in w){const M=w.session;if("phoneNumber"in w)return se("enroll"===M.type,p,"internal-error"),(yield function kM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:start",B(p,c))}(p,{idToken:M.credential,phoneEnrollmentInfo:{phoneNumber:w.phoneNumber,recaptchaToken:y}})).phoneSessionInfo.sessionInfo;{se("signin"===M.type,p,"internal-error");const j=(null===(g=w.multiFactorHint)||void 0===g?void 0:g.uid)||w.multiFactorUid;return se(j,p,"missing-multi-factor-info"),(yield function lC(p,c){return J(p,"POST","/v2/accounts/mfaSignIn:start",B(p,c))}(p,{mfaPendingCredential:M.credential,mfaEnrollmentId:j,phoneSignInInfo:{recaptchaToken:y}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:M}=yield function eC(p,c){return tp.apply(this,arguments)}(p,{phoneNumber:w.phoneNumber,recaptchaToken:y});return M}}finally{h._reset()}}),yd.apply(this,arguments)}function Gt(p,c){return Pl.apply(this,arguments)}function Pl(){return(Pl=(0,A.Z)(function*(p,c){yield rd((0,Z.m9)(p),c)})).apply(this,arguments)}let vd=(()=>{class p{constructor(h){this.providerId=p.PROVIDER_ID,this.auth=hn(h)}verifyPhoneNumber(h,g){return Rl(this.auth,h,(0,Z.m9)(g))}static credential(h,g){return wo._fromVerification(h,g)}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{phoneNumber:g,temporaryProof:y}=h;return g&&y?wo._fromTokenResponse(g,y):null}}return p.PROVIDER_ID="phone",p.PHONE_SIGN_IN_METHOD="phone",p})();function $n(p,c){return c?K(c):(se(p._popupRedirectResolver,p,"argument-error"),p._popupRedirectResolver)}class Pp extends Ja{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return Eo(c,this._buildIdpRequest())}_linkToIdToken(c,h){return Eo(c,this._buildIdpRequest(h))}_getReauthenticationResolver(c){return Eo(c,this._buildIdpRequest())}_buildIdpRequest(c){const h={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(h.idToken=c),h}}function $y(p){return vy(p.auth,new Pp(p),p.bypassAuthState)}function hu(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),yy(h,new Pp(p),p.bypassAuthState)}function Ii(p){return Np.apply(this,arguments)}function Np(){return(Np=(0,A.Z)(function*(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),rd(h,new Pp(p),p.bypassAuthState)})).apply(this,arguments)}class Hy{constructor(c,h,g,y,w=!1){this.auth=c,this.resolver=g,this.user=y,this.bypassAuthState=w,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(h)?h:[h]}execute(){var c=this;return new Promise(function(){var h=(0,A.Z)(function*(g,y){c.pendingPromise={resolve:g,reject:y};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(w){c.reject(w)}});return function(g,y){return h.apply(this,arguments)}}())}onAuthEvent(c){var h=this;return(0,A.Z)(function*(){const{urlResponse:g,sessionId:y,postBody:w,tenantId:M,error:j,type:re}=c;if(j)return void h.reject(j);const Ee={auth:h.auth,requestUri:g,sessionId:y,tenantId:M||void 0,postBody:w||void 0,user:h.user,bypassAuthState:h.bypassAuthState};try{h.resolve(yield h.getIdpTask(re)(Ee))}catch(xe){h.reject(xe)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return $y;case"linkViaPopup":case"linkViaRedirect":return Ii;case"reauthViaPopup":case"reauthViaRedirect":return hu;default:ot(this.auth,"internal-error")}}resolve(c){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yC=new Wr(2e3,1e4);function Ro(p,c,h){return Ed.apply(this,arguments)}function Ed(){return(Ed=(0,A.Z)(function*(p,c,h){const g=hn(p);Un(p,c,Zs);const y=$n(g,h);return new Mp(g,"signInViaPopup",c,y).executeNotNull()})).apply(this,arguments)}function vC(p,c,h){return Id.apply(this,arguments)}function Id(){return(Id=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Un(g.auth,c,Zs);const y=$n(g.auth,h);return new Mp(g.auth,"reauthViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}function qy(p,c,h){return wd.apply(this,arguments)}function wd(){return(wd=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Un(g.auth,c,Zs);const y=$n(g.auth,h);return new Mp(g.auth,"linkViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}let Mp=(()=>{class p extends Hy{constructor(h,g,y,w,M){super(h,g,w,M),this.provider=y,this.authWindow=null,this.pollId=null,p.currentPopupAction&&p.currentPopupAction.cancel(),p.currentPopupAction=this}executeNotNull(){var h=this;return(0,A.Z)(function*(){const g=yield h.execute();return se(g,h.auth,"internal-error"),g})()}onExecution(){var h=this;return(0,A.Z)(function*(){Kt(1===h.filter.length,"Popup operations only handle one event");const g=kn();h.authWindow=yield h.resolver._openPopup(h.auth,h.provider,h.filter[0],g),h.authWindow.associatedEvent=g,h.resolver._originValidation(h.auth).catch(y=>{h.reject(y)}),h.resolver._isIframeWebStorageSupported(h.auth,y=>{y||h.reject(Mt(h.auth,"web-storage-unsupported"))}),h.pollUserCancellation()})()}get eventId(){var h;return(null===(h=this.authWindow)||void 0===h?void 0:h.associatedEvent)||null}cancel(){this.reject(Mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,p.currentPopupAction=null}pollUserCancellation(){const h=()=>{var g,y;this.pollId=null!==(y=null===(g=this.authWindow)||void 0===g?void 0:g.window)&&void 0!==y&&y.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Mt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(h,yC.get())};h()}}return p.currentPopupAction=null,p})();const Be="pendingRedirect",fu=new Map;class WM extends Hy{constructor(c,h,g=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],h,void 0,g),this.eventId=null}execute(){var c=()=>super.execute,h=this;return(0,A.Z)(function*(){let g=fu.get(h.auth._key());if(!g){try{const w=(yield function EC(p,c){return xp.apply(this,arguments)}(h.resolver,h.auth))?yield c().call(h):null;g=()=>Promise.resolve(w)}catch(y){g=()=>Promise.reject(y)}fu.set(h.auth._key(),g)}return h.bypassAuthState||fu.set(h.auth._key(),()=>Promise.resolve(null)),g()})()}onAuthEvent(c){var h=()=>super.onAuthEvent,g=this;return(0,A.Z)(function*(){if("signInViaRedirect"===c.type)return h().call(g,c);if("unknown"!==c.type){if(c.eventId){const y=yield g.auth._redirectUserForId(c.eventId);if(y)return g.user=y,h().call(g,c);g.resolve(null)}}else g.resolve(null)})()}onExecution(){return(0,A.Z)(function*(){})()}cleanUp(){}}function xp(){return(xp=(0,A.Z)(function*(p,c){const h=Wy(c),g=Gy(p);if(!(yield g._isAvailable()))return!1;const y="true"===(yield g._get(h));return yield g._remove(h),y})).apply(this,arguments)}function kp(p,c){return Td.apply(this,arguments)}function Td(){return(Td=(0,A.Z)(function*(p,c){return Gy(p)._set(Wy(c),"true")})).apply(this,arguments)}function pu(){fu.clear()}function zy(p,c){fu.set(p._key(),c)}function Gy(p){return K(p._redirectPersistence)}function Wy(p){return Fe(Be,p.config.apiKey,p.name)}function IC(p,c,h){return function wC(p,c,h){return ee.apply(this,arguments)}(p,c,h)}function ee(){return(ee=(0,A.Z)(function*(p,c,h){const g=hn(p);Un(p,c,Zs),yield g._initializationPromise;const y=$n(g,h);return yield kp(y,g),y._openRedirect(g,c,"signInViaRedirect")})).apply(this,arguments)}function It(p,c,h){return function Op(p,c,h){return Nl.apply(this,arguments)}(p,c,h)}function Nl(){return(Nl=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Un(g.auth,c,Zs),yield g.auth._initializationPromise;const y=$n(g.auth,h);yield kp(y,g.auth);const w=yield TC(g);return y._openRedirect(g.auth,c,"reauthViaRedirect",w)})).apply(this,arguments)}function gr(p,c,h){return function Ky(p,c,h){return ya.apply(this,arguments)}(p,c,h)}function ya(){return(ya=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Un(g.auth,c,Zs),yield g.auth._initializationPromise;const y=$n(g.auth,h);yield id(!1,g,c.providerId),yield kp(y,g.auth);const w=yield TC(g);return y._openRedirect(g.auth,c,"linkViaRedirect",w)})).apply(this,arguments)}function ks(p,c){return Ml.apply(this,arguments)}function Ml(){return(Ml=(0,A.Z)(function*(p,c){return yield hn(p)._initializationPromise,xl(p,c,!1)})).apply(this,arguments)}function xl(p,c){return Fp.apply(this,arguments)}function Fp(){return(Fp=(0,A.Z)(function*(p,c,h=!1){const g=hn(p),y=$n(g,c),M=yield new WM(g,y,h).execute();return M&&!h&&(delete M.user._redirectEventId,yield g._persistUserIfCurrent(M.user),yield g._setRedirectUser(null,c)),M})).apply(this,arguments)}function TC(p){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,A.Z)(function*(p){const c=kn(`${p.uid}:::`);return p._redirectEventId=c,yield p.auth._setRedirectUser(p),yield p.auth._persistUserIfCurrent(p),c})).apply(this,arguments)}class Os{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let h=!1;return this.consumers.forEach(g=>{this.isEventForConsumer(c,g)&&(h=!0,this.sendToConsumer(c,g),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function Xs(p){switch(p.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return va(p);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,h||(this.queuedRedirectEvent=c,h=!0)),h}sendToConsumer(c,h){var g;if(c.error&&!va(c)){const y=(null===(g=c.error.code)||void 0===g?void 0:g.split("auth/")[1])||"internal-error";h.onError(Mt(this.auth,y))}else h.onAuthEvent(c)}isEventForConsumer(c,h){const g=null===h.eventId||!!c.eventId&&c.eventId===h.eventId;return h.filter.includes(c.type)&&g}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Lp(c))}saveEventToCache(c){this.cachedEventUids.add(Lp(c)),this.lastProcessedEventTime=Date.now()}}function Lp(p){return[p.type,p.eventId,p.sessionId,p.tenantId].filter(c=>c).join("-")}function va({type:p,error:c}){return"unknown"===p&&"auth/no-auth-event"===c?.code}function Zy(p){return bd.apply(this,arguments)}function bd(){return(bd=(0,A.Z)(function*(p,c={}){return J(p,"GET","/v1/projects",c)})).apply(this,arguments)}const CC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bC=/^https?/;function kl(){return(kl=(0,A.Z)(function*(p){if(p.config.emulator)return;const{authorizedDomains:c}=yield Zy(p);for(const h of c)try{if(Qy(h))return}catch{}ot(p,"unauthorized-domain")})).apply(this,arguments)}function Qy(p){const c=En(),{protocol:h,hostname:g}=new URL(c);if(p.startsWith("chrome-extension://")){const M=new URL(p);return""===M.hostname&&""===g?"chrome-extension:"===h&&p.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===h&&M.hostname===g}if(!bC.test(h))return!1;if(CC.test(p))return g===p;const y=p.replace(/\./g,"\\.");return new RegExp("^(.+\\."+y+"|"+y+")$","i").test(g)}const Up=new Wr(3e4,6e4);function Yy(){const p=Rt().___jsl;if(p?.H)for(const c of Object.keys(p.H))if(p.H[c].r=p.H[c].r||[],p.H[c].L=p.H[c].L||[],p.H[c].r=[...p.H[c].L],p.CP)for(let h=0;h<p.CP.length;h++)p.CP[h]=null}let gu=null;const ev=new Wr(5e3,15e3),tv="__/auth/iframe",nv="emulator/auth/iframe",Bp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AC(p){const c=p.config;se(c.authDomain,p,"auth-domain-config-required");const h=c.emulator?Cs(c,nv):`https://${p.config.authDomain}/${tv}`,g={apiKey:c.apiKey,appName:p.name,v:F.SDK_VERSION},y=DC.get(p.config.apiHost);y&&(g.eid=y);const w=p._getFrameworks();return w.length&&(g.fw=w.join(",")),`${h}?${(0,Z.xO)(g).slice(1)}`}function Js(){return Js=(0,A.Z)(function*(p){const c=yield function Jy(p){return gu=gu||function Xy(p){return new Promise((c,h)=>{var g,y,w;function M(){Yy(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{Yy(),h(Mt(p,"network-request-failed"))},timeout:Up.get()})}if(null!==(y=null===(g=Rt().gapi)||void 0===g?void 0:g.iframes)&&void 0!==y&&y.Iframe)c(gapi.iframes.getContext());else{if(null===(w=Rt().gapi)||void 0===w||!w.load){const j=ZT("iframefcb");return Rt()[j]=()=>{gapi.load?M():h(Mt(p,"network-request-failed"))},ay(`https://apis.google.com/js/api.js?onload=${j}`).catch(re=>h(re))}M()}}).catch(c=>{throw gu=null,c})}(p),gu}(p),h=Rt().gapi;return se(h,p,"internal-error"),c.open({where:document.body,url:AC(p),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Bp,dontclear:!0},g=>new Promise(function(){var y=(0,A.Z)(function*(w,M){yield g.restyle({setHideOnLeave:!1});const j=Mt(p,"network-request-failed"),re=Rt().setTimeout(()=>{M(j)},ev.get());function Ee(){Rt().clearTimeout(re),w(g)}g.ping(Ee).then(Ee,()=>{M(j)})});return function(w,M){return y.apply(this,arguments)}}()))}),Js.apply(this,arguments)}const pn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class jp{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Po="__/auth/handler",MC="emulator/auth/handler",Ad=encodeURIComponent("fac");function mu(p,c,h,g,y,w){return _u.apply(this,arguments)}function _u(){return(_u=(0,A.Z)(function*(p,c,h,g,y,w){se(p.config.authDomain,p,"auth-domain-config-required"),se(p.config.apiKey,p,"invalid-api-key");const M={apiKey:p.config.apiKey,appName:p.name,authType:h,redirectUrl:g,v:F.SDK_VERSION,eventId:y};if(c instanceof Zs){c.setDefaultLanguage(p.languageCode),M.providerId=c.providerId||"",(0,Z.xb)(c.getCustomParameters())||(M.customParameters=JSON.stringify(c.getCustomParameters()));for(const[xe,ht]of Object.entries(w||{}))M[xe]=ht}if(c instanceof nu){const xe=c.getScopes().filter(ht=>""!==ht);xe.length>0&&(M.scopes=xe.join(","))}p.tenantId&&(M.tid=p.tenantId);const j=M;for(const xe of Object.keys(j))void 0===j[xe]&&delete j[xe];const re=yield p._getAppCheckToken(),Ee=re?`#${Ad}=${encodeURIComponent(re)}`:"";return`${function $p({config:p}){return p.emulator?Cs(p,MC):`https://${p.authDomain}/${Po}`}(p)}?${(0,Z.xO)(j).slice(1)}${Ee}`})).apply(this,arguments)}const Sd="webStorageSupport",sv=class iv{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xs,this._completeRedirectFn=xl,this._overrideRedirectResult=zy}_openPopup(c,h,g,y){var w=this;return(0,A.Z)(function*(){var M;Kt(null===(M=w.eventManagers[c._key()])||void 0===M?void 0:M.manager,"_initialize() not called before _openPopup()");const j=yield mu(c,h,g,En(),y);return function rv(p,c,h,g=500,y=600){const w=Math.max((window.screen.availHeight-y)/2,0).toString(),M=Math.max((window.screen.availWidth-g)/2,0).toString();let j="";const re=Object.assign(Object.assign({},pn),{width:g.toString(),height:y.toString(),top:w,left:M}),Ee=(0,Z.z$)().toLowerCase();h&&(j=or(Ee)?"_blank":h),Ft(Ee)&&(c=c||"http://localhost",re.scrollbars="yes");const xe=Object.entries(re).reduce((Ur,[eo,Vl])=>`${Ur}${eo}=${Vl},`,"");if(function nt(p=(0,Z.z$)()){var c;return De(p)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(Ee)&&"_self"!==j)return function Dd(p,c){const h=document.createElement("a");h.href=p,h.target=c;const g=document.createEvent("MouseEvent");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(g)}(c||"",j),new jp(null);const ht=window.open(c||"",j,xe);se(ht,p,"popup-blocked");try{ht.focus()}catch{}return new jp(ht)}(c,j,kn())})()}_openRedirect(c,h,g,y){var w=this;return(0,A.Z)(function*(){return yield w._originValidation(c),function Py(p){Rt().location.href=p}(yield mu(c,h,g,En(),y)),new Promise(()=>{})})()}_initialize(c){const h=c._key();if(this.eventManagers[h]){const{manager:y,promise:w}=this.eventManagers[h];return y?Promise.resolve(y):(Kt(w,"If manager is not set, promise should be"),w)}const g=this.initAndGetManager(c);return this.eventManagers[h]={promise:g},g.catch(()=>{delete this.eventManagers[h]}),g}initAndGetManager(c){var h=this;return(0,A.Z)(function*(){const g=yield function Vr(p){return Js.apply(this,arguments)}(c),y=new Os(c);return g.register("authEvent",w=>(se(w?.authEvent,c,"invalid-auth-event"),{status:y.onEvent(w.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),h.eventManagers[c._key()]={manager:y},h.iframes[c._key()]=g,y})()}_isIframeWebStorageSupported(c,h){this.iframes[c._key()].send(Sd,{type:Sd},y=>{var w;const M=null===(w=y?.[0])||void 0===w?void 0:w[Sd];void 0!==M&&h(!!M),ot(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const h=c._key();return this.originValidationPromises[h]||(this.originValidationPromises[h]=function Vp(p){return kl.apply(this,arguments)}(c)),this.originValidationPromises[h]}get _shouldInitProactively(){return Mn()||Re()||De()}};class yu{constructor(c){this.factorId=c}_process(c,h,g){switch(h.type){case"enroll":return this._finalizeEnroll(c,h.credential,g);case"signin":return this._finalizeSignIn(c,h.credential);default:return pt("unexpected MultiFactorSessionType")}}}class Ea extends yu{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new Ea(c)}_finalizeEnroll(c,h,g){return function OM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:finalize",B(p,c))}(c,{idToken:h,displayName:g,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,h){return function Ap(p,c){return J(p,"POST","/v2/accounts/mfaSignIn:finalize",B(p,c))}(c,{mfaPendingCredential:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let xC=(()=>{class p{constructor(){}static assertion(h){return Ea._fromCredential(h)}}return p.FACTOR_ID="phone",p})();var ov="@firebase/auth";class KM{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var h=this;return(0,A.Z)(function*(){return h.assertAuthConfigured(),yield h.auth._initializationPromise,h.auth.currentUser?{accessToken:yield h.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const h=this.auth.onIdTokenChanged(g=>{c(g?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,h),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const h=this.internalListeners.get(c);h&&(this.internalListeners.delete(c),h(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,Z.Pz)("authIdTokenMaxAge"),function Fl(p){(0,F._registerComponent)(new Xt.wA("auth",(c,{options:h})=>{const g=c.getProvider("app").getImmediate(),y=c.getProvider("heartbeat"),w=c.getProvider("app-check-internal"),{apiKey:M,authDomain:j}=g.options;se(M&&!M.includes(":"),"invalid-api-key",{appName:g.name});const re={apiKey:M,authDomain:j,clientPlatform:p,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:st(p)},Ee=new CM(g,y,w,re);return function ye(p,c){const h=c?.persistence||[],g=(Array.isArray(h)?h:[h]).map(K);c?.errorMap&&p._updateErrorMap(c.errorMap),p._initializeWithPersistence(g,c?.popupRedirectResolver)}(Ee,h),Ee},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,h,g)=>{c.getProvider("auth-internal").initialize()})),(0,F._registerComponent)(new Xt.wA("auth-internal",c=>{const h=hn(c.getProvider("auth").getImmediate());return new KM(h)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,F.registerVersion)(ov,"1.4.0",function Hp(p){switch(p){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(p)),(0,F.registerVersion)(ov,"1.4.0","esm2017")}("Browser")},58:(Ts,Kn,ke)=>{ke.d(Kn,{BH:()=>ci,DV:()=>sr,Dv:()=>Zr,G6:()=>Cs,GJ:()=>Bn,L:()=>yt,LL:()=>Y,Pz:()=>Mt,Sg:()=>Un,UG:()=>pt,UI:()=>xi,US:()=>Xt,Wj:()=>tn,Wl:()=>Ne,Yr:()=>Wr,ZB:()=>be,ZR:()=>J,aH:()=>ot,b$:()=>In,cI:()=>de,dS:()=>ts,eu:()=>G,g5:()=>F,gK:()=>wn,gQ:()=>cr,h$:()=>Ut,hl:()=>$,hu:()=>Z,jU:()=>Kt,lb:()=>Tn,m9:()=>Ss,ne:()=>di,p$:()=>ae,pd:()=>es,r3:()=>Qn,ru:()=>En,tV:()=>X,uI:()=>se,ug:()=>ki,vZ:()=>bs,w1:()=>Xi,w9:()=>en,xO:()=>As,xb:()=>Kr,z$:()=>Xe,zd:()=>Ji});const A={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Z=function(N,S){if(!N)throw F(S)},F=function(N){return new Error("Firebase Database ("+A.SDK_VERSION+") INTERNAL ASSERT FAILED: "+N)},Ae=function(N){const S=[];let I=0;for(let C=0;C<N.length;C++){let E=N.charCodeAt(C);E<128?S[I++]=E:E<2048?(S[I++]=E>>6|192,S[I++]=63&E|128):55296==(64512&E)&&C+1<N.length&&56320==(64512&N.charCodeAt(C+1))?(E=65536+((1023&E)<<10)+(1023&N.charCodeAt(++C)),S[I++]=E>>18|240,S[I++]=E>>12&63|128,S[I++]=E>>6&63|128,S[I++]=63&E|128):(S[I++]=E>>12|224,S[I++]=E>>6&63|128,S[I++]=63&E|128)}return S},Xt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(N,S){if(!Array.isArray(N))throw Error("encodeByteArray takes an array as a parameter");this.init_();const I=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,C=[];for(let E=0;E<N.length;E+=3){const R=N[E],K=E+1<N.length,Ie=K?N[E+1]:0,ve=E+2<N.length,Fe=ve?N[E+2]:0;let Ft=(15&Ie)<<2|Fe>>6,Re=63&Fe;ve||(Re=64,K||(Ft=64)),C.push(I[R>>2],I[(3&R)<<4|Ie>>4],I[Ft],I[Re])}return C.join("")},encodeString(N,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(N):this.encodeByteArray(Ae(N),S)},decodeString(N,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(N):function(N){const S=[];let I=0,C=0;for(;I<N.length;){const E=N[I++];if(E<128)S[C++]=String.fromCharCode(E);else if(E>191&&E<224){const R=N[I++];S[C++]=String.fromCharCode((31&E)<<6|63&R)}else if(E>239&&E<365){const ve=((7&E)<<18|(63&N[I++])<<12|(63&N[I++])<<6|63&N[I++])-65536;S[C++]=String.fromCharCode(55296+(ve>>10)),S[C++]=String.fromCharCode(56320+(1023&ve))}else{const R=N[I++],K=N[I++];S[C++]=String.fromCharCode((15&E)<<12|(63&R)<<6|63&K)}}return S.join("")}(this.decodeStringToByteArray(N,S))},decodeStringToByteArray(N,S){this.init_();const I=S?this.charToByteMapWebSafe_:this.charToByteMap_,C=[];for(let E=0;E<N.length;){const R=I[N.charAt(E++)],Ie=E<N.length?I[N.charAt(E)]:0;++E;const Fe=E<N.length?I[N.charAt(E)]:64;++E;const ge=E<N.length?I[N.charAt(E)]:64;if(++E,null==R||null==Ie||null==Fe||null==ge)throw new Nn;C.push(R<<2|Ie>>4),64!==Fe&&(C.push(Ie<<4&240|Fe>>2),64!==ge&&C.push(Fe<<6&192|ge))}return C},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let N=0;N<this.ENCODED_VALS.length;N++)this.byteToCharMap_[N]=this.ENCODED_VALS.charAt(N),this.charToByteMap_[this.byteToCharMap_[N]]=N,this.byteToCharMapWebSafe_[N]=this.ENCODED_VALS_WEBSAFE.charAt(N),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[N]]=N,N>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(N)]=N,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(N)]=N)}}};class Nn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ut=function(N){const S=Ae(N);return Xt.encodeByteArray(S,!0)},yt=function(N){return Ut(N).replace(/\./g,"")},X=function(N){try{return Xt.decodeString(N,!0)}catch(S){console.error("base64Decode failed: ",S)}return null};function ae(N){return be(void 0,N)}function be(N,S){if(!(S instanceof Object))return S;switch(S.constructor){case Date:return new Date(S.getTime());case Object:void 0===N&&(N={});break;case Array:N=[];break;default:return S}for(const I in S)!S.hasOwnProperty(I)||!We(I)||(N[I]=be(N[I],S[I]));return N}function We(N){return"__proto__"!==N}const He=()=>{try{return function Ct(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const N=process.env.__FIREBASE_DEFAULTS__;return N?JSON.parse(N):void 0})()||(()=>{if(typeof document>"u")return;let N;try{N=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const S=N&&X(N[1]);return S&&JSON.parse(S)})()}catch(N){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${N}`)}},ot=()=>{var N;return null===(N=He())||void 0===N?void 0:N.config},Mt=N=>{var S;return null===(S=He())||void 0===S?void 0:S[`_${N}`]};class ci{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((S,I)=>{this.resolve=S,this.reject=I})}wrapCallback(S){return(I,C)=>{I?this.reject(I):this.resolve(C),"function"==typeof S&&(this.promise.catch(()=>{}),1===S.length?S(I):S(I,C))}}}function Un(N,S){if(N.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const C=S||"demo-project",E=N.iat||0,R=N.sub||N.user_id;if(!R)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const K=Object.assign({iss:`https://securetoken.google.com/${C}`,aud:C,iat:E,exp:E+3600,auth_time:E,sub:R,user_id:R,firebase:{sign_in_provider:"custom",identities:{}}},N);return[yt(JSON.stringify({alg:"none",type:"JWT"})),yt(JSON.stringify(K)),""].join(".")}function Xe(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function se(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xe())}function pt(){var N;const S=null===(N=He())||void 0===N?void 0:N.forceEnvironment;if("node"===S)return!0;if("browser"===S)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Kt(){return"object"==typeof self&&self.self===self}function En(){const N="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof N&&void 0!==N.id}function In(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Xi(){const N=Xe();return N.indexOf("MSIE ")>=0||N.indexOf("Trident/")>=0}function Wr(){return!0===A.NODE_CLIENT||!0===A.NODE_ADMIN}function Cs(){return!pt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $(){try{return"object"==typeof indexedDB}catch{return!1}}function G(){return new Promise((N,S)=>{try{let I=!0;const C="validate-browser-context-for-indexeddb-analytics-module",E=self.indexedDB.open(C);E.onsuccess=()=>{E.result.close(),I||self.indexedDB.deleteDatabase(C),N(!0)},E.onupgradeneeded=()=>{I=!1},E.onerror=()=>{var R;S((null===(R=E.error)||void 0===R?void 0:R.message)||"")}}catch(I){S(I)}})}class J extends Error{constructor(S,I,C){super(I),this.code=S,this.customData=C,this.name="FirebaseError",Object.setPrototypeOf(this,J.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y.prototype.create)}}class Y{constructor(S,I,C){this.service=S,this.serviceName=I,this.errors=C}create(S,...I){const C=I[0]||{},E=`${this.service}/${S}`,R=this.errors[S],K=R?function ce(N,S){return N.replace(it,(I,C)=>{const E=S[C];return null!=E?String(E):`<${C}?>`})}(R,C):"Error";return new J(E,`${this.serviceName}: ${K} (${E}).`,C)}}const it=/\{\$([^}]+)}/g;function de(N){return JSON.parse(N)}function Ne(N){return JSON.stringify(N)}const vt=function(N){let S={},I={},C={},E="";try{const R=N.split(".");S=de(X(R[0])||""),I=de(X(R[1])||""),E=R[2],C=I.d||{},delete I.d}catch{}return{header:S,claims:I,data:C,signature:E}},en=function(N){const I=vt(N).claims;return!!I&&"object"==typeof I&&I.hasOwnProperty("iat")},Bn=function(N){const S=vt(N).claims;return"object"==typeof S&&!0===S.admin};function Qn(N,S){return Object.prototype.hasOwnProperty.call(N,S)}function sr(N,S){if(Object.prototype.hasOwnProperty.call(N,S))return N[S]}function Kr(N){for(const S in N)if(Object.prototype.hasOwnProperty.call(N,S))return!1;return!0}function xi(N,S,I){const C={};for(const E in N)Object.prototype.hasOwnProperty.call(N,E)&&(C[E]=S.call(I,N[E],E,N));return C}function bs(N,S){if(N===S)return!0;const I=Object.keys(N),C=Object.keys(S);for(const E of I){if(!C.includes(E))return!1;const R=N[E],K=S[E];if(gt(R)&&gt(K)){if(!bs(R,K))return!1}else if(R!==K)return!1}for(const E of C)if(!I.includes(E))return!1;return!0}function gt(N){return null!==N&&"object"==typeof N}function As(N){const S=[];for(const[I,C]of Object.entries(N))Array.isArray(C)?C.forEach(E=>{S.push(encodeURIComponent(I)+"="+encodeURIComponent(E))}):S.push(encodeURIComponent(I)+"="+encodeURIComponent(C));return S.length?"&"+S.join("&"):""}function Ji(N){const S={};return N.replace(/^\?/,"").split("&").forEach(C=>{if(C){const[E,R]=C.split("=");S[decodeURIComponent(E)]=decodeURIComponent(R)}}),S}function es(N){const S=N.indexOf("?");if(!S)return"";const I=N.indexOf("#",S);return N.substring(S,I>0?I:void 0)}class cr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let S=1;S<this.blockSize;++S)this.pad_[S]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(S,I){I||(I=0);const C=this.W_;if("string"==typeof S)for(let ge=0;ge<16;ge++)C[ge]=S.charCodeAt(I)<<24|S.charCodeAt(I+1)<<16|S.charCodeAt(I+2)<<8|S.charCodeAt(I+3),I+=4;else for(let ge=0;ge<16;ge++)C[ge]=S[I]<<24|S[I+1]<<16|S[I+2]<<8|S[I+3],I+=4;for(let ge=16;ge<80;ge++){const Ft=C[ge-3]^C[ge-8]^C[ge-14]^C[ge-16];C[ge]=4294967295&(Ft<<1|Ft>>>31)}let Fe,Et,E=this.chain_[0],R=this.chain_[1],K=this.chain_[2],Ie=this.chain_[3],ve=this.chain_[4];for(let ge=0;ge<80;ge++){ge<40?ge<20?(Fe=Ie^R&(K^Ie),Et=1518500249):(Fe=R^K^Ie,Et=1859775393):ge<60?(Fe=R&K|Ie&(R|K),Et=2400959708):(Fe=R^K^Ie,Et=3395469782);const Ft=(E<<5|E>>>27)+Fe+ve+Et+C[ge]&4294967295;ve=Ie,Ie=K,K=4294967295&(R<<30|R>>>2),R=E,E=Ft}this.chain_[0]=this.chain_[0]+E&4294967295,this.chain_[1]=this.chain_[1]+R&4294967295,this.chain_[2]=this.chain_[2]+K&4294967295,this.chain_[3]=this.chain_[3]+Ie&4294967295,this.chain_[4]=this.chain_[4]+ve&4294967295}update(S,I){if(null==S)return;void 0===I&&(I=S.length);const C=I-this.blockSize;let E=0;const R=this.buf_;let K=this.inbuf_;for(;E<I;){if(0===K)for(;E<=C;)this.compress_(S,E),E+=this.blockSize;if("string"==typeof S){for(;E<I;)if(R[K]=S.charCodeAt(E),++K,++E,K===this.blockSize){this.compress_(R),K=0;break}}else for(;E<I;)if(R[K]=S[E],++K,++E,K===this.blockSize){this.compress_(R),K=0;break}}this.inbuf_=K,this.total_+=I}digest(){const S=[];let I=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let E=this.blockSize-1;E>=56;E--)this.buf_[E]=255&I,I/=256;this.compress_(this.buf_);let C=0;for(let E=0;E<5;E++)for(let R=24;R>=0;R-=8)S[C]=this.chain_[E]>>R&255,++C;return S}}function di(N,S){const I=new hi(N,S);return I.subscribe.bind(I)}class hi{constructor(S,I){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=I,this.task.then(()=>{S(this)}).catch(C=>{this.error(C)})}next(S){this.forEachObserver(I=>{I.next(S)})}error(S){this.forEachObserver(I=>{I.error(S)}),this.close(S)}complete(){this.forEachObserver(S=>{S.complete()}),this.close()}subscribe(S,I,C){let E;if(void 0===S&&void 0===I&&void 0===C)throw new Error("Missing Observer.");E=function dr(N,S){if("object"!=typeof N||null===N)return!1;for(const I of S)if(I in N&&"function"==typeof N[I])return!0;return!1}(S,["next","error","complete"])?S:{next:S,error:I,complete:C},void 0===E.next&&(E.next=xt),void 0===E.error&&(E.error=xt),void 0===E.complete&&(E.complete=xt);const R=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?E.error(this.finalError):E.complete()}catch{}}),this.observers.push(E),R}unsubscribeOne(S){void 0===this.observers||void 0===this.observers[S]||(delete this.observers[S],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(S){if(!this.finalized)for(let I=0;I<this.observers.length;I++)this.sendOne(I,S)}sendOne(S,I){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[S])try{I(this.observers[S])}catch(C){typeof console<"u"&&console.error&&console.error(C)}})}close(S){this.finalized||(this.finalized=!0,void 0!==S&&(this.finalError=S),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xt(){}const Zr=function(N,S,I,C){let E;if(C<S?E="at least "+S:C>I&&(E=0===I?"none":"no more than "+I),E)throw new Error(N+" failed: Was called with "+C+(1===C?" argument.":" arguments.")+" Expects "+E+".")};function wn(N,S){return`${N} failed: ${S} argument `}function tn(N,S,I,C){if((!C||I)&&"function"!=typeof I)throw new Error(wn(N,S)+"must be a valid function.")}function Tn(N,S,I,C){if((!C||I)&&("object"!=typeof I||null===I))throw new Error(wn(N,S)+"must be a valid context object.")}const ts=function(N){const S=[];let I=0;for(let C=0;C<N.length;C++){let E=N.charCodeAt(C);if(E>=55296&&E<=56319){const R=E-55296;C++,Z(C<N.length,"Surrogate pair missing trail surrogate."),E=65536+(R<<10)+(N.charCodeAt(C)-56320)}E<128?S[I++]=E:E<2048?(S[I++]=E>>6|192,S[I++]=63&E|128):E<65536?(S[I++]=E>>12|224,S[I++]=E>>6&63|128,S[I++]=63&E|128):(S[I++]=E>>18|240,S[I++]=E>>12&63|128,S[I++]=E>>6&63|128,S[I++]=63&E|128)}return S},ki=function(N){let S=0;for(let I=0;I<N.length;I++){const C=N.charCodeAt(I);C<128?S++:C<2048?S+=2:C>=55296&&C<=56319?(S+=4,I++):S+=3}return S};function Ss(N){return N&&N._delegate?N._delegate:N}},838:(Ts,Kn,ke)=>{function A(n){return"function"==typeof n}function Z(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const F=Z(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Ae(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class _t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(A(r))try{r()}catch(s){e=s instanceof F?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{Ut(s)}catch(o){e=e??[],o instanceof F?e=[...e,...o.errors]:e.push(o)}}if(e)throw new F(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Ut(e);else{if(e instanceof _t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ae(t,e)}remove(e){const{_finalizers:t}=this;t&&Ae(t,e),e instanceof _t&&e._removeParent(this)}}_t.EMPTY=(()=>{const n=new _t;return n.closed=!0,n})();const Xt=_t.EMPTY;function Nn(n){return n instanceof _t||n&&"closed"in n&&A(n.remove)&&A(n.add)&&A(n.unsubscribe)}function Ut(n){A(n)?n():n.unsubscribe()}const yt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},X={setTimeout(n,e,...t){const{delegate:r}=X;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=X;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ae(n){X.setTimeout(()=>{const{onUnhandledError:e}=yt;if(!e)throw n;e(n)})}function be(){}const We=ct("C",void 0,void 0);function ct(n,e,t){return{kind:n,value:e,error:t}}let $e=null;function He(n){if(yt.useDeprecatedSynchronousErrorHandling){const e=!$e;if(e&&($e={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=$e;if($e=null,t)throw r}}else n()}class vn extends _t{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Nn(e)&&e.add(this)):this.destination=Kt}static create(e,t,r){return new Un(e,t,r)}next(e){this.isStopped?pt(function Zn(n){return ct("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?pt(function Ct(n){return ct("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?pt(We,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ot=Function.prototype.bind;function Mt(n,e){return ot.call(n,e)}class ci{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Xe(r)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Xe(r)}else Xe(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xe(t)}}}class Un extends vn{constructor(e,t,r){let i;if(super(),A(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&yt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Mt(e.next,s),error:e.error&&Mt(e.error,s),complete:e.complete&&Mt(e.complete,s)}):i=e}this.destination=new ci(i)}}function Xe(n){yt.useDeprecatedSynchronousErrorHandling?function ir(n){yt.useDeprecatedSynchronousErrorHandling&&$e&&($e.errorThrown=!0,$e.error=n)}(n):ae(n)}function pt(n,e){const{onStoppedNotification:t}=yt;t&&X.setTimeout(()=>t(n,e))}const Kt={closed:!0,next:be,error:function se(n){throw n},complete:be},En="function"==typeof Symbol&&Symbol.observable||"@@observable";function In(n){return n}function Xi(n){return 0===n.length?In:1===n.length?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}let Ze=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){const s=function $(n){return n&&n instanceof vn||function Cs(n){return n&&A(n.next)&&A(n.error)&&A(n.complete)}(n)&&Nn(n)}(t)?t:new Un(t,r,i);return He(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=Wr(r))((i,s)=>{const o=new Un({next:a=>{try{t(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[En](){return this}pipe(...t){return Xi(t)(this)}toPromise(t){return new(t=Wr(t))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Wr(n){var e;return null!==(e=n??yt.Promise)&&void 0!==e?e:Promise}const G=Z(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let z=(()=>{class n extends Ze{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new B(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new G}next(t){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Xt:(this.currentObservers=null,s.push(t),new _t(()=>{this.currentObservers=null,Ae(s,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){const t=new Ze;return t.source=this,t}}return n.create=(e,t)=>new B(e,t),n})();class B extends z{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:Xt}}function J(n){return A(n?.lift)}function Y(n){return e=>{if(J(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(n,e,t,r,i){return new it(n,e,t,r,i)}class it extends vn{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function de(n,e){return Y((t,r)=>{let i=0;t.subscribe(ce(r,s=>{r.next(n.call(e,s,i++))}))})}var Ne=ke(582);const vt=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Jt(n){return A(n?.then)}function Bt(n){return A(n[En])}function en(n){return Symbol.asyncIterator&&A(n?.[Symbol.asyncIterator])}function Bn(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const sr=function Qn(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Kr(n){return A(n?.[sr])}function xi(n){return(0,Ne.FC)(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:i}=yield(0,Ne.qq)(t.read());if(i)return yield(0,Ne.qq)(void 0);yield yield(0,Ne.qq)(r)}}finally{t.releaseLock()}})}function bs(n){return A(n?.getReader)}function gt(n){if(n instanceof Ze)return n;if(null!=n){if(Bt(n))return function Ds(n){return new Ze(e=>{const t=n[En]();if(A(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(vt(n))return function As(n){return new Ze(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Jt(n))return function Ji(n){return new Ze(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ae)})}(n);if(en(n))return cr(n);if(Kr(n))return function es(n){return new Ze(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(bs(n))return function di(n){return cr(xi(n))}(n)}throw Bn(n)}function cr(n){return new Ze(e=>{(function hi(n,e){var t,r,i,s;return(0,Ne.mG)(this,void 0,void 0,function*(){try{for(t=(0,Ne.KL)(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function fi(n,e,t,r=0,i=!1){const s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function xt(n,e,t=1/0){return A(e)?xt((r,i)=>de((s,o)=>e(r,s,i,o))(gt(n(r,i))),t):("number"==typeof e&&(t=e),Y((r,i)=>function dr(n,e,t,r,i,s,o,a){const u=[];let l=0,d=0,f=!1;const m=()=>{f&&!u.length&&!l&&e.complete()},_=T=>l<r?v(T):u.push(T),v=T=>{s&&e.next(T),l++;let D=!1;gt(t(T,d++)).subscribe(ce(e,k=>{i?.(k),s?_(k):e.next(k)},()=>{D=!0},void 0,()=>{if(D)try{for(l--;u.length&&l<r;){const k=u.shift();o?fi(e,o,()=>v(k)):v(k)}m()}catch(k){e.error(k)}}))};return n.subscribe(ce(e,_,()=>{f=!0,m()})),()=>{a?.()}}(r,i,n,t)))}function Zr(n=1/0){return xt(In,n)}const wn=new Ze(n=>n.complete());function ts(n){return n[n.length-1]}function ki(n){return A(ts(n))?n.pop():void 0}function ns(n){return function Tn(n){return n&&A(n.schedule)}(ts(n))?n.pop():void 0}function jn(n,e=0){return Y((t,r)=>{t.subscribe(ce(r,i=>fi(r,n,()=>r.next(i),e),()=>fi(r,n,()=>r.complete(),e),i=>fi(r,n,()=>r.error(i),e)))})}function Or(n,e=0){return Y((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Ss(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ze(t=>{fi(t,e,()=>{const r=n[Symbol.asyncIterator]();fi(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function I(n,e){return e?function S(n,e){if(null!=n){if(Bt(n))return function pi(n,e){return gt(n).pipe(Or(e),jn(e))}(n,e);if(vt(n))return function vo(n,e){return new Ze(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(Jt(n))return function Xa(n,e){return gt(n).pipe(Or(e),jn(e))}(n,e);if(en(n))return Ss(n,e);if(Kr(n))return function sa(n,e){return new Ze(t=>{let r;return fi(t,e,()=>{r=n[sr](),fi(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>A(r?.return)&&r.return()})}(n,e);if(bs(n))return function N(n,e){return Ss(xi(n),e)}(n,e)}throw Bn(n)}(n,e):gt(n)}function C(...n){const e=ns(n),t=function Yn(n,e){return"number"==typeof ts(n)?n.pop():e}(n,1/0),r=n;return r.length?1===r.length?gt(r[0]):Zr(t)(I(r,e)):wn}class E extends z{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function R(...n){return I(n,ns(n))}function K(n={}){const{connector:e=(()=>new z),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,l=0,d=!1,f=!1;const m=()=>{a?.unsubscribe(),a=void 0},_=()=>{m(),o=u=void 0,d=f=!1},v=()=>{const T=o;_(),T?.unsubscribe()};return Y((T,D)=>{l++,!f&&!d&&m();const k=u=u??e();D.add(()=>{l--,0===l&&!f&&!d&&(a=Ie(v,i))}),k.subscribe(D),!o&&l>0&&(o=new Un({next:P=>k.next(P),error:P=>{f=!0,m(),a=Ie(_,t,P),k.error(P)},complete:()=>{d=!0,m(),a=Ie(_,r),k.complete()}}),gt(T).subscribe(o))})(s)}}function Ie(n,e,...t){if(!0===e)return void n();if(!1===e)return;const r=new Un({next:()=>{r.unsubscribe(),n()}});return gt(e(...t)).subscribe(r)}function ve(n,e){return Y((t,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();t.subscribe(ce(r,u=>{i?.unsubscribe();let l=0;const d=s++;gt(n(u,d)).subscribe(i=ce(r,f=>r.next(e?e(u,f,d,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Fe(n,e=In){return n=n??Et,Y((t,r)=>{let i,s=!0;t.subscribe(ce(r,o=>{const a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function Et(n,e){return n===e}function ge(n){for(let e in n)if(n[e]===ge)return e;throw Error("Could not find renamed property on target object.")}function Ft(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Re(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Re).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function or(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const oa=ge({__forward_ref__:ge});function U(n){return n.__forward_ref__=U,n.toString=function(){return Re(this())},n}function x(n){return ie(n)?n():n}function ie(n){return"function"==typeof n&&n.hasOwnProperty(oa)&&n.__forward_ref__===U}function De(n){return n&&!!n.\u0275providers}const nt="https://g.co/ng/security#xss";class L extends Error{constructor(e,t){super(function Mn(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Ce(n){return"string"==typeof n?n:null==n?"":String(n)}function Gf(n,e){throw new L(-201,!1)}function wr(n,e){null==n&&function Le(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}(e,n,null,"!=")}function ye(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Cn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Gc(n){return hy(n,eu)||hy(n,Wc)}function hy(n,e){return n.hasOwnProperty(e)?n[e]:null}function yl(n){return n&&(n.hasOwnProperty(Wf)||n.hasOwnProperty(JT))?n[Wf]:null}const eu=ge({\u0275prov:ge}),Wf=ge({\u0275inj:ge}),Wc=ge({ngInjectableDef:ge}),JT=ge({ngInjectorDef:ge});var rt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(rt||{});let Kf;function Qr(n){const e=Kf;return Kf=n,e}function Zc(n,e,t){const r=Gc(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&rt.Optional?null:void 0!==e?e:void Gf(Re(n))}const Lt=globalThis;class le{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=ye({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ua={},ep="__NG_DI_FLAG__",mi="ngTempTokenPath",tp=/\n/gm,Xc="__source";let tu;function Io(n){const e=tu;return tu=n,e}function nC(n,e=rt.Default){if(void 0===tu)throw new L(-203,!1);return null===tu?Zc(n,void 0,e):tu.get(n,e&rt.Optional?null:void 0,e)}function W(n,e=rt.Default){return(function Kc(){return Kf}()||nC)(x(n),e)}function pe(n,e=rt.Default){return W(n,Jc(e))}function Jc(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function la(n){const e=[];for(let t=0;t<n.length;t++){const r=x(n[t]);if(Array.isArray(r)){if(0===r.length)throw new L(900,!1);let i,s=rt.Default;for(let o=0;o<r.length;o++){const a=r[o],u=rp(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(W(i,s))}else e.push(W(r))}return e}function ed(n,e){return n[ep]=e,n.prototype[ep]=e,n}function rp(n){return n[ep]}function _i(n){return{toString:n}.toString()}var td=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(td||{}),Oi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Oi||{});const Rs={},bt=[],Qs=ge({\u0275cmp:ge}),ip=ge({\u0275dir:ge}),ru=ge({\u0275pipe:ge}),my=ge({\u0275mod:ge}),Ps=ge({\u0275fac:ge}),ca=ge({__NG_ELEMENT_ID__:ge}),yi=ge({__NG_ENV_ID__:ge});function sp(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function op(n,e,t){let r=0;for(;r<t.length;){const i=t[r];if("number"==typeof i){if(0!==i)break;r++;const s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{const s=i,o=t[++r];El(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function nd(n){return 3===n||4===n||6===n}function El(n){return 64===n.charCodeAt(0)}function iu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||ap(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function ap(n,e,t,r,i){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}const _y="ng-template";function up(n,e,t){let r=0,i=!0;for(;r<n.length;){let s=n[r++];if("string"==typeof s&&i){const o=n[r++];if(t&&"class"===s&&-1!==sp(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function rd(n){return 4===n.type&&n.value!==_y}function lp(n,e,t){return e===(4!==n.type||t?n.value:_y)}function id(n,e,t){let r=4;const i=n.attrs||[],s=function cp(n){for(let e=0;e<n.length;e++)if(nd(n[e]))return e;return n.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!lp(n,u,t)||""===u&&1===e.length){if(vi(r))return!1;o=!0}}else{const l=8&r?u:e[++a];if(8&r&&null!==n.attrs){if(!up(n.attrs,l,t)){if(vi(r))return!1;o=!0}continue}const f=yy(8&r?"class":u,i,rd(n),t);if(-1===f){if(vi(r))return!1;o=!0;continue}if(""!==l){let m;m=f>s?"":i[f+1].toLowerCase();const _=8&r?m:null;if(_&&-1!==sp(_,l,0)||2&r&&l!==m){if(vi(r))return!1;o=!0}}}}else{if(!o&&!vi(r)&&!vi(u))return!1;if(o&&vi(u))continue;o=!1,r=u|1&r}}return vi(r)||o}function vi(n){return 0==(1&n)}function yy(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function od(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function sd(n,e,t=!1){for(let r=0;r<e.length;r++)if(id(n,e[r],t))return!0;return!1}function hp(n,e){return n?":not("+e.trim()+")":e}function fp(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!vi(o)&&(e+=hp(s,i),i=""),r=o,s=s||!vi(r);t++}return""!==i&&(e+=hp(s,i)),e}function To(n){return _i(()=>{const e=Iy(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===td.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Oi.Emulated,styles:n.styles||bt,_:null,schemas:n.schemas||null,tView:null,id:""};ud(t);const r=n.dependencies;return t.directiveDefs=Il(r,!1),t.pipeDefs=Il(r,!0),t.id=function iC(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function rC(n){return dt(n)||hr(n)}function mp(n){return null!==n}function nn(n){return _i(()=>({type:n.type,bootstrap:n.bootstrap||bt,declarations:n.declarations||bt,imports:n.imports||bt,exports:n.exports||bt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ad(n,e){if(null==n)return Rs;const t={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=r,e&&(e[i]=s)}return t}function Ve(n){return _i(()=>{const e=Iy(n);return ud(e),e})}function dt(n){return n[Qs]||null}function hr(n){return n[ip]||null}function fr(n){return n[ru]||null}function Fr(n,e){const t=n[my]||null;if(!t&&!0===e)throw new Error(`Type ${Re(n)} does not have '\u0275mod' property.`);return t}function Iy(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Rs,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||bt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ad(n.inputs,e),outputs:ad(n.outputs)}}function ud(n){n.features?.forEach(e=>e(n))}function Il(n,e){if(!n)return null;const t=e?fr:rC;return()=>("function"==typeof n?n():n).map(r=>t(r)).filter(mp)}const rn=0,me=1,qe=2,sn=3,rs=4,da=5,Cr=6,ou=7,fn=8,Co=9,bo=10,ze=11,ha=12,wy=13,Do=14,xn=15,fa=16,au=17,Fi=18,wl=19,ld=20,Ao=21,Ys=22,uu=23,pa=24,at=25,cd=1,Ty=2,Ns=7,lu=9,br=11;function Ei(n){return Array.isArray(n)&&"object"==typeof n[cd]}function pr(n){return Array.isArray(n)&&!0===n[cd]}function vp(n){return 0!=(4&n.flags)}function ga(n){return n.componentOffset>-1}function Ep(n){return 1==(1&n.flags)}function Ms(n){return!!n.template}function Cy(n){return 0!=(512&n[qe])}function cu(n,e){return n.hasOwnProperty(Ps)?n[Ps]:null}let kn=null,hd=!1;function Rt(n){const e=kn;return kn=n,e}const Py={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Ny(n){if(!Dl(n)||n.dirty){if(!n.producerMustRecompute(n)&&!bl(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function My(n){n.dirty=!0,function pd(n){if(void 0===n.liveConsumerNode)return;const e=hd;hd=!0;try{for(const t of n.liveConsumerNode)t.dirty||My(t)}finally{hd=e}}(n),n.consumerMarkedDirty?.(n)}function gd(n){return n&&(n.nextProducerIndex=0),Rt(n)}function Cp(n,e){if(Rt(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Dl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)_a(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function bl(n){So(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Ny(t),r!==t.version))return!0}return!1}function bp(n){if(So(n),Dl(n))for(let e=0;e<n.producerNode.length;e++)_a(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function _a(n,e){if(function Dp(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),So(n),1===n.liveConsumerNode.length)for(let r=0;r<n.producerNode.length;r++)_a(n.producerNode[r],n.producerIndexOfThis[r]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];So(i),i.producerIndexOfThis[r]=e}}function Dl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function So(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let uC=null;const Vy=()=>{},pC=(()=>({...Py,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Vy}))();class Uy{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Li(){return By}function By(n){return n.type.prototype.ngOnChanges&&(n.setInput=Rp),gC}function gC(){const n=_d(this),e=n?.current;if(e){const t=n.previous;if(t===Rs)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Rp(n,e,t,r){const i=this.declaredInputs[t],s=_d(n)||function mC(n,e){return n[jy]=e}(n,{previous:Rs,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new Uy(u&&u.currentValue,e,a===Rs),n[r]=e}Li.ngInherit=!0;const jy="__ngSimpleChanges__";function _d(n){return n[jy]||null}const Vi=function(n,e,t){};function Gt(n){for(;Array.isArray(n);)n=n[rn];return n}function vd(n,e){return Gt(e[n])}function $n(n,e){return Gt(e[n.index])}function $y(n,e){return n.data[e]}function Ii(n,e){const t=e[n];return Ei(t)?t:t[rn]}function Ro(n,e){return null==e?null:n[e]}function Ed(n){n[au]=0}function vC(n){1024&n[qe]||(n[qe]|=1024,qy(n,1))}function Id(n){1024&n[qe]&&(n[qe]&=-1025,qy(n,-1))}function qy(n,e){let t=n[sn];if(null===t)return;t[da]+=e;let r=t;for(t=t[sn];null!==t&&(1===e&&1===r[da]||-1===e&&0===r[da]);)t[da]+=e,r=t,t=t[sn]}const Be={lFrame:ev(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Td(){return Be.bindingsEnabled}function ee(){return Be.lFrame.lView}function It(){return Be.lFrame.tView}function Op(n){return Be.lFrame.contextLView=n,n[fn]}function Nl(n){return Be.lFrame.contextLView=null,n}function gr(){let n=Ky();for(;null!==n&&64===n.type;)n=n.parent;return n}function Ky(){return Be.lFrame.currentTNode}function ks(n,e){const t=Be.lFrame;t.currentTNode=n,t.isParent=e}function Ml(){return Be.lFrame.isParent}function xl(){Be.lFrame.isParent=!1}function va(){return Be.lFrame.bindingIndex++}function Xs(n){const e=Be.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function CC(n,e){const t=Be.lFrame;t.bindingIndex=t.bindingRootIndex=n,Vp(e)}function Vp(n){Be.lFrame.currentDirectiveIndex=n}function kl(n){const e=Be.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function Up(n){Be.lFrame.currentQueryIndex=n}function Yy(n){const e=n[me];return 2===e.type?e.declTNode:1===e.type?n[Cr]:null}function Xy(n,e,t){if(t&rt.SkipSelf){let i=e,s=n;for(;!(i=i.parent,null!==i||t&rt.Host||(i=Yy(s),null===i||(s=s[Do],10&i.type))););if(null===i)return!1;e=i,n=s}const r=Be.lFrame=Jy();return r.currentTNode=e,r.lView=n,!0}function gu(n){const e=Jy(),t=n[me];Be.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Jy(){const n=Be.lFrame,e=null===n?null:n.child;return null===e?ev(n):e}function ev(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function tv(){const n=Be.lFrame;return Be.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const nv=tv;function Bp(){const n=tv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Vr(){return Be.lFrame.selectedIndex}function Js(n){Be.lFrame.selectedIndex=n}function pn(){const n=Be.lFrame;return $y(n.tView,n.selectedIndex)}let rv=!0;function Dd(){return rv}function Po(n){rv=n}function Ad(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function mu(n,e,t){Sd(n,e,3,t)}function _u(n,e,t,r){(3&n[qe])===t&&Sd(n,e,t,r)}function $p(n,e){let t=n[qe];(3&t)===e&&(t&=8191,t+=1,n[qe]=t)}function Sd(n,e,t,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&n[au]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(n[au]+=65536),(a<s||-1==s)&&(sv(n,t,e,u),n[au]=(4294901760&n[au])+u+2),u++}function iv(n,e){Vi(4,n,e);const t=Rt(null);try{e.call(n)}finally{Rt(t),Vi(5,n,e)}}function sv(n,e,t,r){const i=t[r]<0,s=t[r+1],a=n[i?-t[r]:t[r]];i?n[qe]>>13<n[au]>>16&&(3&n[qe])===e&&(n[qe]+=8192,iv(a,s)):iv(a,s)}const yu=-1;class Ea{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function Hp(n){return n!==yu}function Fl(n){return 32767&n}function Ll(n,e){let t=function FC(n){return n>>16}(n),r=e;for(;t>0;)r=r[Do],t--;return r}let Pd=!0;function Nd(n){const e=Pd;return Pd=n,e}const p=255,c=5;let h=0;const g={};function w(n,e){const t=j(n,e);if(-1!==t)return t;const r=e[me];r.firstCreatePass&&(n.injectorIndex=e.length,M(r.data,n),M(e,null),M(r.blueprint,null));const i=re(n,e),s=n.injectorIndex;if(Hp(i)){const o=Fl(i),a=Ll(i,e),u=a[me].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function M(n,e){n.push(0,0,0,0,0,0,0,0,e)}function j(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function re(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){if(r=ZM(i),null===r)return yu;if(t++,i=i[Do],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return yu}function Ee(n,e,t){!function y(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(ca)&&(r=t[ca]),null==r&&(r=t[ca]=h++);const i=r&p;e.data[n+(i>>c)]|=1<<i}(n,e,t)}function ht(n,e,t){if(t&rt.Optional||void 0!==n)return n;Gf()}function Ur(n,e,t,r){if(t&rt.Optional&&void 0===r&&(r=null),!(t&(rt.Self|rt.Host))){const i=n[Co],s=Qr(void 0);try{return i?i.get(e,r,t&rt.Optional):Zc(e,r,t&rt.Optional)}finally{Qr(s)}}return ht(r,0,t)}function eo(n,e,t,r=rt.Default,i){if(null!==n){if(2048&e[qe]&&!(r&rt.Self)){const o=function YW(n,e,t,r,i){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[qe]&&!(512&o[qe]);){const a=Vl(s,o,t,r|rt.Self,g);if(a!==g)return a;let u=s.parent;if(!u){const l=o[ld];if(l){const d=l.get(t,g,r);if(d!==g)return d}u=ZM(o),o=o[Do]}s=u}return i}(n,e,t,r,g);if(o!==g)return o}const s=Vl(n,e,t,r,g);if(s!==g)return s}return Ur(e,t,r,i)}function Vl(n,e,t,r,i){const s=function uv(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ca)?n[ca]:void 0;return"number"==typeof e?e>=0?e&p:LC:e}(t);if("function"==typeof s){if(!Xy(e,n,r))return r&rt.Host?ht(i,0,r):Ur(e,t,r,i);try{let o;if(o=s(r),null!=o||r&rt.Optional)return o;Gf()}finally{nv()}}else if("number"==typeof s){let o=null,a=j(n,e),u=yu,l=r&rt.Host?e[xn][Cr]:null;for((-1===a||r&rt.SkipSelf)&&(u=-1===a?re(n,e):e[a+8],u!==yu&&qp(r,!1)?(o=e[me],a=Fl(u),e=Ll(u,e)):a=-1);-1!==a;){const d=e[me];if(Md(s,a,d.data)){const f=av(a,e,t,o,r,l);if(f!==g)return f}u=e[a+8],u!==yu&&qp(r,e[me].data[a+8]===l)&&Md(s,a,e)?(o=d,a=Fl(u),e=Ll(u,e)):a=-1}}return i}function av(n,e,t,r,i,s){const o=e[me],a=o.data[n+8],d=function vu(n,e,t,r,i){const s=n.providerIndexes,o=e.data,a=1048575&s,u=n.directiveStart,d=s>>20,m=i?a+d:n.directiveEnd;for(let _=r?a:a+d;_<m;_++){const v=o[_];if(_<u&&t===v||_>=u&&v.type===t)return _}if(i){const _=o[u];if(_&&Ms(_)&&_.type===t)return u}return null}(a,o,t,null==r?ga(a)&&Pd:r!=o&&0!=(3&a.type),i&rt.Host&&s===a);return null!==d?No(e,o,d,a):g}function No(n,e,t,r){let i=n[t];const s=e.data;if(function xC(n){return n instanceof Ea}(i)){const o=i;o.resolving&&function _l(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new L(-200,`Circular dependency in DI detected for ${n}${t}`)}(function st(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ce(n)}(s[t]));const a=Nd(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Qr(o.injectImpl):null;Xy(n,r,rt.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&function MC(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=By(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&Qr(l),Nd(a),o.resolving=!1,nv()}}return i}function Md(n,e,t){return!!(t[e+(n>>c)]&1<<n)}function qp(n,e){return!(n&rt.Self||n&rt.Host&&e)}class Dr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return eo(this._tNode,this._lView,e,Jc(r),t)}}function LC(){return new Dr(gr(),ee())}function Xn(n){return _i(()=>{const e=n.prototype.constructor,t=e[Ps]||Gp(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[Ps]||Gp(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Gp(n){return ie(n)?()=>{const e=Gp(x(n));return e&&e()}:cu(n)}function ZM(n){const e=n[me],t=e.type;return 2===t?e.declTNode:1===t?n[Cr]:null}const kd="__parameters__";function Fd(n,e,t){return _i(()=>{const r=function VC(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,l,d){const f=u.hasOwnProperty(kd)?u[kd]:Object.defineProperty(u,kd,{value:[]})[kd];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Vd(n,e){n.forEach(t=>Array.isArray(t)?Vd(t,e):e(t))}function YM(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function cv(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function is(n,e,t){let r=Ud(n,e);return r>=0?n[1|r]=t:(r=~r,function i3(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function UC(n,e){const t=Ud(n,e);if(t>=0)return n[1|t]}function Ud(n,e){return function XM(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}(n,e,1)}const Zp=ed(Fd("Optional"),8),hv=ed(Fd("SkipSelf"),4);function _v(n){return 128==(128&n.flags)}var Iu=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Iu||{});const b3=/^>|^->|<!--|-->|--!>|<!-$/g,D3=/(<|>)/g,A3="\u200b$1\u200b";const qC=new Map;let S3=0;const GC="__ngContext__";function Yr(n,e){Ei(e)?(n[GC]=e[wl],function P3(n){qC.set(n[wl],n)}(e)):n[GC]=e}let WC;function KC(n,e){return WC(n,e)}function Xp(n){const e=n[sn];return pr(e)?e[sn]:e}function yx(n){return Ex(n[ha])}function vx(n){return Ex(n[rs])}function Ex(n){for(;null!==n&&!pr(n);)n=n[rs];return n}function $d(n,e,t,r,i){if(null!=r){let s,o=!1;pr(r)?s=r:Ei(r)&&(o=!0,r=r[rn]);const a=Gt(r);0===n&&null!==t?null==i?Cx(e,t,a):Ul(e,t,a,i||null,!0):1===n&&null!==t?Ul(e,t,a,i||null,!0):2===n?function Cv(n,e,t){const r=wv(n,e);r&&function Z3(n,e,t,r){n.removeChild(e,t,r)}(n,r,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function X3(n,e,t,r,i){const s=t[Ns];s!==Gt(t)&&$d(e,n,r,s,i);for(let a=br;a<t.length;a++){const u=t[a];eg(u[me],u,n,e,r,s)}}(e,n,s,t,i)}}function ZC(n,e){return n.createComment(function cx(n){return n.replace(b3,e=>e.replace(D3,A3))}(e))}function Ev(n,e,t){return n.createElement(e,t)}function wx(n,e){const t=n[lu],r=t.indexOf(e);Id(e),t.splice(r,1)}function Iv(n,e){if(n.length<=br)return;const t=br+e,r=n[t];if(r){const i=r[fa];null!==i&&i!==n&&wx(i,r),e>0&&(n[t-1][rs]=r[rs]);const s=cv(n,br+e);!function j3(n,e){eg(n,e,e[ze],2,null,null),e[rn]=null,e[Cr]=null}(r[me],r);const o=s[Fi];null!==o&&o.detachView(s[me]),r[sn]=null,r[rs]=null,r[qe]&=-129}return r}function QC(n,e){if(!(256&e[qe])){const t=e[ze];e[uu]&&bp(e[uu]),e[pa]&&bp(e[pa]),t.destroyNode&&eg(n,e,t,3,null,null),function q3(n){let e=n[ha];if(!e)return YC(n[me],n);for(;e;){let t=null;if(Ei(e))t=e[ha];else{const r=e[br];r&&(t=r)}if(!t){for(;e&&!e[rs]&&e!==n;)Ei(e)&&YC(e[me],e),e=e[sn];null===e&&(e=n),Ei(e)&&YC(e[me],e),t=e&&e[rs]}e=t}}(e)}}function YC(n,e){if(!(256&e[qe])){e[qe]&=-129,e[qe]|=256,function K3(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof Ea)){const s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];Vi(4,a,u);try{u.call(a)}finally{Vi(5,a,u)}}else{Vi(4,i,s);try{s.call(i)}finally{Vi(5,i,s)}}}}}(n,e),function W3(n,e){const t=n.cleanup,r=e[ou];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else t[s].call(r[t[s+1]]);null!==r&&(e[ou]=null);const i=e[Ao];if(null!==i){e[Ao]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(n,e),1===e[me].type&&e[ze].destroy();const t=e[fa];if(null!==t&&pr(e[sn])){t!==e[sn]&&wx(t,e);const r=e[Fi];null!==r&&r.detachView(n)}!function N3(n){qC.delete(n[wl])}(e)}}function XC(n,e,t){return function Tx(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[rn];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=n.data[r.directiveStart+i];if(s===Oi.None||s===Oi.Emulated)return null}return $n(r,t)}}(n,e.parent,t)}function Ul(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Cx(n,e,t){n.appendChild(e,t)}function bx(n,e,t,r,i){null!==r?Ul(n,e,t,r,i):Cx(n,e,t)}function wv(n,e){return n.parentNode(e)}let JC,bv,r0,Dv,Sx=function Ax(n,e,t){return 40&n.type?$n(n,t):null};function Tv(n,e,t,r){const i=XC(n,r,e),s=e[ze],a=function Dx(n,e,t){return Sx(n,e,t)}(r.parent||e[Cr],r,e);if(null!=i)if(Array.isArray(t))for(let u=0;u<t.length;u++)bx(s,i,t[u],a,!1);else bx(s,i,t,a,!1);void 0!==JC&&JC(s,r,e,t,i)}function Jp(n,e){if(null!==e){const t=e.type;if(3&t)return $n(e,n);if(4&t)return e0(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return Jp(n,r);{const i=n[e.index];return pr(i)?e0(-1,i):Gt(i)}}if(32&t)return KC(e,n)()||Gt(n[e.index]);{const r=Px(n,e);return null!==r?Array.isArray(r)?r[0]:Jp(Xp(n[xn]),r):Jp(n,e.next)}}return null}function Px(n,e){return null!==e?n[xn][Cr].projection[e.projection]:null}function e0(n,e){const t=br+n+1;if(t<e.length){const r=e[t],i=r[me].firstChild;if(null!==i)return Jp(r,i)}return e[Ns]}function t0(n,e,t,r,i,s,o){for(;null!=t;){const a=r[t.index],u=t.type;if(o&&0===e&&(a&&Yr(Gt(a),r),t.flags|=2),32!=(32&t.flags))if(8&u)t0(n,e,t.child,r,i,s,!1),$d(e,n,i,a,s);else if(32&u){const l=KC(t,r);let d;for(;d=l();)$d(e,n,i,d,s);$d(e,n,i,a,s)}else 16&u?Mx(n,e,r,t,i,s):$d(e,n,i,a,s);t=o?t.projectionNext:t.next}}function eg(n,e,t,r,i,s){t0(t,r,n.firstChild,e,i,s,!1)}function Mx(n,e,t,r,i,s){const o=t[xn],u=o[Cr].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)$d(e,n,i,u[l],s);else{let l=u;const d=o[sn];_v(r)&&(l.flags|=128),t0(n,e,l,d,i,s,!0)}}function xx(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function kx(n,e,t){const{mergedAttrs:r,classes:i,styles:s}=t;null!==r&&op(n,e,r),null!==i&&xx(n,e,i),null!==s&&function e9(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function Hd(n){return function n0(){if(void 0===bv&&(bv=null,Lt.trustedTypes))try{bv=Lt.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return bv}()?.createHTML(n)||n}function qd(){if(void 0!==r0)return r0;if(typeof document<"u")return document;throw new L(210,!1)}function Ox(n){return function s0(){if(void 0===Dv&&(Dv=null,Lt.trustedTypes))try{Dv=Lt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Dv}()?.createHTML(n)||n}class Bl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nt})`}}class s9 extends Bl{getTypeName(){return"HTML"}}class o9 extends Bl{getTypeName(){return"Style"}}class a9 extends Bl{getTypeName(){return"Script"}}class u9 extends Bl{getTypeName(){return"URL"}}class l9 extends Bl{getTypeName(){return"ResourceURL"}}function ss(n){return n instanceof Bl?n.changingThisBreaksApplicationSecurity:n}function Mo(n,e){const t=function c9(n){return n instanceof Bl&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${nt})`)}return t===e}class m9{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Hd(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class _9{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Hd(e),t}}const v9=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Av(n){return(n=String(n)).match(v9)?n:"unsafe:"+n}function Ia(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function tg(...n){const e={};for(const t of n)for(const r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}const Ux=Ia("area,br,col,hr,img,wbr"),Bx=Ia("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jx=Ia("rp,rt"),o0=tg(Ux,tg(Bx,Ia("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),tg(jx,Ia("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),tg(jx,Bx)),a0=Ia("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),$x=tg(a0,Ia("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ia("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),E9=Ia("script,style,template");class I9{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,r=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!o0.hasOwnProperty(t))return this.sanitizedSomething=!0,!E9.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=e.attributes;for(let i=0;i<r.length;i++){const s=r.item(i),o=s.name,a=o.toLowerCase();if(!$x.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let u=s.value;a0[a]&&(u=Av(u)),this.buf.push(" ",o,'="',Hx(u),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();o0.hasOwnProperty(t)&&!Ux.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Hx(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const w9=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,T9=/([^\#-~ |!])/g;function Hx(n){return n.replace(/&/g,"&amp;").replace(w9,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(T9,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Sv;function qx(n,e){let t=null;try{Sv=Sv||function Vx(n){const e=new _9(n);return function y9(){try{return!!(new window.DOMParser).parseFromString(Hd(""),"text/html")}catch{return!1}}()?new m9(e):e}(n);let r=e?String(e):"";t=Sv.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=t.innerHTML,t=Sv.getInertBodyElement(r)}while(r!==s);return Hd((new I9).sanitizeChildren(u0(t)||t))}finally{if(t){const r=u0(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function u0(n){return"content"in n&&function C9(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var os=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(os||{});function l0(n){const e=function ng(){const n=ee();return n&&n[bo].sanitizer}();return e?Ox(e.sanitize(os.HTML,n)||""):Mo(n,"HTML")?Ox(ss(n)):qx(qd(),Ce(n))}const rg=new le("ENVIRONMENT_INITIALIZER"),Kx=new le("INJECTOR",-1),Zx=new le("INJECTOR_DEF_TYPES");class c0{get(e,t=ua){if(t===ua){const r=new Error(`NullInjectorError: No provider for ${Re(e)}!`);throw r.name="NullInjectorError",r}return t}}function Rv(n){return{\u0275providers:n}}function P9(...n){return{\u0275providers:Qx(0,n),\u0275fromNgModule:!0}}function Qx(n,...e){const t=[],r=new Set;let i;const s=o=>{t.push(o)};return Vd(e,o=>{const a=o;Pv(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&Yx(i,s),t}function Yx(n,e){for(let t=0;t<n.length;t++){const{ngModule:r,providers:i}=n[t];d0(i,s=>{e(s,r)})}}function Pv(n,e,t,r){if(!(n=x(n)))return!1;let i=null,s=yl(n);const o=!s&&dt(n);if(s||o){if(o&&!o.standalone)return!1;i=n}else{const u=n.ngModule;if(s=yl(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of u)Pv(l,e,t,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{Vd(s.imports,d=>{Pv(d,e,t,r)&&(l||=[],l.push(d))})}finally{}void 0!==l&&Yx(l,e)}if(!a){const l=cu(i)||(()=>new i);e({provide:i,useFactory:l,deps:bt},i),e({provide:Zx,useValue:i,multi:!0},i),e({provide:rg,useValue:()=>W(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const l=n;d0(u,d=>{e(d,l)})}}}return i!==n&&void 0!==n.providers}function d0(n,e){for(let t of n)De(t)&&(t=t.\u0275providers),Array.isArray(t)?d0(t,e):e(t)}const N9=ge({provide:String,useValue:ge});function h0(n){return null!==n&&"object"==typeof n&&N9 in n}function jl(n){return"function"==typeof n}const f0=new le("Set Injector scope."),Nv={},x9={};let p0;function Mv(){return void 0===p0&&(p0=new c0),p0}class as{}class zd extends as{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,m0(e,o=>this.processProvider(o)),this.records.set(Kx,Gd(void 0,this)),i.has("environment")&&this.records.set(as,Gd(void 0,this));const s=this.records.get(f0);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Zx.multi,bt,rt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Io(this),r=Qr(void 0);try{return e()}finally{Io(t),Qr(r)}}get(e,t=ua,r=rt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(yi))return e[yi](this);r=Jc(r);const s=Io(this),o=Qr(void 0);try{if(!(r&rt.SkipSelf)){let u=this.records.get(e);if(void 0===u){const l=function V9(n){return"function"==typeof n||"object"==typeof n&&n instanceof le}(e)&&Gc(e);u=l&&this.injectableDefInScope(l)?Gd(g0(e),Nv):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&rt.Self?Mv():this.parent).get(e,t=r&rt.Optional&&t===ua?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[mi]=a[mi]||[]).unshift(Re(e)),s)throw a;return function Zs(n,e,t,r){const i=n[mi];throw e[Xc]&&i.unshift(e[Xc]),n.message=function nu(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let i=Re(e);if(Array.isArray(e))i=e.map(Re).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Re(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(tp,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[mi]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Qr(o),Io(s)}}resolveInjectorInitializers(){const e=Io(this),t=Qr(void 0);try{const i=this.get(rg.multi,bt,rt.Self);for(const s of i)s()}finally{Io(e),Qr(t)}}toString(){const e=[],t=this.records;for(const r of t.keys())e.push(Re(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new L(205,!1)}processProvider(e){let t=jl(e=x(e))?e:x(e&&e.provide);const r=function O9(n){return h0(n)?Gd(void 0,n.useValue):Gd(ek(n),Nv)}(e);if(jl(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=Gd(void 0,Nv,!0),i.factory=()=>la(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){return t.value===Nv&&(t.value=x9,t.value=t.factory()),"object"==typeof t.value&&t.value&&function L9(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=x(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function g0(n){const e=Gc(n),t=null!==e?e.factory:cu(n);if(null!==t)return t;if(n instanceof le)throw new L(204,!1);if(n instanceof Function)return function k9(n){const e=n.length;if(e>0)throw function Kp(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}(e,"?"),new L(204,!1);const t=function Ja(n){return n&&(n[eu]||n[Wc])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new L(204,!1)}function ek(n,e,t){let r;if(jl(n)){const i=x(n);return cu(i)||g0(i)}if(h0(n))r=()=>x(n.useValue);else if(function Jx(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...la(n.deps||[]));else if(function Xx(n){return!(!n||!n.useExisting)}(n))r=()=>W(x(n.useExisting));else{const i=x(n&&(n.useClass||n.provide));if(!function F9(n){return!!n.deps}(n))return cu(i)||g0(i);r=()=>new i(...la(n.deps))}return r}function Gd(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function m0(n,e){for(const t of n)Array.isArray(t)?m0(t,e):t&&De(t)?m0(t.\u0275providers,e):e(t)}const xv=new le("AppId",{providedIn:"root",factory:()=>U9}),U9="ng",tk=new le("Platform Initializer"),Ls=new le("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),nk=new le("AnimationModuleType"),rk=new le("CSP nonce",{providedIn:"root",factory:()=>qd().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let ik=(n,e,t)=>null;function C0(n,e,t=!1){return ik(n,e,t)}class Z9{}class ak{}class Y9{resolveComponentFactory(e){throw function Q9(n){const e=Error(`No component factory found for ${Re(n)}.`);return e.ngComponent=n,e}(e)}}let og=(()=>{class n{static#e=this.NULL=new Y9}return n})();function X9(){return Zd(gr(),ee())}function Zd(n,e){return new us($n(n,e))}let us=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=X9}return n})();class ag{}let wa=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function e6(){const n=ee(),t=Ii(gr().index,n);return(Ei(t)?t:n)[ze]}()}return n})(),t6=(()=>{class n{static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>null})}return n})();class Qd{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const lk=new Qd("16.2.12"),A0={};function fk(n,e=null,t=null,r){const i=pk(n,e,t,r);return i.resolveInjectorInitializers(),i}function pk(n,e=null,t=null,r,i=new Set){const s=[t||bt,P9(n)];return r=r||("object"==typeof n?void 0:Re(n)),new zd(s,e||Mv(),r||null,i)}let Xr=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=ua;static#t=this.NULL=new c0;static create(t,r){if(Array.isArray(t))return fk({name:""},r,t,"");{const i=t.name??"";return fk({name:i},t.parent,t.providers,i)}}static#n=this.\u0275prov=ye({token:n,providedIn:"any",factory:()=>W(Kx)});static#r=this.__NG_ELEMENT_ID__=-1}return n})();function R0(n){return n.ngOriginalError}class Ta{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&R0(e);for(;t&&R0(t);)t=R0(t);return t||null}}function N0(n){return e=>{setTimeout(n,void 0,e)}}const Hn=class u6 extends z{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=N0(s),i&&(i=N0(i)),o&&(o=N0(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof _t&&e.add(a),a}};function mk(...n){}class wt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Hn(!1),this.onMicrotaskEmpty=new Hn(!1),this.onStable=new Hn(!1),this.onError=new Hn(!1),typeof Zone>"u")throw new L(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function l6(){const n="function"==typeof Lt.requestAnimationFrame;let e=Lt[n?"requestAnimationFrame":"setTimeout"],t=Lt[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function h6(n){const e=()=>{!function d6(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Lt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,x0(n),n.isCheckStableRunning=!0,M0(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),x0(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(function p6(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(i,s,o,a);try{return _k(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),yk(n)}},onInvoke:(t,r,i,s,o,a,u)=>{try{return _k(n),t.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),yk(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,x0(n),M0(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!wt.isInAngularZone())throw new L(909,!1)}static assertNotInAngularZone(){if(wt.isInAngularZone())throw new L(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,c6,mk,mk);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const c6={};function M0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function x0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function _k(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function yk(n){n._nesting--,M0(n)}class f6{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Hn,this.onMicrotaskEmpty=new Hn,this.onStable=new Hn,this.onError=new Hn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}const vk=new le("",{providedIn:"root",factory:Ek});function Ek(){const n=pe(wt);let e=!0;return C(new Ze(i=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{i.next(e),i.complete()})}),new Ze(i=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{wt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=n.onUnstable.subscribe(()=>{wt.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(K()))}function Ca(n){return n instanceof Function?n():n}let k0=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new n})}return n})();function ug(n){for(;n;){n[qe]|=64;const e=Xp(n);if(Cy(n)&&!e)return n;n=e}return null}const bk=new le("",{providedIn:"root",factory:()=>!1});let Bv=null;function Rk(n,e){return n[e]??Mk()}function Pk(n,e){const t=Mk();t.producerNode?.length&&(n[e]=Bv,t.lView=n,Bv=Nk())}const C6={...Py,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{ug(n.lView)},lView:null};function Nk(){return Object.create(C6)}function Mk(){return Bv??=Nk(),Bv}const Qe={};function bn(n){xk(It(),ee(),Vr()+n,!1)}function xk(n,e,t,r){if(!r)if(3==(3&e[qe])){const s=n.preOrderCheckHooks;null!==s&&mu(e,s,t)}else{const s=n.preOrderHooks;null!==s&&_u(e,s,0,t)}Js(t)}function te(n,e=rt.Default){const t=ee();return null===t?W(n,e):eo(gr(),t,x(n),e)}function jv(n,e,t,r,i,s,o,a,u,l,d){const f=e.blueprint.slice();return f[rn]=i,f[qe]=140|r,(null!==l||n&&2048&n[qe])&&(f[qe]|=2048),Ed(f),f[sn]=f[Do]=n,f[fn]=t,f[bo]=o||n&&n[bo],f[ze]=a||n&&n[ze],f[Co]=u||n&&n[Co]||null,f[Cr]=s,f[wl]=function R3(){return S3++}(),f[Ys]=d,f[ld]=l,f[xn]=2==e.type?n[xn]:f,f}function Jd(n,e,t,r,i){let s=n.data[e];if(null===s)s=function O0(n,e,t,r,i){const s=Ky(),o=Ml(),u=n.data[e]=function M6(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function pu(){return null!==Be.skipHydrationRootTNode}()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,r,i);return null===n.firstChild&&(n.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(n,e,t,r,i),function Zy(){return Be.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=r,s.attrs=i;const o=function ya(){const n=Be.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ks(s,!0),s}function lg(n,e,t,r){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Ok(n,e,t,r,i){const s=Rk(e,uu),o=Vr(),a=2&r;try{Js(-1),a&&e.length>at&&xk(n,e,at,!1),Vi(a?2:0,i);const l=a?s:null,d=gd(l);try{null!==l&&(l.dirty=!1),t(r,i)}finally{Cp(l,d)}}finally{a&&null===e[uu]&&Pk(e,uu),Js(o),Vi(a?3:1,i)}}function F0(n,e,t){if(vp(e)){const r=Rt(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Rt(r)}}}function L0(n,e,t){Td()&&(function U6(n,e,t,r){const i=t.directiveStart,s=t.directiveEnd;ga(t)&&function G6(n,e,t){const r=$n(e,n),i=Fk(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=$v(n,jv(n,i,null,o,r,e,null,n[bo].rendererFactory.createRenderer(r,t),null,null,null));n[e.index]=a}(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||w(t,e),Yr(r,e);const o=t.initialInputs;for(let a=i;a<s;a++){const u=n.data[a],l=No(e,n,a,t);Yr(l,e),null!==o&&W6(0,a-i,l,u,0,o),Ms(u)&&(Ii(t.index,e)[fn]=No(e,n,a,t))}}(n,e,t,$n(t,e)),64==(64&t.flags)&&jk(n,e,t))}function V0(n,e,t=$n){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?t(e,n):n[o];n[i++]=a}}}function Fk(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=U0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function U0(n,e,t,r,i,s,o,a,u,l,d){const f=at+r,m=f+i,_=function D6(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:Qe);return t}(f,m),v="function"==typeof l?l():l;return _[me]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:v,incompleteFirstPass:!1,ssrId:d}}let Lk=n=>null;function Vk(n,e,t,r){for(let i in n)if(n.hasOwnProperty(i)){t=null===t?{}:t;const s=n[i];null===r?Uk(t,e,i,s):r.hasOwnProperty(i)&&Uk(t,e,r[i],s)}return t}function Uk(n,e,t,r){n.hasOwnProperty(t)?n[t].push(e,r):n[t]=[e,r]}function ls(n,e,t,r,i,s,o,a){const u=$n(e,t);let d,l=e.inputs;!a&&null!=l&&(d=l[r])?(q0(n,t,d,r,i),ga(e)&&function O6(n,e){const t=Ii(e,n);16&t[qe]||(t[qe]|=64)}(t,e.index)):3&e.type&&(r=function k6(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}function B0(n,e,t,r){if(Td()){const i=null===r?null:{"":-1},s=function j6(n,e){const t=n.directiveRegistry;let r=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(sd(e,o.selectors,!1))if(r||(r=[]),Ms(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),j0(n,e,a.length)}else r.unshift(o),j0(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Bk(n,e,t,o,i,a),i&&function $6(n,e,t){if(e){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new L(-301,!1);r.push(e[i],s)}}}(t,r,i)}t.mergedAttrs=iu(t.mergedAttrs,t.attrs)}function Bk(n,e,t,r,i,s){for(let l=0;l<r.length;l++)Ee(w(t,e),n,r[l].type);!function q6(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,r.length);for(let l=0;l<r.length;l++){const d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=lg(n,e,r.length,null);for(let l=0;l<r.length;l++){const d=r[l];t.mergedAttrs=iu(t.mergedAttrs,d.hostAttrs),z6(n,t,e,u,d),H6(u,d,i),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}!function x6(n,e,t){const i=e.directiveEnd,s=n.data,o=e.attrs,a=[];let u=null,l=null;for(let d=e.directiveStart;d<i;d++){const f=s[d],m=t?t.get(f):null,v=m?m.outputs:null;u=Vk(f.inputs,d,u,m?m.inputs:null),l=Vk(f.outputs,d,l,v);const T=null===u||null===o||rd(e)?null:K6(u,d,o);a.push(T)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}(n,t,s)}function jk(n,e,t){const r=t.directiveStart,i=t.directiveEnd,s=t.index,o=function bC(){return Be.lFrame.currentDirectiveIndex}();try{Js(s);for(let a=r;a<i;a++){const u=n.data[a],l=e[a];Vp(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&B6(u,l)}}finally{Js(-1),Vp(o)}}function B6(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function j0(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function H6(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Ms(e)&&(t[""]=n)}}function z6(n,e,t,r,i){n.data[r]=i;const s=i.factory||(i.factory=cu(i.type)),o=new Ea(s,Ms(i),te);n.blueprint[r]=o,t[r]=o,function L6(n,e,t,r,i){const s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function V6(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,r,s)}}(n,e,r,lg(n,t,i.hostVars,Qe),i)}function xo(n,e,t,r,i,s){const o=$n(n,e);!function $0(n,e,t,r,i,s,o){if(null==s)n.removeAttribute(e,i,t);else{const a=null==o?Ce(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}(e[ze],o,s,n.value,t,r,i)}function W6(n,e,t,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)$k(r,t,o[a++],o[a++],o[a++])}function $k(n,e,t,r,i){const s=Rt(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==n.setInput?n.setInput(e,i,t,r):e[r]=i}finally{Rt(s)}}function K6(n,e,t){let r=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===r&&(r=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function Hk(n,e,t,r){return[n,!0,!1,e,null,0,r,t,null,null,null]}function qk(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const s=t[r+1];if(-1!==s){const o=n.data[s];Up(t[r]),o.contentQueries(2,e[s],s)}}}function $v(n,e){return n[ha]?n[wy][rs]=e:n[ha]=e,n[wy]=e,e}function H0(n,e,t){Up(0);const r=Rt(null);try{e(n,t)}finally{Rt(r)}}function Wk(n,e,t){return(null===n||Ms(n))&&(t=function Pl(n){for(;Array.isArray(n);){if("object"==typeof n[cd])return n;n=n[rn]}return null}(t[e.index])),t[ze]}function Kk(n,e){const t=n[Co],r=t?t.get(Ta,null):null;r&&r.handleError(e)}function q0(n,e,t,r,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];$k(n.data[o],e[o],r,a,i)}}function Z6(n,e){const t=Ii(e,n),r=t[me];!function Q6(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(r,t);const i=t[rn];null!==i&&null===t[Ys]&&(t[Ys]=C0(i,t[Co])),z0(r,t,t[fn])}function z0(n,e,t){gu(e);try{const r=n.viewQuery;null!==r&&H0(1,r,t);const i=n.template;null!==i&&Ok(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&qk(n,e),n.staticViewQueries&&H0(2,n.viewQuery,t);const s=n.components;null!==s&&function Y6(n,e){for(let t=0;t<e.length;t++)Z6(n,e[t])}(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[qe]&=-5,Bp()}}let Zk=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,r,i){const s=typeof Zone>"u"?null:Zone.current,o=function fC(n,e,t){const r=Object.create(pC);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;const i=o=>{r.cleanupFn=o};return r.ref={notify:()=>My(r),run:()=>{if(r.dirty=!1,r.hasRun&&!bl(r))return;r.hasRun=!0;const o=gd(r);try{r.cleanupFn(),r.cleanupFn=Vy,r.fn(i)}finally{Cp(r,o)}},cleanup:()=>r.cleanupFn()},r.ref}(t,l=>{this.all.has(l)&&this.queue.set(l,s)},i);let a;this.all.add(o),o.notify();const u=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=r?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[t,r]of this.queue)this.queue.delete(t),r?r.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new n})}return n})();function Hv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=or(i,a):2==s&&(r=or(r,a+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function cg(n,e,t,r,i=!1){for(;null!==t;){const s=e[t.index];null!==s&&r.push(Gt(s)),pr(s)&&Qk(s,r);const o=t.type;if(8&o)cg(n,e,t.child,r);else if(32&o){const a=KC(t,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=Px(e,t);if(Array.isArray(a))r.push(...a);else{const u=Xp(e[xn]);cg(u[me],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Qk(n,e){for(let t=br;t<n.length;t++){const r=n[t],i=r[me].firstChild;null!==i&&cg(r[me],r,i,e)}n[Ns]!==n[rn]&&e.push(n[Ns])}function qv(n,e,t,r=!0){const i=e[bo],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{Yk(n,e,n.template,t)}catch(u){throw r&&Kk(e,u),u}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function Yk(n,e,t,r){const i=e[qe];if(256!=(256&i)){e[bo].effectManager?.flush(),gu(e);try{Ed(e),function Lp(n){return Be.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Ok(n,e,t,2,r);const o=3==(3&i);if(o){const l=n.preOrderCheckHooks;null!==l&&mu(e,l,null)}else{const l=n.preOrderHooks;null!==l&&_u(e,l,0,null),$p(e,0)}if(function e5(n){for(let e=yx(n);null!==e;e=vx(e)){if(!e[Ty])continue;const t=e[lu];for(let r=0;r<t.length;r++){vC(t[r])}}}(e),Xk(e,2),null!==n.contentQueries&&qk(n,e),o){const l=n.contentCheckHooks;null!==l&&mu(e,l)}else{const l=n.contentHooks;null!==l&&_u(e,l,1),$p(e,1)}!function b6(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const r=Rk(e,pa);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)Js(~s);else{const o=s,a=t[++i],u=t[++i];CC(a,o),r.dirty=!1;const l=gd(r);try{u(2,e[o])}finally{Cp(r,l)}}}}finally{null===e[pa]&&Pk(e,pa),Js(-1)}}(n,e);const a=n.components;null!==a&&eO(e,a,0);const u=n.viewQuery;if(null!==u&&H0(2,u,r),o){const l=n.viewCheckHooks;null!==l&&mu(e,l)}else{const l=n.viewHooks;null!==l&&_u(e,l,2),$p(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[qe]&=-73,Id(e)}finally{Bp()}}}function Xk(n,e){for(let t=yx(n);null!==t;t=vx(t))for(let r=br;r<t.length;r++)Jk(t[r],e)}function t5(n,e,t){Jk(Ii(e,n),t)}function Jk(n,e){if(!function Hy(n){return 128==(128&n[qe])}(n))return;const t=n[me],r=n[qe];if(80&r&&0===e||1024&r||2===e)Yk(t,n,t.template,n[fn]);else if(n[da]>0){Xk(n,1);const i=t.components;null!==i&&eO(n,i,1)}}function eO(n,e,t){for(let r=0;r<e.length;r++)t5(n,e[r],t)}class dg{get rootNodes(){const e=this._lView,t=e[me];return cg(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[fn]}set context(e){this._lView[fn]=e}get destroyed(){return 256==(256&this._lView[qe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[sn];if(pr(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(Iv(e,r),cv(t,r))}this._attachedToViewContainer=!1}QC(this._lView[me],this._lView)}onDestroy(e){!function wd(n,e){if(256==(256&n[qe]))throw new L(911,!1);null===n[Ao]&&(n[Ao]=[]),n[Ao].push(e)}(this._lView,e)}markForCheck(){ug(this._cdRefInjectingView||this._lView)}detach(){this._lView[qe]&=-129}reattach(){this._lView[qe]|=128}detectChanges(){qv(this._lView[me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new L(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function H3(n,e){eg(n,e,e[ze],2,null,null)}(this._lView[me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new L(902,!1);this._appRef=e}}class n5 extends dg{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;qv(e[me],e,e[fn],!1)}checkNoChanges(){}get context(){return null}}class tO extends og{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=dt(e);return new hg(t,this.ngModule)}}function nO(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class i5{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Jc(r);const i=this.injector.get(e,A0,r);return i!==A0||t===A0?i:this.parentInjector.get(e,t,r)}}class hg extends ak{get inputs(){const e=this.componentDef,t=e.inputTransforms,r=nO(e.inputs);if(null!==t)for(const i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return nO(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ey(n){return n.map(fp).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=(i=i||this.ngModule)instanceof as?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new i5(e,s):e,a=o.get(ag,null);if(null===a)throw new L(407,!1);const f={rendererFactory:a,sanitizer:o.get(t6,null),effectManager:o.get(Zk,null),afterRenderEventManager:o.get(k0,null)},m=a.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",v=r?function A6(n,e,t,r){const s=r.get(bk,!1)||t===Oi.ShadowDom,o=n.selectRootElement(e,s);return function S6(n){Lk(n)}(o),o}(m,r,this.componentDef.encapsulation,o):Ev(m,_,function r5(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(_)),k=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let P=null;null!==v&&(P=C0(v,o,!0));const O=U0(0,null,null,1,0,null,null,null,null,null,null),q=jv(null,O,null,k,null,null,f,m,o,null,P);let ue,Te;gu(q);try{const Ue=this.componentDef;let St,Ir=null;Ue.findHostDirectiveDefs?(St=[],Ir=new Map,Ue.findHostDirectiveDefs(Ue,St,Ir),St.push(Ue)):St=[Ue];const Qi=function o5(n,e){const t=n[me],r=at;return n[r]=e,Jd(t,r,2,"#host",null)}(q,v),GT=function a5(n,e,t,r,i,s,o){const a=i[me];!function u5(n,e,t,r){for(const i of n)e.mergedAttrs=iu(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Hv(e,e.mergedAttrs,!0),null!==t&&kx(r,t,e))}(r,n,e,o);let u=null;null!==e&&(u=C0(e,i[Co]));const l=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const f=jv(i,Fk(t),null,d,i[n.index],n,s,l,null,null,u);return a.firstCreatePass&&j0(a,n,r.length-1),$v(i,f),i[n.index]=f}(Qi,v,Ue,St,q,f,m);Te=$y(O,at),v&&function c5(n,e,t,r){if(r)op(n,t,["ng-version",lk.full]);else{const{attrs:i,classes:s}=function pp(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&e.push(s,n[++r]):8===i&&t.push(s);else{if(!vi(i))break;i=s}r++}return{attrs:e,classes:t}}(e.selectors[0]);i&&op(n,t,i),s&&s.length>0&&xx(n,t,s.join(" "))}}(m,Ue,v,r),void 0!==t&&function d5(n,e,t){const r=n.projection=[];for(let i=0;i<e.length;i++){const s=t[i];r.push(null!=s?Array.from(s):null)}}(Te,this.ngContentSelectors,t),ue=function l5(n,e,t,r,i,s){const o=gr(),a=i[me],u=$n(o,i);Bk(a,i,o,t,null,r);for(let d=0;d<t.length;d++)Yr(No(i,a,o.directiveStart+d,o),i);jk(a,i,o),u&&Yr(u,i);const l=No(i,a,o.directiveStart+o.componentOffset,o);if(n[fn]=i[fn]=l,null!==s)for(const d of s)d(l,e);return F0(a,o,n),l}(GT,Ue,St,Ir,q,[h5]),z0(O,q,null)}finally{Bp()}return new s5(this.componentType,ue,Zd(Te,q),q,Te)}}class s5 extends Z9{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new n5(i),this.componentType=e}setInput(e,t){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;q0(s[me],s,i,e,t),this.previousInputValues.set(e,t),ug(Ii(this._tNode.index,s))}}get injector(){return new Dr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function h5(){const n=gr();Ad(ee()[me],n)}function jt(n){let e=function rO(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(Ms(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new L(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);const o=n;o.inputs=zv(n.inputs),o.inputTransforms=zv(n.inputTransforms),o.declaredInputs=zv(n.declaredInputs),o.outputs=zv(n.outputs);const a=i.hostBindings;a&&m5(n,a);const u=i.viewQuery,l=i.contentQueries;if(u&&p5(n,u),l&&g5(n,l),Ft(n.inputs,i.inputs),Ft(n.declaredInputs,i.declaredInputs),Ft(n.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Ft(o.inputTransforms,i.inputTransforms)),Ms(i)&&i.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===jt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function f5(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=iu(i.hostAttrs,t=iu(t,i.hostAttrs))}}(r)}function zv(n){return n===Rs?{}:n===bt?[]:n}function p5(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function g5(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,s)=>{e(r,i,s),t(r,i,s)}:e}function m5(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}function Jr(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Bi(n,e,t,r){const i=ee();return Jr(i,va(),e)&&(It(),xo(pn(),i,n,e,t,r)),Bi}function ei(n,e,t,r,i,s,o,a){const u=ee(),l=It(),d=n+at,f=l.firstCreatePass?function j5(n,e,t,r,i,s,o,a,u){const l=e.consts,d=Jd(e,n,4,o||null,Ro(l,a));B0(e,t,d,Ro(l,u)),Ad(e,d);const f=d.tView=U0(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,l,u,e,t,r,i,s,o):l.data[d];ks(f,!1);const m=EO(l,u,f,n);Dd()&&Tv(l,u,m,f),Yr(m,u),$v(u,u[d]=Hk(m,u,m,f)),Ep(f)&&L0(l,u,f),null!=o&&V0(u,f,a)}let EO=function IO(n,e,t,r){return Po(!0),e[ze].createComment("")};function Jn(n,e,t){const r=ee();return Jr(r,va(),e)&&ls(It(),pn(),r,n,e,r[ze],t,!1),Jn}function X0(n,e,t,r,i){const o=i?"class":"style";q0(n,t,e.inputs[o],o,r)}function $t(n,e,t,r){const i=ee(),s=It(),o=at+n,a=i[ze],u=s.firstCreatePass?function G5(n,e,t,r,i,s){const o=e.consts,u=Jd(e,n,2,r,Ro(o,i));return B0(e,t,u,Ro(o,s)),null!==u.attrs&&Hv(u,u.attrs,!1),null!==u.mergedAttrs&&Hv(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,t,r):s.data[o],l=wO(s,i,u,a,e,n);i[o]=l;const d=Ep(u);return ks(u,!0),kx(a,l,u),32!=(32&u.flags)&&Dd()&&Tv(s,i,l,u),0===function EC(){return Be.lFrame.elementDepthCount}()&&Yr(l,i),function xp(){Be.lFrame.elementDepthCount++}(),d&&(L0(s,i,u),F0(s,u,i)),null!==r&&V0(i,u),$t}function Zt(){let n=gr();Ml()?xl():(n=n.parent,ks(n,!1));const e=n;(function zy(n){return Be.skipHydrationRootTNode===n})(e)&&function wC(){Be.skipHydrationRootTNode=null}(),function kp(){Be.lFrame.elementDepthCount--}();const t=It();return t.firstCreatePass&&(Ad(t,n),vp(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Rd(n){return 0!=(8&n.flags)}(e)&&X0(t,e,ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function ov(n){return 0!=(16&n.flags)}(e)&&X0(t,e,ee(),e.stylesWithoutHost,!1),Zt}function to(n,e,t,r){return $t(n,e,t,r),Zt(),to}let wO=(n,e,t,r,i,s)=>(Po(!0),Ev(r,i,function jp(){return Be.lFrame.currentNamespace}()));function _g(n,e,t){const r=ee(),i=It(),s=n+at,o=i.firstCreatePass?function Z5(n,e,t,r,i){const s=e.consts,o=Ro(s,r),a=Jd(e,n,8,"ng-container",o);return null!==o&&Hv(a,o,!0),B0(e,t,a,Ro(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,r,e,t):i.data[s];ks(o,!0);const a=CO(i,r,o,n);return r[s]=a,Dd()&&Tv(i,r,a,o),Yr(a,r),Ep(o)&&(L0(i,r,o),F0(i,o,r)),null!=t&&V0(r,o),_g}function yg(){let n=gr();const e=It();return Ml()?xl():(n=n.parent,ks(n,!1)),e.firstCreatePass&&(Ad(e,n),vp(n)&&e.queries.elementEnd(n)),yg}let CO=(n,e,t,r)=>(Po(!0),ZC(e[ze],""));function J0(){return ee()}function vg(n){return!!n&&"function"==typeof n.then}function bO(n){return!!n&&"function"==typeof n.subscribe}function ar(n,e,t,r){const i=ee(),s=It(),o=gr();return function AO(n,e,t,r,i,s,o){const a=Ep(r),l=n.firstCreatePass&&function Gk(n){return n.cleanup||(n.cleanup=[])}(n),d=e[fn],f=function zk(n){return n[ou]||(n[ou]=[])}(e);let m=!0;if(3&r.type||o){const T=$n(r,e),D=o?o(T):T,k=f.length,P=o?q=>o(Gt(q[r.index])):r.index;let O=null;if(!o&&a&&(O=function X5(n,e,t,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===r){const a=e[ou],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(n,e,i,r.index)),null!==O)(O.__ngLastListenerFn__||O).__ngNextListenerFn__=s,O.__ngLastListenerFn__=s,m=!1;else{s=RO(r,e,d,s,!1);const q=t.listen(D,i,s);f.push(s,q),l&&l.push(i,P,k,k+1)}}else s=RO(r,e,d,s,!1);const _=r.outputs;let v;if(m&&null!==_&&(v=_[i])){const T=v.length;if(T)for(let D=0;D<T;D+=2){const ue=e[v[D]][v[D+1]].subscribe(s),Te=f.length;f.push(s,ue),l&&l.push(i,r.index,Te,-(Te+1))}}}(s,i,i[ze],o,n,e,r),ar}function SO(n,e,t,r){try{return Vi(6,e,t),!1!==t(r)}catch(i){return Kk(n,i),!1}finally{Vi(7,e,t)}}function RO(n,e,t,r,i){return function s(o){if(o===Function)return r;ug(n.componentOffset>-1?Ii(n.index,e):e);let u=SO(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)u=SO(e,t,l,o)&&u,l=l.__ngNextListenerFn__;return i&&!1===u&&o.preventDefault(),u}}function cs(n=1){return function DC(n){return(Be.lFrame.contextLView=function AC(n,e){for(;n>0;)e=e[Do],n--;return e}(n,Be.lFrame.contextLView))[fn]}(n)}function Yv(n,e){return n<<17|e<<2}function wu(n){return n>>17&32767}function tb(n){return 2|n}function Hl(n){return(131068&n)>>2}function nb(n,e){return-131069&n|e<<2}function rb(n){return 1|n}function UO(n,e,t,r,i){const s=n[t+1],o=null===e;let a=r?wu(s):Hl(s),u=!1;for(;0!==a&&(!1===u||o);){const d=n[a+1];a8(n[a],e)&&(u=!0,n[a+1]=r?rb(d):tb(d)),a=r?wu(d):Hl(d)}u&&(n[t+1]=r?tb(s):rb(s))}function a8(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Ud(n,e)>=0}const _r={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function BO(n){return n.substring(_r.key,_r.keyEnd)}function jO(n,e){const t=_r.textEnd;return t===e?-1:(e=_r.keyEnd=function d8(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,_r.key=e,t),lh(n,e,t))}function lh(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function ch(n,e,t){return no(n,e,t,!1),ch}function Xv(n,e){return no(n,e,null,!0),Xv}function Da(n){!function ro(n,e,t,r){const i=It(),s=Xs(2);i.firstUpdatePass&&WO(i,null,s,r);const o=ee();if(t!==Qe&&Jr(o,s,t)){const a=i.data[Vr()];if(YO(a,r)&&!GO(i,s)){let u=r?a.classesWithoutHost:a.stylesWithoutHost;null!==u&&(t=or(u,t||"")),X0(i,a,o,t,r)}else!function I8(n,e,t,r,i,s,o,a){i===Qe&&(i=bt);let u=0,l=0,d=0<i.length?i[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const m=u<i.length?i[u+1]:void 0,_=l<s.length?s[l+1]:void 0;let T,v=null;d===f?(u+=2,l+=2,m!==_&&(v=f,T=_)):null===f||null!==d&&d<f?(u+=2,v=d):(l+=2,v=f,T=_),null!==v&&ZO(n,e,t,r,v,T,o,a),d=u<i.length?i[u]:null,f=l<s.length?s[l]:null}}(i,a,o,o[ze],o[s+1],o[s+1]=function v8(n,e,t){if(null==t||""===t)return bt;const r=[],i=ss(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)n(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&n(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(n,e,t),r,s)}}(E8,Fo,n,!0)}function Fo(n,e){for(let t=function l8(n){return function HO(n){_r.key=0,_r.keyEnd=0,_r.value=0,_r.valueEnd=0,_r.textEnd=n.length}(n),jO(n,lh(n,0,_r.textEnd))}(e);t>=0;t=jO(e,t))is(n,BO(e),!0)}function no(n,e,t,r){const i=ee(),s=It(),o=Xs(2);s.firstUpdatePass&&WO(s,n,o,r),e!==Qe&&Jr(i,o,e)&&ZO(s,s.data[Vr()],i,i[ze],n,i[o+1]=function w8(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Re(ss(n)))),n}(e,t),r,o)}function GO(n,e){return e>=n.expandoStartIndex}function WO(n,e,t,r){const i=n.data;if(null===i[t+1]){const s=i[Vr()],o=GO(n,t);YO(s,r)&&null===e&&!o&&(e=!1),e=function g8(n,e,t,r){const i=kl(n);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=Eg(t=ib(null,n,e,t,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==i)if(t=ib(i,n,e,t,r),null===s){let u=function m8(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==Hl(r))return n[wu(r)]}(n,e,r);void 0!==u&&Array.isArray(u)&&(u=ib(null,n,e,u[1],r),u=Eg(u,e.attrs,r),function _8(n,e,t,r){n[wu(t?e.classBindings:e.styleBindings)]=r}(n,e,r,u))}else s=function y8(n,e,t){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Eg(r,n[s].hostAttrs,t);return Eg(r,e.attrs,t)}(n,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,r),function s8(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=wu(o),u=Hl(o);n[r]=t;let d,l=!1;if(Array.isArray(t)?(d=t[1],(null===d||Ud(t,d)>0)&&(l=!0)):d=t,i)if(0!==u){const m=wu(n[a+1]);n[r+1]=Yv(m,a),0!==m&&(n[m+1]=nb(n[m+1],r)),n[a+1]=function r8(n,e){return 131071&n|e<<17}(n[a+1],r)}else n[r+1]=Yv(a,0),0!==a&&(n[a+1]=nb(n[a+1],r)),a=r;else n[r+1]=Yv(u,0),0===a?a=r:n[u+1]=nb(n[u+1],r),u=r;l&&(n[r+1]=tb(n[r+1])),UO(n,d,r,!0),UO(n,d,r,!1),function o8(n,e,t,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Ud(s,e)>=0&&(t[r+1]=rb(t[r+1]))}(e,d,n,r,s),o=Yv(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,r)}}function ib(n,e,t,r,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],r=Eg(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),r}function Eg(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),is(n,o,!!t||e[++s]))}return void 0===n?null:n}function E8(n,e,t){const r=String(e);""!==r&&!r.includes(" ")&&is(n,r,t)}function ZO(n,e,t,r,i,s,o,a){if(!(3&e.type))return;const u=n.data,l=u[a+1],d=function i8(n){return 1==(1&n)}(l)?QO(u,e,t,i,Hl(l),o):void 0;Jv(d)||(Jv(s)||function n8(n){return 2==(2&n)}(l)&&(s=QO(u,null,t,i,a,o)),function J3(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=-1===r.indexOf("-")?void 0:Iu.DashCase;null==i?n.removeStyle(t,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Iu.Important),n.setStyle(t,r,i,s))}}(r,o,vd(Vr(),t),i,s))}function QO(n,e,t,r,i,s){const o=null===e;let a;for(;i>0;){const u=n[i],l=Array.isArray(u),d=l?u[1]:u,f=null===d;let m=t[i+1];m===Qe&&(m=f?bt:void 0);let _=f?UC(m,r):d===r?m:void 0;if(l&&!Jv(_)&&(_=UC(u,r)),Jv(_)&&(a=_,o))return a;const v=n[i+1];i=o?wu(v):Hl(v)}if(null!==e){let u=s?e.residualClasses:e.residualStyles;null!=u&&(a=UC(u,r))}return a}function Jv(n){return void 0!==n}function YO(n,e){return 0!=(n.flags&(e?8:16))}function On(n,e=""){const t=ee(),r=It(),i=n+at,s=r.firstCreatePass?Jd(r,i,1,e,null):r.data[i],o=XO(r,t,s,e,n);t[i]=o,Dd()&&Tv(r,t,o,s),ks(s,!1)}let XO=(n,e,t,r,i)=>(Po(!0),function vv(n,e){return n.createText(e)}(e[ze],r));function Aa(n,e,t){const r=ee(),i=function th(n,e,t,r){return Jr(n,va(),t)?e+Ce(t)+r:Qe}(r,n,e,t);return i!==Qe&&function ba(n,e,t){const r=vd(e,n);!function Ix(n,e,t){n.setValue(e,t)}(n[ze],r,t)}(r,Vr(),i),Aa}function sb(n,e,t){const r=ee();if(Jr(r,va(),e)){const s=It(),o=pn();ls(s,o,r,n,e,Wk(kl(s.data),o,r),t,!0)}return sb}const hh="en-US";let E1=hh;function ub(n,e,t,r,i){if(n=x(n),Array.isArray(n))for(let s=0;s<n.length;s++)ub(n[s],e,t,r,i);else{const s=It(),o=ee(),a=gr();let u=jl(n)?n:x(n.provide);const l=ek(n),d=1048575&a.providerIndexes,f=a.directiveStart,m=a.providerIndexes>>20;if(jl(n)||!n.multi){const _=new Ea(l,i,te),v=cb(u,e,i?d:d+m,f);-1===v?(Ee(w(a,o),s,u),lb(s,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[v]=_,o[v]=_)}else{const _=cb(u,e,d+m,f),v=cb(u,e,d,d+m),D=v>=0&&t[v];if(i&&!D||!i&&!(_>=0&&t[_])){Ee(w(a,o),s,u);const k=function HK(n,e,t,r,i){const s=new Ea(n,t,te);return s.multi=[],s.index=e,s.componentProviders=0,z1(s,i,r&&!t),s}(i?$K:jK,t.length,i,r,l);!i&&D&&(t[v].providerFactory=k),lb(s,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(k),o.push(k)}else lb(s,n,_>-1?_:v,z1(t[i?v:_],l,!i&&r));!i&&r&&D&&t[v].componentProviders++}}}function lb(n,e,t,r){const i=jl(e),s=function M9(n){return!!n.useClass}(e);if(i||s){const u=(s?x(e.useClass):e).prototype.ngOnDestroy;if(u){const l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const d=l.indexOf(t);-1===d?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function z1(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function cb(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function jK(n,e,t,r){return db(this.multi,[])}function $K(n,e,t,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=No(t,t[me],this.providerFactory.index,r);s=a.slice(0,o),db(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],db(i,s);return s}function db(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Dn(n,e=[]){return t=>{t.providersResolver=(r,i)=>function BK(n,e,t){const r=It();if(r.firstCreatePass){const i=Ms(n);ub(t,r.data,r.blueprint,i,!0),ub(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}class zl{}class G1{}class hb extends zl{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tO(this);const i=Fr(e);this._bootstrapComponents=Ca(i.bootstrap),this._r3Injector=pk(e,t,[{provide:zl,useValue:this},{provide:og,useValue:this.componentFactoryResolver},...r],Re(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class fb extends G1{constructor(e){super(),this.moduleType=e}create(e){return new hb(this.moduleType,e,[])}}class W1 extends zl{constructor(e){super(),this.componentFactoryResolver=new tO(this),this.instance=null;const t=new zd([...e.providers,{provide:zl,useValue:this},{provide:og,useValue:this.componentFactoryResolver}],e.parent||Mv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function pb(n,e,t=null){return new W1({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let GK=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=Qx(0,t.type),i=r.length>0?pb([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ye({token:n,providedIn:"environment",factory:()=>new n(W(as))})}return n})();function iE(n){n.getStandaloneInjector=e=>e.get(GK).getOrCreateStandaloneInjector(n)}function EZ(n,e,t,r=!0){const i=e[me];if(function z3(n,e,t,r){const i=br+r,s=t.length;r>0&&(t[i-1][rs]=e),r<s-br?(e[rs]=t[i],YM(t,br+r,e)):(t.push(e),e[rs]=null),e[sn]=t;const o=e[fa];null!==o&&t!==o&&function G3(n,e){const t=n[lu];e[xn]!==e[sn][sn][xn]&&(n[Ty]=!0),null===t?n[lu]=[e]:t.push(e)}(o,e);const a=e[Fi];null!==a&&a.insertView(n),e[qe]|=128}(i,e,n,t),r){const s=e0(t,n),o=e[ze],a=wv(o,n[Ns]);null!==a&&function $3(n,e,t,r,i,s){r[rn]=i,r[Cr]=e,eg(n,r,t,1,i,s)}(i,n[Cr],o,e,a,s)}}Symbol;let Sa=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=TZ}return n})();const IZ=Sa,wZ=class extends IZ{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){const i=function vZ(n,e,t,r){const i=e.tView,a=jv(n,i,t,4096&n[qe]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[fa]=n[e.index];const l=n[Fi];return null!==l&&(a[Fi]=l.createEmbeddedView(i)),z0(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:r});return new dg(i)}};function TZ(){return function sE(n,e){return 4&n.type?new wZ(e,n,Zd(n,e)):null}(gr(),ee())}let io=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=RZ}return n})();function RZ(){return function dF(n,e){let t;const r=e[n.index];return pr(r)?t=r:(t=Hk(r,e,null,n),e[n.index]=t,$v(e,t)),hF(t,e,n,r),new lF(t,n,e)}(gr(),ee())}const PZ=io,lF=class extends PZ{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Zd(this._hostTNode,this._hostLView)}get injector(){return new Dr(this._hostTNode,this._hostLView)}get parentInjector(){const e=re(this._hostTNode,this._hostLView);if(Hp(e)){const t=Ll(e,this._hostLView),r=Fl(e);return new Dr(t[me].data[r+8],t)}return new Dr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=cF(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-br}createEmbeddedView(e,t,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,r,i,s){const o=e&&!function Wp(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const T=t||{};a=T.index,r=T.injector,i=T.projectableNodes,s=T.environmentInjector||T.ngModuleRef}const u=o?e:new hg(dt(e)),l=r||this.parentInjector;if(!s&&null==u.ngModule){const D=(o?l:this.parentInjector).get(as,null);D&&(s=D)}dt(u.componentType??{});const _=u.create(l,i,null,s);return this.insertImpl(_.hostView,a,false),_}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,r){const i=e._lView;if(function yC(n){return pr(n[sn])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const l=i[sn],d=new lF(l,l[Cr],l[sn]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return EZ(a,i,o,!r),e.attachToViewContainerRef(),YM(_b(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=cF(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=Iv(this._lContainer,t);r&&(cv(_b(this._lContainer),t),QC(r[me],r))}detach(e){const t=this._adjustIndex(e,-1),r=Iv(this._lContainer,t);return r&&null!=cv(_b(this._lContainer),t)?new dg(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function cF(n){return n[8]}function _b(n){return n[8]||(n[8]=[])}let hF=function fF(n,e,t,r){if(n[Ns])return;let i;i=8&t.type?Gt(r):function NZ(n,e){const t=n[ze],r=t.createComment(""),i=$n(e,n);return Ul(t,wv(t,i),r,function Q3(n,e){return n.nextSibling(e)}(t,i),!1),r}(e,t),n[Ns]=i};const Sb=new le("Application Initializer");let Rb=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=pe(Sb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const i of this.appInits){const s=i();if(vg(s))t.push(s);else if(bO(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});t.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),VF=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Ra=new le("LocaleId",{providedIn:"root",factory:()=>pe(Ra,rt.Optional|rt.SkipSelf)||function u7(){return typeof $localize<"u"&&$localize.locale||hh}()});let uE=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new E(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class d7{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let UF=(()=>{class n{compileModuleSync(t){return new fb(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),s=Ca(Fr(t).declarations).reduce((o,a)=>{const u=dt(a);return u&&o.push(new hg(u)),o},[]);return new d7(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const HF=new le(""),cE=new le("");let kb,Mb=(()=>{class n{constructor(t,r,i){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,kb||(function x7(n){kb=n}(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{wt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||n)(W(wt),W(xb),W(cE))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),xb=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return kb?.findTestabilityInTree(this,t,r)??null}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Tu=null;const qF=new le("AllowMultipleToken"),Ob=new le("PlatformDestroyListeners"),Fb=new le("appBootstrapListener");class GF{constructor(e,t){this.name=e,this.token=t}}function KF(n,e,t=[]){const r=`Platform: ${e}`,i=new le(r);return(s=[])=>{let o=Lb();if(!o||o.injector.get(qF,!1)){const a=[...t,...s,{provide:i,useValue:!0}];n?n(a):function F7(n){if(Tu&&!Tu.get(qF,!1))throw new L(400,!1);(function zF(){!function lC(n){uC=n}(()=>{throw new L(600,!1)})})(),Tu=n;const e=n.get(QF);(function WF(n){n.get(tk,null)?.forEach(t=>t())})(n)}(function ZF(n=[],e){return Xr.create({name:e,providers:[{provide:f0,useValue:"platform"},{provide:Ob,useValue:new Set([()=>Tu=null])},...n]})}(a,r))}return function V7(n){const e=Lb();if(!e)throw new L(401,!1);return e}()}}function Lb(){return Tu?.get(QF)??null}let QF=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const i=function U7(n="zone.js",e){return"noop"===n?new f6:"zone.js"===n?new wt(e):n}(r?.ngZone,function YF(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function zK(n,e,t){return new hb(n,e,t)}(t.moduleType,this.injector,function nL(n){return[{provide:wt,useFactory:n},{provide:rg,multi:!0,useFactory:()=>{const e=pe(j7,{optional:!0});return()=>e.initialize()}},{provide:tL,useFactory:B7},{provide:vk,useFactory:Ek}]}(()=>i)),o=s.injector.get(Ta,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:u=>{o.handleError(u)}});s.onDestroy(()=>{dE(this._modules,s),a.unsubscribe()})}),function XF(n,e,t){try{const r=t();return vg(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(Rb);return a.runInitializers(),a.donePromise.then(()=>(function I1(n){wr(n,"Expected localeId to be defined"),"string"==typeof n&&(E1=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ra,hh)||hh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,r=[]){const i=JF({},r);return function k7(n,e,t){const r=new fb(t);return Promise.resolve(r)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){const r=t.injector.get(Pa);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new L(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new L(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(Ob,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||n)(W(Xr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function JF(n,e){return Array.isArray(e)?e.reduce(JF,n):{...n,...e}}let Pa=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=pe(tL),this.zoneIsStable=pe(vk),this.componentTypes=[],this.components=[],this.isStable=pe(uE).hasPendingTasks.pipe(ve(t=>t?R(!1):this.zoneIsStable),Fe(),K()),this._injector=pe(as)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const i=t instanceof ak;if(!this._injector.get(Rb).done)throw!i&&function su(n){const e=dt(n)||hr(n)||fr(n);return null!==e&&e.standalone}(t),new L(405,!1);let o;o=i?t:this._injector.get(og).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function O7(n){return n.isBoundToModule}(o)?void 0:this._injector.get(zl),l=o.create(Xr.NULL,[],r||o.selector,a),d=l.location.nativeElement,f=l.injector.get(HF,null);return f?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),dE(this.components,l),f?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new L(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;dE(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(Fb,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>dE(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new L(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const tL=new le("",{providedIn:"root",factory:()=>pe(Ta).handleError.bind(void 0)});function B7(){const n=pe(wt),e=pe(Ta);return t=>n.runOutsideAngular(()=>e.handleError(t))}let j7=(()=>{class n{constructor(){this.zone=pe(wt),this.applicationRef=pe(Pa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let hE=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=H7}return n})();function H7(n){return function q7(n,e,t){if(ga(n)&&!t){const r=Ii(n.index,e);return new dg(r,r)}return 47&n.type?new dg(e[xn],e):null}(gr(),ee(),16==(16&n))}const rQ=KF(null,"core",[]);let iQ=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(r){return new(r||n)(W(Pa))};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({})}return n})(),Hb=null;function Cu(){return Hb}class yQ{}const yr=new le("DocumentToken");let qb=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(EQ)},providedIn:"platform"})}return n})();const vQ=new le("Location Initialized");let EQ=(()=>{class n extends qb{constructor(){super(),this._doc=pe(yr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cu().getBaseHref(this._doc)}onPopState(t){const r=Cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=Cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function zb(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function IL(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Na(n){return n&&"?"!==n[0]?"?"+n:n}let Wl=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(TL)},providedIn:"root"})}return n})();const wL=new le("appBaseHref");let TL=(()=>{class n extends Wl{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??pe(yr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return zb(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Na(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){const o=this.prepareExternalUrl(i+Na(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){const o=this.prepareExternalUrl(i+Na(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(qb),W(wL,8))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),IQ=(()=>{class n extends Wl{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=zb(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Na(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Na(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(qb),W(wL,8))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),Gb=(()=>{class n{constructor(t){this._subject=new Hn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function CQ(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(IL(CL(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Na(r))}normalize(t){return n.stripTrailingSlash(function TQ(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,CL(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Na(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Na(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static#e=this.normalizeQueryParams=Na;static#t=this.joinWithSlash=zb;static#n=this.stripTrailingSlash=IL;static#r=this.\u0275fac=function(r){return new(r||n)(W(Wl))};static#i=this.\u0275prov=ye({token:n,factory:function(){return function wQ(){return new Gb(W(Wl))}()},providedIn:"root"})}return n})();function CL(n){return n.replace(/\/index.html$/,"")}function xL(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,s]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}let AE=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new hY,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){LL("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){LL("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static#e=this.\u0275fac=function(r){return new(r||n)(te(io),te(Sa))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class hY{constructor(){this.$implicit=null,this.ngIf=null}}function LL(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Re(e)}'.`)}let LY=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({})}return n})();function SE(n){return"server"===n}let jY=(()=>{class n{static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new $Y(W(yr),window)})}return n})();class $Y{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function HY(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class jL{}class hX extends yQ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class lD extends hX{static makeCurrent(){!function _Q(n){Hb||(Hb=n)}(new lD)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function fX(){return kg=kg||document.querySelector("base"),kg?kg.getAttribute("href"):null}();return null==t?null:function pX(n){NE=NE||document.createElement("a"),NE.setAttribute("href",n);const e=NE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){kg=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return xL(document.cookie,e)}}let NE,kg=null,mX=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const cD=new le("EventManagerPlugins");let GL=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new L(5101,!1);return this._eventNameToPlugin.set(t,r),r}static#e=this.\u0275fac=function(r){return new(r||n)(W(cD),W(wt))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class WL{constructor(e){this._doc=e}}const dD="ng-app-id";let KL=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=SE(s),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${dD}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){const i=this.styleRef;if(i.has(t)){const s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(dD),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(dD,this.appId),o}}addStyleToHost(t,r){const i=this.getStyleElement(t,r);t.appendChild(i);const s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(xv),W(rk,8),W(Ls))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const hD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},fD=/%COMP%/g,EX=new le("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function QL(n,e){return e.map(t=>t.replace(fD,n))}let pD=(()=>{class n{constructor(t,r,i,s,o,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=SE(a),this.defaultRenderer=new gD(t,o,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Oi.ShadowDom&&(r={...r,encapsulation:Oi.Emulated});const i=this.getOrCreateRenderer(t,r);return i instanceof XL?i.applyToHost(t):i instanceof mD&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Oi.Emulated:s=new XL(u,l,r,this.appId,d,o,a,f);break;case Oi.ShadowDom:return new CX(u,l,t,r,o,a,this.nonce,f);default:s=new mD(u,l,r,d,o,a,f)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||n)(W(GL),W(KL),W(xv),W(EX),W(yr),W(Ls),W(wt),W(rk))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class gD{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(hD[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YL(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(YL(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new L(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const s=hD[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=hD[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Iu.DashCase|Iu.Important)?e.style.setProperty(t,r,i&Iu.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Iu.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){if("string"==typeof e&&!(e=Cu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function YL(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class CX extends gD{constructor(e,t,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=QL(i.id,i.styles);for(const d of l){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class mD extends gD{constructor(e,t,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?QL(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class XL extends mD{constructor(e,t,r,i,s,o,a,u){const l=i+"-"+r.id;super(e,t,r,s,o,a,u,l),this.contentAttr=function IX(n){return"_ngcontent-%COMP%".replace(fD,n)}(l),this.hostAttr=function wX(n){return"_nghost-%COMP%".replace(fD,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let bX=(()=>{class n extends WL{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const JL=["alt","control","meta","shift"],DX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},AX={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let SX=(()=>{class n extends WL{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cu().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),JL.forEach(l=>{const d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=DX[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),JL.forEach(o=>{o!==i&&(0,AX[o])(t)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const tV=[{provide:Ls,useValue:"browser"},{provide:tk,useValue:function RX(){lD.makeCurrent()},multi:!0},{provide:yr,useFactory:function NX(){return function i9(n){r0=n}(document),document},deps:[]}],MX=KF(rQ,"browser",tV),xX=new le(""),nV=[{provide:cE,useClass:class gX{addToWindow(e){Lt.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new L(5103,!1);return s},Lt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Lt.getAllAngularRootElements=()=>e.getAllRootElements(),Lt.frameworkStabilizers||(Lt.frameworkStabilizers=[]),Lt.frameworkStabilizers.push(r=>{const i=Lt.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(u=>{u.whenStable(a)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?Cu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:HF,useClass:Mb,deps:[wt,xb,cE]},{provide:Mb,useClass:Mb,deps:[wt,xb,cE]}],rV=[{provide:f0,useValue:"root"},{provide:Ta,useFactory:function PX(){return new Ta},deps:[]},{provide:cD,useClass:bX,multi:!0,deps:[yr,wt,Ls]},{provide:cD,useClass:SX,multi:!0,deps:[yr]},pD,KL,GL,{provide:ag,useExisting:pD},{provide:jL,useClass:mX,deps:[]},[]];let iV=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:xv,useValue:t.appId}]}}static#e=this.\u0275fac=function(r){return new(r||n)(W(xX,12))};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({providers:[...rV,...nV],imports:[LY,iQ]})}return n})(),sV=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new r:function OX(){return new sV(W(yr))}(),i},providedIn:"root"})}return n})();typeof window<"u"&&window;let uV=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new(r||n):W(lV),i},providedIn:"root"})}return n})(),lV=(()=>{class n extends uV{constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case os.NONE:return r;case os.HTML:return Mo(r,"HTML")?ss(r):qx(this._doc,String(r)).toString();case os.STYLE:return Mo(r,"Style")?ss(r):r;case os.SCRIPT:if(Mo(r,"Script"))return ss(r);throw new L(5200,!1);case os.URL:return Mo(r,"URL")?ss(r):Av(String(r));case os.RESOURCE_URL:if(Mo(r,"ResourceURL"))return ss(r);throw new L(5201,!1);default:throw new L(5202,!1)}}bypassSecurityTrustHtml(t){return function d9(n){return new s9(n)}(t)}bypassSecurityTrustStyle(t){return function h9(n){return new o9(n)}(t)}bypassSecurityTrustScript(t){return function f9(n){return new a9(n)}(t)}bypassSecurityTrustUrl(t){return function p9(n){return new u9(n)}(t)}bypassSecurityTrustResourceUrl(t){return function g9(n){return new l9(n)}(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new r:function UX(n){return new lV(n.get(yr))}(W(Xr)),i},providedIn:"root"})}return n})();const{isArray:BX}=Array,{getPrototypeOf:jX,prototype:$X,keys:HX}=Object;function dV(n){if(1===n.length){const e=n[0];if(BX(e))return{args:e,keys:null};if(function qX(n){return n&&"object"==typeof n&&jX(n)===$X}(e)){const t=HX(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}const{isArray:zX}=Array;function hV(n){return de(e=>function GX(n,e){return zX(e)?n(...e):n(e)}(n,e))}function fV(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}let pV=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(r){return new(r||n)(te(wa),te(us))};static#t=this.\u0275dir=Ve({type:n})}return n})(),Kl=(()=>{class n extends pV{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=Xn(n)))(i||n)}}();static#t=this.\u0275dir=Ve({type:n,features:[jt]})}return n})();const Lo=new le("NgValueAccessor"),ZX={provide:Lo,useExisting:U(()=>ME),multi:!0},YX=new le("CompositionEventMode");let ME=(()=>{class n extends pV{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function QX(){const n=Cu()?Cu().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(r){return new(r||n)(te(wa),te(us),te(YX,8))};static#t=this.\u0275dir=Ve({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&ar("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Dn([ZX]),jt]})}return n})();function Du(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function mV(n){return null!=n&&"number"==typeof n.length}const ti=new le("NgValidators"),Au=new le("NgAsyncValidators"),XX=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class yD{static min(e){return function _V(n){return e=>{if(Du(e.value)||Du(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function yV(n){return e=>{if(Du(e.value)||Du(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function vV(n){return Du(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function EV(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function IV(n){return Du(n.value)||XX.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function wV(n){return e=>Du(e.value)||!mV(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function TV(n){return e=>mV(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function CV(n){if(!n)return xE;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Du(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return PV(e)}static composeAsync(e){return NV(e)}}function xE(n){return null}function bV(n){return null!=n}function DV(n){return vg(n)?I(n):n}function AV(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function SV(n,e){return e.map(t=>t(n))}function RV(n){return n.map(e=>function JX(n){return!n.validate}(e)?e:t=>e.validate(t))}function PV(n){if(!n)return null;const e=n.filter(bV);return 0==e.length?null:function(t){return AV(SV(t,e))}}function vD(n){return null!=n?PV(RV(n)):null}function NV(n){if(!n)return null;const e=n.filter(bV);return 0==e.length?null:function(t){return function WX(...n){const e=ki(n),{args:t,keys:r}=dV(n),i=new Ze(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let u=o,l=o;for(let d=0;d<o;d++){let f=!1;gt(t[d]).subscribe(ce(s,m=>{f||(f=!0,l--),a[d]=m},()=>u--,void 0,()=>{(!u||!f)&&(l||s.next(r?fV(r,a):a),s.complete())}))}});return e?i.pipe(hV(e)):i}(SV(t,e).map(DV)).pipe(de(AV))}}function ED(n){return null!=n?NV(RV(n)):null}function MV(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function xV(n){return n._rawValidators}function kV(n){return n._rawAsyncValidators}function ID(n){return n?Array.isArray(n)?n:[n]:[]}function kE(n,e){return Array.isArray(n)?n.includes(e):n===e}function OV(n,e){const t=ID(e);return ID(n).forEach(i=>{kE(t,i)||t.push(i)}),t}function FV(n,e){return ID(e).filter(t=>!kE(n,t))}class LV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=vD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ED(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class bi extends LV{get formDirective(){return null}get path(){return null}}class Su extends LV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class VV{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let UV=(()=>{class n extends VV{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||n)(te(Su,2))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&Xv("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[jt]})}return n})(),BV=(()=>{class n extends VV{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||n)(te(bi,10))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&Xv("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[jt]})}return n})();const Og="VALID",FE="INVALID",_h="PENDING",Fg="DISABLED";function CD(n){return(LE(n)?n.validators:n)||null}function bD(n,e){return(LE(e)?e.asyncValidators:n)||null}function LE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function $V(n,e,t){const r=n.controls;if(!(e?Object.keys(r):r).length)throw new L(1e3,"");if(!r[t])throw new L(1001,"")}function HV(n,e,t){n._forEachChild((r,i)=>{if(void 0===t[i])throw new L(1002,"")})}class VE{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Og}get invalid(){return this.status===FE}get pending(){return this.status==_h}get disabled(){return this.status===Fg}get enabled(){return this.status!==Fg}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(OV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(OV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(FV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(FV(e,this._rawAsyncValidators))}hasValidator(e){return kE(this._rawValidators,e)}hasAsyncValidator(e){return kE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=_h,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Fg,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Og,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Og||this.status===_h)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fg:Og}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=_h,this._hasOwnPendingAsyncValidator=!0;const t=DV(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Hn,this.statusChanges=new Hn}_calculateStatus(){return this._allControlsDisabled()?Fg:this.errors?FE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_h)?_h:this._anyControlsHaveStatus(FE)?FE:Og}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){LE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function rJ(n){return Array.isArray(n)?vD(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function iJ(n){return Array.isArray(n)?ED(n):n||null}(this._rawAsyncValidators)}}class Lg extends VE{constructor(e,t,r){super(CD(t),bD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){HV(this,0,e),Object.keys(e).forEach(r=>{$V(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class qV extends Lg{}const Zl=new le("CallSetDisabledState",{providedIn:"root",factory:()=>Vg}),Vg="always";function Ug(n,e,t=Vg){DD(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function oJ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&zV(n,e)})}(n,e),function uJ(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function aJ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&zV(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function sJ(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function BE(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),$E(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function jE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function DD(n,e){const t=xV(n);null!==e.validator?n.setValidators(MV(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=kV(n);null!==e.asyncValidator?n.setAsyncValidators(MV(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();jE(e._rawValidators,i),jE(e._rawAsyncValidators,i)}function $E(n,e){let t=!1;if(null!==n){if(null!==e.validator){const i=xV(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const i=kV(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}const r=()=>{};return jE(e._rawValidators,r),jE(e._rawAsyncValidators,r),t}function zV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function KV(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function ZV(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const jg=class extends VE{constructor(e=null,t,r){super(CD(t),bD(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),LE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=ZV(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){KV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){KV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){ZV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};let e2=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275dir=Ve({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return n})(),n2=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({})}return n})();const ND=new le("NgModelWithFormControlWarning"),wJ={provide:bi,useExisting:U(()=>HE)};let HE=(()=>{class n extends bi{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Hn,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&($E(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return Ug(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){BE(t.control||null,t,!1),function hJ(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,function WV(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,i=this.form.get(t.path);r!==i&&(BE(r||null,t),(n=>n instanceof jg)(i)&&(Ug(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);(function GV(n,e){DD(n,e)})(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function lJ(n,e){return $E(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){DD(this.form,this),this._oldForm&&$E(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(r){return new(r||n)(te(ti,10),te(Au,10),te(Zl,8))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&ar("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Dn([wJ]),jt,Li]})}return n})();const bJ={provide:Su,useExisting:U(()=>kD)};let kD=(()=>{class n extends Su{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Hn,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function RD(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===ME?t=s:function dJ(n){return Object.getPrototypeOf(n.constructor)===Kl}(s)?r=s:i=s}),i||r||t||null}(0,s)}ngOnChanges(t){this._added||this._setUpControl(),function SD(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function UE(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(r){return new(r||n)(te(bi,13),te(ti,10),te(Au,10),te(Lo,10),te(ND,8))};static#n=this.\u0275dir=Ve({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Dn([bJ]),jt,Li]})}return n})(),y2=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({imports:[n2]})}return n})();class v2 extends VE{constructor(e,t,r){super(CD(t),bD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){HV(this,0,e),e.forEach((r,i)=>{$V(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function E2(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let BJ=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,r=null){const i=this._reduceControls(t);let s={};return E2(r)?s=r:null!==r&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Lg(i,s)}record(t,r=null){const i=this._reduceControls(t);return new qV(i,r)}control(t,r,i){let s={};return this.useNonNullable?(E2(r)?s=r:(s.validators=r,s.asyncValidators=i),new jg(t,{...s,nonNullable:!0})):new jg(t,r,i)}array(t,r,i){const s=t.map(o=>this._createControl(o));return new v2(s,r,i)}_reduceControls(t){const r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){return t instanceof jg||t instanceof VE?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jJ=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Zl,useValue:t.callSetDisabledState??Vg}]}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({imports:[y2]})}return n})(),$J=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ND,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Zl,useValue:t.callSetDisabledState??Vg}]}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({imports:[y2]})}return n})();function VD(...n){const e=ns(n),t=ki(n),{args:r,keys:i}=dV(n);if(0===r.length)return I([],e);const s=new Ze(function qJ(n,e,t=In){return r=>{I2(e,()=>{const{length:i}=n,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)I2(e,()=>{const l=I(n[u],e);let d=!1;l.subscribe(ce(r,f=>{s[u]=f,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>fV(i,o):In));return t?s.pipe(hV(t)):s}function I2(n,e,t){n?fi(t,n,e):e()}const qE=Z(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function UD(...n){return function zJ(){return Zr(1)}()(I(n,ns(n)))}function w2(n){return new Ze(e=>{gt(n()).subscribe(e)})}function $g(n,e){const t=A(n)?n:()=>n,r=i=>i.error(t());return new Ze(e?i=>e.schedule(r,0,i):r)}function BD(){return Y((n,e)=>{let t=null;n._refCount++;const r=ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class T2 extends Ze{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,J(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new _t;const t=this.getSubject();e.add(this.source.subscribe(ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=_t.EMPTY)}return e}refCount(){return BD()(this)}}function yh(n){return n<=0?()=>wn:Y((e,t)=>{let r=0;e.subscribe(ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function zE(...n){const e=ns(n);return Y((t,r)=>{(e?UD(n,t,e):UD(n,t)).subscribe(r)})}function js(n,e){return Y((t,r)=>{let i=0;t.subscribe(ce(r,s=>n.call(e,s,i++)&&r.next(s)))})}function GE(n){return Y((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function C2(n=GJ){return Y((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function GJ(){return new qE}function Ru(n,e){const t=arguments.length>=2;return r=>r.pipe(n?js((i,s)=>n(i,s,r)):In,yh(1),t?GE(e):C2(()=>new qE))}function vh(n,e){return A(e)?xt(n,e,1):xt(n,1)}function Br(n,e,t){const r=A(n)||e||t?{next:n,error:e,complete:t}:n;return r?Y((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(ce(s,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),s.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):In}function Yl(n){return Y((e,t)=>{let s,r=null,i=!1;r=e.subscribe(ce(t,void 0,void 0,o=>{s=gt(n(o,Yl(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Eh(n,e){return Y(function WJ(n,e,t,r,i){return(s,o)=>{let a=t,u=e,l=0;s.subscribe(ce(o,d=>{const f=l++;u=a?n(u,d,f):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(n,e,arguments.length>=2,!0))}function jD(n){return n<=0?()=>wn:Y((e,t)=>{let r=[];e.subscribe(ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Hg(n){return Y((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const et="primary",qg=Symbol("RouteTitle");class YJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Ih(n){return new YJ(n)}function XJ(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Vo(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!b2(n[i],e[i]))return!1;return!0}function b2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}return n===e}function D2(n){return n.length>0?n[n.length-1]:null}function Pu(n){return function HJ(n){return!!n&&(n instanceof Ze||A(n.lift)&&A(n.subscribe))}(n)?n:vg(n)?I(Promise.resolve(n)):R(n)}const eee={exact:function R2(n,e,t){if(!Xl(n.segments,e.segments)||!WE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!R2(n.children[r],e.children[r],t))return!1;return!0},subset:P2},A2={exact:function tee(n,e){return Vo(n,e)},subset:function nee(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>b2(n[t],e[t]))},ignored:()=>!0};function S2(n,e,t){return eee[t.paths](n.root,e.root,t.matrixParams)&&A2[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function P2(n,e,t){return N2(n,e,e.segments,t)}function N2(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!Xl(i,t)||e.hasChildren()||!WE(i,t,r))}if(n.segments.length===t.length){if(!Xl(n.segments,t)||!WE(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!P2(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Xl(n.segments,i)&&WE(n.segments,i,r)&&n.children[et])&&N2(n.children[et],e,s,r)}}function WE(n,e,t){return e.every((r,i)=>A2[t](n[i].parameters,r.parameters))}class wh{constructor(e=new Ht([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ih(this.queryParams)),this._queryParamMap}toString(){return see.serialize(this)}}class Ht{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return KE(this)}}class zg{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Ih(this.parameters)),this._parameterMap}toString(){return k2(this)}}function Xl(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let Gg=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return new $D},providedIn:"root"})}return n})();class $D{parse(e){const t=new mee(e);return new wh(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Wg(e.root,!0)}`,r=function uee(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${ZE(t)}=${ZE(i)}`).join("&"):`${ZE(t)}=${ZE(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function oee(n){return encodeURI(n)}(e.fragment)}`:""}`}}const see=new $D;function KE(n){return n.segments.map(e=>k2(e)).join("/")}function Wg(n,e){if(!n.hasChildren())return KE(n);if(e){const t=n.children[et]?Wg(n.children[et],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==et&&r.push(`${i}:${Wg(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function iee(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===et&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==et&&(t=t.concat(e(i,r)))}),t}(n,(r,i)=>i===et?[Wg(n.children[et],!1)]:[`${i}:${Wg(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[et]?`${KE(n)}/${t[0]}`:`${KE(n)}/(${t.join("//")})`}}function M2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ZE(n){return M2(n).replace(/%3B/gi,";")}function HD(n){return M2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function QE(n){return decodeURIComponent(n)}function x2(n){return QE(n.replace(/\+/g,"%20"))}function k2(n){return`${HD(n.path)}${function aee(n){return Object.keys(n).map(e=>`;${HD(e)}=${HD(n[e])}`).join("")}(n.parameters)}`}const lee=/^[^\/()?;#]+/;function qD(n){const e=n.match(lee);return e?e[0]:""}const cee=/^[^\/()?;=#]+/,hee=/^[^=?&#]+/,pee=/^[^&#]+/;class mee{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ht([],{}):new Ht([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[et]=new Ht(e,t)),r}parseSegment(){const e=qD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new L(4009,!1);return this.capture(e),new zg(QE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function dee(n){const e=n.match(cee);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=qD(this.remaining);i&&(r=i,this.capture(r))}e[QE(t)]=QE(r)}parseQueryParam(e){const t=function fee(n){const e=n.match(hee);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const o=function gee(n){const e=n.match(pee);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=x2(t),s=x2(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=qD(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new L(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=et);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[et]:new Ht([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new L(4011,!1)}}function O2(n){return n.segments.length>0?new Ht([],{[et]:n}):n}function F2(n){const e={};for(const r of Object.keys(n.children)){const s=F2(n.children[r]);if(r===et&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function _ee(n){if(1===n.numberOfChildren&&n.children[et]){const e=n.children[et];return new Ht(n.segments.concat(e.segments),e.children)}return n}(new Ht(n.segments,e))}function Jl(n){return n instanceof wh}function L2(n){let e;const i=O2(function t(s){const o={};for(const u of s.children){const l=t(u);o[u.outlet]=l}const a=new Ht(s.url,o);return s===n&&(e=a),a}(n.root));return e??i}function V2(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(0===e.length)return zD(i,i,i,t,r);const s=function vee(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new B2(!0,0,n);let e=0,t=!1;const r=n.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new B2(t,e,r)}(e);if(s.toRoot())return zD(i,i,new Ht([],{}),t,r);const o=function Eee(n,e,t){if(n.isAbsolute)return new XE(e,!0,0);if(!t)return new XE(e,!1,NaN);if(null===t.parent)return new XE(t,!0,0);const r=YE(n.commands[0])?0:1;return function Iee(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new L(4005,!1);i=r.segments.length}return new XE(r,!1,i-s)}(t,t.segments.length-1+r,n.numberOfDoubleDots)}(s,i,n),a=o.processChildren?Zg(o.segmentGroup,o.index,s.commands):j2(o.segmentGroup,o.index,s.commands);return zD(i,o.segmentGroup,a,t,r)}function YE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Kg(n){return"object"==typeof n&&null!=n&&n.outlets}function zD(n,e,t,r,i){let o,s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),o=n===e?t:U2(n,e,t);const a=O2(F2(o));return new wh(a,s,i)}function U2(n,e,t){const r={};return Object.entries(n.children).forEach(([i,s])=>{r[i]=s===e?t:U2(s,e,t)}),new Ht(n.segments,r)}class B2{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&YE(r[0]))throw new L(4003,!1);const i=r.find(Kg);if(i&&i!==D2(r))throw new L(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class XE{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function j2(n,e,t){if(n||(n=new Ht([],{})),0===n.segments.length&&n.hasChildren())return Zg(n,e,t);const r=function Tee(n,e,t){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;const o=n.segments[i],a=t[r];if(Kg(a))break;const u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!H2(u,l,o))return s;r+=2}else{if(!H2(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const s=new Ht(n.segments.slice(0,r.pathIndex),{});return s.children[et]=new Ht(n.segments.slice(r.pathIndex),n.children),Zg(s,0,i)}return r.match&&0===i.length?new Ht(n.segments,{}):r.match&&!n.hasChildren()?GD(n,e,t):r.match?Zg(n,0,i):GD(n,e,t)}function Zg(n,e,t){if(0===t.length)return new Ht(n.segments,{});{const r=function wee(n){return Kg(n[0])?n[0].outlets:{[et]:n}}(t),i={};if(Object.keys(r).some(s=>s!==et)&&n.children[et]&&1===n.numberOfChildren&&0===n.children[et].segments.length){const s=Zg(n.children[et],e,t);return new Ht(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=j2(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new Ht(n.segments,i)}}function GD(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(Kg(s)){const u=Cee(s.outlets);return new Ht(r,u)}if(0===i&&YE(t[0])){r.push(new zg(n.segments[e].path,$2(t[0]))),i++;continue}const o=Kg(s)?s.outlets[et]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&YE(a)?(r.push(new zg(o,$2(a))),i+=2):(r.push(new zg(o,{})),i++)}return new Ht(r,{})}function Cee(n){const e={};return Object.entries(n).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[t]=GD(new Ht([],{}),0,r))}),e}function $2(n){const e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function H2(n,e,t){return n==t.path&&Vo(e,t.parameters)}const Qg="imperative";class Uo{constructor(e,t){this.id=e,this.url=t}}class JE extends Uo{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Nu extends Uo{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Yg extends Uo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Th extends Uo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class eI extends Uo{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class q2 extends Uo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bee extends Uo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dee extends Uo{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Aee extends Uo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class See extends Uo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ree{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Pee{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Nee{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Mee{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xee{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kee{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class z2{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class WD{}class KD{constructor(e){this.url=e}}class Oee{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Xg,this.attachRef=null}}let Xg=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Oee,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class G2{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=ZD(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=ZD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=QD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return QD(e,this._root).map(t=>t.value)}}function ZD(n,e){if(n===e.value)return e;for(const t of e.children){const r=ZD(n,t);if(r)return r}return null}function QD(n,e){if(n===e.value)return[e];for(const t of e.children){const r=QD(n,t);if(r.length)return r.unshift(e),r}return[]}class ka{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ch(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class W2 extends G2{constructor(e,t){super(e),this.snapshot=t,YD(this,e)}toString(){return this.snapshot.toString()}}function K2(n,e){const t=function Fee(n,e){const o=new tI([],{},{},"",{},et,e,null,{});return new Q2("",new ka(o,[]))}(0,e),r=new E([new zg("",{})]),i=new E({}),s=new E({}),o=new E({}),a=new E(""),u=new bh(r,i,o,a,s,et,e,t.root);return u.snapshot=t.root,new W2(new ka(u,[]),t)}class bh{constructor(e,t,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(de(l=>l[qg]))??R(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(de(e=>Ih(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(de(e=>Ih(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Z2(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],s=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function Lee(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class tI{get title(){return this.data?.[qg]}constructor(e,t,r,i,s,o,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ih(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ih(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Q2 extends G2{constructor(e,t){super(t),this.url=e,YD(this,t)}toString(){return Y2(this._root)}}function YD(n,e){e.value._routerState=n,e.children.forEach(t=>YD(n,t))}function Y2(n){const e=n.children.length>0?` { ${n.children.map(Y2).join(", ")} } `:"";return`${n.value}${e}`}function XD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Vo(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Vo(e.params,t.params)||n.paramsSubject.next(t.params),function JJ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Vo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Vo(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function JD(n,e){const t=Vo(n.params,e.params)&&function ree(n,e){return Xl(n,e)&&n.every((t,r)=>Vo(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||JD(n.parent,e.parent))}let eA=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=et,this.activateEvents=new Hn,this.deactivateEvents=new Hn,this.attachEvents=new Hn,this.detachEvents=new Hn,this.parentContexts=pe(Xg),this.location=pe(io),this.changeDetector=pe(hE),this.environmentInjector=pe(as),this.inputBinder=pe(nI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new L(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new L(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new L(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new L(4013,!1);this._activatedRoute=t;const i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Vee(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275dir=Ve({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Li]})}return n})();class Vee{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===bh?this.route:e===Xg?this.childContexts:this.parent.get(e,t)}}const nI=new le("");let X2=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,i=VD([r.queryParams,r.params,r.data]).pipe(ve(([s,o,a],u)=>(a={...s,...o,...a},0===u?R(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const o=function mQ(n){const e=dt(n);if(!e)return null;const t=new hg(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,i)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function Jg(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function Bee(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Jg(n,r,i);return Jg(n,r)})}(n,e,t);return new ka(r,i)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Jg(n,a)),o}}const r=function jee(n){return new bh(new E(n.url),new E(n.params),new E(n.queryParams),new E(n.fragment),new E(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(s=>Jg(n,s));return new ka(r,i)}}const tA="ngNavigationCancelingError";function J2(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=Jl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=eU(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function eU(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[tA]=!0,r.cancellationCode=e,t&&(r.url=t),r}function tU(n){return n&&n[tA]}let nU=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=To({type:n,selectors:[["ng-component"]],standalone:!0,features:[iE],decls:1,vars:0,template:function(r,i){1&r&&to(0,"router-outlet")},dependencies:[eA],encapsulation:2})}return n})();function nA(n){const e=n.children&&n.children.map(nA),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==et&&(t.component=nU),t}function ao(n){return n.outlet||et}function em(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Zee{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),XD(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Ch(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ch(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ch(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){const i=Ch(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new kee(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Mee(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(XD(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),XD(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=em(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class rU{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class rI{constructor(e,t){this.component=e,this.route=t}}function Qee(n,e,t){const r=n._root;return tm(r,e?e._root:null,t,[r.value])}function Dh(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||function dy(n){return null!==Gc(n)}(n)?e.get(n):n:r}function tm(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Ch(e);return n.children.forEach(o=>{(function Xee(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function Jee(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Xl(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Xl(n.url,e.url)||!Vo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!JD(n,e)||!Vo(n.queryParams,e.queryParams);default:return!JD(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new rU(r)):(s.data=o.data,s._resolvedData=o._resolvedData),tm(n,e,s.component?a?a.children:null:t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new rI(a.outlet.component,o))}else o&&nm(e,a,i),i.canActivateChecks.push(new rU(r)),tm(n,null,s.component?a?a.children:null:t,r,i)})(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>nm(a,t.getContext(o),i)),i}function nm(n,e,t){const r=Ch(n),i=n.value;Object.entries(r).forEach(([s,o])=>{nm(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new rI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function rm(n){return"function"==typeof n}function iU(n){return n instanceof qE||"EmptyError"===n?.name}const iI=Symbol("INITIAL_VALUE");function Ah(){return ve(n=>VD(n.map(e=>e.pipe(yh(1),zE(iI)))).pipe(de(e=>{for(const t of e)if(!0!==t){if(t===iI)return iI;if(!1===t||t instanceof wh)return t}return!0}),js(e=>e!==iI),yh(1)))}function sU(n){return function Yi(...n){return Xi(n)}(Br(e=>{if(Jl(e))throw J2(0,e)}),de(e=>!0===e))}class sI{constructor(e){this.segmentGroup=e||null}}class oU{constructor(e){this.urlTree=e}}function Sh(n){return $g(new sI(n))}function aU(n){return $g(new oU(n))}class vte{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new L(4002,!1)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return R(r);if(i.numberOfChildren>1||!i.children[et])return $g(new L(4e3,!1));i=i.children[et]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const s=this.createSegmentGroup(e,t.root,r,i);return new wh(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){const s=this.createSegments(e,t.segments,r,i);let o={};return Object.entries(t.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Ht(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new L(4001,!1);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}const rA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ete(n,e,t,r,i){const s=iA(n,e,t);return s.matched?(r=function Hee(n,e){return n.providers&&!n._injector&&(n._injector=pb(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,r),function mte(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?R(i.map(o=>{const a=Dh(o,n);return Pu(function ste(n){return n&&rm(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Ah(),sU()):R(!0)}(r,e,t).pipe(de(o=>!0===o?s:{...rA}))):R(s)}function iA(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...rA}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||XJ)(t,n,e);if(!i)return{...rA};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function uU(n,e,t,r){return t.length>0&&function Tte(n,e,t){return t.some(r=>oI(n,e,r)&&ao(r)!==et)}(n,t,r)?{segmentGroup:new Ht(e,wte(r,new Ht(t,n.children))),slicedSegments:[]}:0===t.length&&function Cte(n,e,t){return t.some(r=>oI(n,e,r))}(n,t,r)?{segmentGroup:new Ht(n.segments,Ite(n,0,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ht(n.segments,n.children),slicedSegments:t}}function Ite(n,e,t,r,i){const s={};for(const o of r)if(oI(n,t,o)&&!i[ao(o)]){const a=new Ht([],{});s[ao(o)]=a}return{...i,...s}}function wte(n,e){const t={};t[et]=e;for(const r of n)if(""===r.path&&ao(r)!==et){const i=new Ht([],{});t[ao(r)]=i}return t}function oI(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Ste{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new vte(this.urlSerializer,this.urlTree)}noMatchError(e){return new L(4002,!1)}recognize(){const e=uU(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,et).pipe(Yl(t=>{if(t instanceof oU)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof sI?this.noMatchError(t):t}),de(t=>{const r=new tI([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},et,this.rootComponentType,null,{}),i=new ka(r,t),s=new Q2("",i),o=function yee(n,e,t=null,r=null){return V2(L2(n),e,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,et).pipe(Yl(r=>{throw r instanceof sI?this.noMatchError(r):r}))}inheritParamsAndData(e){const t=e.value,r=Z2(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0)}processChildren(e,t,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return I(i).pipe(vh(s=>{const o=r.children[s],a=function Wee(n,e){const t=n.filter(r=>ao(r)===e);return t.push(...n.filter(r=>ao(r)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),Eh((s,o)=>(s.push(...o),s)),GE(null),function KJ(n,e){const t=arguments.length>=2;return r=>r.pipe(n?js((i,s)=>n(i,s,r)):In,jD(1),t?GE(e):C2(()=>new qE))}(),xt(s=>{if(null===s)return Sh(r);const o=lU(s);return function Rte(n){n.sort((e,t)=>e.value.outlet===et?-1:t.value.outlet===et?1:e.value.outlet.localeCompare(t.value.outlet))}(o),R(o)}))}processSegment(e,t,r,i,s,o){return I(t).pipe(vh(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Yl(u=>{if(u instanceof sI)return R(null);throw u}))),Ru(a=>!!a),Yl(a=>{if(iU(a))return function Dte(n,e,t){return 0===e.length&&!n.children[t]}(r,i,s)?R([]):Sh(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return function bte(n,e,t,r){return!!(ao(n)===r||r!==et&&oI(e,t,n))&&("**"===n.path||iA(e,n,t).matched)}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Sh(i):Sh(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const s=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?aU(s):this.applyRedirects.lineralizeSegments(r,s).pipe(xt(o=>{const a=new Ht(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){const{matched:a,consumedSegments:u,remainingSegments:l,positionalParamSegments:d}=iA(t,i,s);if(!a)return Sh(t);const f=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d);return i.redirectTo.startsWith("/")?aU(f):this.applyRedirects.lineralizeSegments(i,f).pipe(xt(m=>this.processSegment(e,r,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a;if("**"===r.path){const u=i.length>0?D2(i).parameters:{};a=R({snapshot:new tI(i,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cU(r),ao(r),r.component??r._loadedComponent??null,r,dU(r)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Ete(t,r,i,e).pipe(de(({matched:u,consumedSegments:l,remainingSegments:d,parameters:f})=>u?{snapshot:new tI(l,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cU(r),ao(r),r.component??r._loadedComponent??null,r,dU(r)),consumedSegments:l,remainingSegments:d}:null));return a.pipe(ve(u=>null===u?Sh(t):this.getChildConfig(e=r._injector??e,r,i).pipe(ve(({routes:l})=>{const d=r._loadedInjector??e,{snapshot:f,consumedSegments:m,remainingSegments:_}=u,{segmentGroup:v,slicedSegments:T}=uU(t,m,_,l);if(0===T.length&&v.hasChildren())return this.processChildren(d,l,v).pipe(de(k=>null===k?null:[new ka(f,k)]));if(0===l.length&&0===T.length)return R([new ka(f,[])]);const D=ao(r)===s;return this.processSegment(d,l,v,T,D?et:s,!0).pipe(de(k=>[new ka(f,k)]))}))))}getChildConfig(e,t,r){return t.children?R({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?R({routes:t._loadedRoutes,injector:t._loadedInjector}):function gte(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?R(!0):R(i.map(o=>{const a=Dh(o,n);return Pu(function tte(n){return n&&rm(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Ah(),sU())}(e,t,r).pipe(xt(i=>i?this.configLoader.loadChildren(e,t).pipe(Br(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function yte(n){return $g(eU(!1,3))}())):R({routes:[],injector:e})}}function Pte(n){const e=n.value.routeConfig;return e&&""===e.path}function lU(n){const e=[],t=new Set;for(const r of n){if(!Pte(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=lU(r.children);e.push(new ka(r.value,i))}return e.filter(r=>!t.has(r))}function cU(n){return n.data||{}}function dU(n){return n.resolve||{}}function hU(n){return"string"==typeof n.title||null===n.title}function sA(n){return ve(e=>{const t=n(e);return t?I(t).pipe(de(()=>e)):R(e)})}const Rh=new le("ROUTES");let oA=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=pe(UF)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return R(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Pu(t.loadComponent()).pipe(de(fU),Br(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Hg(()=>{this.componentLoaders.delete(t)})),i=new T2(r,()=>new z).pipe(BD());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return R({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function Lte(n,e,t,r){return Pu(n.loadChildren()).pipe(de(fU),xt(i=>i instanceof G1||Array.isArray(i)?R(i):I(e.compileModuleAsync(i))),de(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(t).injector,o=s.get(Rh,[],{optional:!0,self:!0}).flat()),{routes:o.map(nA),injector:s}}))}(r,this.compiler,t,this.onLoadEndListener).pipe(Hg(()=>{this.childrenLoaders.delete(r)})),o=new T2(s,()=>new z).pipe(BD());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function fU(n){return function Vte(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let aI=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new z,this.transitionAbortSubject=new z,this.configLoader=pe(oA),this.environmentInjector=pe(as),this.urlSerializer=pe(Gg),this.rootContexts=pe(Xg),this.inputBindingEnabled=null!==pe(nI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>R(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Pee(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new Ree(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t,r,i){return this.transitions=new E({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:t.urlHandlingStrategy.extract(r),urlAfterRedirects:t.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Qg,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(js(s=>0!==s.id),de(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),ve(s=>{this.currentTransition=s;let o=!1,a=!1;return R(s).pipe(Br(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ve(u=>{const l=u.currentBrowserUrl.toString(),d=!t.navigated||u.extractedUrl.toString()!==l||l!==u.currentUrlTree.toString();if(!d&&"reload"!==(u.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const m="";return this.events.next(new Th(u.id,this.urlSerializer.serialize(u.rawUrl),m,0)),u.resolve(null),wn}if(t.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return R(u).pipe(ve(m=>{const _=this.transitions?.getValue();return this.events.next(new JE(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),_!==this.transitions?.getValue()?wn:Promise.resolve(m)}),function Nte(n,e,t,r,i,s){return xt(o=>function Ate(n,e,t,r,i,s,o="emptyOnly"){return new Ste(n,e,t,r,i,o,s).recognize()}(n,e,t,r,o.extractedUrl,i,s).pipe(de(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Br(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects};const _=new q2(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(_)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:m,extractedUrl:_,source:v,restoredState:T,extras:D}=u,k=new JE(m,this.urlSerializer.serialize(_),v,T);this.events.next(k);const P=K2(0,this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:P,urlAfterRedirects:_,extras:{...D,skipLocationChange:!1,replaceUrl:!1}},R(s)}{const m="";return this.events.next(new Th(u.id,this.urlSerializer.serialize(u.extractedUrl),m,1)),u.resolve(null),wn}}),Br(u=>{const l=new bee(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),de(u=>(this.currentTransition=s={...u,guards:Qee(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function ate(n,e){return xt(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?R({...t,guardsResult:!0}):function ute(n,e,t,r){return I(n).pipe(xt(i=>function pte(n,e,t,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?R(s.map(a=>{const u=em(e)??i,l=Dh(a,u);return Pu(function ite(n){return n&&rm(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,r):u.runInContext(()=>l(n,e,t,r))).pipe(Ru())})).pipe(Ah()):R(!0)}(i.component,i.route,t,e,r)),Ru(i=>!0!==i,!0))}(o,r,i,n).pipe(xt(a=>a&&function ete(n){return"boolean"==typeof n}(a)?function lte(n,e,t,r){return I(e).pipe(vh(i=>UD(function dte(n,e){return null!==n&&e&&e(new Nee(n)),R(!0)}(i.route.parent,r),function cte(n,e){return null!==n&&e&&e(new xee(n)),R(!0)}(i.route,r),function fte(n,e,t){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function Yee(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>w2(()=>R(o.guards.map(u=>{const l=em(o.node)??t,d=Dh(u,l);return Pu(function rte(n){return n&&rm(n.canActivateChild)}(d)?d.canActivateChild(r,n):l.runInContext(()=>d(r,n))).pipe(Ru())})).pipe(Ah())));return R(s).pipe(Ah())}(n,i.path,t),function hte(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return R(!0);const i=r.map(s=>w2(()=>{const o=em(e)??t,a=Dh(s,o);return Pu(function nte(n){return n&&rm(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Ru())}));return R(i).pipe(Ah())}(n,i.route,t))),Ru(i=>!0!==i,!0))}(r,s,n,e):R(a)),de(a=>({...t,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),Br(u=>{if(s.guardsResult=u.guardsResult,Jl(u.guardsResult))throw J2(0,u.guardsResult);const l=new Dee(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),js(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),sA(u=>{if(u.guards.canActivateChecks.length)return R(u).pipe(Br(l=>{const d=new Aee(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ve(l=>{let d=!1;return R(l).pipe(function Mte(n,e){return xt(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return R(t);let s=0;return I(i).pipe(vh(o=>function xte(n,e,t,r){const i=n.routeConfig,s=n._resolve;return void 0!==i?.title&&!hU(i)&&(s[qg]=i.title),function kte(n,e,t,r){const i=function Ote(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return R({});const s={};return I(i).pipe(xt(o=>function Fte(n,e,t,r){const i=em(e)??r,s=Dh(n,i);return Pu(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(n[o],e,t,r).pipe(Ru(),Br(a=>{s[o]=a}))),jD(1),function ZJ(n){return de(()=>n)}(s),Yl(o=>iU(o)?wn:$g(o)))}(s,n,e,r).pipe(de(o=>(n._resolvedData=o,n.data=Z2(n,t).resolve,i&&hU(i)&&(n.data[qg]=i.title),null)))}(o.route,r,n,e)),Br(()=>s++),jD(1),xt(o=>s===i.length?R(t):wn))})}(t.paramsInheritanceStrategy,this.environmentInjector),Br({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",2)}}))}),Br(l=>{const d=new See(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),sA(u=>{const l=d=>{const f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(Br(m=>{d.component=m}),de(()=>{})));for(const m of d.children)f.push(...l(m));return f};return VD(l(u.targetSnapshot.root)).pipe(GE(),yh(1))}),sA(()=>this.afterPreactivation()),de(u=>{const l=function Uee(n,e,t){const r=Jg(n,e._root,t?t._root:void 0);return new W2(r,e)}(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:l},s}),Br(()=>{this.events.next(new WD)}),((n,e,t,r)=>de(i=>(new Zee(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),yh(1),Br({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Nu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),t.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function QJ(n){return Y((e,t)=>{gt(n).subscribe(ce(t,()=>t.complete(),be)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(Br(u=>{throw u}))),Hg(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Yl(u=>{if(a=!0,tU(u))this.events.next(new Yg(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function $ee(n){return tU(n)&&Jl(n.url)}(u)?this.events.next(new KD(u.url)):s.resolve(!1);else{this.events.next(new eI(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(u))}catch(l){s.reject(l)}}return wn}))}))}cancelNavigationTransition(t,r,i){const s=new Yg(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pU(n){return n!==Qg}let gU=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===et);return r}getResolvedTitleForRoute(t){return t.data[qg]}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(Ute)},providedIn:"root"})}return n})(),Ute=(()=>{class n extends gU{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||n)(W(sV))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Bte=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe($te)},providedIn:"root"})}return n})();class jte{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let $te=(()=>{class n extends jte{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=Xn(n)))(i||n)}}();static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const uI=new le("",{providedIn:"root",factory:()=>({})});let Hte=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(qte)},providedIn:"root"})}return n})(),qte=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var im=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(im||{});function mU(n,e){n.events.pipe(js(t=>t instanceof Nu||t instanceof Yg||t instanceof eI||t instanceof Th),de(t=>t instanceof Nu||t instanceof Th?im.COMPLETE:t instanceof Yg&&(0===t.code||1===t.code)?im.REDIRECTING:im.FAILED),js(t=>t!==im.REDIRECTING),yh(1)).subscribe(()=>{e()})}function zte(n){throw n}function Gte(n,e,t){return e.parse("/")}const Wte={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Kte={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Hi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=pe(VF),this.isNgZoneEnabled=!1,this._events=new z,this.options=pe(uI,{optional:!0})||{},this.pendingTasks=pe(uE),this.errorHandler=this.options.errorHandler||zte,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Gte,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=pe(Hte),this.routeReuseStrategy=pe(Bte),this.titleStrategy=pe(gU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=pe(Rh,{optional:!0})?.flat()??[],this.navigationTransitions=pe(aI),this.urlSerializer=pe(Gg),this.location=pe(Gb),this.componentInputBindingEnabled=!!pe(nI,{optional:!0}),this.eventsSubscription=new _t,this.isNgZoneEnabled=pe(wt)instanceof wt&&wt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new wh,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=K2(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:i}=this.navigationTransitions;if(null===i)return void(_U(r)&&this._events.next(r));if(r instanceof JE)pU(i.source)&&(this.browserUrlTree=i.extractedUrl);else if(r instanceof Th)this.rawUrlTree=i.rawUrl;else if(r instanceof q2){if("eager"===this.urlUpdateStrategy){if(!i.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl);this.setBrowserUrl(s,i)}this.browserUrlTree=i.urlAfterRedirects}}else if(r instanceof WD)this.currentUrlTree=i.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i),this.browserUrlTree=i.urlAfterRedirects);else if(r instanceof Yg)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(i);else if(r instanceof KD){const s=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),o={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||pU(i.source)};this.scheduleNavigation(s,Qg,null,o,{resolve:i.resolve,reject:i.reject,promise:i.promise})}r instanceof eI&&this.restoreHistory(i,!0),r instanceof Nu&&(this.navigated=!0),_U(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Qg,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(nA),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o;let f,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{f=L2(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),f=this.currentUrlTree.root}return V2(f,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Jl(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Qg,null,r)}navigate(t,r={skipLocationChange:!1}){return function Zte(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new L(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...Wte}:!1===r?{...Kte}:r,Jl(t))return S2(this.currentUrlTree,t,i);const s=this.parseUrl(t);return S2(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const s=t[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((f,m)=>{a=f,u=m});const d=this.pendingTasks.add();return mU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _U(n){return!(n instanceof WD||n instanceof KD)}class yU{}let Xte=(()=>{class n{constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(js(t=>t instanceof Nu),vh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=pb(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return I(i).pipe(Zr())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):R(null);const s=i.pipe(xt(o=>null===o?R(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return r.loadComponent&&!r._loadedComponent?I([s,this.loader.loadComponent(r)]).pipe(Zr()):s})}static#e=this.\u0275fac=function(r){return new(r||n)(W(Hi),W(UF),W(as),W(yU),W(oA))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const uA=new le("");let vU=(()=>{class n{constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof JE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Nu?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Th&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof z2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new z2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function kk(){throw new Error("invalid")}()};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function Oa(n,e){return{\u0275kind:n,\u0275providers:e}}function IU(){const n=pe(Xr);return e=>{const t=n.get(Pa);if(e!==t.components[0])return;const r=n.get(Hi),i=n.get(wU);1===n.get(lA)&&r.initialNavigation(),n.get(TU,null,rt.Optional)?.setUpPreloading(),n.get(uA,null,rt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const wU=new le("",{factory:()=>new z}),lA=new le("",{providedIn:"root",factory:()=>1}),TU=new le("");function nne(n){return Oa(0,[{provide:TU,useExisting:Xte},{provide:yU,useExisting:n}])}const CU=new le("ROUTER_FORROOT_GUARD"),ine=[Gb,{provide:Gg,useClass:$D},Hi,Xg,{provide:bh,useFactory:function EU(n){return n.routerState.root},deps:[Hi]},oA,[]];function sne(){return new GF("Router",Hi)}let bU=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[ine,[],{provide:Rh,multi:!0,useValue:t},{provide:CU,useFactory:lne,deps:[[Hi,new Zp,new hv]]},{provide:uI,useValue:r||{}},r?.useHash?{provide:Wl,useClass:IQ}:{provide:Wl,useClass:TL},{provide:uA,useFactory:()=>{const n=pe(jY),e=pe(wt),t=pe(uI),r=pe(aI),i=pe(Gg);return t.scrollOffset&&n.setOffset(t.scrollOffset),new vU(i,r,n,e,t)}},r?.preloadingStrategy?nne(r.preloadingStrategy).\u0275providers:[],{provide:GF,multi:!0,useFactory:sne},r?.initialNavigation?cne(r):[],r?.bindToComponentInputs?Oa(8,[X2,{provide:nI,useExisting:X2}]).\u0275providers:[],[{provide:DU,useFactory:IU},{provide:Fb,multi:!0,useExisting:DU}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Rh,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(r){return new(r||n)(W(CU,8))};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({})}return n})();function lne(n){return"guarded"}function cne(n){return["disabled"===n.initialNavigation?Oa(3,[{provide:Sb,multi:!0,useFactory:()=>{const e=pe(Hi);return()=>{e.setUpLocationChangeListener()}}},{provide:lA,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Oa(2,[{provide:lA,useValue:0},{provide:Sb,multi:!0,deps:[Xr],useFactory:e=>{const t=e.get(vQ,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(Hi),s=e.get(wU);mU(i,()=>{r(!0)}),e.get(aI).afterPreactivation=()=>(r(!0),s.closed?R(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const DU=new le("");var AU=ke(562),b=ke(58),qi=ke(534),hs=ke(879),uo=ke(537);ke(365),(0,qi.registerVersion)("firebase","10.6.0","app");class pne extends _t{constructor(e,t){super()}schedule(e,t=0){return this}}const lI={setInterval(n,e,...t){const{delegate:r}=lI;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=lI;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class SU extends pne{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return lI.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&lI.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ae(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const cA={now:()=>(cA.delegate||Date).now(),delegate:void 0};class sm{constructor(e,t=sm.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}sm.now=cA.now;class RU extends sm{constructor(e,t=sm.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const _ne=new class mne extends RU{}(class gne extends SU{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}}),cI=new RU(SU),Ph=new Qd("ANGULARFIRE2_VERSION");class dI{constructor(){return((n,e)=>{const t=(0,qi.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(vne)}}const vne="app-check";function Nh(){}class PU{zone;delegate;constructor(e,t=_ne){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,r)}}class Ene{zone;task=null;constructor(e){this.zone=e}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nh,{},Nh,Nh)),t.pipe(Br({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let hI=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new PU(Zone.current)),this.insideAngular=t.run(()=>new PU(Zone.current,cI)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(W(wt))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Mh(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function NU(n){return n.pipe(jn(Mh().outsideAngular))}function tr(n){return function wne(n){return function(t){return(t=t.lift(new Ene(n.ngZone))).pipe(Or(n.outsideAngular),jn(n.insideAngular))}}(Mh())(n)}var fs=ke(106);fs.Z.registerVersion("firebase","10.6.0","app-compat");const Dne=["ngOnDestroy"];class MU{constructor(e){return e}}const xh=new le("angularfire2.app.options"),kh=new le("angularfire2.app.name");function om(n,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const o=fs.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>fs.Z.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){const a=!!module.hot;Rne("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new MU(o)}const Rne=(n,...e)=>{},Pne={provide:MU,useFactory:om,deps:[xh,wt,[new Zp,kh]]};let Nne=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:xh,useValue:t},{provide:kh,useValue:r}]}}constructor(t){fs.Z.registerVersion("angularfire",Ph.full,"core"),fs.Z.registerVersion("angularfire",Ph.full,"app-compat"),fs.Z.registerVersion("angular",lk.full,t.toString())}static \u0275fac=function(r){return new(r||n)(W(Ls))};static \u0275mod=nn({type:n});static \u0275inj=Cn({providers:[Pne]})}return n})();function fI(n,e,t,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return function Mne(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(i,o)||(xU("error",`${e} was already initialized on the ${t} Firebase App with different settings.${xne?" You may need to reload as Firebase is not HMR aware.":""}`),xU("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}const xne=typeof module<"u"&&!!module.hot,xU=(n,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[];class kne extends z{constructor(e=1/0,t=1/0,r=cA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=t.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function kU(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,K({connector:()=>new kne(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function OU(n,e){return A(e)?ve(()=>n,e):ve(()=>n)}const dA=new le("angularfire2.auth.use-emulator"),hA=new le("angularfire2.auth.settings"),fA=new le("angularfire2.auth.tenant-id"),pA=new le("angularfire2.auth.langugage-code"),gA=new le("angularfire2.auth.use-device-language"),mA=new le("angularfire.auth.persistence"),_A=(n,e,t,r,i,s,o,a)=>fI(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,s,o,a]);let tc=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,u,l,d,f,m,_){const v=new z,T=R(void 0).pipe(jn(o.outsideAngular),ve(()=>s.runOutsideAngular(()=>Promise.resolve().then(ke.bind(ke,365)))),de(()=>om(t,s,r)),de(D=>_A(D,s,a,l,d,f,u,m)),kU({bufferSize:1,refCount:!1}));if(SE(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=R(null);else{T.pipe(Ru()).subscribe();const D=T.pipe(ve(O=>O.getRedirectResult().then(q=>q,()=>null)),tr,kU({bufferSize:1,refCount:!1})),k=T.pipe(ve(O=>new Ze(q=>({unsubscribe:s.runOutsideAngular(()=>O.onAuthStateChanged(ue=>q.next(ue),ue=>q.error(ue),()=>q.complete()))})))),P=T.pipe(ve(O=>new Ze(q=>({unsubscribe:s.runOutsideAngular(()=>O.onIdTokenChanged(ue=>q.next(ue),ue=>q.error(ue),()=>q.complete()))}))));this.authState=D.pipe(OU(k),Or(o.outsideAngular),jn(o.insideAngular)),this.user=D.pipe(OU(P),Or(o.outsideAngular),jn(o.insideAngular)),this.idToken=this.user.pipe(ve(O=>O?I(O.getIdToken()):R(null))),this.idTokenResult=this.user.pipe(ve(O=>O?I(O.getIdTokenResult()):R(null))),this.credential=C(D,v,this.authState.pipe(js(O=>!O))).pipe(de(O=>O?.user?O:null),Or(o.outsideAngular),jn(o.insideAngular))}return((n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(Dne.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{const f=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,f),f})})})}))(this,T,s,{spy:{apply:(D,k,P)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&P.then(O=>v.next(O))}}})}static \u0275fac=function(r){return new(r||n)(W(xh),W(kh,8),W(Ls),W(wt),W(hI),W(dA,8),W(hA,8),W(fA,8),W(pA,8),W(gA,8),W(mA,8),W(dI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Fne=(()=>{class n{constructor(){fs.Z.registerVersion("angularfire",Ph.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({providers:[tc]})}return n})();var nc=function(n){return n.UserNotFound="auth/user-not-found",n.WrongPassword="auth/wrong-password",n.EmailInUse="auth/email-already-in-use",n.WeakPassword="auth/weak-password",n.BadEmail="auth/invalid-email",n.InvalidLogin="auth/invalid-login-credentials",n}(nc||{});let Lne=(()=>{class n{constructor(){}firebaseError(t){switch(t){case nc.UserNotFound:return"User does not exist";case nc.WrongPassword:return"Wrong password";case nc.EmailInUse:return"Email already in use";case nc.WeakPassword:return"Weak password, use 6 characters at least";case nc.BadEmail:return"Invalid Email";case nc.InvalidLogin:return"Credentials not accepted";default:return"Unknown error"}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class FU{}class Vne{}const Fa="*";function Une(n,e){return{type:7,name:n,definitions:e,options:{}}}function LU(n,e=null){return{type:4,styles:e,timings:n}}function VU(n,e=null){return{type:2,steps:n,options:e}}function am(n){return{type:6,styles:n,offset:null}}function yA(n,e,t){return{type:0,name:n,styles:e,options:t}}function UU(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}class um{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class BU{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,r=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(i)})}getPosition(){const e=this.players.reduce((t,r)=>null===t||r.totalTime>t.totalTime?r:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}const jU=["toast-component",""];function Bne(n,e){if(1&n){const t=J0();$t(0,"button",5),ar("click",function(){return Op(t),Nl(cs().remove())}),$t(1,"span",6),On(2,"\xd7"),Zt()()}}function jne(n,e){if(1&n&&(_g(0),On(1),yg()),2&n){const t=cs(2);bn(1),Aa("[",t.duplicatesCount+1,"]")}}function $ne(n,e){if(1&n&&($t(0,"div"),On(1),ei(2,jne,2,1,"ng-container",4),Zt()),2&n){const t=cs();Da(t.options.titleClass),Bi("aria-label",t.title),bn(1),Aa(" ",t.title," "),bn(1),Jn("ngIf",t.duplicatesCount)}}function Hne(n,e){if(1&n&&to(0,"div",7),2&n){const t=cs();Da(t.options.messageClass),Jn("innerHTML",t.message,l0)}}function qne(n,e){if(1&n&&($t(0,"div",8),On(1),Zt()),2&n){const t=cs();Da(t.options.messageClass),Bi("aria-label",t.message),bn(1),Aa(" ",t.message," ")}}function zne(n,e){if(1&n&&($t(0,"div"),to(1,"div",9),Zt()),2&n){const t=cs();bn(1),ch("width",t.width+"%")}}class Xne{_attachedHost;component;viewContainerRef;injector;constructor(e,t){this.component=e,this.injector=t}attach(e,t){return this._attachedHost=e,e.attach(this,t)}detach(){const e=this._attachedHost;if(e)return this._attachedHost=void 0,e.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class Jne{_attachedPortal;_disposeFn;attach(e,t){return this._attachedPortal=e,this.attachComponentPortal(e,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(e){this._disposeFn=e}}class ere{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new z;_activate=new z;_manualClose=new z;_resetTimeout=new z;_countDuplicate=new z;constructor(e){this._overlayRef=e}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(e,t){e&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}}class pI{toastId;config;message;title;toastType;toastRef;_onTap=new z;_onAction=new z;constructor(e,t,r,i,s,o){this.toastId=e,this.config=t,this.message=r,this.title=i,this.toastType=s,this.toastRef=o,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(e){this._onAction.next(e)}onAction(){return this._onAction.asObservable()}}const HU=new le("ToastConfig");class tre extends Jne{_hostDomElement;_componentFactoryResolver;_appRef;constructor(e,t,r){super(),this._hostDomElement=e,this._componentFactoryResolver=t,this._appRef=r}attachComponentPortal(e,t){const r=this._componentFactoryResolver.resolveComponentFactory(e.component);let i;return i=r.create(e.injector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(i),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(i)),i}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let nre=(()=>{class n{_document=pe(yr);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class rre{_portalHost;constructor(e){this._portalHost=e}attach(e,t=!0){return this._portalHost.attach(e,t)}detach(){return this._portalHost.detach()}}let ire=(()=>{class n{_overlayContainer=pe(nre);_componentFactoryResolver=pe(og);_appRef=pe(Pa);_document=pe(yr);_paneElements=new Map;create(t,r){return this._createOverlayRef(this.getPaneElement(t,r))}getPaneElement(t="",r){return this._paneElements.get(r)||this._paneElements.set(r,{}),this._paneElements.get(r)[t]||(this._paneElements.get(r)[t]=this._createPaneElement(t,r)),this._paneElements.get(r)[t]}_createPaneElement(t,r){const i=this._document.createElement("div");return i.id="toast-container",i.classList.add(t),i.classList.add("toast-container"),r?r.getContainerElement().appendChild(i):this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalHost(t){return new tre(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new rre(this._createPortalHost(t))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gI=(()=>{class n{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,r,i,s,o){this.overlay=r,this._injector=i,this.sanitizer=s,this.ngZone=o,this.toastrConfig={...t.default,...t.config},t.config.iconClasses&&(this.toastrConfig.iconClasses={...t.default.iconClasses,...t.config.iconClasses})}show(t,r,i={},s=""){return this._preBuildNotification(s,t,r,this.applyConfig(i))}success(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",t,r,this.applyConfig(i))}error(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",t,r,this.applyConfig(i))}info(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",t,r,this.applyConfig(i))}warning(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",t,r,this.applyConfig(i))}clear(t){for(const r of this.toasts)if(void 0!==t){if(r.toastId===t)return void r.toastRef.manualClose()}else r.toastRef.manualClose()}remove(t){const r=this._findToast(t);if(!r||(r.activeToast.toastRef.close(),this.toasts.splice(r.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const i=this.toasts[this.currentlyActive].toastRef;i.isInactive()||(this.currentlyActive=this.currentlyActive+1,i.activate())}return!0}findDuplicate(t="",r="",i,s){const{includeTitleDuplicates:o}=this.toastrConfig;for(const a of this.toasts)if((!o||o&&a.title===t)&&a.message===r)return a.toastRef.onDuplicate(i,s),a;return null}applyConfig(t={}){return{...this.toastrConfig,...t}}_findToast(t){for(let r=0;r<this.toasts.length;r++)if(this.toasts[r].toastId===t)return{index:r,activeToast:this.toasts[r]};return null}_preBuildNotification(t,r,i,s){return s.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,r,i,s)):this._buildNotification(t,r,i,s)}_buildNotification(t,r,i,s){if(!s.toastComponent)throw new Error("toastComponent required");const o=this.findDuplicate(i,r,this.toastrConfig.resetTimeoutOnDuplicate&&s.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&i||r)&&this.toastrConfig.preventDuplicates&&null!==o)return o;this.previousToastMessage=r;let a=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(a=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const u=this.overlay.create(s.positionClass,this.overlayContainer);this.index=this.index+1;let l=r;r&&s.enableHtml&&(l=this.sanitizer.sanitize(os.HTML,r));const d=new ere(u),f=new pI(this.index,s,l,i,t,d),_=Xr.create({providers:[{provide:pI,useValue:f}],parent:this._injector}),v=new Xne(s.toastComponent,_),T=u.attach(v,s.newestOnTop);d.componentInstance=T.instance;const D={toastId:this.index,title:i||"",message:r||"",toastRef:d,onShown:d.afterActivate(),onHidden:d.afterClosed(),onTap:f.onTap(),onAction:f.onAction(),portal:T};return a||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{D.toastRef.activate()})),this.toasts.push(D),D}static \u0275fac=function(r){return new(r||n)(W(HU),W(ire),W(Xr),W(uV),W(wt))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const sre={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",toastComponent:(()=>{class n{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=-1;toastClasses="";state;get displayStyle(){if("inactive"===this.state.value)return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,r,i){this.toastrService=t,this.toastPackage=r,this.ngZone=i,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(s=>{this.duplicatesCount=s}),this.state={value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}}}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state={...this.state,value:"active"},!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const t=(new Date).getTime();this.width=(this.hideTime-t)/this.options.timeOut*100,"increasing"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state={...this.state,value:"active"},this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state.value&&(clearTimeout(this.timeout),this.state={...this.state,value:"removed"},this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state.value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state.value&&"extendedTimeOut"!==this.options.disableTimeOut&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state.value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),r)):this.timeout=setTimeout(()=>t(),r)}outsideInterval(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),r)):this.intervalId=setInterval(()=>t(),r)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(r){return new(r||n)(te(gI),te(pI),te(wt))};static \u0275cmp=To({type:n,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(r,i){1&r&&ar("click",function(){return i.tapToast()})("mouseenter",function(){return i.stickAround()})("mouseleave",function(){return i.delayedHideToast()}),2&r&&(sb("@flyInOut",i.state),Da(i.toastClasses),ch("display",i.displayStyle))},standalone:!0,features:[iE],attrs:jU,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,i){1&r&&(ei(0,Bne,3,0,"button",0),ei(1,$ne,3,5,"div",1),ei(2,Hne,1,3,"div",2),ei(3,qne,2,4,"div",3),ei(4,zne,2,2,"div",4)),2&r&&(Jn("ngIf",i.options.closeButton),bn(1),Jn("ngIf",i.title),bn(1),Jn("ngIf",i.message&&i.options.enableHtml),bn(1),Jn("ngIf",i.message&&!i.options.enableHtml),bn(1),Jn("ngIf",i.options.progressBar))},dependencies:[AE],encapsulation:2,data:{animation:[Une("flyInOut",[yA("inactive",am({opacity:0})),yA("active",am({opacity:1})),yA("removed",am({opacity:0})),UU("inactive => active",LU("{{ easeTime }}ms {{ easing }}")),UU("active => removed",LU("{{ easeTime }}ms {{ easing }}"))])]}})}return n})()},ore=(n={})=>Rv([{provide:HU,useValue:{default:sre,config:n}}]);let are=(()=>{class n{static forRoot(t={}){return{ngModule:n,providers:[ore(t)]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({})}return n})(),EA=(()=>{class n{constructor(){this.loggedIn=new E(!1)}get isLoggedIn(){return this.loggedIn.asObservable()}isLoggedNext(t){return this.loggedIn.next(t)}SessionAddStorage(t,r){sessionStorage.setItem(t,JSON.stringify(r))}SessionGetStorage(t){const r=sessionStorage.getItem(t);return JSON.parse(r)}SessionRemove(t){sessionStorage.removeItem(t),sessionStorage.clear()}SessionClear(){sessionStorage.clear()}LocalAddStorage(t,r){localStorage.setItem(t,JSON.stringify(r))}LocalGetStorage(t){const r=localStorage.getItem(t);return JSON.parse(r)}LocalRemove(t){localStorage.removeItem(t)}LocalClear(){localStorage.clear()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class mI{}class _I{}class Bo{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Bo?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Bo;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Bo?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class ure{encodeKey(e){return qU(e)}encodeValue(e){return qU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const cre=/%(\d[a-f0-9])/gi,dre={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function qU(n){return encodeURIComponent(n).replace(cre,(e,t)=>dre[t]??e)}function yI(n){return`${n}`}class Mu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ure,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function lre(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],u=t.get(o)||[];u.push(a),t.set(o,u)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],i=Array.isArray(r)?r.map(yI):[yI(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Mu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(yI(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(yI(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class hre{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function zU(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function GU(n){return typeof Blob<"u"&&n instanceof Blob}function WU(n){return typeof FormData<"u"&&n instanceof FormData}class lm{constructor(e,t,r,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function fre(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Bo),this.context||(this.context=new hre),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Mu,this.urlWithParams=t}serializeBody(){return null===this.body?null:zU(this.body)||GU(this.body)||WU(this.body)||function pre(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Mu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||WU(this.body)?null:GU(this.body)?this.body.type||null:zU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Mu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let u=e.headers||this.headers,l=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((f,m)=>f.set(m,e.setHeaders[m]),u)),e.setParams&&(l=Object.keys(e.setParams).reduce((f,m)=>f.set(m,e.setParams[m]),l)),new lm(t,r,s,{params:l,headers:u,context:d,reportProgress:a,responseType:i,withCredentials:o})}}var Oh=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Oh||{});class IA{constructor(e,t=200,r="OK"){this.headers=e.headers||new Bo,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class wA extends IA{constructor(e={}){super(e),this.type=Oh.ResponseHeader}clone(e={}){return new wA({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Fh extends IA{constructor(e={}){super(e),this.type=Oh.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Fh({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class KU extends IA{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function TA(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let ZU=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof lm)s=t;else{let u,l;u=i.headers instanceof Bo?i.headers:new Bo(i.headers),i.params&&(l=i.params instanceof Mu?i.params:new Mu({fromObject:i.params})),s=new lm(t,r,void 0!==i.body?i.body:null,{headers:u,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=R(s).pipe(vh(u=>this.handler.handle(u)));if(t instanceof lm||"events"===i.observe)return o;const a=o.pipe(js(u=>u instanceof Fh));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(de(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return a.pipe(de(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return a.pipe(de(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return a.pipe(de(u=>u.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Mu).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,TA(i,r))}post(t,r,i={}){return this.request("POST",t,TA(i,r))}put(t,r,i={}){return this.request("PUT",t,TA(i,r))}static#e=this.\u0275fac=function(r){return new(r||n)(W(mI))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function XU(n,e){return e(n)}function mre(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}const yre=new le(""),cm=new le(""),JU=new le("");function vre(){let n=null;return(e,t)=>{null===n&&(n=(pe(yre,{optional:!0})??[]).reduceRight(mre,XU));const r=pe(uE),i=r.add();return n(e,t).pipe(Hg(()=>r.remove(i)))}}let eB=(()=>{class n extends mI{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=pe(uE)}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(cm),...this.injector.get(JU,[])]));this.chain=i.reduceRight((s,o)=>function _re(n,e,t){return(r,i)=>t.runInContext(()=>e(r,s=>n(s,i)))}(s,o,this.injector),XU)}const r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Hg(()=>this.pendingTasks.remove(r)))}static#e=this.\u0275fac=function(r){return new(r||n)(W(_I),W(as))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const Tre=/^\)\]\}',?\n/;let nB=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new L(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?I(r.\u0275loadImpl()):R(null)).pipe(ve(()=>new Ze(s=>{const o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((T,D)=>o.setRequestHeader(T,D.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const T=t.detectContentTypeHeader();null!==T&&o.setRequestHeader("Content-Type",T)}if(t.responseType){const T=t.responseType.toLowerCase();o.responseType="json"!==T?T:"text"}const a=t.serializeBody();let u=null;const l=()=>{if(null!==u)return u;const T=o.statusText||"OK",D=new Bo(o.getAllResponseHeaders()),k=function Cre(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return u=new wA({headers:D,status:o.status,statusText:T,url:k}),u},d=()=>{let{headers:T,status:D,statusText:k,url:P}=l(),O=null;204!==D&&(O=typeof o.response>"u"?o.responseText:o.response),0===D&&(D=O?200:0);let q=D>=200&&D<300;if("json"===t.responseType&&"string"==typeof O){const ue=O;O=O.replace(Tre,"");try{O=""!==O?JSON.parse(O):null}catch(Te){O=ue,q&&(q=!1,O={error:Te,text:O})}}q?(s.next(new Fh({body:O,headers:T,status:D,statusText:k,url:P||void 0})),s.complete()):s.error(new KU({error:O,headers:T,status:D,statusText:k,url:P||void 0}))},f=T=>{const{url:D}=l(),k=new KU({error:T,status:o.status||0,statusText:o.statusText||"Unknown Error",url:D||void 0});s.error(k)};let m=!1;const _=T=>{m||(s.next(l()),m=!0);let D={type:Oh.DownloadProgress,loaded:T.loaded};T.lengthComputable&&(D.total=T.total),"text"===t.responseType&&o.responseText&&(D.partialText=o.responseText),s.next(D)},v=T=>{let D={type:Oh.UploadProgress,loaded:T.loaded};T.lengthComputable&&(D.total=T.total),s.next(D)};return o.addEventListener("load",d),o.addEventListener("error",f),o.addEventListener("timeout",f),o.addEventListener("abort",f),t.reportProgress&&(o.addEventListener("progress",_),null!==a&&o.upload&&o.upload.addEventListener("progress",v)),o.send(a),s.next({type:Oh.Sent}),()=>{o.removeEventListener("error",f),o.removeEventListener("abort",f),o.removeEventListener("load",d),o.removeEventListener("timeout",f),t.reportProgress&&(o.removeEventListener("progress",_),null!==a&&o.upload&&o.upload.removeEventListener("progress",v)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(r){return new(r||n)(W(jL))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const CA=new le("XSRF_ENABLED"),rB=new le("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),iB=new le("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class sB{}let Are=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=xL(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(Ls),W(rB))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function Sre(n,e){const t=n.url.toLowerCase();if(!pe(CA)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const r=pe(sB).getToken(),i=pe(iB);return null!=r&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var xu=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(xu||{});function Rre(...n){const e=[ZU,nB,eB,{provide:mI,useExisting:eB},{provide:_I,useExisting:nB},{provide:cm,useValue:Sre,multi:!0},{provide:CA,useValue:!0},{provide:sB,useClass:Are}];for(const t of n)e.push(...t.\u0275providers);return Rv(e)}const oB=new le("LEGACY_INTERCEPTOR_FN");function Pre(){return function rc(n,e){return{\u0275kind:n,\u0275providers:e}}(xu.LegacyInterceptors,[{provide:oB,useFactory:vre},{provide:cm,useExisting:oB,multi:!0}])}let Nre=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({providers:[Rre(Pre())]})}return n})(),Lre=(()=>{class n{constructor(t,r,i,s){this.http=t,this.storageService=r,this.afAuth=i,this.toastr=s,this.apiUrl="https://petguardian-api.uc.r.appspot.com/"}GoogleAuth(){return this.AuthLogin(new AU.X)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{console.log("You have been successfully logged in!")}).catch(r=>{console.log(r)})}static#e=this.\u0275fac=function(r){return new(r||n)(W(ZU),W(EA),W(tc),W(gI))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Vre(n,e){1&n&&($t(0,"span",13)(1,"strong"),On(2,"Mail"),Zt(),On(3," is required "),Zt())}function Ure(n,e){1&n&&($t(0,"span",13),On(1," Mail must be "),$t(2,"strong"),On(3,"valid"),Zt()())}function Bre(n,e){1&n&&($t(0,"span",13)(1,"strong"),On(2,"Password"),Zt(),On(3," is required "),Zt())}const jre=[{path:"",component:(()=>{class n{constructor(t,r,i,s,o,a,u){this.fb=t,this.afAuth=r,this.router=i,this.fireBaseErrorService=s,this.toastr=o,this.storageService=a,this.apiService=u,this.loginUser=this.fb.group({email:["",[yD.required,yD.email]],password:["",yD.required]}),this.subscription=this.storageService.isLoggedIn.subscribe(l=>{1==l&&this.router.navigate(["dashboard"])}),this.checkSession()}checkSession(){const t=localStorage.getItem("usrMail")||"",r=localStorage.getItem("usrPswd")||"";this.login(t,r,!0)}login(t,r,i){var s=this.loginUser.value.email,o=this.loginUser.value.password;if(i){if(""==t||""==r)return;s=t,o=r}localStorage.setItem("usrMail",s),localStorage.setItem("usrPswd",o),console.log("Email: "+s+" Password: "+o),this.afAuth.signInWithEmailAndPassword(s,o).then(a=>{this.storageService.isLoggedNext(!0),this.storageService.SessionAddStorage("uid",a.user?.uid),this.router.navigate(["home"])}).catch(a=>{this.toastr.error(this.fireBaseErrorService.firebaseError(a.code),"Error")})}GoogleAuth(){return this.AuthLogin(new AU.X)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{this.storageService.isLoggedNext(!0),this.storageService.SessionAddStorage("uid",r.user?.uid),console.log(r.user?.uid),this.router.navigate(["home"])}).catch(r=>{console.log(r)})}static#e=this.\u0275fac=function(r){return new(r||n)(te(BJ),te(tc),te(Hi),te(Lne),te(gI),te(EA),te(Lre))};static#t=this.\u0275cmp=To({type:n,selectors:[["app-login"]],decls:26,vars:5,consts:[[1,"wrapper"],[1,"body"],[3,"formGroup","ngSubmit"],[1,"form-floating","mb-3"],["type","email","formControlName","email","placeholder","name@example.com",1,"form-control"],["class","text-danger errorLabel",4,"ngIf"],["type","password","formControlName","password","placeholder","Password",1,"form-control"],[1,"d-grid","gap-2"],["type","submit",1,"basicButton","btn-google",3,"disabled"],[1,"form-group","mt-3"],[1,"btn","btn-lg","btn-google",3,"click"],["src","/assets/img/googleicon.png","alt",""],[1,"btn","btn-lg","btn-reg",3,"click"],[1,"text-danger","errorLabel"]],template:function(r,i){if(1&r&&($t(0,"div",0)(1,"div",1)(2,"h1"),On(3,"Wellcome to Weed CoBot"),Zt(),$t(4,"form",2),ar("ngSubmit",function(){return i.login("","",!1)}),$t(5,"div",3),to(6,"input",4),$t(7,"label"),On(8,"Email"),Zt(),ei(9,Vre,4,0,"span",5),ei(10,Ure,4,0,"span",5),Zt(),$t(11,"div",3),to(12,"input",6),$t(13,"label"),On(14,"Password"),Zt(),ei(15,Bre,4,0,"span",5),Zt(),$t(16,"div",7)(17,"button",8),On(18,"Login"),Zt()()(),$t(19,"div",9)(20,"button",10),ar("click",function(){return i.GoogleAuth()}),to(21,"img",11),On(22," Login with google"),Zt()(),$t(23,"div",9)(24,"button",12),ar("click",function(){return i.router.navigate(["register"])}),On(25,"Register"),Zt()()()()),2&r){let s,o,a;bn(4),Jn("formGroup",i.loginUser),bn(5),Jn("ngIf",(null==(s=i.loginUser.get("email"))?null:s.hasError("required"))&&(null==(s=i.loginUser.get("email"))?null:s.touched)),bn(1),Jn("ngIf",(null==(o=i.loginUser.get("email"))?null:o.hasError("email"))&&(null==(o=i.loginUser.get("email"))?null:o.touched)),bn(5),Jn("ngIf",(null==(a=i.loginUser.get("password"))?null:a.hasError("required"))&&(null==(a=i.loginUser.get("password"))?null:a.touched)),bn(2),Jn("disabled",i.loginUser.invalid)}},dependencies:[AE,e2,ME,UV,BV,HE,kD],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-image:url(/assets/img/background.jpg);background-size:cover;padding:100px;height:100vh}.logo[_ngcontent-%COMP%]{height:130px;margin-bottom:10px}.body[_ngcontent-%COMP%]{margin-top:2%;width:100%;max-width:330px;text-align:center;padding:3%;border-radius:20px;background-color:#00000089}.btn-google[_ngcontent-%COMP%]{background-color:#61a1fe;color:#fff;width:100%;font-weight:500}.btn-reg[_ngcontent-%COMP%]{background-color:#9d9d9d;color:#fff;width:100%;font-weight:500}.btn-google[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;margin-bottom:4px;margin-right:14px}.btn-reg[_ngcontent-%COMP%]{background-color:#9d9d9d;color:#fff;width:100%}h1[_ngcontent-%COMP%]{color:#fff;font-weight:500;border-color:#fff}.basicButton[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:8px;border-radius:8px;border-color:none;font-size:20px}"]})}return n})()},{path:"register",component:(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=To({type:n,selectors:[["app-register"]],decls:2,vars:0,template:function(r,i){1&r&&($t(0,"p"),On(1,"register works!"),Zt())}})}return n})()},{path:"home",component:(()=>{class n{constructor(t,r,i){this.afAuth=t,this.router=r,this.storageService=i}logout(){this.afAuth.signOut().then(()=>{this.storageService.isLoggedNext(!1),localStorage.clear(),this.router.navigate(["/"])})}static#e=this.\u0275fac=function(r){return new(r||n)(te(tc),te(Hi),te(EA))};static#t=this.\u0275cmp=To({type:n,selectors:[["app-home"]],decls:2,vars:0,consts:[[1,"btn","btn-lg","btn-reg",3,"click"]],template:function(r,i){1&r&&($t(0,"button",0),ar("click",function(){return i.logout()}),On(1,"Logout"),Zt())}})}return n})()}];let $re=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({imports:[bU.forRoot(jre),bU]})}return n})(),Hre=(()=>{class n{constructor(){this.title="weedcobot-angular"}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=To({type:n,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"content"]],template:function(r,i){1&r&&($t(0,"div",0),to(1,"router-outlet"),Zt())},dependencies:[eA]})}return n})();const qre_firebase={apiKey:"AIzaSyACr8sywQsvgP9JEoDjruJpLlfeOdT9M5g",authDomain:"weedcobot.firebaseapp.com",projectId:"weedcobot",storageBucket:"weedcobot.appspot.com",messagingSenderId:"626040150744",appId:"1:626040150744:web:9cd284bb5098a73e1895ad"};var Q=ke(861);const aB="@firebase/database";let bA="";function DA(n){bA=n}class Wre{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,b.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,b.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Kre{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,b.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const lB=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Wre(e)}}catch{}return new Kre},ic=lB("localStorage"),AA=lB("sessionStorage"),Lh=new hs.Yd("@firebase/database"),cB=function(){let n=1;return function(){return n++}}(),dB=function(n){const e=(0,b.dS)(n),t=new b.gQ;t.update(e);const r=t.digest();return b.US.encodeByteArray(r)},dm=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=dm.apply(null,r):e+="object"==typeof r?(0,b.Wl)(r):r,e+=" "}return e};let sc=null,hB=!0;const fB=function(n,e){(0,b.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Lh.logLevel=hs.in.VERBOSE,sc=Lh.log.bind(Lh),e&&AA.set("logging_enabled",!0)):"function"==typeof n?sc=n:(sc=null,AA.remove("logging_enabled"))},Ar=function(...n){if(!0===hB&&(hB=!1,null===sc&&!0===AA.get("logging_enabled")&&fB(!0)),sc){const e=dm.apply(null,n);sc(e)}},hm=function(n){return function(...e){Ar(n,...e)}},SA=function(...n){const e="FIREBASE INTERNAL ERROR: "+dm(...n);Lh.error(e)},jo=function(...n){const e=`FIREBASE FATAL ERROR: ${dm(...n)}`;throw Lh.error(e),new Error(e)},ni=function(...n){const e="FIREBASE WARNING: "+dm(...n);Lh.warn(e)},EI=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},ku="[MIN_NAME]",La="[MAX_NAME]",oc=function(n,e){if(n===e)return 0;if(n===ku||e===La)return-1;if(e===ku||n===La)return 1;{const t=mB(n),r=mB(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},Yre=function(n,e){return n===e?0:n<e?-1:1},fm=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,b.Wl)(e))},RA=function(n){if("object"!=typeof n||null===n)return(0,b.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,b.Wl)(e[r]),t+=":",t+=RA(n[e[r]]);return t+="}",t},pB=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Sr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const gB=function(n){(0,b.hu)(!EI(n),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===n?(s=0,o=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const l=[];for(u=52;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();const d=l.join("");let f="";for(u=0;u<64;u+=8){let m=parseInt(d.substr(u,8),2).toString(16);1===m.length&&(m="0"+m),f+=m}return f.toLowerCase()},tie=new RegExp("^-?(0*)\\d{1,10}$"),mB=function(n){if(tie.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},Vh=function(n){try{n()}catch(e){setTimeout(()=>{throw ni("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},pm=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class sie{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ni(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class oie{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ar("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ni(e)}}let gm=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const IB=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,CB="websocket",bB="long_polling";class NA{constructor(e,t,r,i,s=!1,o="",a=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ic.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ic.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function DB(n,e,t){let r;if((0,b.hu)("string"==typeof e,"typeof type must == string"),(0,b.hu)("object"==typeof t,"typeof params must == object"),e===CB)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==bB)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function aie(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Sr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class uie{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,b.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,b.p$)(this.counters_)}}const MA={},xA={};function kA(n){const e=n.toString();return MA[e]||(MA[e]=new uie),MA[e]}class cie{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Vh(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Ou{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=hm(e),this.stats_=kA(t),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),DB(t,bB,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new cie(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,b.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new OA((...s)=>{const[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&IB.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ou.forceAllow_=!0}static forceDisallow(){Ou.forceDisallow_=!0}static isAvailable(){return!((0,b.Yr)()||!Ou.forceAllow_&&(Ou.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,b.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,b.h$)(t),i=pB(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,b.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,b.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class OA{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,b.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=cB(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=OA.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ar("frame writing exception"),a.stack&&Ar(a.stack),Ar(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ar("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,b.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ar("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let wI=null;typeof MozWebSocket<"u"?wI=MozWebSocket:typeof WebSocket<"u"&&(wI=WebSocket);let Uh=(()=>{class n{constructor(t,r,i,s,o,a,u){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=hm(this.connId),this.stats_=kA(r),this.connURL=n.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){const a={v:"5"};return!(0,b.Yr)()&&typeof location<"u"&&location.hostname&&IB.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),DB(t,CB,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ic.set("previous_websocket_failure",!0);try{let i;if((0,b.Yr)()){i={headers:{"User-Agent":`Firebase/5/${bA}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new wI(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==wI&&!n.forceDisallow_}static previouslyFailed(){return ic.isInMemoryStorage||!0===ic.get("previous_websocket_failure")}markConnectionHealthy(){ic.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,b.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,b.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,b.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=pB(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),xB=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Ou,Uh]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Uh&&Uh.isAvailable();let i=r&&!Uh.previouslyFailed();if(t.webSocketOnly&&(r||ni("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Uh];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class BB{constructor(e,t,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=hm("c:"+this.id+":"),this.transportManager_=new xB(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=pm(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=fm("t",e),r=fm("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=fm("t",e),r=fm("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=fm("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?SA("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):SA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&ni("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),pm(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pm(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ic.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class jB{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class $B{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,b.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,b.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class TI extends $B{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,b.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new TI}getInitialEvent(e){return(0,b.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Vt{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Nt(){return new Vt("")}function ut(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Fu(n){return n.pieces_.length-n.pieceNum_}function Yt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Vt(n.pieces_,e)}function LA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function mm(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function zB(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Vt(e,0)}function An(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Vt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Vt(t,0)}function lt(n){return n.pieceNum_>=n.pieces_.length}function Di(n,e){const t=ut(n),r=ut(e);if(null===t)return e;if(t===r)return Di(Yt(n),Yt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Mie(n,e){const t=mm(n,0),r=mm(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=oc(t[i],r[i]);if(0!==s)return s}return t.length===r.length?0:t.length<r.length?-1:1}function VA(n,e){if(Fu(n)!==Fu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function $s(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Fu(n)>Fu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class xie{constructor(e,t){this.errorPrefix_=t,this.parts_=mm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,b.ug)(this.parts_[r]);GB(this)}}function GB(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ac(n))}function ac(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class UA extends $B{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new UA}getInitialEvent(e){return(0,b.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const _m=1e3;let bI,uc=(()=>{class n extends jB{constructor(t,r,i,s,o,a,u,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=hm("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=_m,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,b.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");UA.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&TI.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_((0,b.Wl)(o)),(0,b.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const r=new b.BH,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,b.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,b.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,u=>{const l=u.d,d=u.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",u),"ok"!==d&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,b.r3)(t,"w")){const i=(0,b.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();ni(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,b.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,b.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,b.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);const o={p:t};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,b.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):SA("Unrecognized action received from server: "+(0,b.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,b.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_m,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=_m,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=_m),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Q.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let u=!1,l=null;const d=function(){l?l.close():(u=!0,s())};t.realtime_={close:d,sendRequest:function(_){(0,b.hu)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)}};const m=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[_,v]=yield Promise.all([t.authTokenProvider_.getToken(m),t.appCheckTokenProvider_.getToken(m)]);u?Ar("getToken() completed but was canceled"):(Ar("getToken() completed. Creating connection."),t.authToken_=_&&_.accessToken,t.appCheckToken_=v&&v.token,l=new BB(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,s,T=>{ni(T+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(_){t.log_("Failed to get token: "+_),u||(t.repoInfo_.nodeAdmin&&ni(_),d())}}})()}interrupt(t){Ar("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ar("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,b.xb)(this.interruptReasons_)&&(this.reconnectDelay_=_m,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(o=>RA(o)).join("$"):"default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){const i=new Vt(t).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Ar("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ar("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,b.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+bA.replace(/\./g,"-")]=1,(0,b.uI)()?t["framework.cordova"]=1:(0,b.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=TI.getInstance().currentlyOnline();return(0,b.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class ft{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ft(e,t)}}class CI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ft(ku,e),i=new ft(ku,t);return 0!==this.compare(r,i)}minPost(){return ft.MIN}}class ZB extends CI{static get __EMPTY_NODE(){return bI}static set __EMPTY_NODE(e){bI=e}compare(e,t){return oc(e.name,t.name)}isDefinedOn(e){throw(0,b.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ft.MIN}maxPost(){return new ft(La,bI)}makePost(e,t){return(0,b.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new ft(e,bI)}toString(){return".key"}}const $o=new ZB;class DI{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let jA,lo=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??zi.EMPTY_NODE,this.right=o??zi.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return zi.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return zi.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class zi{constructor(e,t=zi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new zi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,lo.BLACK,null,null))}remove(e){return new zi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,lo.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new DI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new DI(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new DI(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new DI(this.root_,null,this.comparator_,!0,e)}}function jie(n,e){return oc(n.name,e.name)}function BA(n,e){return oc(n,e)}zi.EMPTY_NODE=new class Bie{copy(e,t,r,i,s){return this}insert(e,t,r){return new lo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const QB=function(n){return"number"==typeof n?"number:"+gB(n):"string:"+n},YB=function(n){if(n.isLeafNode()){const e=n.val();(0,b.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,b.r3)(e,".sv"),"Priority must be a string or number.")}else(0,b.hu)(n===jA||n.isEmpty(),"priority of unexpected type.");(0,b.hu)(n===jA||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let XB,JB,ej,Bh=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,b.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),YB(this.priorityNode_)}static set __childrenNodeConstructor(t){XB=t}static get __childrenNodeConstructor(){return XB}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return lt(t)?this:".priority"===ut(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=ut(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,b.hu)(".priority"!==i||1===Fu(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Yt(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+QB(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?gB(this.value_):this.value_,this.lazyHash_=dB(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,b.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return(0,b.hu)(s>=0,"Unknown leaf type: "+r),(0,b.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const un=new class zie extends CI{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return 0===s?oc(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ft.MIN}maxPost(){return new ft(La,new Bh("[PRIORITY-POST]",ej))}makePost(e,t){const r=JB(e);return new ft(t,new Bh("[PRIORITY-POST]",r))}toString(){return".priority"}},Gie=Math.log(2);class Wie{constructor(e){this.count=parseInt(Math.log(e+1)/Gie,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const AI=function(n,e,t,r){n.sort(e);const i=function(u,l){const d=l-u;let f,m;if(0===d)return null;if(1===d)return f=n[u],m=t?t(f):f,new lo(m,f.node,lo.BLACK,null,null);{const _=parseInt(d/2,10)+u,v=i(u,_),T=i(_+1,l);return f=n[_],m=t?t(f):f,new lo(m,f.node,lo.BLACK,v,T)}},a=function(u){let l=null,d=null,f=n.length;const m=function(v,T){const D=f-v,k=f;f-=v;const P=i(D+1,k),O=n[D],q=t?t(O):O;_(new lo(q,O.node,T,null,P))},_=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<u.count;++v){const T=u.nextBitIsOne(),D=Math.pow(2,u.count-(v+1));T?m(D,lo.BLACK):(m(D,lo.BLACK),m(D,lo.RED))}return d}(new Wie(n.length));return new zi(r||e,a)};let $A;const jh={};class Va{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,b.hu)(jh&&un,"ChildrenNode.ts has not been loaded"),$A=$A||new Va({".priority":jh},{".priority":un}),$A}get(e){const t=(0,b.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zi?t:null}hasIndex(e){return(0,b.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,b.hu)(e!==$o,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(ft.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?AI(r,e.getCompare()):jh;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const d=Object.assign({},this.indexes_);return d[u]=a,new Va(d,l)}addToIndexes(e,t){const r=(0,b.UI)(this.indexes_,(i,s)=>{const o=(0,b.DV)(this.indexSet_,s);if((0,b.hu)(o,"Missing index implementation for "+s),i===jh){if(o.isDefinedOn(e.node)){const a=[],u=t.getIterator(ft.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),AI(a,o.getCompare())}return jh}{const a=t.get(e.name);let u=i;return a&&(u=u.remove(new ft(e.name,a))),u.insert(e,e.node)}});return new Va(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,b.UI)(this.indexes_,i=>{if(i===jh)return i;{const s=t.get(e.name);return s?i.remove(new ft(e.name,s)):i}});return new Va(r,this.indexSet_)}}let ym,Ye=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&YB(this.priorityNode_),this.children_.isEmpty()&&(0,b.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ym||(ym=new n(new zi(BA),null,Va.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ym}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?ym:r}}getChild(t){const r=ut(t);return null===r?this:this.getImmediateChild(r).getChild(Yt(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,b.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new ft(t,r);let s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?ym:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){const i=ut(t);if(null===i)return r;{(0,b.hu)(".priority"!==ut(t)||1===Fu(t),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Yt(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(un,(a,u)=>{r[a]=u.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+QB(this.getPriority().val())+":"),this.forEachChild(un,(r,i)=>{const s=i.hash();""!==s&&(t+=":"+r+":"+s)}),this.lazyHash_=""===t?"":dB(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ft(t,r));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new ft(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new ft(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,ft.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,ft.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===vm?-1:0}withIndex(t){if(t===$o||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===$o||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(un),s=r.getIterator(un);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===$o?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const vm=new class Kie extends Ye{constructor(){super(new zi(BA),Ye.EMPTY_NODE,Va.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ye.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(ft,{MIN:{value:new ft(ku,Ye.EMPTY_NODE)},MAX:{value:new ft(La,vm)}}),ZB.__EMPTY_NODE=Ye.EMPTY_NODE,Bh.__childrenNodeConstructor=Ye,function $ie(n){jA=n}(vm),function qie(n){ej=n}(vm);const Zie=!0;function Fn(n,e=null){if(null===n)return Ye.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,b.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Bh(n,Fn(e));if(n instanceof Array||!Zie){let t=Ye.EMPTY_NODE;return Sr(n,(r,i)=>{if((0,b.r3)(n,r)&&"."!==r.substring(0,1)){const s=Fn(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Fn(e))}{const t=[];let r=!1;if(Sr(n,(o,a)=>{if("."!==o.substring(0,1)){const u=Fn(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new ft(o,u)))}}),0===t.length)return Ye.EMPTY_NODE;const s=AI(t,jie,o=>o.name,BA);if(r){const o=AI(t,un.getCompare());return new Ye(s,Fn(e),new Va({".priority":o},{".priority":un}))}return new Ye(s,Fn(e),Va.Default)}}!function Hie(n){JB=n}(Fn);class HA extends CI{constructor(e){super(),this.indexPath_=e,(0,b.hu)(!lt(e)&&".priority"!==ut(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return 0===s?oc(e.name,t.name):s}makePost(e,t){const r=Fn(e),i=Ye.EMPTY_NODE.updateChild(this.indexPath_,r);return new ft(t,i)}maxPost(){const e=Ye.EMPTY_NODE.updateChild(this.indexPath_,vm);return new ft(La,e)}toString(){return mm(this.indexPath_,0).join("/")}}const qA=new class Qie extends CI{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?oc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ft.MIN}maxPost(){return ft.MAX}makePost(e,t){const r=Fn(e);return new ft(t,r)}toString(){return".value"}};function tj(n){return{type:"value",snapshotNode:n}}function $h(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Em(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Im(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class zA{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){(0,b.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Em(t,a)):(0,b.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange($h(t,r)):o.trackChildChange(Im(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(un,(i,s)=>{t.hasChild(i)||r.trackChildChange(Em(i,s))}),t.isLeafNode()||t.forEachChild(un,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Im(i,s,o))}else r.trackChildChange($h(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ye.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class wm{constructor(e){this.indexedFilter_=new zA(e.getIndex()),this.index_=e.getIndex(),this.startPost_=wm.getStartPost_(e),this.endPost_=wm.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ft(t,r))||(r=Ye.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Ye.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Ye.EMPTY_NODE);const s=this;return t.forEachChild(un,(o,a)=>{s.matches(new ft(o,a))||(i=i.updateImmediateChild(o,Ye.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Xie{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new wm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ft(t,r))||(r=Ye.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Ye.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;i=Ye.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=t.withIndex(this.index_),i=i.updatePriority(Ye.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Ye.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,_)=>f(_,m)}else o=this.index_.getCompare();const a=e;(0,b.hu)(a.numChildren()===this.limit_,"");const u=new ft(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(t)){const f=a.getImmediateChild(t);let m=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=m&&(m.name===t||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const _=null==m?1:o(m,u);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(Im(t,r,f)),a.updateImmediateChild(t,r);{s?.trackChildChange(Em(t,f));const T=a.updateImmediateChild(t,Ye.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange($h(m.name,m.node)),T.updateImmediateChild(m.name,m.node)):T}}return r.isEmpty()?e:d&&o(l,u)>=0?(null!=s&&(s.trackChildChange(Em(l.name,l.node)),s.trackChildChange($h(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,Ye.EMPTY_NODE)):e}}class SI{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=un}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,b.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,b.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ku}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,b.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,b.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:La}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,b.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===un}copy(){const e=new SI;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function GA(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function WA(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function RI(n,e){const t=n.copy();return t.index_=e,t}function nj(n){const e={};if(n.isDefault())return e;let t;if(n.index_===un?t="$priority":n.index_===qA?t="$value":n.index_===$o?t="$key":((0,b.hu)(n.index_ instanceof HA,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,b.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,b.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,b.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,b.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,b.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function rj(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==un&&(e.i=n.index_.toString()),e}class PI extends jB{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=hm("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,b.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=PI.getListenId_(e,r),a={};this.listens_[o]=a;const u=nj(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let f=d;if(404===l&&(f=null,l=null),null===l&&this.onDataUpdate_(s,f,!1,r),(0,b.DV)(this.listens_,o)===a){let m;m=l?401===l?"permission_denied":"rest_error:"+l:"ok",i(m,null)}})}unlisten(e,t){const r=PI.getListenId_(e,t);delete this.listens_[r]}get(e){const t=nj(e._queryParams),r=e._path.toString(),i=new b.BH;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,b.xO)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,b.cI)(a.responseText)}catch{ni("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&ni("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class ise{constructor(){this.rootNode_=Ye.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function NI(){return{value:null,children:new Map}}function Hh(n,e,t){if(lt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=ut(e);n.children.has(r)||n.children.set(r,NI()),Hh(n.children.get(r),e=Yt(e),t)}}function KA(n,e){if(lt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(un,(r,i)=>{Hh(n,new Vt(r),i)}),KA(n,e)}}if(n.children.size>0){const t=ut(e);return e=Yt(e),n.children.has(t)&&KA(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function ZA(n,e,t){null!==n.value?t(e,n.value):function sse(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{ZA(i,new Vt(e.toString()+"/"+r),t)})}class ose{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Sr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class lse{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ose(e);const r=1e4+2e4*Math.random();pm(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Sr(e,(i,s)=>{s>0&&(0,b.r3)(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),pm(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ho=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ho||{});function XA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class MI{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ho.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(lt(this.path)){if(null!=this.affectedTree.value)return(0,b.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Vt(e));return new MI(Nt(),t,this.revert)}}return(0,b.hu)(ut(this.path)===e,"operationForChild called for unrelated child."),new MI(Yt(this.path),this.affectedTree,this.revert)}}class Tm{constructor(e,t){this.source=e,this.path=t,this.type=Ho.LISTEN_COMPLETE}operationForChild(e){return lt(this.path)?new Tm(this.source,Nt()):new Tm(this.source,Yt(this.path))}}class lc{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ho.OVERWRITE}operationForChild(e){return lt(this.path)?new lc(this.source,Nt(),this.snap.getImmediateChild(e)):new lc(this.source,Yt(this.path),this.snap)}}class qh{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ho.MERGE}operationForChild(e){if(lt(this.path)){const t=this.children.subtree(new Vt(e));return t.isEmpty()?null:t.value?new lc(this.source,Nt(),t.value):new qh(this.source,Nt(),t)}return(0,b.hu)(ut(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new qh(this.source,Yt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Lu{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(lt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ut(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class cse{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Cm(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,u)=>function fse(n,e,t){if(null==e.childName||null==t.childName)throw(0,b.g5)("Should only compare child_ events.");const r=new ft(e.childName,e.snapshotNode),i=new ft(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,a,u)),o.forEach(a=>{const u=function hse(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,n.query_))})})}function xI(n,e){return{eventCache:n,serverCache:e}}function bm(n,e,t,r){return xI(new Lu(e,t,r),n.serverCache)}function sj(n,e,t,r){return xI(n.eventCache,new Lu(e,t,r))}function kI(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function cc(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let JA;class ln{constructor(e,t=(()=>(JA||(JA=new zi(Yre)),JA))()){this.value=e,this.children=t}static fromObject(e){let t=new ln(null);return Sr(e,(r,i)=>{t=t.set(new Vt(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Nt(),value:this.value};if(lt(e))return null;{const r=ut(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Yt(e),t);return null!=s?{path:An(new Vt(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(lt(e))return this;{const t=ut(e),r=this.children.get(t);return null!==r?r.subtree(Yt(e)):new ln(null)}}set(e,t){if(lt(e))return new ln(t,this.children);{const r=ut(e),s=(this.children.get(r)||new ln(null)).set(Yt(e),t),o=this.children.insert(r,s);return new ln(this.value,o)}}remove(e){if(lt(e))return this.children.isEmpty()?new ln(null):new ln(null,this.children);{const t=ut(e),r=this.children.get(t);if(r){const i=r.remove(Yt(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new ln(null):new ln(this.value,s)}return this}}get(e){if(lt(e))return this.value;{const t=ut(e),r=this.children.get(t);return r?r.get(Yt(e)):null}}setTree(e,t){if(lt(e))return t;{const r=ut(e),s=(this.children.get(r)||new ln(null)).setTree(Yt(e),t);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new ln(this.value,o)}}fold(e){return this.fold_(Nt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(An(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Nt(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(lt(e))return null;{const s=ut(e),o=this.children.get(s);return o?o.findOnPath_(Yt(e),An(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Nt(),t)}foreachOnPath_(e,t,r){if(lt(e))return this;{this.value&&r(t,this.value);const i=ut(e),s=this.children.get(i);return s?s.foreachOnPath_(Yt(e),An(t,i),r):new ln(null)}}foreach(e){this.foreach_(Nt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(An(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class co{constructor(e){this.writeTree_=e}static empty(){return new co(new ln(null))}}function Dm(n,e,t){if(lt(e))return new co(new ln(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Di(i,e);return s=s.updateChild(o,t),new co(n.writeTree_.set(i,s))}{const i=new ln(t),s=n.writeTree_.setTree(e,i);return new co(s)}}}function eS(n,e,t){let r=n;return Sr(t,(i,s)=>{r=Dm(r,An(e,i),s)}),r}function oj(n,e){if(lt(e))return co.empty();{const t=n.writeTree_.setTree(e,new ln(null));return new co(t)}}function tS(n,e){return null!=dc(n,e)}function dc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Di(t.path,e)):null}function aj(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(un,(r,i)=>{e.push(new ft(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new ft(r,i.value))}),e}function Vu(n,e){if(lt(e))return n;{const t=dc(n,e);return new co(null!=t?new ln(t):n.writeTree_.subtree(e))}}function nS(n){return n.writeTree_.isEmpty()}function zh(n,e){return uj(Nt(),n.writeTree_,e)}function uj(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,b.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):t=uj(An(n,i),s,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(An(n,".priority"),r)),t}}function OI(n,e){return fj(e,n)}function vse(n,e){if(n.snap)return $s(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&$s(An(n.path,t),e))return!0;return!1}function Ise(n){return n.visible}function lj(n,e,t){let r=co.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)$s(t,o)?(a=Di(t,o),r=Dm(r,a,s.snap)):$s(o,t)&&(a=Di(o,t),r=Dm(r,Nt(),s.snap.getChild(a)));else{if(!s.children)throw(0,b.g5)("WriteRecord should have .snap or .children");if($s(t,o))a=Di(t,o),r=eS(r,a,s.children);else if($s(o,t))if(a=Di(o,t),lt(a))r=eS(r,Nt(),s.children);else{const u=(0,b.DV)(s.children,ut(a));if(u){const l=u.getChild(Yt(a));r=Dm(r,Nt(),l)}}}}}return r}function cj(n,e,t,r,i){if(r||i){const s=Vu(n.visibleWrites,e);return!i&&nS(s)?t:i||null!=t||tS(s,Nt())?zh(lj(n.allWrites,function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&($s(l.path,e)||$s(e,l.path))},e),t||Ye.EMPTY_NODE):null}{const s=dc(n.visibleWrites,e);if(null!=s)return s;{const o=Vu(n.visibleWrites,e);return nS(o)?t:null!=t||tS(o,Nt())?zh(o,t||Ye.EMPTY_NODE):null}}}function FI(n,e,t,r){return cj(n.writeTree,n.treePath,e,t,r)}function rS(n,e){return function wse(n,e,t){let r=Ye.EMPTY_NODE;const i=dc(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(un,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Vu(n.visibleWrites,e);return t.forEachChild(un,(o,a)=>{const u=zh(Vu(s,new Vt(o)),a);r=r.updateImmediateChild(o,u)}),aj(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return aj(Vu(n.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(n.writeTree,n.treePath,e)}function dj(n,e,t,r){return function Tse(n,e,t,r,i){(0,b.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=An(e,t);if(tS(n.visibleWrites,s))return null;{const o=Vu(n.visibleWrites,s);return nS(o)?i.getChild(t):zh(o,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function LI(n,e){return function bse(n,e){return dc(n.visibleWrites,e)}(n.writeTree,An(n.treePath,e))}function iS(n,e,t){return function Cse(n,e,t,r){const i=An(e,t),s=dc(n.visibleWrites,i);return null!=s?s:r.isCompleteForChild(t)?zh(Vu(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function hj(n,e){return fj(An(n.treePath,e),n.writeTree)}function fj(n,e){return{treePath:n,writeTree:e}}class Rse{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,b.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,b.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(r,Im(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(r,Em(r,i.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(r,$h(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,b.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,Im(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const pj=new class Pse{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class sS{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Lu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return iS(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:cc(this.viewCache_),s=function Sse(n,e,t,r,i,s){return function Dse(n,e,t,r,i,s,o){let a;const u=Vu(n.visibleWrites,e),l=dc(u,Nt());if(null!=l)a=l;else{if(null==t)return[];a=zh(u,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const d=[],f=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=m.getNext();for(;_&&d.length<i;)0!==f(_,r)&&d.push(_),_=m.getNext();return d}}(n.writeTree,n.treePath,e,t,r,i,s)}(this.writes_,i,t,1,r,e);return 0===s.length?null:s[0]}}function gj(n,e,t,r,i,s){const o=e.eventCache;if(null!=LI(r,t))return e;{let a,u;if(lt(t))if((0,b.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=cc(e),f=rS(r,l instanceof Ye?l:Ye.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const l=FI(r,cc(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{const l=ut(t);if(".priority"===l){(0,b.hu)(1===Fu(t),"Can't have a priority with additional path components");const d=o.getNode();u=e.serverCache.getNode();const f=dj(r,t,d,u);a=null!=f?n.filter.updatePriority(d,f):o.getNode()}else{const d=Yt(t);let f;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const m=dj(r,t,o.getNode(),u);f=null!=m?o.getNode().getImmediateChild(l).updateChild(d,m):o.getNode().getImmediateChild(l)}else f=iS(r,l,e.serverCache);a=null!=f?n.filter.updateChild(o.getNode(),l,f,d,i,s):o.getNode()}}return bm(e,a,o.isFullyInitialized()||lt(t),n.filter.filtersNodes())}}function VI(n,e,t,r,i,s,o,a){const u=e.serverCache;let l;const d=o?n.filter:n.filter.getIndexedFilter();if(lt(t))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){const _=u.getNode().updateChild(t,r);l=d.updateFullNode(u.getNode(),_,null)}else{const _=ut(t);if(!u.isCompleteForPath(t)&&Fu(t)>1)return e;const v=Yt(t),D=u.getNode().getImmediateChild(_).updateChild(v,r);l=".priority"===_?d.updatePriority(u.getNode(),D):d.updateChild(u.getNode(),_,D,v,pj,null)}const f=sj(e,l,u.isFullyInitialized()||lt(t),d.filtersNodes());return gj(n,f,t,i,new sS(i,f,s),a)}function oS(n,e,t,r,i,s,o){const a=e.eventCache;let u,l;const d=new sS(i,e,s);if(lt(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=bm(e,l,!0,n.filter.filtersNodes());else{const f=ut(t);if(".priority"===f)l=n.filter.updatePriority(e.eventCache.getNode(),r),u=bm(e,l,a.isFullyInitialized(),a.isFiltered());else{const m=Yt(t),_=a.getNode().getImmediateChild(f);let v;if(lt(m))v=r;else{const T=d.getCompleteChild(f);v=null!=T?".priority"===LA(m)&&T.getChild(zB(m)).isEmpty()?T:T.updateChild(m,r):Ye.EMPTY_NODE}u=_.equals(v)?e:bm(e,n.filter.updateChild(a.getNode(),f,v,m,d,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return u}function mj(n,e){return n.eventCache.isCompleteForChild(e)}function _j(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function aS(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,u=e;l=lt(t)?r:new ln(null).setTree(t,r);const d=e.serverCache.getNode();return l.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){const v=_j(0,e.serverCache.getNode().getImmediateChild(f),m);u=VI(n,u,new Vt(f),v,i,s,o,a)}}),l.children.inorderTraversal((f,m)=>{const _=!e.serverCache.isCompleteForChild(f)&&null===m.value;if(!d.hasChild(f)&&!_){const T=_j(0,e.serverCache.getNode().getImmediateChild(f),m);u=VI(n,u,new Vt(f),T,i,s,o,a)}}),u}class Use{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new zA(r.getIndex()),s=function Jie(n){return n.loadsAllData()?new zA(n.getIndex()):n.hasLimit()?new Xie(n):new wm(n)}(r);this.processor_=function Nse(n){return{filter:n}}(s);const o=t.serverCache,a=t.eventCache,u=i.updateFullNode(Ye.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(Ye.EMPTY_NODE,a.getNode(),null),d=new Lu(u,o.isFullyInitialized(),i.filtersNodes()),f=new Lu(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=xI(f,d),this.eventGenerator_=new cse(this.query_)}get query(){return this.query_}}function $se(n,e){const t=cc(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!lt(e)&&!t.getImmediateChild(ut(e)).isEmpty())?t.getChild(e):null}function yj(n){return 0===n.eventRegistrations_.length}function vj(n,e,t){const r=[];if(t){(0,b.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}else i.push(o)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function Ej(n,e,t,r){e.type===Ho.MERGE&&null!==e.source.queryId&&((0,b.hu)(cc(n.viewCache_),"We should always have a full cache before handling merges"),(0,b.hu)(kI(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=function xse(n,e,t,r,i){const s=new Rse;let o,a;if(t.type===Ho.OVERWRITE){const l=t;l.source.fromUser?o=oS(n,e,l.path,l.snap,r,i,s):((0,b.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!lt(l.path),o=VI(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Ho.MERGE){const l=t;l.source.fromUser?o=function Ose(n,e,t,r,i,s,o){let a=e;return r.foreach((u,l)=>{const d=An(t,u);mj(e,ut(d))&&(a=oS(n,a,d,l,i,s,o))}),r.foreach((u,l)=>{const d=An(t,u);mj(e,ut(d))||(a=oS(n,a,d,l,i,s,o))}),a}(n,e,l.path,l.children,r,i,s):((0,b.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=aS(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Ho.ACK_USER_WRITE){const l=t;o=l.revert?function Vse(n,e,t,r,i,s){let o;if(null!=LI(r,t))return e;{const a=new sS(r,e,i),u=e.eventCache.getNode();let l;if(lt(t)||".priority"===ut(t)){let d;if(e.serverCache.isFullyInitialized())d=FI(r,cc(e));else{const f=e.serverCache.getNode();(0,b.hu)(f instanceof Ye,"serverChildren would be complete if leaf node"),d=rS(r,f)}l=n.filter.updateFullNode(u,d,s)}else{const d=ut(t);let f=iS(r,d,e.serverCache);null==f&&e.serverCache.isCompleteForChild(d)&&(f=u.getImmediateChild(d)),l=null!=f?n.filter.updateChild(u,d,f,Yt(t),a,s):e.eventCache.getNode().hasChild(d)?n.filter.updateChild(u,d,Ye.EMPTY_NODE,Yt(t),a,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=FI(r,cc(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=LI(r,Nt()),bm(e,l,o,n.filter.filtersNodes())}}(n,e,l.path,r,i,s):function Fse(n,e,t,r,i,s,o){if(null!=LI(i,t))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(lt(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return VI(n,e,t,u.getNode().getChild(t),i,s,a,o);if(lt(t)){let l=new ln(null);return u.getNode().forEachChild($o,(d,f)=>{l=l.set(new Vt(d),f)}),aS(n,e,t,l,i,s,a,o)}return e}{let l=new ln(null);return r.foreach((d,f)=>{const m=An(t,d);u.isCompleteForPath(m)&&(l=l.set(d,u.getNode().getChild(m)))}),aS(n,e,t,l,i,s,a,o)}}(n,e,l.path,l.affectedTree,r,i,s)}else{if(t.type!==Ho.LISTEN_COMPLETE)throw(0,b.g5)("Unknown operation type: "+t.type);o=function Lse(n,e,t,r,i){const s=e.serverCache;return gj(n,sj(e,s.getNode(),s.isFullyInitialized()||lt(t),s.isFiltered()),t,r,pj,i)}(n,e,t.path,r,s)}const u=s.getChanges();return function kse(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=kI(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(tj(kI(e)))}}(e,o,u),{viewCache:o,changes:u}}(n.processor_,i,e,t,r);return function Mse(n,e){(0,b.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,b.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,b.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Ij(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Ij(n,e,t,r){return function dse(n,e,t,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Yie(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),Cm(n,i,"child_removed",e,r,t),Cm(n,i,"child_added",e,r,t),Cm(n,i,"child_moved",s,r,t),Cm(n,i,"child_changed",e,r,t),Cm(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let UI,jI;class wj{constructor(){this.views=new Map}}function uS(n,e,t,r){const i=e.source.queryId;if(null!==i){const s=n.views.get(i);return(0,b.hu)(null!=s,"SyncTree gave us an op for an invalid query."),Ej(s,e,t,r)}{let s=[];for(const o of n.views.values())s=s.concat(Ej(o,e,t,r));return s}}function Tj(n,e,t,r,i){const o=n.views.get(e._queryIdentifier);if(!o){let a=FI(t,i?r:null),u=!1;a?u=!0:r instanceof Ye?(a=rS(t,r),u=!1):(a=Ye.EMPTY_NODE,u=!1);const l=xI(new Lu(a,u,!1),new Lu(r,i,!1));return new Use(e,l)}return o}function Cj(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Uu(n,e){let t=null;for(const r of n.views.values())t=t||$se(r,e);return t}function bj(n,e){return e._queryParams.loadsAllData()?BI(n):n.views.get(e._queryIdentifier)}function Dj(n,e){return null!=bj(n,e)}function Bu(n){return null!=BI(n)}function BI(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Xse=1;class Aj{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ln(null),this.pendingWriteTree_=function Ase(){return{visibleWrites:co.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function lS(n,e,t,r,i){return function gse(n,e,t,r,i){(0,b.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Dm(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Gh(n,new lc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function ju(n,e,t=!1){const r=function _se(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function yse(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);(0,b.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&vse(a,r.path)?i=!1:$s(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Ese(n){n.visibleWrites=lj(n.allWrites,Ise,Nt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=oj(n.visibleWrites,r.path):Sr(r.children,u=>{n.visibleWrites=oj(n.visibleWrites,An(r.path,u))}),!0))}(n.pendingWriteTree_,e)){let s=new ln(null);return null!=r.snap?s=s.set(Nt(),!0):Sr(r.children,o=>{s=s.set(new Vt(o),!0)}),Gh(n,new MI(r.path,s,t))}return[]}function Am(n,e,t){return Gh(n,new lc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function $I(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||Dj(o,e))){const u=function Zse(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const a=Bu(n);if("default"===i)for(const[u,l]of n.views.entries())o=o.concat(vj(l,t,r)),yj(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{const u=n.views.get(i);u&&(o=o.concat(vj(u,t,r)),yj(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Bu(n)&&s.push(new(function Gse(){return(0,b.hu)(UI,"Reference.ts has not been loaded"),UI}())(e._repo,e._path)),{removed:s,events:o}}(o,e,t,r);(function Wse(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const l=u.removed;if(a=u.events,!i){const d=-1!==l.findIndex(m=>m._queryParams.loadsAllData()),f=n.syncPointTree_.findOnPath(s,(m,_)=>Bu(_));if(d&&!f){const m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){const _=function soe(n){return n.fold((e,t,r)=>{if(t&&Bu(t))return[BI(t)];{let i=[];return t&&(i=Cj(t)),Sr(r,(s,o)=>{i=i.concat(o)}),i}})}(m);for(let v=0;v<_.length;++v){const T=_[v],D=T.query,k=Nj(n,T);n.listenProvider_.startListening(Rm(D),Sm(n,D),k.hashFn,k.onComplete)}}}!f&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Rm(e),null):l.forEach(m=>{const _=n.queryToTagMap.get(qI(m));n.listenProvider_.stopListening(Rm(m),_)}))}!function ooe(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=qI(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}(n,l)}return a}function Sj(n,e,t,r){const i=dS(n,r);if(null!=i){const s=hS(i),o=s.path,a=s.queryId,u=Di(o,e);return fS(n,o,new lc(XA(a),u,t))}return[]}function cS(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(m,_)=>{const v=Di(m,i);s=s||Uu(_,v),o=o||Bu(_)});let u,a=n.syncPointTree_.get(i);a?(o=o||Bu(a),s=s||Uu(a,Nt())):(a=new wj,n.syncPointTree_=n.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=Ye.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,v)=>{const T=Uu(v,Nt());T&&(s=s.updateImmediateChild(_,T))}));const l=Dj(a,e);if(!l&&!e._queryParams.loadsAllData()){const m=qI(e);(0,b.hu)(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");const _=function aoe(){return Xse++}();n.queryToTagMap.set(m,_),n.tagToQueryMap.set(_,m)}let f=function Kse(n,e,t,r,i,s){const o=Tj(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),function Hse(n,e){n.eventRegistrations_.push(e)}(o,t),function qse(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(un,(s,o)=>{r.push($h(s,o))}),t.isFullyInitialized()&&r.push(tj(t.getNode())),Ij(n,r,t.getNode(),e)}(o,t)}(a,e,t,OI(n.pendingWriteTree_,i),s,u);if(!l&&!o&&!r){const m=bj(a,e);f=f.concat(function uoe(n,e,t){const r=e._path,i=Sm(n,e),s=Nj(n,t),o=n.listenProvider_.startListening(Rm(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)(0,b.hu)(!Bu(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((l,d,f)=>{if(!lt(l)&&d&&Bu(d))return[BI(d).query];{let m=[];return d&&(m=m.concat(Cj(d).map(_=>_.query))),Sr(f,(_,v)=>{m=m.concat(v)}),m}});for(let l=0;l<u.length;++l){const d=u[l];n.listenProvider_.stopListening(Rm(d),Sm(n,d))}}return o}(n,e,m))}return f}function HI(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=Uu(a,Di(o,e));if(l)return l});return cj(i,e,s,t,!0)}function Gh(n,e){return Rj(e,n.syncPointTree_,null,OI(n.pendingWriteTree_,Nt()))}function Rj(n,e,t,r){if(lt(n.path))return Pj(n,e,t,r);{const i=e.get(Nt());null==t&&null!=i&&(t=Uu(i,Nt()));let s=[];const o=ut(n.path),a=n.operationForChild(o),u=e.children.get(o);if(u&&a){const l=t?t.getImmediateChild(o):null,d=hj(r,o);s=s.concat(Rj(a,u,l,d))}return i&&(s=s.concat(uS(i,n,r,t))),s}}function Pj(n,e,t,r){const i=e.get(Nt());null==t&&null!=i&&(t=Uu(i,Nt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=t?t.getImmediateChild(o):null,l=hj(r,o),d=n.operationForChild(o);d&&(s=s.concat(Pj(d,a,u,l)))}),i&&(s=s.concat(uS(i,n,r,t))),s}function Nj(n,e){const t=e.query,r=Sm(n,t);return{hashFn:()=>(function Bse(n){return n.viewCache_.serverCache.getNode()}(e)||Ye.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function noe(n,e,t){const r=dS(n,t);if(r){const i=hS(r),s=i.path,o=i.queryId,a=Di(s,e);return fS(n,s,new Tm(XA(o),a))}return[]}(n,t._path,r):function toe(n,e){return Gh(n,new Tm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function eie(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return $I(n,t,null,s)}}}}function Sm(n,e){const t=qI(e);return n.queryToTagMap.get(t)}function qI(n){return n._path.toString()+"$"+n._queryIdentifier}function dS(n,e){return n.tagToQueryMap.get(e)}function hS(n){const e=n.indexOf("$");return(0,b.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Vt(n.substr(0,e))}}function fS(n,e,t){const r=n.syncPointTree_.get(e);return(0,b.hu)(r,"Missing sync point for query tag that we're tracking"),uS(r,t,OI(n.pendingWriteTree_,e),null)}function Rm(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Yse(){return(0,b.hu)(jI,"Reference.ts has not been loaded"),jI}())(n._repo,n._path):n}class pS{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new pS(t)}node(){return this.node_}}class gS{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=An(this.path_,e);return new gS(this.syncTree_,t)}node(){return HI(this.syncTree_,this.path_)}}const loe=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},Mj=function(n,e,t){return n&&"object"==typeof n?((0,b.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?coe(n[".sv"],e,t):"object"==typeof n[".sv"]?doe(n[".sv"],e):void(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},coe=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,b.hu)(!1,"Unexpected server value: "+n)},doe=function(n,e,t){n.hasOwnProperty("increment")||(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,b.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,b.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},xj=function(n,e,t,r){return _S(e,new gS(t,n),r)},mS=function(n,e,t){return _S(n,new pS(e),t)};function _S(n,e,t){const r=n.getPriority().val(),i=Mj(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=Mj(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Bh(a,Fn(i)):n}{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Bh(i))),o.forEachChild(un,(a,u)=>{const l=_S(u,e.getImmediateChild(a),t);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}class yS{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function zI(n,e){let t=e instanceof Vt?e:new Vt(e),r=n,i=ut(t);for(;null!==i;){const s=(0,b.DV)(r.node.children,i)||{children:{},childCount:0};r=new yS(i,r,s),t=Yt(t),i=ut(t)}return r}function hc(n){return n.node.value}function vS(n,e){n.node.value=e,ES(n)}function kj(n){return n.node.childCount>0}function GI(n,e){Sr(n.node.children,(t,r)=>{e(new yS(t,n,r))})}function Oj(n,e,t,r){t&&!r&&e(n),GI(n,i=>{Oj(i,e,!0,r)}),t&&r&&e(n)}function Pm(n){return new Vt(null===n.parent?n.name:Pm(n.parent)+"/"+n.name)}function ES(n){null!==n.parent&&function poe(n,e,t){const r=function hoe(n){return void 0===hc(n)&&!kj(n)}(t),i=(0,b.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,ES(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,ES(n))}(n.parent,n.name,n)}const goe=/[\[\].#$\/\u0000-\u001F\u007F]/,moe=/[\[\].#$\u0000-\u001F\u007F]/,IS=10485760,WI=function(n){return"string"==typeof n&&0!==n.length&&!goe.test(n)},Fj=function(n){return"string"==typeof n&&0!==n.length&&!moe.test(n)},Nm=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!EI(n)||n&&"object"==typeof n&&(0,b.r3)(n,".sv")},qo=function(n,e,t,r){r&&void 0===e||Mm((0,b.gK)(n,"value"),e,t)},Mm=function(n,e,t){const r=t instanceof Vt?new xie(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+ac(r));if("function"==typeof e)throw new Error(n+"contains a function "+ac(r)+" with contents = "+e.toString());if(EI(e))throw new Error(n+"contains "+e.toString()+" "+ac(r));if("string"==typeof e&&e.length>IS/3&&(0,b.ug)(e)>IS)throw new Error(n+"contains a string greater than "+IS+" utf8 bytes "+ac(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Sr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!WI(o)))throw new Error(n+" contains an invalid key ("+o+") "+ac(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function kie(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,b.ug)(e),GB(n)})(r,o),Mm(n,a,r),function Oie(n){const e=n.parts_.pop();n.byteLength_-=(0,b.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&s)throw new Error(n+' contains ".value" child '+ac(r)+" in addition to actual children.")}},Lj=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,b.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Sr(e,(o,a)=>{const u=new Vt(o);if(Mm(i,a,An(t,u)),".priority"===LA(u)&&!Nm(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=mm(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!WI(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Mie);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&$s(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},wS=function(n,e,t){if(!t||void 0!==e){if(EI(e))throw new Error((0,b.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Nm(e))throw new Error((0,b.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},xm=function(n,e,t,r){if(!(r&&void 0===t||WI(t)))throw new Error((0,b.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},km=function(n,e,t,r){if(!(r&&void 0===t||Fj(t)))throw new Error((0,b.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},voe=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),km(n,e,t,r)},Hs=function(n,e){if(".info"===ut(e))throw new Error(n+" failed = Can't modify data under /.info/")},Vj=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!WI(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Fj(n)}(t))throw new Error((0,b.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Eoe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function KI(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==t&&!VA(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Uj(n,e,t){KI(n,t),Bj(n,r=>VA(r,e))}function ps(n,e,t){KI(n,t),Bj(n,r=>$s(r,e)||$s(e,r))}function Bj(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(Ioe(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function Ioe(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();sc&&Ar("event: "+t.toString()),Vh(r)}}}const jj="repo_interrupt",woe=25;class Toe{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Eoe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=NI(),this.transactionQueueTree_=new yS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $j(n){const t=n.infoData_.getNode(new Vt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Om(n){return loe({timestamp:$j(n)})}function Hj(n,e,t,r,i){n.dataUpdateCount++;const s=new Vt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const u=(0,b.UI)(t,l=>Fn(l));o=function roe(n,e,t,r){const i=dS(n,r);if(i){const s=hS(i),o=s.path,a=s.queryId,u=Di(o,e),l=ln.fromObject(t);return fS(n,o,new qh(XA(a),u,l))}return[]}(n.serverSyncTree_,s,u,i)}else{const u=Fn(t);o=Sj(n.serverSyncTree_,s,u,i)}else if(r){const u=(0,b.UI)(t,l=>Fn(l));o=function eoe(n,e,t){const r=ln.fromObject(t);return Gh(n,new qh({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,s,u)}else{const u=Fn(t);o=Am(n.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Kh(n,s)),ps(n.eventQueue_,a,o)}function qj(n,e){TS(n,"connected",e),!1===e&&function Soe(n){Wh(n,"onDisconnectEvents");const e=Om(n),t=NI();ZA(n.onDisconnect_,Nt(),(i,s)=>{const o=xj(i,s,n.serverSyncTree_,e);Hh(t,i,o)});let r=[];ZA(t,Nt(),(i,s)=>{r=r.concat(Am(n.serverSyncTree_,i,s));const o=AS(n,i);Kh(n,o)}),n.onDisconnect_=NI(),ps(n.eventQueue_,Nt(),r)}(n)}function TS(n,e,t){const r=new Vt("/.info/"+e),i=Fn(t);n.infoData_.updateSnapshot(r,i);const s=Am(n.infoSyncTree_,r,i);ps(n.eventQueue_,r,s)}function ZI(n){return n.nextWriteId_++}function CS(n,e,t,r,i){Wh(n,"set",{path:e.toString(),value:t,priority:r});const s=Om(n),o=Fn(t,r),a=HI(n.serverSyncTree_,e),u=mS(o,a,s),l=ZI(n),d=lS(n.serverSyncTree_,e,u,l,!0);KI(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(m,_)=>{const v="ok"===m;v||ni("set at "+e+" failed: "+m);const T=ju(n.serverSyncTree_,l,!v);ps(n.eventQueue_,e,T),$u(0,i,m,_)});const f=AS(n,e);Kh(n,f),ps(n.eventQueue_,f,[])}function Roe(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&KA(n.onDisconnect_,e),$u(0,t,r,i)})}function zj(n,e,t,r){const i=Fn(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&Hh(n.onDisconnect_,e,i),$u(0,r,s,o)})}function bS(n,e,t){let r;r=".info"===ut(e._path)?$I(n.infoSyncTree_,e,t):$I(n.serverSyncTree_,e,t),Uj(n.eventQueue_,e._path,r)}function Gj(n){n.persistentConnection_&&n.persistentConnection_.interrupt(jj)}function Wh(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ar(t,...e)}function $u(n,e,t,r){e&&Vh(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function DS(n,e,t){return HI(n.serverSyncTree_,e,t)||Ye.EMPTY_NODE}function QI(n,e=n.transactionQueueTree_){if(e||YI(n,e),hc(e)){const t=Kj(n,e);(0,b.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function Ooe(n,e,t){const r=t.map(l=>l.currentWriteId),i=DS(n,e,r);let s=i;const o=i.hash();for(let l=0;l<t.length;l++){const d=t[l];(0,b.hu)(0===d.status,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Di(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;n.server_.put(u.toString(),a,l=>{Wh(n,"transaction put response",{path:u.toString(),status:l});let d=[];if("ok"===l){const f=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat(ju(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&f.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();YI(n,zI(n.transactionQueueTree_,e)),QI(n,n.transactionQueueTree_),ps(n.eventQueue_,e,d);for(let m=0;m<f.length;m++)Vh(f[m])}else{if("datastale"===l)for(let f=0;f<t.length;f++)t[f].status=3===t[f].status?4:0;else{ni("transaction at "+u.toString()+" failed: "+l);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=l}Kh(n,e)}},o)}(n,Pm(e),t)}else kj(e)&&GI(e,t=>{QI(n,t)})}function Kh(n,e){const t=Wj(n,e),r=Pm(t);return function Foe(n,e,t){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=Di(t,u.path);let f,d=!1;if((0,b.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,f=u.abortReason,i=i.concat(ju(n.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=woe)d=!0,f="maxretry",i=i.concat(ju(n.serverSyncTree_,u.currentWriteId,!0));else{const m=DS(n,u.path,o);u.currentInputSnapshot=m;const _=e[a].update(m.val());if(void 0!==_){Mm("transaction failed: Data returned ",_,u.path);let v=Fn(_);"object"==typeof _&&null!=_&&(0,b.r3)(_,".priority")||(v=v.updatePriority(m.getPriority()));const D=u.currentWriteId,k=Om(n),P=mS(v,m,k);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=P,u.currentWriteId=ZI(n),o.splice(o.indexOf(D),1),i=i.concat(lS(n.serverSyncTree_,u.path,P,u.currentWriteId,u.applyLocally)),i=i.concat(ju(n.serverSyncTree_,D,!0))}else d=!0,f="nodata",i=i.concat(ju(n.serverSyncTree_,u.currentWriteId,!0))}ps(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===f?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(f),!1,null)))}YI(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Vh(r[a]);QI(n,n.transactionQueueTree_)}(n,Kj(n,t),r),r}function Wj(n,e){let t,r=n.transactionQueueTree_;for(t=ut(e);null!==t&&void 0===hc(r);)r=zI(r,t),t=ut(e=Yt(e));return r}function Kj(n,e){const t=[];return Zj(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Zj(n,e,t){const r=hc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);GI(e,i=>{Zj(n,i,t)})}function YI(n,e){const t=hc(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,vS(e,t.length>0?t:void 0)}GI(e,r=>{YI(n,r)})}function AS(n,e){const t=Pm(Wj(n,e)),r=zI(n.transactionQueueTree_,e);return function foe(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{SS(n,i)}),SS(n,r),Oj(r,i=>{SS(n,i)}),t}function SS(n,e){const t=hc(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?((0,b.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):((0,b.hu)(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(ju(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?vS(e,void 0):t.length=s+1,ps(n.eventQueue_,Pm(e),i);for(let o=0;o<r.length;o++)Vh(r[o])}}const RS=function(n,e){const t=Uoe(n),r=t.namespace;return"firebase.com"===t.domain&&jo(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&jo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ni("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new NA(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new Vt(t.pathString)}},Uoe=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof n){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");-1===d&&(d=n.length);let f=n.indexOf("?");-1===f&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=function Loe(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(d,f)));const m=function Voe(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ni(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,f)));l=e.indexOf(":"),l>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(l+1),10)):l=e.length;const _=e.slice(0,l);if("localhost"===_.toLowerCase())t="localhost";else if(_.split(".").length<=2)t=_;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},Qj="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Boe=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const s=new Array(8);for(i=7;i>=0;i--)s[i]=Qj.charAt(t%64),t=Math.floor(t/64);(0,b.hu)(0===t,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=Qj.charAt(e[i]);return(0,b.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class Yj{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,b.Wl)(this.snapshot.exportVal())}}class Xj{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class PS{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,b.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Jj{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new b.BH;return Roe(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Hs("OnDisconnect.remove",this._path);const e=new b.BH;return zj(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Hs("OnDisconnect.set",this._path),qo("OnDisconnect.set",e,this._path,!1);const t=new b.BH;return zj(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Hs("OnDisconnect.setWithPriority",this._path),qo("OnDisconnect.setWithPriority",e,this._path,!1),wS("OnDisconnect.setWithPriority",t,!1);const r=new b.BH;return function Poe(n,e,t,r,i){const s=Fn(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&Hh(n.onDisconnect_,e,s),$u(0,i,o,a)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Hs("OnDisconnect.update",this._path),Lj("OnDisconnect.update",e,this._path,!1);const t=new b.BH;return function Noe(n,e,t,r){if((0,b.xb)(t))return Ar("onDisconnect().update() called with empty data.  Don't do anything."),void $u(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{"ok"===i&&Sr(t,(o,a)=>{const u=Fn(a);Hh(n.onDisconnect_,An(e,o),u)}),$u(0,r,i,s)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Gi{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return lt(this._path)?null:LA(this._path)}get ref(){return new qs(this._repo,this._path)}get _queryIdentifier(){const e=rj(this._queryParams),t=RA(e);return"{}"===t?"default":t}get _queryObject(){return rj(this._queryParams)}isEqual(e){if(!((e=(0,b.m9)(e))instanceof Gi))return!1;const t=this._repo===e._repo,r=VA(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Nie(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function XI(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hu(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===$o){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ku)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==La)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===un){if(null!=e&&!Nm(e)||null!=t&&!Nm(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,b.hu)(n.getIndex()instanceof HA||n.getIndex()===qA,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function JI(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class qs extends Gi{constructor(e,t){super(e,t,new SI,!1)}get parent(){const e=zB(this._path);return null===e?null:new qs(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class fc{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Vt(e),r=pc(this.ref,e);return new fc(this._node.getChild(t),r,un)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new fc(i,pc(this.ref,r),un)))}hasChild(e){const t=new Vt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function e$(n,e){return(n=(0,b.m9)(n))._checkNotDeleted("ref"),void 0!==e?pc(n._root,e):n._root}function t$(n,e){(n=(0,b.m9)(n))._checkNotDeleted("refFromURL");const t=RS(e,n._repo.repoInfo_.nodeAdmin);Vj("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&jo("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),e$(n,t.path.toString())}function pc(n,e){return null===ut((n=(0,b.m9)(n))._path)?voe("child","path",e,!1):km("child","path",e,!1),new qs(n._repo,An(n._path,e))}function NS(n,e){n=(0,b.m9)(n),Hs("set",n._path),qo("set",e,n._path,!1);const t=new b.BH;return CS(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function zoe(n,e){Lj("update",e,n._path,!1);const t=new b.BH;return function Aoe(n,e,t,r){Wh(n,"update",{path:e.toString(),value:t});let i=!0;const s=Om(n),o={};if(Sr(t,(a,u)=>{i=!1,o[a]=xj(An(e,a),Fn(u),n.serverSyncTree_,s)}),i)Ar("update() called with empty data.  Don't do anything."),$u(0,r,"ok",void 0);else{const a=ZI(n),u=function Jse(n,e,t,r){!function mse(n,e,t,r){(0,b.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=eS(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=ln.fromObject(t);return Gh(n,new qh({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,o,a);KI(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,d)=>{const f="ok"===l;f||ni("update at "+e+" failed: "+l);const m=ju(n.serverSyncTree_,a,!f),_=m.length>0?Kh(n,e):e;ps(n.eventQueue_,_,m),$u(0,r,l,d)}),Sr(t,l=>{const d=AS(n,An(e,l));Kh(n,d)}),ps(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Goe(n){n=(0,b.m9)(n);const e=new PS(()=>{}),t=new Fm(e);return function Doe(n,e,t){const r=function ioe(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{const f=Di(l,t);r=r||Uu(d,f)});let i=n.syncPointTree_.get(t);i?r=r||Uu(i,Nt()):(i=new wj,n.syncPointTree_=n.syncPointTree_.set(t,i));const s=null!=r,o=s?new Lu(r,!0,!1):null;return function jse(n){return kI(n.viewCache_)}(Tj(i,e,OI(n.pendingWriteTree_,e._path),s?o.getNode():Ye.EMPTY_NODE,s))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const s=Fn(i).withIndex(e._queryParams.getIndex());let o;if(cS(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())o=Am(n.serverSyncTree_,e._path,s);else{const a=Sm(n.serverSyncTree_,e);o=Sj(n.serverSyncTree_,e._path,s,a)}return ps(n.eventQueue_,e._path,o),$I(n.serverSyncTree_,e,t,null,!0),s},i=>(Wh(n,"get for query "+(0,b.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new fc(r,new qs(n._repo,n._path),n._queryParams.getIndex()))}class Fm{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new Yj("value",this,new fc(e.snapshotNode,new qs(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Xj(this,e,t):null}matches(e){return e instanceof Fm&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class ew{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Xj(this,e,t):null}createEvent(e,t){(0,b.hu)(null!=e.childName,"Child events should have a childName.");const r=pc(new qs(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Yj(e.type,this,new fc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ew&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Lm(n,e,t,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=t,l=(d,f)=>{bS(n._repo,n,a),u(d,f)};l.userCallback=t.userCallback,l.context=t.context,t=l}const o=new PS(t,s||void 0),a="value"===e?new Fm(o):new ew(e,o);return function Moe(n,e,t){let r;r=".info"===ut(e._path)?cS(n.infoSyncTree_,e,t):cS(n.serverSyncTree_,e,t),Uj(n.eventQueue_,e._path,r)}(n._repo,n,a),()=>bS(n._repo,n,a)}function MS(n,e,t,r){return Lm(n,"value",e,t,r)}function n$(n,e,t,r){return Lm(n,"child_added",e,t,r)}function r$(n,e,t,r){return Lm(n,"child_changed",e,t,r)}function i$(n,e,t,r){return Lm(n,"child_moved",e,t,r)}function s$(n,e,t,r){return Lm(n,"child_removed",e,t,r)}function o$(n,e,t){let r=null;const i=t?new PS(t):null;"value"===e?r=new Fm(i):e&&(r=new ew(e,i)),bS(n._repo,n,r)}class ho{}class a$ extends ho{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("endAt",this._value,e._path,!0);const t=WA(e._queryParams,this._value,this._key);if(JI(t),Hu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gi(e._repo,e._path,t,e._orderByCalled)}}class Koe extends ho{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("endBefore",this._value,e._path,!1);const t=function rse(n,e,t){let r;return r=WA(n,e,n.index_===$o||t?t:ku),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(JI(t),Hu(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gi(e._repo,e._path,t,e._orderByCalled)}}class u$ extends ho{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("startAt",this._value,e._path,!0);const t=GA(e._queryParams,this._value,this._key);if(JI(t),Hu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Gi(e._repo,e._path,t,e._orderByCalled)}}class Yoe extends ho{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("startAfter",this._value,e._path,!1);const t=function nse(n,e,t){let r;return r=GA(n,e,n.index_===$o||t?t:La),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(JI(t),Hu(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Gi(e._repo,e._path,t,e._orderByCalled)}}class Joe extends ho{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gi(e._repo,e._path,function ese(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class tae extends ho{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gi(e._repo,e._path,function tse(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class rae extends ho{constructor(e){super(),this._path=e}_apply(e){XI(e,"orderByChild");const t=new Vt(this._path);if(lt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new HA(t),i=RI(e._queryParams,r);return Hu(i),new Gi(e._repo,e._path,i,!0)}}class sae extends ho{_apply(e){XI(e,"orderByKey");const t=RI(e._queryParams,$o);return Hu(t),new Gi(e._repo,e._path,t,!0)}}class aae extends ho{_apply(e){XI(e,"orderByPriority");const t=RI(e._queryParams,un);return Hu(t),new Gi(e._repo,e._path,t,!0)}}class lae extends ho{_apply(e){XI(e,"orderByValue");const t=RI(e._queryParams,qA);return Hu(t),new Gi(e._repo,e._path,t,!0)}}class dae extends ho{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(qo("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new a$(this._value,this._key)._apply(new u$(this._value,this._key)._apply(e))}}function fo(n,...e){let t=(0,b.m9)(n);for(const r of e)t=r._apply(t);return t}(function zse(n){(0,b.hu)(!UI,"__referenceConstructor has already been defined"),UI=n})(qs),function Qse(n){(0,b.hu)(!jI,"__referenceConstructor has already been defined"),jI=n}(qs);const xS={};function kS(n,e,t,r,i){let s=r||n.options.databaseURL;void 0===s&&(n.options.projectId||jo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ar("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let u,l,o=RS(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=RS(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const d=i&&u?new gm(gm.OWNER):new oie(n.name,n.options,e);Vj("Invalid Firebase Database URL",o),lt(o.path)||jo("Database URL must point to the root of a Firebase Database (not including a child path).");const f=function mae(n,e,t,r){let i=xS[e.name];i||(i={},xS[e.name]=i);let s=i[n.toURLString()];return s&&jo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Toe(n,false,t,r),i[n.toURLString()]=s,s}(a,n,d,new sie(n.name,t));return new yae(f,n)}class yae{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Coe(n,e,t){if(n.stats_=kA(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new PI(n.repoInfo_,(r,i,s,o)=>{Hj(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>qj(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,b.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new uc(n.repoInfo_,e,(r,i,s,o)=>{Hj(n,r,i,s,o)},r=>{qj(n,r)},r=>{!function boe(n,e){Sr(e,(t,r)=>{TS(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function lie(n,e){const t=n.toString();return xA[t]||(xA[t]=e()),xA[t]}(n.repoInfo_,()=>new lse(n.stats_,n.server_)),n.infoData_=new ise,n.infoSyncTree_=new Aj({startListening:(r,i,s,o)=>{let a=[];const u=n.infoData_.getNode(r._path);return u.isEmpty()||(a=Am(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),TS(n,"connected",!1),n.serverSyncTree_=new Aj({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,u)=>{const l=o(a,u);ps(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new qs(this._repo,Nt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function gae(n,e){const t=xS[e];(!t||t[n.key]!==n)&&jo(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Gj(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&jo("Cannot call "+e+" on a deleted database.")}}function c$(){xB.IS_TRANSPORT_INITIALIZED&&ni("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vae(){c$(),Ou.forceDisallow()}function Eae(){c$(),Uh.forceDisallow(),Ou.forceAllow()}function Tae(n,e){fB(n,e)}const bae={".sv":"timestamp"};class Sae{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}uc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},uc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Cae(n){DA(qi.SDK_VERSION),(0,qi._registerComponent)(new uo.wA("database",(e,{instanceIdentifier:t})=>kS(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(aB,"1.0.1",n),(0,qi.registerVersion)(aB,"1.0.1","esm2017")}();const Mae=new hs.Yd("@firebase/database-compat"),h$=function(n){Mae.warn("FIREBASE WARNING: "+n)};class Oae{constructor(e){this._delegate=e}cancel(e){(0,b.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,b.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,b.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,b.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,b.Dv)("OnDisconnect.set",1,2,arguments.length),(0,b.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,b.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,b.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if((0,b.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,h$("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,b.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class Fae{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,b.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class qu{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,b.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,b.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,b.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,b.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,b.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),km("DataSnapshot.child","path",e,!1),new qu(this._database,this._delegate.child(e))}hasChild(e){return(0,b.Dv)("DataSnapshot.hasChild",1,1,arguments.length),km("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,b.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,b.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,b.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new qu(this._database,t)))}hasChildren(){return(0,b.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,b.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,b.Dv)("DataSnapshot.ref",0,0,arguments.length),new gs(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class jr{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;(0,b.Dv)("Query.on",2,4,arguments.length),(0,b.Wj)("Query.on","callback",t,!1);const o=jr.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new qu(this.database,l),d)};a.userCallback=t,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return MS(this._delegate,a,u),t;case"child_added":return n$(this._delegate,a,u),t;case"child_removed":return s$(this._delegate,a,u),t;case"child_changed":return r$(this._delegate,a,u),t;case"child_moved":return i$(this._delegate,a,u),t;default:throw new Error((0,b.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,b.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,b.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,b.Wj)("Query.off","callback",t,!0),(0,b.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,o$(this._delegate,e,i)}else o$(this._delegate,e)}get(){return Goe(this._delegate).then(e=>new qu(this.database,e))}once(e,t,r,i){(0,b.Dv)("Query.once",1,4,arguments.length),(0,b.Wj)("Query.once","callback",t,!0);const s=jr.getCancelAndContextArgs_("Query.once",r,i),o=new b.BH,a=(l,d)=>{const f=new qu(this.database,l);t&&t.call(s.context,f,d),o.resolve(f)};a.userCallback=t,a.context=s.context;const u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":MS(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":n$(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":s$(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":r$(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":i$(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,b.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,b.Dv)("Query.limitToFirst",1,1,arguments.length),new jr(this.database,fo(this._delegate,function eae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Joe(n)}(e)))}limitToLast(e){return(0,b.Dv)("Query.limitToLast",1,1,arguments.length),new jr(this.database,fo(this._delegate,function nae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new tae(n)}(e)))}orderByChild(e){return(0,b.Dv)("Query.orderByChild",1,1,arguments.length),new jr(this.database,fo(this._delegate,function iae(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return km("orderByChild","path",n,!1),new rae(n)}(e)))}orderByKey(){return(0,b.Dv)("Query.orderByKey",0,0,arguments.length),new jr(this.database,fo(this._delegate,function oae(){return new sae}()))}orderByPriority(){return(0,b.Dv)("Query.orderByPriority",0,0,arguments.length),new jr(this.database,fo(this._delegate,function uae(){return new aae}()))}orderByValue(){return(0,b.Dv)("Query.orderByValue",0,0,arguments.length),new jr(this.database,fo(this._delegate,function cae(){return new lae}()))}startAt(e=null,t){return(0,b.Dv)("Query.startAt",0,2,arguments.length),new jr(this.database,fo(this._delegate,function Qoe(n=null,e){return xm("startAt","key",e,!0),new u$(n,e)}(e,t)))}startAfter(e=null,t){return(0,b.Dv)("Query.startAfter",0,2,arguments.length),new jr(this.database,fo(this._delegate,function Xoe(n,e){return xm("startAfter","key",e,!0),new Yoe(n,e)}(e,t)))}endAt(e=null,t){return(0,b.Dv)("Query.endAt",0,2,arguments.length),new jr(this.database,fo(this._delegate,function Woe(n,e){return xm("endAt","key",e,!0),new a$(n,e)}(e,t)))}endBefore(e=null,t){return(0,b.Dv)("Query.endBefore",0,2,arguments.length),new jr(this.database,fo(this._delegate,function Zoe(n,e){return xm("endBefore","key",e,!0),new Koe(n,e)}(e,t)))}equalTo(e,t){return(0,b.Dv)("Query.equalTo",1,2,arguments.length),new jr(this.database,fo(this._delegate,function hae(n,e){return xm("equalTo","key",e,!0),new dae(n,e)}(e,t)))}toString(){return(0,b.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,b.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,b.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof jr))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,b.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,b.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,b.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new gs(this.database,new qs(this._delegate._repo,this._delegate._path))}}class gs extends jr{constructor(e,t){super(e,new Gi(t._repo,t._path,new SI,!1)),this.database=e,this._delegate=t}getKey(){return(0,b.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,b.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new gs(this.database,pc(this._delegate,e))}getParent(){(0,b.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new gs(this.database,e):null}getRoot(){return(0,b.Dv)("Reference.root",0,0,arguments.length),new gs(this.database,this._delegate.root)}set(e,t){(0,b.Dv)("Reference.set",1,2,arguments.length),(0,b.Wj)("Reference.set","onComplete",t,!0);const r=NS(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,b.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,h$("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Hs("Reference.update",this._delegate._path),(0,b.Wj)("Reference.update","onComplete",t,!0);const r=zoe(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,b.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,b.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function qoe(n,e,t){if(Hs("setWithPriority",n._path),qo("setWithPriority",e,n._path,!1),wS("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new b.BH;return CS(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,b.Dv)("Reference.remove",0,1,arguments.length),(0,b.Wj)("Reference.remove","onComplete",e,!0);const t=function $oe(n){return Hs("remove",n._path),NS(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,b.Dv)("Reference.transaction",1,3,arguments.length),(0,b.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,b.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,b.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function Rae(n,e,t){var r;if(n=(0,b.m9)(n),Hs("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,s=new b.BH,a=MS(n,()=>{});return function koe(n,e,t,r,i,s){Wh(n,"transaction on "+e);const o={path:e,update:t,onComplete:r,status:null,order:cB(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=DS(n,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Mm("transaction failed: Data returned ",u,o.path),o.status=0;const l=zI(n.transactionQueueTree_,e),d=hc(l)||[];let f;d.push(o),vS(l,d),"object"==typeof u&&null!==u&&(0,b.r3)(u,".priority")?(f=(0,b.DV)(u,".priority"),(0,b.hu)(Nm(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(HI(n.serverSyncTree_,e)||Ye.EMPTY_NODE).getPriority().val();const m=Om(n),_=Fn(u,f),v=mS(_,a,m);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=v,o.currentWriteId=ZI(n);const T=lS(n.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);ps(n.eventQueue_,e,T),QI(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(u,l,d)=>{let f=null;u?s.reject(u):(f=new fc(d,new qs(n._repo,n._path),un),s.resolve(new Sae(l,f)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new Fae(s.committed,new qu(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){(0,b.Dv)("Reference.setPriority",1,2,arguments.length),(0,b.Wj)("Reference.setPriority","onComplete",t,!0);const r=function Hoe(n,e){n=(0,b.m9)(n),Hs("setPriority",n._path),wS("setPriority",e,!1);const t=new b.BH;return CS(n._repo,An(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,b.Dv)("Reference.push",0,2,arguments.length),(0,b.Wj)("Reference.push","onComplete",t,!0);const r=function joe(n,e){n=(0,b.m9)(n),Hs("push",n._path),qo("push",e,n._path,!0);const t=$j(n._repo),r=Boe(t),i=pc(n,r),s=pc(n,r);let o;return o=null!=e?NS(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new gs(this.database,o));t&&i.then(()=>t(null),o=>t(o));const s=new gs(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Hs("Reference.onDisconnect",this._delegate._path),new Oae(new Jj(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Vm{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:vae,forceLongPolling:Eae}}useEmulator(e,t,r={}){!function d$(n,e,t,r={}){(n=(0,b.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&jo("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&jo('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new gm(gm.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,b.Sg)(r.mockUserToken,n.app.options.projectId);s=new gm(o)}!function pae(n,e,t,r){n.repoInfo_=new NA(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,s)}(this._delegate,e,t,r)}ref(e){if((0,b.Dv)("database.ref",0,1,arguments.length),e instanceof gs){const t=t$(this._delegate,e.toString());return new gs(this,t)}{const t=e$(this._delegate,e);return new gs(this,t)}}refFromURL(e){(0,b.Dv)("database.refFromURL",1,1,arguments.length);const r=t$(this._delegate,e);return new gs(this,r)}goOffline(){return(0,b.Dv)("database.goOffline",0,0,arguments.length),function Iae(n){(n=(0,b.m9)(n))._checkNotDeleted("goOffline"),Gj(n._repo)}(this._delegate)}goOnline(){return(0,b.Dv)("database.goOnline",0,0,arguments.length),function wae(n){(n=(0,b.m9)(n))._checkNotDeleted("goOnline"),function xoe(n){n.persistentConnection_&&n.persistentConnection_.resume(jj)}(n._repo)}(this._delegate)}}Vm.ServerValue={TIMESTAMP:function Dae(){return bae}(),increment:n=>function Aae(n){return{".sv":{increment:n}}}(n)};var Vae=Object.freeze({__proto__:null,initStandalone:function Lae({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){DA(t);const a=new uo.H0("database-standalone"),u=new uo.zt("auth-internal",a);let l;return u.setComponent(new uo.wA("auth-internal",()=>r,"PRIVATE")),i&&(l=new uo.zt("app-check-internal",a),l.setComponent(new uo.wA("app-check-internal",()=>i,"PRIVATE"))),{instance:new Vm(kS(n,u,l,e,o),n),namespace:s}}});const Uae=Vm.ServerValue;function Um(n,e,t="on",r=cI){return new Ze(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===t&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===t?{unsubscribe(){null!=s&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(de(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),K())}function f$(n){return null==n}function p$(n){return"function"==typeof n.set}function g$(n,e){return p$(e)?e:n.ref(e)}function m$(n,e){if(function jae(n){return"string"==typeof n}(n))return e.stringCase();if(p$(n))return e.firebaseCase();if(function $ae(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function _$(n){return(f$(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function y$(n,e,t){return C(...(e=_$(e)).map(i=>Um(n,i,"on",t)))}function v$(n,e){return function(r,i){return m$(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Gae(n){return function(t){return t?m$(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function E$(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function Zae(n,e){const{payload:t,prevKey:r,key:i}=e,s=E$(n,i),o=function Kae(n,e){if(f$(e))return 0;{const t=E$(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(u=>u.payload.key!==t.key)).splice(o,0,e);else{if(null==r)return[e,...n];(n=n.slice()).splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=n.splice(s,1)[0];return(n=n.slice()).splice(o,0,a),n}return n;default:return n}}function I$(n,e,t){return function Wae(n,e,t){return Um(n,"value","once",t).pipe(ve(r=>{const i=[R(r)];return e.forEach(s=>i.push(Um(n,s,"on",t))),C(...i).pipe(Eh(Zae,[]))}),Fe())}(n,e=_$(e),t)}function w$(n,e){return function(){return Um(n,"value","on",e)}}!function Bae(n){n.INTERNAL.registerComponent(new uo.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Vm(i,r)},"PUBLIC").setServiceProps({Reference:gs,Query:jr,Database:Vm,DataSnapshot:qu,enableLogging:Tae,INTERNAL:Vae,ServerValue:Uae}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","1.0.1")}(fs.Z);const Xae=new le("angularfire2.realtimeDatabaseURL"),Jae=new le("angularfire2.database.use-emulator");let eue=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,u,l,d,f,m,_,v,T,D){this.schedulers=a;const k=u,P=om(t,o,r);l&&_A(P,o,d,m,_,v,f,T),this.database=fI(`${P.name}.database.${i}`,"AngularFireDatabase",P.name,()=>{const O=o.runOutsideAngular(()=>P.database(i||void 0));return k&&O.useEmulator(...k),O},[k])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>g$(this.database,t));let s=i;return r&&(s=r(i)),function Qae(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:v$(r,"update"),set:v$(r,"set"),push:i=>r.push(i),remove:Gae(r),snapshotChanges:i=>I$(n,i,t).pipe(tr),stateChanges:i=>y$(n,i,t).pipe(tr),auditTrail:i=>function Hae(n,e,t){return function zae(n,e,t){return function qae(n,e){return Um(n,"value","on",e).pipe(de(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function zre(...n){const e=ki(n);return Y((t,r)=>{const i=n.length,s=new Array(i);let o=n.map(()=>!1),a=!1;for(let u=0;u<i;u++)gt(n[u]).subscribe(ce(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(In))&&(o=null))},be));t.subscribe(ce(r,u=>{if(a){const l=[u,...s];r.next(e?e(...l):l)}}))})}(e),de(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function Gre(n){return Y((e,t)=>{let r=!1,i=0;e.subscribe(ce(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),de(i=>i.actions))}(n,y$(n,e).pipe(Eh((i,s)=>[...i,s],[])),t)}(n,i,t).pipe(tr),valueChanges:(i,s)=>I$(n,i,t).pipe(de(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),tr)}}(s,this)}object(t){return function Yae(n,e){return{query:n,snapshotChanges:()=>w$(n,e.schedulers.outsideAngular)().pipe(tr),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>w$(n,e.schedulers.outsideAngular)().pipe(tr,de(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>g$(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(W(xh),W(kh,8),W(Xae,8),W(Ls),W(wt),W(hI),W(Jae,8),W(tc,8),W(dA,8),W(hA,8),W(fA,8),W(pA,8),W(gA,8),W(mA,8),W(dI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),tue=(()=>{class n{constructor(){fs.Z.registerVersion("angularfire",Ph.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({providers:[eue]})}return n})();function OS(){return Y((n,e)=>{let t,r=!1;n.subscribe(ce(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var _e,nue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},po={},FS=FS||{},Ke=nue||self;function tw(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Bm(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var LS="closure_uid_"+(1e9*Math.random()>>>0),iue=0;function sue(n,e,t){return n.call.apply(n.bind,arguments)}function oue(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function ri(n,e,t){return(ri=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sue:oue).apply(null,arguments)}function nw(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Rr(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function zu(){this.s=this.s,this.o=this.o}zu.prototype.s=!1,zu.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function rue(n){Object.prototype.hasOwnProperty.call(n,LS)&&n[LS]||(n[LS]=++iue)}(this)},zu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const T$=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function VS(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function C$(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(tw(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function ii(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}ii.prototype.h=function(){this.defaultPrevented=!0};var uue=function(){if(!Ke.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ke.addEventListener("test",()=>{},e),Ke.removeEventListener("test",()=>{},e)}catch{}return n}();function jm(n){return/^[\s\xa0]*$/.test(n)}function rw(){var n=Ke.navigator;return n&&(n=n.userAgent)?n:""}function zo(n){return-1!=rw().indexOf(n)}function US(n){return US[" "](n),n}US[" "]=function(){};var jS,n,cue=zo("Opera"),Zh=zo("Trident")||zo("MSIE"),b$=zo("Edge"),BS=b$||Zh,D$=zo("Gecko")&&!(-1!=rw().toLowerCase().indexOf("webkit")&&!zo("Edge"))&&!(zo("Trident")||zo("MSIE"))&&!zo("Edge"),due=-1!=rw().toLowerCase().indexOf("webkit")&&!zo("Edge");function A$(){var n=Ke.document;return n?n.documentMode:void 0}e:{var $S="",HS=(n=rw(),D$?/rv:([^\);]+)(\)|;)/.exec(n):b$?/Edge\/([\d\.]+)/.exec(n):Zh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):due?/WebKit\/(\S+)/.exec(n):cue?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(HS&&($S=HS?HS[1]:""),Zh){var qS=A$();if(null!=qS&&qS>parseFloat($S)){jS=String(qS);break e}}jS=$S}var hue=Ke.document&&Zh&&(A$()||parseInt(jS,10))||void 0;function $m(n,e){if(ii.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(D$){e:{try{US(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:fue[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&$m.$.h.call(this)}}Rr($m,ii);var fue={2:"touch",3:"pen",4:"mouse"};$m.prototype.h=function(){$m.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Hm="closure_listenable_"+(1e6*Math.random()|0),pue=0;function gue(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++pue,this.fa=this.ia=!1}function iw(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function GS(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function R$(n){const e={};for(const t in n)e[t]=n[t];return e}const P$="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N$(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<P$.length;s++)t=P$[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function sw(n){this.src=n,this.g={},this.h=0}function WS(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=T$(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(iw(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function KS(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}sw.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=KS(n,e,r,i);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new gue(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var ZS="closure_lm_"+(1e6*Math.random()|0),QS={};function M$(n,e,t,r,i){if(r&&r.once)return k$(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)M$(n,e[s],t,r,i);return null}return t=eR(t),n&&n[Hm]?n.O(e,t,Bm(r)?!!r.capture:!!r,i):x$(n,e,t,!1,r,i)}function x$(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=Bm(i)?!!i.capture:!!i,a=XS(n);if(a||(n[ZS]=a=new sw(n)),(t=a.add(e,t,r,o,s)).proxy)return t;if(r=function _ue(){const e=yue;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)uue||(i=o),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(F$(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function k$(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)k$(n,e[s],t,r,i);return null}return t=eR(t),n&&n[Hm]?n.P(e,t,Bm(r)?!!r.capture:!!r,i):x$(n,e,t,!0,r,i)}function O$(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)O$(n,e[s],t,r,i);else r=Bm(r)?!!r.capture:!!r,t=eR(t),n&&n[Hm]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=KS(s=n.g[e],t,r,i))&&(iw(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=XS(n))&&(e=n.g[e.toString()],n=-1,e&&(n=KS(e,t,r,i)),(t=-1<n?e[n]:null)&&YS(t))}function YS(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Hm])WS(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(F$(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=XS(e))?(WS(t,n),0==t.h&&(t.src=null,e[ZS]=null)):iw(n)}}}function F$(n){return n in QS?QS[n]:QS[n]="on"+n}function yue(n,e){if(n.fa)n=!0;else{e=new $m(e,this);var t=n.listener,r=n.la||n.src;n.ia&&YS(n),n=t.call(r,e)}return n}function XS(n){return(n=n[ZS])instanceof sw?n:null}var JS="__closure_events_fn_"+(1e9*Math.random()>>>0);function eR(n){return"function"==typeof n?n:(n[JS]||(n[JS]=function(e){return n.handleEvent(e)}),n[JS])}function Pr(){zu.call(this),this.i=new sw(this),this.S=this,this.J=null}function $r(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new ii(e,n);else if(e instanceof ii)e.target=e.target||n;else{var i=e;N$(e=new ii(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=ow(o,r,!0,e)&&i}if(i=ow(o=e.g=n,r,!0,e)&&i,i=ow(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=ow(o=e.g=t[s],r,!1,e)&&i}function ow(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,u=o.la||o.src;o.ia&&WS(n.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Rr(Pr,zu),Pr.prototype[Hm]=!0,Pr.prototype.removeEventListener=function(n,e,t,r){O$(this,n,e,t,r)},Pr.prototype.N=function(){if(Pr.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)iw(t[r]);delete n.g[e],n.h--}}this.J=null},Pr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Pr.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var tR=Ke.JSON.stringify;function Eue(){var n=nR;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var L$=new class vue{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new wue,n=>n.reset());class wue{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Tue(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Cue(n){Ke.setTimeout(()=>{throw n},0)}let qm,zm=!1,nR=new class Iue{constructor(){this.h=this.g=null}add(e,t){const r=L$.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},V$=()=>{const n=Ke.Promise.resolve(void 0);qm=()=>{n.then(bue)}};var bue=()=>{for(var n;n=Eue();){try{n.h.call(n.g)}catch(t){Cue(t)}var e=L$;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}zm=!1};function aw(n,e){Pr.call(this),this.h=n||1,this.g=e||Ke,this.j=ri(this.qb,this),this.l=Date.now()}function rR(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function iR(n,e,t){if("function"==typeof n)t&&(n=ri(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ri(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ke.setTimeout(n,e||0)}function U$(n){n.g=iR(()=>{n.g=null,n.i&&(n.i=!1,U$(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Rr(aw,Pr),(_e=aw.prototype).ga=!1,_e.T=null,_e.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$r(this,"tick"),this.ga&&(rR(this),this.start()))}},_e.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},_e.N=function(){aw.$.N.call(this),rR(this),delete this.g};class Due extends zu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:U$(this)}N(){super.N(),this.g&&(Ke.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gm(n){zu.call(this),this.h=n,this.g={}}Rr(Gm,zu);var B$=[];function j$(n,e,t,r){Array.isArray(t)||(t&&(B$[0]=t.toString()),t=B$);for(var i=0;i<t.length;i++){var s=M$(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function $$(n){GS(n.g,function(e,t){this.g.hasOwnProperty(t)&&YS(e)},n),n.g={}}function uw(){this.g=!0}function Qh(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Pue(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return tR(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Gm.prototype.N=function(){Gm.$.N.call(this),$$(this)},Gm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},uw.prototype.Ea=function(){this.g=!1},uw.prototype.info=function(){};var gc={},H$=null;function lw(){return H$=H$||new Pr}function q$(n){ii.call(this,gc.Ta,n)}function Wm(n){const e=lw();$r(e,new q$(e))}function z$(n,e){ii.call(this,gc.STAT_EVENT,n),this.stat=e}function Ai(n){const e=lw();$r(e,new z$(e,n))}function G$(n,e){ii.call(this,gc.Ua,n),this.size=e}function Km(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ke.setTimeout(function(){n()},e)}gc.Ta="serverreachability",Rr(q$,ii),gc.STAT_EVENT="statevent",Rr(z$,ii),gc.Ua="timingevent",Rr(G$,ii);var cw={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},W$={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function sR(){}function Z$(){}sR.prototype.h=null;var uR,Zm={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oR(){ii.call(this,"d")}function aR(){ii.call(this,"c")}function dw(){}function Qm(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Gm(this),this.P=Nue,this.V=new aw(n=BS?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Q$}function Q$(){this.i=null,this.g="",this.h=!1}Rr(oR,ii),Rr(aR,ii),Rr(dw,sR),dw.prototype.g=function(){return new XMLHttpRequest},dw.prototype.i=function(){return{}},uR=new dw;var Nue=45e3,lR={},hw={};function cR(n,e,t){n.L=1,n.v=mw(Ua(e)),n.s=t,n.S=!0,Y$(n,null)}function Y$(n,e){n.G=Date.now(),Ym(n),n.A=Ua(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),aH(t.i,"t",r),n.C=0,t=n.l.J,n.h=new Q$,n.g=NH(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Due(ri(n.Pa,n,n.g),n.O)),j$(n.U,n.g,"readystatechange",n.nb),e=n.I?R$(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Wm(),function Aue(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var d=l[0];l=l[1];var f=d.split("_");o=2<=f.length&&"type"==f[1]?o+(d+"=")+l+"&":o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.W,n.s)}function X$(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function J$(n,e,t){let i,r=!0;for(;!n.J&&n.C<t.length;){if(i=Mue(n,t),i==hw){4==e&&(n.o=4,Ai(14),r=!1),Qh(n.j,n.m,null,"[Incomplete Response]");break}if(i==lR){n.o=4,Ai(15),Qh(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Qh(n.j,n.m,i,null),dR(n,i)}X$(n)&&i!=hw&&i!=lR&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ai(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),yR(e),e.M=!0,Ai(11))):(Qh(n.j,n.m,t,"[Invalid Chunked Response]"),mc(n),Xm(n))}function Mue(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?hw:(t=Number(e.substring(t,r)),isNaN(t)?lR:(r+=1)+t>e.length?hw:(e=e.slice(r,r+t),n.C=r+t,e))}function Ym(n){n.Y=Date.now()+n.P,eH(n,n.P)}function eH(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Km(ri(n.lb,n),e)}function fw(n){n.B&&(Ke.clearTimeout(n.B),n.B=null)}function Xm(n){0==n.l.H||n.J||AH(n.l,n)}function mc(n){fw(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,rR(n.V),$$(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function dR(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||hR(t.i,n)))if(!n.K&&hR(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;ww(t),Ew(t)}_R(t),Ai(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Km(ri(t.ib,t),6e3));if(1>=cH(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else yc(t,11)}else if((n.K||t.g==n)&&ww(t),!jm(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const d=l[3];null!=d&&(t.ra=d,t.l.info("VER="+t.ra));const f=l[4];null!=f&&(t.Ga=f,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=r=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const _=n.g;if(_){const v=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||-1==v.indexOf("spdy")&&-1==v.indexOf("quic")&&-1==v.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(fR(s,s.h),s.h=null))}if(r.F){const T=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,gn(r.I,r.F,T))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((r=t).wa=PH(r,r.J?r.pa:null,r.Y),o.K){dH(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.B&&(fw(a),Ym(a)),r.g=o}else bH(r);0<t.j.length&&Iw(t)}else"stop"!=l[0]&&"close"!=l[0]||yc(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?yc(t,7):mR(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Wm()}catch{}}function tH(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(tw(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function kue(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(tw(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function xue(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(tw(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(_e=Qm.prototype).setTimeout=function(n){this.P=n},_e.nb=function(n){n=n.target;const e=this.M;e&&3==Go(n)?e.l():this.Pa(n)},_e.Pa=function(n){try{if(n==this.g)e:{const d=Go(this.g);var e=this.g.Ia();if(this.g.da(),!(3>d)&&(3!=d||BS||this.g&&(this.h.h||this.g.ja()||vH(this.g)))){this.J||4!=d||7==e||Wm(),fw(this);var t=this.g.da();this.ca=t;t:if(X$(this)){var r=vH(this.g);n="";var i=r.length,s=4==Go(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){mc(this),Xm(this);var o="";break t}this.h.i=new Ke.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function Sue(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,d,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!jm(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,Ai(12),mc(this),Xm(this);break e}Qh(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dR(this,t)}this.S?(J$(this,d,o),BS&&this.i&&3==d&&(j$(this.U,this.V,"tick",this.mb),this.V.start())):(Qh(this.j,this.m,o,null),dR(this,o)),4==d&&mc(this),this.i&&!this.J&&(4==d?AH(this.l,this):(this.i=!1,Ym(this)))}else(function Xue(n){const e={};n=(n.g&&2<=Go(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(jm(n[r]))continue;var t=Tue(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function mue(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Ai(12)):(this.o=0,Ai(13)),mc(this),Xm(this)}}}catch{}},_e.mb=function(){if(this.g){var n=Go(this.g),e=this.g.ja();this.C<e.length&&(fw(this),J$(this,n,e),this.i&&4!=n&&Ym(this))}},_e.cancel=function(){this.J=!0,mc(this)},_e.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Rue(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Wm(),Ai(17)),mc(this),this.o=2,Xm(this)):eH(this,this.Y-n)};var nH=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _c(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof _c){this.h=n.h,pw(this,n.j),this.s=n.s,this.g=n.g,gw(this,n.m),this.l=n.l;var e=n.i,t=new t_;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),rH(this,t),this.o=n.o}else n&&(e=String(n).match(nH))?(this.h=!1,pw(this,e[1]||"",!0),this.s=Jm(e[2]||""),this.g=Jm(e[3]||"",!0),gw(this,e[4]),this.l=Jm(e[5]||"",!0),rH(this,e[6]||"",!0),this.o=Jm(e[7]||"")):(this.h=!1,this.i=new t_(null,this.h))}function Ua(n){return new _c(n)}function pw(n,e,t){n.j=t?Jm(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function gw(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function rH(n,e,t){e instanceof t_?(n.i=e,function jue(n,e){e&&!n.j&&(Gu(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(sH(this,r),aH(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=e_(e,Uue)),n.i=new t_(e,n.h))}function gn(n,e,t){n.i.set(e,t)}function mw(n){return gn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Jm(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function e_(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Fue),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Fue(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}_c.prototype.toString=function(){var n=[],e=this.j;e&&n.push(e_(e,iH,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(e_(e,iH,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(e_(t,"/"==t.charAt(0)?Vue:Lue,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",e_(t,Bue)),n.join("")};var iH=/[#\/\?@]/g,Lue=/[#\?:]/g,Vue=/[#\?]/g,Uue=/[#\?@]/g,Bue=/#/g;function t_(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Gu(n){n.g||(n.g=new Map,n.h=0,n.i&&function Oue(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function sH(n,e){Gu(n),e=Yh(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function oH(n,e){return Gu(n),e=Yh(n,e),n.g.has(e)}function aH(n,e,t){sH(n,e),0<t.length&&(n.i=null,n.g.set(Yh(n,e),VS(t)),n.h+=t.length)}function Yh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function uH(n){this.l=n||Hue,n=Ke.PerformanceNavigationTiming?0<(n=Ke.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ke.g&&Ke.g.Ka&&Ke.g.Ka()&&Ke.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(_e=t_.prototype).add=function(n,e){Gu(this),this.i=null,n=Yh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},_e.forEach=function(n,e){Gu(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},_e.ta=function(){Gu(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},_e.Z=function(n){Gu(this);let e=[];if("string"==typeof n)oH(this,n)&&(e=e.concat(this.g.get(Yh(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},_e.set=function(n,e){return Gu(this),this.i=null,oH(this,n=Yh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},_e.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},_e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};var Hue=10;function lH(n){return!!n.h||!!n.g&&n.g.size>=n.j}function cH(n){return n.h?1:n.g?n.g.size:0}function hR(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function fR(n,e){n.g?n.g.add(e):n.h=e}function dH(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function hH(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return VS(n.i)}uH.prototype.cancel=function(){if(this.i=hH(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var que=class{stringify(n){return Ke.JSON.stringify(n,void 0)}parse(n){return Ke.JSON.parse(n,void 0)}};function zue(){this.g=new que}function Gue(n,e,t){const r=t||"";try{tH(n,function(i,s){let o=i;Bm(i)&&(o=tR(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function _w(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function n_(n){this.l=n.ec||null,this.j=n.ob||!1}function yw(n,e){Pr.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=pR,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Rr(n_,sR),n_.prototype.g=function(){return new yw(this.l,this.j)},n_.prototype.i=function(n){return function(){return n}}({}),Rr(yw,Pr);var pR=0;function fH(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function r_(n){n.readyState=4,n.l=null,n.j=null,n.A=null,i_(n)}function i_(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(_e=yw.prototype).open=function(n,e){if(this.readyState!=pR)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,i_(this)},_e.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Ke).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},_e.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,r_(this)),this.readyState=pR},_e.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,i_(this)),this.g&&(this.readyState=3,i_(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Ke.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fH(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},_e.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?r_(this):i_(this),3==this.readyState&&fH(this)}},_e.Za=function(n){this.g&&(this.response=this.responseText=n,r_(this))},_e.Ya=function(n){this.g&&(this.response=n,r_(this))},_e.ka=function(){this.g&&r_(this)},_e.setRequestHeader=function(n,e){this.v.append(n,e)},_e.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},_e.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(yw.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Kue=Ke.JSON.parse;function zn(n){Pr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=pH,this.L=this.M=!1}Rr(zn,Pr);var pH="",Zue=/^https?$/i,Que=["POST","PUT"];function gH(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,mH(n),vw(n)}function mH(n){n.F||(n.F=!0,$r(n,"complete"),$r(n,"error"))}function _H(n){if(n.h&&typeof FS<"u"&&(!n.C[1]||4!=Go(n)||2!=n.da()))if(n.v&&4==Go(n))iR(n.La,0,n);else if($r(n,"readystatechange"),4==Go(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===o){var i=String(n.I).match(nH)[1]||null;!i&&Ke.self&&Ke.self.location&&(i=Ke.self.location.protocol.slice(0,-1)),r=!Zue.test(i?i.toLowerCase():"")}t=r}if(t)$r(n,"complete"),$r(n,"success");else{n.m=6;try{var s=2<Go(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",mH(n)}}finally{vw(n)}}}function vw(n,e){if(n.g){yH(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||$r(n,"ready");try{t.onreadystatechange=r}catch{}}}function yH(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Ke.clearTimeout(n.A),n.A=null)}function Go(n){return n.g?n.g.readyState:0}function vH(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case pH:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function EH(n){let e="";return GS(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function gR(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=EH(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):gn(n,e,t))}function s_(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function IH(n){this.Ga=0,this.j=[],this.l=new uw,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=s_("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=s_("baseRetryDelayMs",5e3,n),this.hb=s_("retryDelaySeedMs",1e4,n),this.eb=s_("forwardChannelMaxRetries",2,n),this.xa=s_("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new uH(n&&n.concurrentRequestLimit),this.Ja=new zue,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function mR(n){if(wH(n),3==n.H){var e=n.W++,t=Ua(n.I);if(gn(t,"SID",n.K),gn(t,"RID",e),gn(t,"TYPE","terminate"),o_(n,t),(e=new Qm(n,n.l,e)).L=2,e.v=mw(Ua(t)),t=!1,Ke.navigator&&Ke.navigator.sendBeacon)try{t=Ke.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Ke.Image&&((new Image).src=e.v,t=!0),t||(e.g=NH(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ym(e)}RH(n)}function Ew(n){n.g&&(yR(n),n.g.cancel(),n.g=null)}function wH(n){Ew(n),n.u&&(Ke.clearTimeout(n.u),n.u=null),ww(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Ke.clearTimeout(n.m),n.m=null)}function Iw(n){if(!lH(n.i)&&!n.m){n.m=!0;var e=n.Na;qm||V$(),zm||(qm(),zm=!0),nR.add(e,n),n.C=0}}function TH(n,e){var t;t=e?e.m:n.W++;const r=Ua(n.I);gn(r,"SID",n.K),gn(r,"RID",t),gn(r,"AID",n.V),o_(n,r),n.o&&n.s&&gR(r,n.o,n.s),t=new Qm(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=CH(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),fR(n.i,t),cR(t,r,e)}function o_(n,e){n.na&&GS(n.na,function(t,r){gn(e,r,t)}),n.h&&tH({},function(t,r){gn(e,r,t)})}function CH(n,e,t){t=Math.min(n.j.length,t);var r=n.h?ri(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<t;u++){let l=i[u].g;const d=i[u].map;if(l-=s,0>l)s=Math.max(0,i[u].g-100),a=!1;else try{Gue(d,o,"req"+l+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function bH(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;qm||V$(),zm||(qm(),zm=!0),nR.add(e,n),n.A=0}}function _R(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Km(ri(n.Ma,n),SH(n,n.A)),n.A++,0))}function yR(n){null!=n.B&&(Ke.clearTimeout(n.B),n.B=null)}function DH(n){n.g=new Qm(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=Ua(n.wa);gn(e,"RID","rpc"),gn(e,"SID",n.K),gn(e,"AID",n.V),gn(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&gn(e,"TO",n.qa),gn(e,"TYPE","xmlhttp"),o_(n,e),n.o&&n.s&&gR(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=mw(Ua(e)),t.s=null,t.S=!0,Y$(t,n)}function ww(n){null!=n.v&&(Ke.clearTimeout(n.v),n.v=null)}function AH(n,e){var t=null;if(n.g==e){ww(n),yR(n),n.g=null;var r=2}else{if(!hR(n.i,e))return;t=e.F,dH(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;$r(r=lw(),new G$(r,t)),Iw(n)}else bH(n);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==r&&function Jue(n,e){return!(cH(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Km(ri(n.Na,n,e),SH(n,n.C)),n.C++,0)))}(n,e)||2==r&&_R(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:yc(n,5);break;case 4:yc(n,10);break;case 3:yc(n,6);break;default:yc(n,2)}}function SH(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function yc(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=ri(n.pb,n);t||(t=new _c("//www.google.com/images/cleardot.gif"),Ke.location&&"http"==Ke.location.protocol||pw(t,"https"),mw(t)),function Wue(n,e){const t=new uw;if(Ke.Image){const r=new Image;r.onload=nw(_w,t,r,"TestLoadImage: loaded",!0,e),r.onerror=nw(_w,t,r,"TestLoadImage: error",!1,e),r.onabort=nw(_w,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=nw(_w,t,r,"TestLoadImage: timeout",!1,e),Ke.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Ai(2);n.H=0,n.h&&n.h.za(e),RH(n),wH(n)}function RH(n){if(n.H=0,n.ma=[],n.h){const e=hH(n.i);(0!=e.length||0!=n.j.length)&&(C$(n.ma,e),C$(n.ma,n.j),n.i.i.length=0,VS(n.j),n.j.length=0),n.h.ya()}}function PH(n,e,t){var r=t instanceof _c?Ua(t):new _c(t);if(""!=r.g)e&&(r.g=e+"."+r.g),gw(r,r.m);else{var i=Ke.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new _c(null);r&&pw(s,r),e&&(s.g=e),i&&gw(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&gn(r,t,e),gn(r,"VER",n.ra),o_(n,r),r}function NH(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new zn(t&&n.Ha&&!n.va?new n_({ob:!0}):n.va)).Oa(n.J),e}function MH(){}function Tw(){if(Zh&&!(10<=Number(hue)))throw Error("Environmental error: no available transport.")}function ms(n,e){Pr.call(this),this.g=new IH(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!jm(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!jm(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Xh(this)}function xH(n){oR.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function kH(){aR.call(this),this.status=1}function Xh(n){this.g=n}function go(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function vR(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function qt(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(_e=zn.prototype).Oa=function(n){this.M=n},_e.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():uR.g(),this.C=function K$(n){return n.h||(n.h=n.i())}(this.u?this.u:uR),this.g.onreadystatechange=ri(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void gH(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Ke.FormData&&n instanceof Ke.FormData,!(0<=T$(Que,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{yH(this),0<this.B&&((this.L=function Yue(n){return Zh&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ri(this.ua,this)):this.A=iR(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){gH(this,s)}},_e.ua=function(){typeof FS<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$r(this,"timeout"),this.abort(8))},_e.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,$r(this,"complete"),$r(this,"abort"),vw(this))},_e.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vw(this,!0)),zn.$.N.call(this)},_e.La=function(){this.s||(this.G||this.v||this.l?_H(this):this.kb())},_e.kb=function(){_H(this)},_e.isActive=function(){return!!this.g},_e.da=function(){try{return 2<Go(this)?this.g.status:-1}catch{return-1}},_e.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},_e.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Kue(e)}},_e.Ia=function(){return this.m},_e.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(_e=IH.prototype).ra=8,_e.H=1,_e.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Qm(this,this.l,n);let s=this.s;if(this.U&&(s?(s=R$(s),N$(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=CH(this,i,e),gn(t=Ua(this.I),"RID",n),gn(t,"CVER",22),this.F&&gn(t,"X-HTTP-Session-Id",this.F),o_(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(EH(s)))+"&"+e:this.o&&gR(t,this.o,s)),fR(this.i,i),this.bb&&gn(t,"TYPE","init"),this.P?(gn(t,"$req",e),gn(t,"SID","null"),i.aa=!0,cR(i,t,null)):cR(i,t,e),this.H=2}}else 3==this.H&&(n?TH(this,n):0==this.j.length||lH(this.i)||TH(this))},_e.Ma=function(){if(this.u=null,DH(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Km(ri(this.jb,this),n)}},_e.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ai(10),Ew(this),DH(this))},_e.ib=function(){null!=this.v&&(this.v=null,Ew(this),_R(this),Ai(19))},_e.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Ai(2)):(this.l.info("Failed to ping google.com"),Ai(1))},_e.isActive=function(){return!!this.h&&this.h.isActive(this)},(_e=MH.prototype).Ba=function(){},_e.Aa=function(){},_e.za=function(){},_e.ya=function(){},_e.isActive=function(){return!0},_e.Va=function(){},Tw.prototype.g=function(n,e){return new ms(n,e)},Rr(ms,Pr),ms.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Ai(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=PH(n,null,n.Y),Iw(n)},ms.prototype.close=function(){mR(this.g)},ms.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=tR(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&Iw(e)},ms.prototype.N=function(){this.g.h=null,delete this.j,mR(this.g),delete this.g,ms.$.N.call(this)},Rr(xH,oR),Rr(kH,aR),Rr(Xh,MH),Xh.prototype.Ba=function(){$r(this.g,"a")},Xh.prototype.Aa=function(n){$r(this.g,new xH(n))},Xh.prototype.za=function(n){$r(this.g,new kH)},Xh.prototype.ya=function(){$r(this.g,"b")},Rr(go,function ele(){this.blockSize=-1}),go.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},go.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)vR(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){vR(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){vR(this,r),i=0;break}}this.h=i,this.i+=e},go.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var tle={};function ER(n){return-128<=n&&128>n?function lue(n,e){var t=tle;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new qt([0|e],0>e?-1:0)}):new qt([0|n],0>n?-1:0)}function Wo(n){if(isNaN(n)||!isFinite(n))return Jh;if(0>n)return Hr(Wo(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=IR;return new qt(e,0)}var IR=4294967296,Jh=ER(0),wR=ER(1),FH=ER(16777216);function Ba(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function zs(n){return-1==n.h}function Hr(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new qt(t,~n.h).add(wR)}function Cw(n,e){return n.add(Hr(e))}function bw(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function a_(n,e){this.g=n,this.h=e}function Dw(n,e){if(Ba(e))throw Error("division by zero");if(Ba(n))return new a_(Jh,Jh);if(zs(n))return e=Dw(Hr(n),e),new a_(Hr(e.g),Hr(e.h));if(zs(e))return e=Dw(n,Hr(e)),new a_(Hr(e.g),e.h);if(30<n.g.length){if(zs(n)||zs(e))throw Error("slowDivide_ only works with positive integers.");for(var t=wR,r=e;0>=r.X(n);)t=LH(t),r=LH(r);var i=ef(t,1),s=ef(r,1);for(r=ef(r,2),t=ef(t,2);!Ba(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(t),s=o),r=ef(r,1),t=ef(t,1)}return e=Cw(n,i.R(e)),new a_(i,e)}for(i=Jh;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Wo(t)).R(e);zs(o)||0<o.X(n);)o=(s=Wo(t-=r)).R(e);Ba(s)&&(s=wR),i=i.add(s),n=Cw(n,o)}return new a_(i,n)}function LH(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new qt(t,n.h)}function ef(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new qt(i,n.h)}(_e=qt.prototype).ea=function(){if(zs(this))return-Hr(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:IR+r)*e,e*=IR}return n},_e.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Ba(this))return"0";if(zs(this))return"-"+Hr(this).toString(n);for(var e=Wo(Math.pow(n,6)),t=this,r="";;){var i=Dw(t,e).g,s=((0<(t=Cw(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(Ba(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},_e.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},_e.X=function(n){return zs(n=Cw(this,n))?-1:Ba(n)?0:1},_e.abs=function(){return zs(this)?Hr(this):this},_e.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new qt(t,-2147483648&t[t.length-1]?-1:0)},_e.R=function(n){if(Ba(this)||Ba(n))return Jh;if(zs(this))return zs(n)?Hr(this).R(Hr(n)):Hr(Hr(this).R(n));if(zs(n))return Hr(this.R(Hr(n)));if(0>this.X(FH)&&0>n.X(FH))return Wo(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=n.D(i)>>>16,u=65535&n.D(i);t[2*r+2*i]+=o*u,bw(t,2*r+2*i),t[2*r+2*i+1]+=s*u,bw(t,2*r+2*i+1),t[2*r+2*i+1]+=o*a,bw(t,2*r+2*i+1),t[2*r+2*i+2]+=s*a,bw(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new qt(t,0)},_e.gb=function(n){return Dw(this,n).h},_e.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new qt(t,this.h&n.h)},_e.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new qt(t,this.h|n.h)},_e.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new qt(t,this.h^n.h)},Tw.prototype.createWebChannel=Tw.prototype.g,ms.prototype.send=ms.prototype.u,ms.prototype.open=ms.prototype.m,ms.prototype.close=ms.prototype.close,cw.NO_ERROR=0,cw.TIMEOUT=8,cw.HTTP_ERROR=6,W$.COMPLETE="complete",Z$.EventType=Zm,Zm.OPEN="a",Zm.CLOSE="b",Zm.ERROR="c",Zm.MESSAGE="d",Pr.prototype.listen=Pr.prototype.O,zn.prototype.listenOnce=zn.prototype.P,zn.prototype.getLastError=zn.prototype.Sa,zn.prototype.getLastErrorCode=zn.prototype.Ia,zn.prototype.getStatus=zn.prototype.da,zn.prototype.getResponseJson=zn.prototype.Wa,zn.prototype.getResponseText=zn.prototype.ja,zn.prototype.send=zn.prototype.ha,zn.prototype.setWithCredentials=zn.prototype.Oa,go.prototype.digest=go.prototype.l,go.prototype.reset=go.prototype.reset,go.prototype.update=go.prototype.j,qt.prototype.add=qt.prototype.add,qt.prototype.multiply=qt.prototype.R,qt.prototype.modulo=qt.prototype.gb,qt.prototype.compare=qt.prototype.X,qt.prototype.toNumber=qt.prototype.ea,qt.prototype.toString=qt.prototype.toString,qt.prototype.getBits=qt.prototype.D,qt.fromNumber=Wo,qt.fromString=function OH(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return Hr(OH(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Wo(Math.pow(e,8)),r=Jh,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),e);8>s?(s=Wo(Math.pow(e,s)),r=r.R(s).add(Wo(o))):r=(r=r.R(t)).add(Wo(o))}return r};var nle=po.createWebChannelTransport=function(){return new Tw},rle=po.getStatEventTarget=function(){return lw()},TR=po.ErrorCode=cw,ile=po.EventType=W$,sle=po.Event=gc,VH=po.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ole=po.FetchXmlHttpFactory=n_,Aw=po.WebChannel=Z$,ale=po.XhrIo=zn,ule=po.Md5=go,tf=po.Integer=qt;const UH="@firebase/firestore";class Nr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nr.UNAUTHENTICATED=new Nr(null),Nr.GOOGLE_CREDENTIALS=new Nr("google-credentials-uid"),Nr.FIRST_PARTY=new Nr("first-party-uid"),Nr.MOCK_USER=new Nr("mock-user");let nf="10.5.2";const Wu=new hs.Yd("@firebase/firestore");function rf(){return Wu.logLevel}function oe(n,...e){if(Wu.logLevel<=hs.in.DEBUG){const t=e.map(CR);Wu.debug(`Firestore (${nf}): ${n}`,...t)}}function nr(n,...e){if(Wu.logLevel<=hs.in.ERROR){const t=e.map(CR);Wu.error(`Firestore (${nf}): ${n}`,...t)}}function Wi(n,...e){if(Wu.logLevel<=hs.in.WARN){const t=e.map(CR);Wu.warn(`Firestore (${nf}): ${n}`,...t)}}function CR(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function we(n="Unexpected state"){const e=`FIRESTORE (${nf}) INTERNAL ASSERTION FAILED: `+n;throw nr(e),new Error(e)}function Pe(n,e){n||we()}function he(n,e){return n}const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends b.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class BH{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dle{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Nr.UNAUTHENTICATED))}shutdown(){}}class hle{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class fle{constructor(e){this.t=e,this.currentUser=Nr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable((0,Q.Z)(function*(){yield l.promise,yield s(r.currentUser)}))},u=l=>{oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vr)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe("string"==typeof r.accessToken),new BH(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Pe(null===e||"string"==typeof e),new Nr(e)}}class ple{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Nr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class gle{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ple(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Nr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class jH{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mle{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{null!=s.error&&oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Pe("string"==typeof t.token),this.R=t.token,new jH(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function _le(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class $H{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=_le(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function Ge(n,e){return n<e?-1:n>e?1:0}function sf(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function HH(n){return n+"\0"}class Sn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ne(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sn.fromMillis(Date.now())}static fromDate(e){return Sn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Sn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Sn(0,0))}static max(){return new Me(new Sn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class u_{constructor(e,t,r){void 0===t?t=0:t>e.length&&we(),void 0===r?r=e.length-t:r>e.length-t&&we(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===u_.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof u_?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Dt extends u_{construct(e,t,r){return new Dt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Dt(t)}static emptyPath(){return new Dt([])}}const yle=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mn extends u_{construct(e,t,r){return new mn(e,t,r)}static isValidIdentifier(e){return yle.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new mn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new ne(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new ne(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ne(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mn(t)}static emptyPath(){return new mn([])}}class fe{constructor(e){this.path=e}static fromPath(e){return new fe(Dt.fromString(e))}static fromName(e){return new fe(Dt.fromString(e).popFirst(5))}static empty(){return new fe(Dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Dt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Dt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fe(new Dt(e.slice()))}}class af{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function bR(n){return n.fields.find(e=>2===e.kind)}function vc(n){return n.fields.filter(e=>2!==e.kind)}af.UNKNOWN_ID=-1;class Ec{constructor(e,t){this.fieldPath=e,this.kind=t}}class uf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new uf(0,_s.min())}}function qH(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Me.fromTimestamp(1e9===r?new Sn(t+1,0):new Sn(t,r));return new _s(i,fe.empty(),e)}function zH(n){return new _s(n.readTime,n.key,-1)}class _s{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new _s(Me.min(),fe.empty(),-1)}static max(){return new _s(Me.max(),fe.empty(),-1)}}function DR(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=fe.comparator(n.documentKey,e.documentKey),0!==t?t:Ge(n.largestBatchId,e.largestBatchId))}const GH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ku(n){return AR.apply(this,arguments)}function AR(){return AR=(0,Q.Z)(function*(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==GH)throw n;oe("LocalStore","Unexpectedly lost primary lease")}),AR.apply(this,arguments)}class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(i=>i?V.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new V((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const l=u;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new V((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Sw{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new l_(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=SR(r.target.error);this.V.reject(new l_(e,i))}}static open(e,t,r,i){try{return new Sw(t,e.transaction(i,r))}catch(s){throw new l_(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(oe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new wle(t)}}class mo{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===mo.S((0,b.z$)())&&nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return oe("SimpleDb","Removing database:",e),Ic(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,b.hl)())return!1;if(mo.C())return!0;const e=(0,b.z$)(),t=mo.S(e),r=0<t&&t<10,i=mo.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,Q.Z)(function*(){return t.db||(oe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new l_(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new ne(H.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new ne(H.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new l_(e,a))},s.onupgradeneeded=o=>{oe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.N(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{oe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,Q.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=Sw.open(s.db,e,o?"readonly":"readwrite",r),l=i(u).next(d=>(u.g(),d)).catch(d=>(u.abort(d),V.reject(d))).toPromise();return l.catch(()=>{}),yield u.m,l}catch(u){const l=u,d="FirebaseError"!==l.name&&a<3;if(oe("SimpleDb","Transaction failed with error:",l.message,"Retrying:",d),s.close(),!d)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ile{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ic(this.k.delete())}}class l_ extends ne{constructor(e,t){super(H.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Zu(n){return"IndexedDbTransactionError"===n.name}class wle{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(oe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(oe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ic(r)}add(e){return oe("SimpleDb","ADD",this.store.name,e,e),Ic(this.store.add(e))}get(e){return Ic(this.store.get(e)).next(t=>(void 0===t&&(t=null),oe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return oe("SimpleDb","DELETE",this.store.name,e),Ic(this.store.delete(e))}count(){return oe("SimpleDb","COUNT",this.store.name),Ic(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new V((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new V((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,t){oe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new V((r,i)=>{t.onerror=s=>{const o=SR(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,t){const r=[];return new V((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new Ile(a),l=t(a.primaryKey,a.value,u);if(l instanceof V){const d=l.catch(f=>(u.done(),V.reject(f)));r.push(d)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>V.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ic(n){return new V((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=SR(r.target.error);t(i)}})}let KH=!1;function SR(n){const e=mo.S((0,b.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return KH||(KH=!0,setTimeout(()=>{throw r},0)),r}}return n}class Tle{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;oe("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Q.Z)(function*(){t.task=null;try{oe("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(r){Zu(r)?oe("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Ku(r)}yield t.ee(6e4)}))}}class Cle{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,Q.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.ne(r,e))})()}ne(e,t){const r=new Set;let i=t,s=!0;return V.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return oe("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(oe("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=zH(s);DR(o,r)>0&&(r=o)}),new _s(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let ys=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function c_(n){return null==n}function d_(n){return 0===n&&1/n==-1/0}function ZH(n){return"number"==typeof n&&Number.isInteger(n)&&!d_(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function si(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=QH(e)),e=ble(n.get(t),e);return QH(e)}function ble(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function QH(n){return n+"\x01\x01"}function Ko(n){const e=n.length;if(Pe(e>=2),2===e)return Pe("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Dt.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&we(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=n.substring(s,o),i+="\0";break;case"\x11":i+=n.substring(s,o+1);break;default:we()}s=o+2}return new Dt(r)}const YH=["userId","batchId"];function Rw(n,e){return[n,si(e)]}function XH(n,e,t){return[n,si(e),t]}const Dle={},Ale=["prefixPath","collectionGroup","readTime","documentId"],Sle=["prefixPath","collectionGroup","documentId"],Rle=["collectionGroup","readTime","prefixPath","documentId"],Ple=["canonicalId","targetId"],Nle=["targetId","path"],Mle=["path","targetId"],xle=["collectionId","parent"],kle=["indexId","uid"],Ole=["uid","sequenceNumber"],Fle=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Lle=["indexId","uid","orderedDocumentKey"],Vle=["userId","collectionPath","documentId"],Ule=["userId","collectionPath","largestBatchId"],Ble=["userId","collectionGroup","largestBatchId"],JH=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],jle=[...JH,"documentOverlays"],eq=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],tq=eq,$le=[...tq,"indexConfiguration","indexState","indexEntries"];class RR extends WH{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function Mr(n,e){const t=he(n);return mo.M(t.ae,e)}function nq(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rq(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class cn{constructor(e,t){this.comparator=e,this.root=t||qr.EMPTY}insert(e,t){return new cn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qr.BLACK,null,null))}remove(e){return new cn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pw(this.root,e,this.comparator,!0)}}class Pw{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??qr.RED,this.left=i??qr.EMPTY,this.right=s??qr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new qr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return qr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}}qr.EMPTY=null,qr.RED=!0,qr.BLACK=!1,qr.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,r,i,s){return this}insert(e,t,r){return new qr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wt{constructor(e){this.comparator=e,this.data=new cn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new iq(this.data.getIterator())}getIteratorFrom(e){return new iq(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Wt(this.comparator);return t.data=e,t}}class iq{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function lf(n){return n.hasNext()?n.getNext():void 0}class Ki{constructor(e){this.fields=e,e.sort(mn.comparator)}static empty(){return new Ki([])}unionWith(e){let t=new Wt(mn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ki(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sf(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class sq extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Er{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new sq("Invalid base64 string: "+s):s}}(e);return new Er(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Er(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Er.EMPTY_BYTE_STRING=new Er("");const qle=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yu(n){if(Pe(!!n),"string"==typeof n){let e=0;const t=qle.exec(n);if(Pe(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Gn(n.seconds),nanos:Gn(n.nanos)}}function Gn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function ja(n){return"string"==typeof n?Er.fromBase64String(n):Er.fromUint8Array(n)}function Nw(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Mw(n){const e=n.mapValue.fields.__previous_value__;return Nw(e)?Mw(e):e}function h_(n){const e=Yu(n.mapValue.fields.__local_write_time__.timestampValue);return new Sn(e.seconds,e.nanos)}class zle{constructor(e,t,r,i,s,o,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class Xu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Xu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Xu&&e.projectId===this.projectId&&e.database===this.database}}const Ju={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},xw={nullValue:"NULL_VALUE"};function el(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nw(n)?4:lq(n)?9007199254740991:10:we()}function Zo(n,e){if(n===e)return!0;const t=el(n);if(t!==el(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return h_(n).isEqual(h_(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Yu(i.timestampValue),a=Yu(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,ja(n.bytesValue).isEqual(ja(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Gn(i.geoPointValue.latitude)===Gn(s.geoPointValue.latitude)&&Gn(i.geoPointValue.longitude)===Gn(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Gn(i.integerValue)===Gn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Gn(i.doubleValue),a=Gn(s.doubleValue);return o===a?d_(o)===d_(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return sf(n.arrayValue.values||[],e.arrayValue.values||[],Zo);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(nq(o)!==nq(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!Zo(o[u],a[u])))return!1;return!0}(n,e);default:return we()}var s}function f_(n,e){return void 0!==(n.values||[]).find(t=>Zo(t,e))}function tl(n,e){if(n===e)return 0;const t=el(n),r=el(e);if(t!==r)return Ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Gn(s.integerValue||s.doubleValue),u=Gn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return oq(n.timestampValue,e.timestampValue);case 4:return oq(h_(n),h_(e));case 5:return Ge(n.stringValue,e.stringValue);case 6:return function(s,o){const a=ja(s),u=ja(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const d=Ge(a[l],u[l]);if(0!==d)return d}return Ge(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ge(Gn(s.latitude),Gn(o.latitude));return 0!==a?a:Ge(Gn(s.longitude),Gn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){const d=tl(a[l],u[l]);if(d)return d}return Ge(a.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ju.mapValue&&o===Ju.mapValue)return 0;if(s===Ju.mapValue)return 1;if(o===Ju.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=Ge(u[f],d[f]);if(0!==m)return m;const _=tl(a[u[f]],l[d[f]]);if(0!==_)return _}return Ge(u.length,d.length)}(n.mapValue,e.mapValue);default:throw we()}}function oq(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ge(n,e);const t=Yu(n),r=Yu(e),i=Ge(t.seconds,r.seconds);return 0!==i?i:Ge(t.nanos,r.nanos)}function cf(n){return PR(n)}function PR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Yu(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?ja(n.bytesValue).toBase64():"referenceValue"in n?fe.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=PR(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${PR(t.fields[o])}`;return i+"}"}(n.mapValue):we()}function wc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function NR(n){return!!n&&"integerValue"in n}function p_(n){return!!n&&"arrayValue"in n}function aq(n){return!!n&&"nullValue"in n}function uq(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ow(n){return!!n&&"mapValue"in n}function g_(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Qu(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=g_(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=g_(n.arrayValue.values[t]);return e}return Object.assign({},n)}function lq(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Gle(n){return"nullValue"in n?xw:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?wc(Xu.empty(),fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:we()}function Wle(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?wc(Xu.empty(),fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Ju:we()}function cq(n,e){const t=tl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function dq(n,e){const t=tl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class zr{constructor(e){this.value=e}static empty(){return new zr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ow(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=g_(t)}setAll(e){let t=mn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=g_(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Ow(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ow(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Qu(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new zr(g_(this.value))}}function hq(n){const e=[];return Qu(n.fields,(t,r)=>{const i=new mn([t]);if(Ow(r)){const s=hq(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ki(e)}class _n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new _n(e,0,Me.min(),Me.min(),Me.min(),zr.empty(),0)}static newFoundDocument(e,t,r,i){return new _n(e,1,t,Me.min(),r,i,0)}static newNoDocument(e,t){return new _n(e,2,t,Me.min(),Me.min(),zr.empty(),0)}static newUnknownDocument(e,t){return new _n(e,3,t,Me.min(),Me.min(),zr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof _n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class nl{constructor(e,t){this.position=e,this.inclusive=t}}function fq(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(r=s.field.isKeyField()?fe.comparator(fe.fromName(o.referenceValue),t.key):tl(o,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function pq(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Zo(n.position[t],e.position[t]))return!1;return!0}class m_{constructor(e,t="asc"){this.field=e,this.dir=t}}function Kle(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class gq{}class Tt extends gq{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Zle(e,t,r):"array-contains"===t?new Xle(e,r):"in"===t?new Iq(e,r):"not-in"===t?new Jle(e,r):"array-contains-any"===t?new ece(e,r):new Tt(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Qle(e,r):new Yle(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(tl(t,this.value)):null!==t&&el(this.value)===el(t)&&this.matchesComparison(tl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zt extends gq{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new zt(e,t)}matches(e){return df(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function df(n){return"and"===n.op}function MR(n){return"or"===n.op}function xR(n){return mq(n)&&df(n)}function mq(n){for(const e of n.filters)if(e instanceof zt)return!1;return!0}function kR(n){if(n instanceof Tt)return n.field.canonicalString()+n.op.toString()+cf(n.value);if(xR(n))return n.filters.map(e=>kR(e)).join(",");{const e=n.filters.map(t=>kR(t)).join(",");return`${n.op}(${e})`}}function _q(n,e){return n instanceof Tt?(r=n,(i=e)instanceof Tt&&r.op===i.op&&r.field.isEqual(i.field)&&Zo(r.value,i.value)):n instanceof zt?function(r,i){return i instanceof zt&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&_q(o,i.filters[a]),!0)}(n,e):void we();var r,i}function yq(n,e){const t=n.filters.concat(e);return zt.create(t,n.op)}function vq(n){return n instanceof Tt?`${(t=n).field.canonicalString()} ${t.op} ${cf(t.value)}`:n instanceof zt?function(t){return t.op.toString()+" {"+t.getFilters().map(vq).join(" ,")+"}"}(n):"Filter";var t}class Zle extends Tt{constructor(e,t,r){super(e,t,r),this.key=fe.fromName(r.referenceValue)}matches(e){const t=fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Qle extends Tt{constructor(e,t){super(e,"in",t),this.keys=Eq(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Yle extends Tt{constructor(e,t){super(e,"not-in",t),this.keys=Eq(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Eq(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>fe.fromName(r.referenceValue))}class Xle extends Tt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return p_(t)&&f_(t.arrayValue,this.value)}}class Iq extends Tt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&f_(this.value.arrayValue,t)}}class Jle extends Tt{constructor(e,t){super(e,"not-in",t)}matches(e){if(f_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!f_(this.value.arrayValue,t)}}class ece extends Tt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!p_(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>f_(this.value.arrayValue,r))}}class tce{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function OR(n,e=null,t=[],r=[],i=null,s=null,o=null){return new tce(n,e,t,r,i,s,o)}function Tc(n){const e=he(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>kR(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),c_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>cf(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>cf(r)).join(",")),e.ce=t}return e.ce}function __(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Kle(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_q(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pq(n.startAt,e.startAt)&&pq(n.endAt,e.endAt)}function Fw(n){return fe.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Lw(n,e){return n.filters.filter(t=>t instanceof Tt&&t.field.isEqual(e))}function wq(n,e,t){let r=xw,i=!0;for(const s of Lw(n,e)){let o=xw,a=!0;switch(s.op){case"<":case"<=":o=Gle(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=xw}cq({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];cq({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}function Tq(n,e,t){let r=Ju,i=!0;for(const s of Lw(n,e)){let o=Ju,a=!0;switch(s.op){case">=":case">":o=Wle(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ju}dq({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];dq({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}class $a{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function Cq(n,e,t,r,i,s,o,a){return new $a(n,e,t,r,i,s,o,a)}function hf(n){return new $a(n)}function bq(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function FR(n){return null!==n.collectionGroup}function ff(n){const e=he(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Wt(mn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new m_(s,r))}),t.has(mn.keyField().canonicalString())||e.le.push(new m_(mn.keyField(),r))}return e.le}function Si(n){const e=he(n);return e.he||(e.he=function Dq(n,e){if("F"===n.limitType)return OR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new m_(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new nl(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new nl(n.startAt.position,n.startAt.inclusive):null;return OR(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,ff(n))),e.he}function LR(n,e){const t=n.filters.concat([e]);return new $a(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vw(n,e,t){return new $a(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function y_(n,e){return __(Si(n),Si(e))&&n.limitType===e.limitType}function Aq(n){return`${Tc(Si(n))}|lt:${n.limitType}`}function pf(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>vq(i)).join(", ")}]`),c_(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>cf(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>cf(i)).join(",")),`Target(${r})`}(Si(n))}; limitType=${n.limitType})`}function v_(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):fe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of ff(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(o,a,u){const l=fq(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,ff(r),i)||r.endAt&&!function(o,a,u){const l=fq(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,ff(r),i)));var r,i}function Sq(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Rq(n){return(e,t)=>{let r=!1;for(const i of ff(n)){const s=nce(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function nce(n,e,t){const r=n.field.isKeyField()?fe.comparator(e.key,t.key):function(s,o,a){const u=o.data.field(s),l=a.data.field(s);return null!==u&&null!==l?tl(u,l):we()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return we()}}class Ha{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qu(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return rq(this.inner)}size(){return this.innerSize}}const rce=new cn(fe.comparator);function Zi(){return rce}const Pq=new cn(fe.comparator);function E_(...n){let e=Pq;for(const t of n)e=e.insert(t.key,t);return e}function Nq(n){let e=Pq;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qo(){return I_()}function Mq(){return I_()}function I_(){return new Ha(n=>n.toString(),(n,e)=>n.isEqual(e))}const ice=new cn(fe.comparator),sce=new Wt(fe.comparator);function tt(...n){let e=sce;for(const t of n)e=e.add(t);return e}const oce=new Wt(Ge);function VR(){return oce}function xq(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:d_(e)?"-0":e}}function kq(n){return{integerValue:""+n}}function Oq(n,e){return ZH(e)?kq(e):xq(n,e)}class Uw{constructor(){this._=void 0}}function ace(n,e,t){return n instanceof gf?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Nw(s)&&(s=Mw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Cc?Lq(n,e):n instanceof bc?Vq(n,e):function(i,s){const o=Fq(i,s),a=Uq(o)+Uq(i.Ie);return NR(o)&&NR(i.Ie)?kq(a):xq(i.serializer,a)}(n,e)}function uce(n,e,t){return n instanceof Cc?Lq(n,e):n instanceof bc?Vq(n,e):t}function Fq(n,e){return n instanceof mf?NR(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class gf extends Uw{}class Cc extends Uw{constructor(e){super(),this.elements=e}}function Lq(n,e){const t=Bq(e);for(const r of n.elements)t.some(i=>Zo(i,r))||t.push(r);return{arrayValue:{values:t}}}class bc extends Uw{constructor(e){super(),this.elements=e}}function Vq(n,e){let t=Bq(e);for(const r of n.elements)t=t.filter(i=>!Zo(i,r));return{arrayValue:{values:t}}}class mf extends Uw{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Uq(n){return Gn(n.integerValue||n.doubleValue)}function Bq(n){return p_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class w_{constructor(e,t){this.field=e,this.transform=t}}class cce{constructor(e,t){this.version=e,this.transformResults=t}}class Rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rn}static exists(e){return new Rn(void 0,e)}static updateTime(e){return new Rn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bw(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class jw{}function jq(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new yf(n.key,Rn.none()):new _f(n.key,n.data,Rn.none());{const t=n.data,r=zr.empty();let i=new Wt(mn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new qa(n.key,r,new Ki(i.toArray()),Rn.none())}}function dce(n,e,t){n instanceof _f?function(i,s,o){const a=i.value.clone(),u=qq(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof qa?function(i,s,o){if(!Bw(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=qq(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Hq(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function T_(n,e,t,r){return n instanceof _f?function(s,o,a,u){if(!Bw(s.precondition,o))return a;const l=s.value.clone(),d=zq(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof qa?function(s,o,a,u){if(!Bw(s.precondition,o))return a;const l=zq(s.fieldTransforms,u,o),d=o.data;return d.setAll(Hq(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):(a=t,Bw(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function hce(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Fq(r.transform,i||null);null!=s&&(null===t&&(t=zr.empty()),t.set(r.field,s))}return t||null}function $q(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&sf(r,i,(s,o)=>function lce(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof Cc&&i instanceof Cc||r instanceof bc&&i instanceof bc?sf(r.elements,i.elements,Zo):r instanceof mf&&i instanceof mf?Zo(r.Ie,i.Ie):r instanceof gf&&i instanceof gf);var r,i}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class _f extends jw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class qa extends jw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Hq(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function qq(n,e,t){const r=new Map;Pe(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,uce(o,a,t[i]))}return r}function zq(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,ace(s,o,e))}return r}class yf extends jw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UR extends jw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class BR{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&dce(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=T_(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=T_(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Mq();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const u=jq(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tt())}isEqual(e){return this.batchId===e.batchId&&sf(this.mutations,e.mutations,(t,r)=>$q(t,r))&&sf(this.baseMutations,e.baseMutations,(t,r)=>$q(t,r))}}class jR{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Pe(e.mutations.length===r.length);let i=ice;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new jR(e,t,r,i)}}class $R{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pce{constructor(e,t){this.count=e,this.unchangedNames=t}}var lr,At;function Gq(n){switch(n){default:return we();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function Wq(n){if(void 0===n)return nr("GRPC error has no .code"),H.UNKNOWN;switch(n){case lr.OK:return H.OK;case lr.CANCELLED:return H.CANCELLED;case lr.UNKNOWN:return H.UNKNOWN;case lr.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case lr.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case lr.INTERNAL:return H.INTERNAL;case lr.UNAVAILABLE:return H.UNAVAILABLE;case lr.UNAUTHENTICATED:return H.UNAUTHENTICATED;case lr.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case lr.NOT_FOUND:return H.NOT_FOUND;case lr.ALREADY_EXISTS:return H.ALREADY_EXISTS;case lr.PERMISSION_DENIED:return H.PERMISSION_DENIED;case lr.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case lr.ABORTED:return H.ABORTED;case lr.OUT_OF_RANGE:return H.OUT_OF_RANGE;case lr.UNIMPLEMENTED:return H.UNIMPLEMENTED;case lr.DATA_LOSS:return H.DATA_LOSS;default:return we()}}(At=lr||(lr={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";function Kq(){return new TextEncoder}const gce=new tf([4294967295,4294967295],0);function Zq(n){const e=Kq().encode(n),t=new ule;return t.update(e),new Uint8Array(t.digest())}function Qq(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new tf([t,r],0),new tf([i,s],0)]}class HR{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new C_(`Invalid padding: ${t}`);if(r<0)throw new C_(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new C_(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new C_(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=tf.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(tf.fromNumber(r)));return 1===i.compare(gce)&&(i=new tf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Zq(e),[r,i]=Qq(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new HR(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const t=Zq(e),[r,i]=Qq(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class C_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class b_{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,D_.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new b_(Me.min(),i,new cn(Ge),Zi(),tt())}}class D_{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new D_(r,t,tt(),tt(),tt())}}class Hw{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class Yq{constructor(e,t){this.targetId=e,this.fe=t}}class Xq{constructor(e,t,r=Er.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Jq{constructor(){this.ge=0,this.pe=tz(),this.ye=Er.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=tt(),t=tt(),r=tt();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:we()}}),new D_(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=tz()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class mce{constructor(e){this.Le=e,this.ke=new Map,this.qe=Zi(),this.Qe=ez(),this.Ke=new cn(Ge)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:we()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(Fw(s))if(0===r){const o=new fe(s.path);this.We(t,o,_n.newNoDocument(o,Me.min()))}else Pe(1===r);else{const o=this.Ze(t);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(t),this.Ke=this.Ke.insert(t,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=ja(r).toUint8Array()}catch(u){if(u instanceof sq)return Wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new HR(o,i,s)}catch(u){return Wi(u instanceof C_?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Fw(a.target)){const u=new fe(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,_n.newNoDocument(u,e))}s.De&&(t.set(o,s.ve()),s.Fe())}});let r=tt();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Ye(u);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new b_(e,t,this.Ke,this.qe,r);return this.qe=Zi(),this.Qe=ez(),this.Ke=new cn(Ge),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Jq,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Wt(Ge),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||oe("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Jq),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function ez(){return new cn(fe.comparator)}function tz(){return new cn(fe.comparator)}const _ce={asc:"ASCENDING",desc:"DESCENDING"},yce={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vce={and:"AND",or:"OR"};class Ece{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qR(n,e){return n.useProto3Json||c_(e)?e:{value:e}}function vf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nz(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ice(n,e){return vf(n,e.toTimestamp())}function rr(n){return Pe(!!n),Me.fromTimestamp(function(t){const r=Yu(t);return new Sn(r.seconds,r.nanos)}(n))}function zR(n,e){return(r=n,new Dt(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function rz(n){const e=Dt.fromString(n);return Pe(hz(e)),e}function A_(n,e){return zR(n.databaseId,e.path)}function Yo(n,e){const t=rz(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new fe(sz(t))}function GR(n,e){return zR(n.databaseId,e)}function iz(n){const e=rz(n);return 4===e.length?Dt.emptyPath():sz(e)}function S_(n){return new Dt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function sz(n){return Pe(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function oz(n,e,t){return{name:A_(n,e),fields:t.value.mapValue.fields}}function az(n,e,t){const r=Yo(n,e.name),i=rr(e.updateTime),s=e.createTime?rr(e.createTime):Me.min(),o=new zr({mapValue:{fields:e.fields}}),a=_n.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function R_(n,e){let t;if(e instanceof _f)t={update:oz(n,e.key,e.value)};else if(e instanceof yf)t={delete:A_(n,e.key)};else if(e instanceof qa)t={update:oz(n,e.key,e.data),updateMask:Rce(e.fieldMask)};else{if(!(e instanceof UR))return we();t={verify:A_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof gf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Cc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof bc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof mf)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw we()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Ice(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:we()),t;var s}function WR(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Rn.updateTime(rr(s.updateTime)):void 0!==s.exists?Rn.exists(s.exists):Rn.none():Rn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(Pe("REQUEST_TIME"===a.setToServerValue),u=new gf):"appendMissingElements"in a?u=new Cc(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new bc(a.removeAllFromArray.values||[]):"increment"in a?u=new mf(o,a.increment):we();const l=mn.fromServerFormat(a.fieldPath);return new w_(l,u)}(n,i)):[];var s;if(e.update){const i=Yo(n,e.update.name),s=new zr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ki((e.updateMask.fieldPaths||[]).map(d=>mn.fromServerFormat(d)));return new qa(i,s,o,t,r)}return new _f(i,s,t,r)}if(e.delete){const i=Yo(n,e.delete);return new yf(i,t)}if(e.verify){const i=Yo(n,e.verify);return new UR(i,t)}return we()}function uz(n,e){return{documents:[GR(n,e.path)]}}function KR(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=GR(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=GR(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return dz(zt.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(l=>{return{field:rl((f=l).field),direction:Dce(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=qR(n,e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),t;var u}function lz(n){let e=iz(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Pe(1===r);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){const m=cz(f);return m instanceof zt&&xR(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(m=>{return new m_(Ef((v=m).field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let a=null;t.limit&&(a=function(f){let m;return m="object"==typeof f?f.value:f,c_(m)?null:m}(t.limit));let u=null;var f;t.startAt&&(u=new nl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new nl(f.values||[],!f.before)}(t.endAt)),Cq(e,i,o,s,a,"F",u,l)}function cz(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ef(t.unaryFilter.field);return Tt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ef(t.unaryFilter.field);return Tt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ef(t.unaryFilter.field);return Tt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ef(t.unaryFilter.field);return Tt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return we()}}(n):void 0!==n.fieldFilter?Tt.create(Ef((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return zt.create(t.compositeFilter.filters.map(r=>cz(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we()}}(t.compositeFilter.op))}(n):we();var t}function Dce(n){return _ce[n]}function Ace(n){return yce[n]}function Sce(n){return vce[n]}function rl(n){return{fieldPath:n.canonicalString()}}function Ef(n){return mn.fromServerFormat(n.fieldPath)}function dz(n){return n instanceof Tt?function(t){if("=="===t.op){if(uq(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NAN"}};if(aq(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(uq(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NAN"}};if(aq(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rl(t.field),op:Ace(t.op),value:t.value}}}(n):n instanceof zt?function(t){const r=t.getFilters().map(i=>dz(i));return 1===r.length?r[0]:{compositeFilter:{op:Sce(t.op),filters:r}}}(n):we()}function Rce(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function hz(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class za{constructor(e,t,r,i,s=Me.min(),o=Me.min(),a=Er.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new za(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new za(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fz{constructor(e){this.ut=e}}function pz(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:qw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:A_(s=n.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:vf(s,o.version.toTimestamp()),createTime:vf(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Dc(e.version)};else{if(!e.isUnknownDocument())return we();r.unknownDocument={path:t.path.toArray(),version:Dc(e.version)}}var s,o;return r}function qw(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Dc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ac(n){const e=new Sn(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function Sc(n,e){const t=(e.baseMutations||[]).map(s=>WR(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>WR(n.ut,s)),i=Sn.fromMillis(e.localWriteTimeMs);return new BR(e.batchId,i,t,r)}function P_(n){const e=Ac(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Ac(n.lastLimboFreeSnapshotVersion):Me.min();let r;return r=void 0!==n.query.documents?(Pe(1===(s=n.query).documents.length),Si(hf(iz(s.documents[0])))):function(s){return Si(lz(s))}(n.query),new za(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Er.fromBase64String(n.resumeToken));var s}function gz(n,e){const t=Dc(e.snapshotVersion),r=Dc(e.lastLimboFreeSnapshotVersion);let i;i=Fw(e.target)?uz(n.ut,e.target):KR(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Tc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ZR(n){const e=lz({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Vw(e,e.limit,"L"):e}function QR(n,e){return new $R(e.largestBatchId,WR(n.ut,e.overlayMutation))}function mz(n,e){const t=e.path.lastSegment();return[n,si(e.path.popLast()),t]}function _z(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Dc(r.readTime),documentKey:si(r.documentKey.path),largestBatchId:r.largestBatchId}}class Nce{getBundleMetadata(e,t){return yz(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Ac(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return yz(e).put({bundleId:(i=t).id,createTime:Dc(rr(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return vz(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:ZR(s.bundledQuery),readTime:Ac(s.readTime)};var s})}saveNamedQuery(e,t){return vz(e).put({name:(i=t).name,readTime:Dc(rr(i.readTime)),bundledQuery:i.bundledQuery});var i}}function yz(n){return Mr(n,"bundles")}function vz(n){return Mr(n,"namedQueries")}class zw{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new zw(e,t.uid||"")}getOverlay(e,t){return N_(e).get(mz(this.userId,t)).next(r=>r?QR(this.serializer,r):null)}getOverlays(e,t){const r=Qo();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new $R(t,o);i.push(this.lt(e,a))}),V.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(si(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(N_(e).H("collectionPathOverlayIndex",a))}),V.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Qo(),s=si(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return N_(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const l=QR(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Qo();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return N_(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{const f=QR(this.serializer,l);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}lt(e,t){return N_(e).put(function(i,s,o){const[a,u,l]=mz(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:R_(i.ut,o.mutation)}}(this.serializer,this.userId,t))}}function N_(n){return Mr(n,"documentOverlays")}class Rc{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Gn(e.integerValue));else if("doubleValue"in e){const r=Gn(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),d_(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(ja(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?lq(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):we()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),fe.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function Mce(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Ez(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Mce(255&r[s]);if(i+=o,8!==o)break}return i}(n);return Math.ceil(e/8)}Rc.St=new Rc;class xce{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=Ez(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=Ez(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class kce{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Oce{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class M_{constructor(){this.Wt=new xce,this.Gt=new kce(this.Wt),this.zt=new Oce(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Pc{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Pc(this.indexId,this.documentKey,this.arrayValue,r)}}function il(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Iz(n.arrayValue,e.arrayValue),0!==t?t:(t=Iz(n.directionalValue,e.directionalValue),0!==t?t:fe.comparator(n.documentKey,e.documentKey)))}function Iz(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class wz{constructor(e){this.Jt=new Wt((t,r)=>mn.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Pe(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=bR(e);if(void 0!==t&&!this.tn(t))return!1;const r=vc(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Wt(mn.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Ec(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ec(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ec(r.field,"asc"===r.dir?0:1)));return new af(af.UNKNOWN_ID,this.collectionId,t,uf.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Tz(n){var e,t;if(Pe(n instanceof Tt||n instanceof zt),n instanceof Tt){if(n instanceof Iq){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Tt.create(n.field,"==",s)))||[];return zt.create(i,"or")}return n}const r=n.filters.map(i=>Tz(i));return zt.create(r,n.op)}function Fce(n){if(0===n.getFilters().length)return[];const e=JR(Tz(n));return Pe(Cz(e)),YR(e)||XR(e)?[e]:e.getFilters()}function YR(n){return n instanceof Tt}function XR(n){return n instanceof zt&&xR(n)}function Cz(n){return YR(n)||XR(n)||function(t){if(t instanceof zt&&MR(t)){for(const r of t.getFilters())if(!YR(r)&&!XR(r))return!1;return!0}return!1}(n)}function JR(n){if(Pe(n instanceof Tt||n instanceof zt),n instanceof Tt)return n;if(1===n.filters.length)return JR(n.filters[0]);const e=n.filters.map(r=>JR(r));let t=zt.create(e,n.op);return t=Gw(t),Cz(t)?t:(Pe(t instanceof zt),Pe(df(t)),Pe(t.filters.length>1),t.filters.reduce((r,i)=>eP(r,i)))}function eP(n,e){let t;return Pe(n instanceof Tt||n instanceof zt),Pe(e instanceof Tt||e instanceof zt),t=n instanceof Tt?e instanceof Tt?zt.create([n,e],"and"):bz(n,e):e instanceof Tt?bz(e,n):function(i,s){if(Pe(i.filters.length>0&&s.filters.length>0),df(i)&&df(s))return yq(i,s.getFilters());const o=MR(i)?i:s,a=MR(i)?s:i,u=o.filters.map(l=>eP(l,a));return zt.create(u,"or")}(n,e),Gw(t)}function bz(n,e){if(df(e))return yq(e,n.getFilters());{const t=e.filters.map(r=>eP(n,r));return zt.create(t,"or")}}function Gw(n){if(Pe(n instanceof Tt||n instanceof zt),n instanceof Tt)return n;const e=n.getFilters();if(1===e.length)return Gw(e[0]);if(mq(n))return n;const t=e.map(i=>Gw(i)),r=[];return t.forEach(i=>{i instanceof Tt?r.push(i):i instanceof zt&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:zt.create(r,n.op)}class Lce{constructor(){this.on=new tP}addToCollectionParentIndex(e,t){return this.on.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(_s.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(_s.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class tP{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Wt(Dt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Wt(Dt.comparator)).toArray()}}const Ww=new Uint8Array(0);class Vce{constructor(e,t){this.user=e,this.databaseId=t,this._n=new tP,this.an=new Ha(r=>Tc(r),(r,i)=>__(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:si(i)};return Dz(e).put(s)}return V.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[HH(t),""],!1,!0);return Dz(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(Ko(o.parent))}return r})}addFieldIndex(e,t){const r=x_(e),i={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(t.indexState){const o=wf(e);return s.next(a=>{o.put(_z(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=x_(e),i=wf(e),s=If(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=x_(e),r=If(e),i=wf(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return V.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new wz(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=If(e);let i=!0;const s=new Map;return V.forEach(this.un(t),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=tt();const a=[];return V.forEach(s,(u,l)=>{var O;oe("IndexedDbIndexManager",`Using index ${O=u,`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`} to execute ${Tc(t)}`);const d=function(O,q){const ue=bR(q);if(void 0===ue)return null;for(const Te of Lw(O,ue.fieldPath))switch(Te.op){case"array-contains-any":return Te.value.arrayValue.values||[];case"array-contains":return[Te.value]}return null}(l,u),f=function(O,q){const ue=new Map;for(const Te of vc(q))for(const Ue of Lw(O,Te.fieldPath))switch(Ue.op){case"==":case"in":ue.set(Te.fieldPath.canonicalString(),Ue.value);break;case"not-in":case"!=":return ue.set(Te.fieldPath.canonicalString(),Ue.value),Array.from(ue.values())}return null}(l,u),m=function(O,q){const ue=[];let Te=!0;for(const Ue of vc(q)){const St=0===Ue.kind?wq(O,Ue.fieldPath,O.startAt):Tq(O,Ue.fieldPath,O.startAt);ue.push(St.value),Te&&(Te=St.inclusive)}return new nl(ue,Te)}(l,u),_=function(O,q){const ue=[];let Te=!0;for(const Ue of vc(q)){const St=0===Ue.kind?Tq(O,Ue.fieldPath,O.endAt):wq(O,Ue.fieldPath,O.endAt);ue.push(St.value),Te&&(Te=St.inclusive)}return new nl(ue,Te)}(l,u),v=this.ln(u,l,m),T=this.ln(u,l,_),D=this.hn(u,l,f),k=this.Pn(u.indexId,d,v,m.inclusive,T,_.inclusive,D);return V.forEach(k,P=>r.j(P,t.limit).next(O=>{O.forEach(q=>{const ue=fe.fromSegments(q.documentKey);o.has(ue)||(o=o.add(ue),a.push(ue))})}))}).next(()=>a)}return V.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:Fce(zt.create(e.filters,"and")).map(r=>OR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,o,a){const u=(null!=t?t.length:1)*Math.max(r.length,s.length),l=u/(null!=t?t.length:1),d=[];for(let f=0;f<u;++f){const m=t?this.In(t[f/l]):Ww,_=this.Tn(e,m,r[f%l],i),v=this.En(e,m,s[f%l],o),T=a.map(D=>this.Tn(e,m,D,!0));d.push(...this.createRange(_,v,T))}return d}Tn(e,t,r,i){const s=new Pc(e,fe.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Pc(e,fe.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new wz(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.un(t);return V.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let l=new Wt(mn.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?d=!0:l=l.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}dn(e,t){const r=new M_;for(const i of vc(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);Rc.St.ht(s,o)}return r.Ut()}In(e){const t=new M_;return Rc.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new M_;return Rc.St.ht(wc(this.databaseId,t),r.jt(function(s){const o=vc(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(null===r)return[];let i=[];i.push(new M_);let s=0;for(const o of vc(e)){const a=r[s++];for(const u of i)if(this.Rn(t,o.fieldPath)&&p_(a))i=this.Vn(i,o,a);else{const l=u.jt(o.kind);Rc.St.ht(a,l)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new M_;u.seed(a.Ut()),Rc.St.ht(o,u.jt(t.kind)),s.push(u)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof Tt&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=x_(e),i=wf(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const o=[];return V.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new uf(f.sequenceNumber,new _s(Ac(f.readTime),new fe(Ko(f.documentKey)),f.largestBatchId)):uf.empty(),_=d.fields.map(([v,T])=>new Ec(mn.fromServerFormat(v),T));return new af(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ge(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=x_(e),s=wf(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,u=>s.put(_z(u.indexId,this.user,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),V.forEach(a,u=>this.gn(e,i,u).next(l=>{const d=this.pn(s,u);return l.isEqual(d)?V.resolve():this.yn(e,s,u,l,d)}))))})}wn(e,t,r,i){return If(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return If(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=If(e);let s=new Wt(il);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(o,a)=>{s=s.add(new Pc(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,t){let r=new Wt(il);const i=this.dn(t,e);if(null==i)return r;const s=bR(t);if(null!=s){const o=e.data.field(s.fieldPath);if(p_(o))for(const a of o.arrayValue.values||[])r=r.add(new Pc(t.indexId,e.key,this.In(a),i))}else r=r.add(new Pc(t.indexId,e.key,Ww,i));return r}yn(e,t,r,i,s){oe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,l,d,f,m){const _=u.getIterator(),v=l.getIterator();let T=lf(_),D=lf(v);for(;T||D;){let k=!1,P=!1;if(T&&D){const O=d(T,D);O<0?P=!0:O>0&&(k=!0)}else null!=T?P=!0:k=!0;k?(f(D),D=lf(v)):P?(m(T),T=lf(_)):(T=lf(_),D=lf(v))}}(i,s,il,a=>{o.push(this.wn(e,t,r,a))},a=>{o.push(this.Sn(e,t,r,a))}),V.waitFor(o)}fn(e){let t=1;return wf(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>il(o,a)).filter((o,a,u)=>!a||0!==il(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=il(o,e),u=il(o,t);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ww,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ww,[]]))}return s}bn(e,t){return il(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Az)}getMinOffset(e,t){return V.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||we())).next(Az)}}function Dz(n){return Mr(n,"collectionParents")}function If(n){return Mr(n,"indexEntries")}function x_(n){return Mr(n,"indexConfiguration")}function wf(n){return Mr(n,"indexState")}function Az(n){Pe(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;DR(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new _s(e.readTime,e.documentKey,t)}const Sz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class oi{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new oi(e,oi.DEFAULT_COLLECTION_PERCENTILE,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Rz(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.Y({range:o},(d,f,m)=>(a++,m.delete()));s.push(u.next(()=>{Pe(1===a)}));const l=[];for(const d of t.mutations){const f=XH(e,d.key.path,t.batchId);s.push(i.delete(f)),l.push(d.key)}return V.waitFor(s).next(()=>l)}function Kw(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we();e=n.noDocument}return JSON.stringify(e).length}oi.DEFAULT_COLLECTION_PERCENTILE=10,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oi.DEFAULT=new oi(41943040,oi.DEFAULT_COLLECTION_PERCENTILE,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oi.DISABLED=new oi(-1,0,0);class Zw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){Pe(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Zw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sl(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Tf(e),o=sl(e);return o.add({}).next(a=>{Pe("number"==typeof a);const u=new BR(a,t,r,i),l=function(_,v,T){const D=T.baseMutations.map(P=>R_(_.ut,P)),k=T.mutations.map(P=>R_(_.ut,P));return{userId:v,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:D,mutations:k}}(this.serializer,this.userId,u),d=[];let f=new Wt((m,_)=>Ge(m.canonicalString(),_.canonicalString()));for(const m of i){const _=XH(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,Dle))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),V.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return sl(e).get(t).next(r=>r?(Pe(r.userId===this.userId),Sc(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?V.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return sl(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(Pe(a.batchId>=r),s=Sc(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return sl(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return sl(e).W("userMutationsIndex",t).next(r=>r.map(i=>Sc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Rw(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Tf(e).Y({range:i},(o,a,u)=>{const[l,d,f]=o,m=Ko(d);if(l===this.userId&&t.path.isEqual(m))return sl(e).get(f).next(_=>{if(!_)throw we();Pe(_.userId===this.userId),s.push(Sc(this.serializer,_))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Wt(Ge);const i=[];return t.forEach(s=>{const o=Rw(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Tf(e).Y({range:a},(l,d,f)=>{const[m,_,v]=l,T=Ko(_);m===this.userId&&s.path.isEqual(T)?r=r.add(v):f.done()});i.push(u)}),V.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Rw(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Wt(Ge);return Tf(e).Y({range:o},(u,l,d)=>{const[f,m,_]=u,v=Ko(m);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(_)):d.done()}).next(()=>this.vn(e,a))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(sl(e).get(s).next(o=>{if(null===o)throw we();Pe(o.userId===this.userId),r.push(Sc(this.serializer,o))}))}),V.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Rz(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),V.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Tf(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Ko(s[1]);i.push(u)}else a.done()}).next(()=>{Pe(0===i.length)})})}containsKey(e,t){return Pz(e,this.userId,t)}Mn(e){return Nz(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Pz(n,e,t){const r=Rw(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Tf(n).Y({range:s,J:!0},(a,u,l)=>{const[d,f,m]=a;d===e&&f===i&&(o=!0),l.done()}).next(()=>o)}function sl(n){return Mr(n,"mutations")}function Tf(n){return Mr(n,"documentMutations")}function Nz(n){return Mr(n,"mutationQueues")}class Nc{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Nc(0)}static Nn(){return new Nc(-1)}}class Uce{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Nc(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>Me.fromTimestamp(new Sn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Cf(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(Pe(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Cf(e).Y((o,a)=>{const u=P_(a);u.sequenceNumber<=t&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>V.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Cf(e).Y((r,i)=>{const s=P_(i);t(s)})}Bn(e){return Mz(e).get("targetGlobalKey").next(t=>(Pe(null!==t),t))}Ln(e,t){return Mz(e).put("targetGlobalKey",t)}kn(e,t){return Cf(e).put(gz(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Tc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Cf(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const l=P_(a);__(t,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=ol(e);return t.forEach(o=>{const a=si(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(i)}removeMatchingKeys(e,t,r){const i=ol(e);return V.forEach(t,s=>{const o=si(s.path);return V.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=ol(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ol(e);let s=tt();return i.Y({range:r,J:!0},(o,a,u)=>{const l=Ko(o[1]),d=new fe(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){const r=si(t.path),i=IDBKeyRange.bound([r],[HH(r)],!1,!0);let s=0;return ol(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,l)=>{0!==o&&(s++,l.done())}).next(()=>s>0)}_t(e,t){return Cf(e).get(t).next(r=>r?P_(r):null)}}function Cf(n){return Mr(n,"targets")}function Mz(n){return Mr(n,"targetGlobal")}function ol(n){return Mr(n,"targetDocuments")}function xz([n,e],[t,r]){const i=Ge(n,t);return 0===i?Ge(e,r):i}class Bce{constructor(e){this.Qn=e,this.buffer=new Wt(xz),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();xz(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class kz{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;oe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Q.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Zu(r)?oe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Ku(r)}yield t.Gn(3e5)}))}}class jce{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return V.resolve(ys._e);const r=new Bce(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Sz)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sz):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,o,a,u,l;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),rf()<=hs.in.DEBUG&&oe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-d}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${f} documents in `+(l-u)+`ms\nTotal Duration: ${l-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}class $ce{constructor(e,t){this.db=e,this.garbageCollector=function Oz(n,e){return new jce(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Qw(e,r)}removeReference(e,t,r){return Qw(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Qw(e,t)}Xn(e,t){return function(i,s){let o=!1;return Nz(i).Z(a=>Pz(i,a,s).next(u=>(u&&(o=!0),V.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=t){const u=this.Xn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Me.min()),ol(e).delete([0,si(o.path)])))});i.push(u)}}).next(()=>V.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Qw(e,t)}Zn(e,t){const r=ol(e);let i,s=ys._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{0===o?(s!==ys._e&&t(new fe(Ko(i)),s),s=l,i=u):s=ys._e}).next(()=>{s!==ys._e&&t(new fe(Ko(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qw(n,e){return ol(n).put((i=n.currentSequenceNumber,{targetId:0,path:si(e.path),sequenceNumber:i}));var i}class Fz{constructor(){this.changes=new Ha(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Hce{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Mc(e).put(r)}removeEntry(e,t,r){return Mc(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],qw(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=_n.newInvalidDocument(t);return Mc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(k_(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:_n.newInvalidDocument(t)};return Mc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(k_(t))},(i,s)=>{r={document:this.tr(t,s),size:Kw(s)}}).next(()=>r)}getEntries(e,t){let r=Zi();return this.rr(e,t,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,t){let r=Zi(),i=new cn(fe.comparator);return this.rr(e,t,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Kw(o))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return V.resolve();let i=new Wt(Bz);t.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(k_(i.first()),k_(i.last())),o=i.getIterator();let a=o.getNext();return Mc(e).Y({index:"documentKeyIndex",range:s},(u,l,d)=>{const f=fe.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&Bz(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.U(k_(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),qw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mc(e).W(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Zi();for(const f of l){const m=this.tr(fe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(v_(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Zi();const o=Uz(t,r),a=Uz(t,_s.max());return Mc(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{const f=this.tr(fe.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new qce(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Vz(e).get("remoteDocumentGlobalKey").next(t=>(Pe(!!t),t))}er(e,t){return Vz(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=function Pce(n,e){let t;if(e.document)t=az(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=fe.fromSegments(e.noDocument.path),i=Ac(e.noDocument.readTime);t=_n.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we();{const r=fe.fromSegments(e.unknownDocument.path),i=Ac(e.unknownDocument.version);t=_n.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Sn(i[0],i[1]);return Me.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(Me.min()))return r}return _n.newInvalidDocument(e)}}function Lz(n){return new Hce(n)}class qce extends Fz{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new Ha(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Wt((s,o)=>Ge(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=pz(this._r.serializer,o);i=i.add(s.path.popLast());const l=Kw(u);r+=l-a.size,t.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=pz(this._r.serializer,o.convertToNoDocument(Me.min()));t.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Vz(n){return Mr(n,"remoteDocumentGlobal")}function Mc(n){return Mr(n,"remoteDocumentsV14")}function k_(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Uz(n,e){const t=e.documentKey.path.toArray();return[n,qw(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Bz(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Ge(t[s],r[s]),i)return i;return i=Ge(t.length,r.length),i||(i=Ge(t[t.length-2],r[r.length-2]),i||Ge(t[t.length-1],r[r.length-1]))}class zce{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class jz{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&T_(r.mutation,i,Ki.empty(),Sn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,tt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=tt()){const i=Qo();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=E_();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Qo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,tt()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Zi();const o=I_(),a=I_();return t.forEach((u,l)=>{const d=r.get(l.key);i.has(l.key)&&(void 0===d||d.mutation instanceof qa)?s=s.insert(l.key,l):void 0!==d?(o.set(l.key,d.mutation.getFieldMask()),T_(d.mutation,l,d.mutation.getFieldMask(),Sn.now())):o.set(l.key,Ki.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var f;return a.set(l,new zce(d,null!==(f=o.get(l))&&void 0!==f?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=I_();let i=new cn((o,a)=>o-a),s=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=t.get(u);if(null===l)return;let d=r.get(u)||Ki.empty();d=a.applyToLocalView(l,d),r.set(u,d);const f=(i.get(a.batchId)||tt()).add(u);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,d=u.value,f=Mq();d.forEach(m=>{if(!s.has(m)){const _=jq(t.get(m),r.get(m));null!==_&&f.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return fe.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):FR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var o}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(Qo());let a=-1,u=s;return o.next(l=>V.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,tt())).next(d=>({batchId:a,changes:Nq(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new fe(t)).next(r=>{let i=E_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=E_();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,u=>{const l=(f=t,m=u.child(s),new $a(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,m;return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{const d=l.getKey();null===o.get(d)&&(o=o.insert(d,_n.newInvalidDocument(d)))});let a=E_();return o.forEach((u,l)=>{const d=s.get(u);void 0!==d&&T_(d.mutation,l,Ki.empty(),Sn.now()),v_(t,l)&&(a=a.insert(u,l))}),a})}}class Gce{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return V.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:rr(i.createTime)}),V.resolve();var i}getNamedQuery(e,t){return V.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:ZR(i.bundledQuery),readTime:rr(i.readTime)}),V.resolve();var i}}class Wce{constructor(){this.overlays=new cn(fe.comparator),this.lr=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qo();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const i=Qo(),s=t.length+1,o=new fe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new cn((l,d)=>l-d);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);null===d&&(d=Qo(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}const a=Qo(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return V.resolve(a)}lt(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new $R(t,r));let s=this.lr.get(t);void 0===s&&(s=tt(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class nP{constructor(){this.hr=new Wt(xr.Pr),this.Ir=new Wt(xr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new xr(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new xr(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new fe(new Dt([])),r=new xr(t,e),i=new xr(t,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new fe(new Dt([])),r=new xr(t,e),i=new xr(t,e+1);let s=tt();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new xr(e,0),r=this.hr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class xr{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return fe.comparator(e.key,t.key)||Ge(e.gr,t.gr)}static Tr(e,t){return Ge(e.gr,t.gr)||fe.comparator(e.key,t.key)}}class Kce{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Wt(xr.Pr)}checkEmpty(e){return V.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++;const o=new BR(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new xr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new xr(t,0),i=new xr(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Wt(Ge);return t.forEach(i=>{const s=new xr(i,0),o=new xr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),V.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;fe.isDocumentKey(s)||(s=s.child(""));const o=new xr(new fe(s),0);let a=new Wt(Ge);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.gr)),!0)},o),V.resolve(this.br(a))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Pe(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return V.forEach(t.mutations,i=>{const s=new xr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new xr(t,0),i=this.yr.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return V.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Zce{constructor(e){this.Cr=e,this.docs=new cn(fe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():_n.newInvalidDocument(t))}getEntries(e,t){let r=Zi();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():_n.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Zi();const o=t.path,a=new fe(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||DR(zH(d),r)<=0||(i.has(d.key)||v_(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){we()}vr(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Qce(this)}getSize(e){return V.resolve(this.size)}}class Qce extends Fz{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class Yce{constructor(e){this.persistence=e,this.Fr=new Ha(t=>Tc(t),__),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Mr=0,this.Or=new nP,this.targetCount=0,this.Nr=Nc.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),V.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Nc(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.kn(t),V.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Or.containsKey(t))}}class rP{constructor(e,t){this.Br={},this.overlays={},this.Lr=new ys(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Yce(this),this.indexManager=new Lce,this.remoteDocumentCache=new Zce(r=>this.referenceDelegate.Qr(r)),this.serializer=new fz(t),this.Kr=new Gce(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Wce,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Kce(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){oe("MemoryPersistence","Starting transaction:",e);const i=new Xce(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return V.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class Xce extends WH{constructor(e){super(),this.currentSequenceNumber=e}}class Yw{constructor(e){this.persistence=e,this.Gr=new nP,this.zr=null}static jr(e){return new Yw(e)}get Hr(){if(this.zr)return this.zr;throw we()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Hr,r=>{const i=fe.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,Me.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return V.or([()=>V.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class Jce{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Sw("createOrUpgrade",t);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YH,{unique:!0}),u.createObjectStore("documentMutations"),$z(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),$z(e)),o=o.next(()=>function(u){const l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,l){return l.store("mutations").W().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YH,{unique:!0});const f=l.store("mutations"),m=d.map(_=>f.put(_));return V.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const l=u.createObjectStore("documentOverlays",{keyPath:Vle});l.createIndex("collectionPathOverlayIndex",Ule,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",Ble,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const l=u.createObjectStore("remoteDocumentsV14",{keyPath:Ale});l.createIndex("documentKeyIndex",Sle),l.createIndex("collectionGroupIndex",Rle)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:kle}).createIndex("sequenceNumberIndex",Ole,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Fle}).createIndex("documentKeyIndex",Lle,{unique:!1})}(e))),o}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=Kw(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>V.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>V.forEach(a,u=>{Pe(u.userId===s.userId);const l=Sc(this.serializer,u);return Rz(e,s.userId,l).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new Dt(o),l=[0,si(u)];s.push(t.get(l).next(d=>d?V.resolve():t.put({targetId:0,path:si(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>V.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:xle});const r=t.store("collectionParents"),i=new tP,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:si(u)})}};return t.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new Dt(o);return s(u.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([o,a,u],l)=>{const d=Ko(a);return s(d.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=P_(i),o=gz(this.serializer,s);return t.put(o)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=t.store("remoteDocumentsV14"),u=(f=o,f.document?new fe(Dt.fromString(f.document.name).popFirst(5)):f.noDocument?fe.fromSegments(f.noDocument.path):f.unknownDocument?fe.fromSegments(f.unknownDocument.path):we()).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var f;i.push(a.put(l))}).next(()=>V.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=Lz(this.serializer),s=new rP(Yw.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var l;let d=null!==(l=a.get(u.userId))&&void 0!==l?l:tt();Sc(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),V.forEach(a,(u,l)=>{const d=new Nr(l),f=zw.ct(this.serializer,d),m=s.getIndexManager(d),_=Zw.ct(d,this.serializer,m,s.referenceDelegate);return new jz(i,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new RR(t,ys._e),u).next()})})}}function $z(n){n.createObjectStore("targetDocuments",{keyPath:Nle}).createIndex("documentTargetsIndex",Mle,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ple,{unique:!0}),n.createObjectStore("targetGlobal")}const iP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class sP{constructor(e,t,r,i,s,o,a,u,l,d,f=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=l,this._i=d,this.ai=f,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!sP.D())throw new ne(H.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $ce(this,i),this.Ii=t+"main",this.serializer=new fz(u),this.Ti=new mo(this.Ii,this.ai,new Jce(this.serializer)),this.qr=new Uce(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Lz(this.serializer),this.Kr=new Nce,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===d&&nr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(H.FAILED_PRECONDITION,iP);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new ys(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var r=(0,Q.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,Q.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,Q.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Jw(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(Zu(e))return oe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return oe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return O_(e).get("owner").next(t=>V.resolve(this.wi(t)))}Si(e){return Jw(e).delete(this.clientId)}bi(){var e=this;return(0,Q.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Mr(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return V.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of t)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?V.resolve(!0):O_(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new ne(H.FAILED_PRECONDITION,iP);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jw(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&oe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Q.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new RR(t,ys._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Jw(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return Zw.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vce(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return zw.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){oe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(u=this.ai)?$le:14===u?tq:13===u?eq:12===u?jle:11===u?JH:void we();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new RR(a,this.Lr?this.Lr.next():ys._e),"readwrite-primary"===t?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw nr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new ne(H.FAILED_PRECONDITION,GH);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return O_(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ne(H.FAILED_PRECONDITION,iP)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return O_(e).put("owner",t)}static D(){return mo.D()}pi(e){const t=O_(e);return t.get("owner").next(r=>this.wi(r)?(oe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Di(e,t){const r=Date.now();return!(e<r-t||e>r&&(nr(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,b.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return oe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){nr("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function O_(n){return Mr(n,"owner")}function Jw(n){return Mr(n,"clientMetadata")}function oP(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class aP{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=tt(),i=tt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new aP(e,t.fromCache,r,i)}}class ede{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Hz{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new ede;return this.Hi(e,t,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(rf()<=hs.in.DEBUG&&oe("QueryEngine","SDK will not create cache indexes for query:",pf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),V.resolve()):(rf()<=hs.in.DEBUG&&oe("QueryEngine","Query:",pf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(rf()<=hs.in.DEBUG&&oe("QueryEngine","The SDK decides to create cache indexes for query:",pf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Si(t))):V.resolve())}zi(e,t){if(bq(t))return V.resolve(null);let r=Si(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Vw(t,null,"F"),r=Si(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=tt(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(t,a);return this.Zi(t,l,o,u.readTime)?this.zi(e,Vw(t,null,"F")):this.Xi(e,l,t,u)}))})))}ji(e,t,r,i){return bq(t)||i.isEqual(Me.min())?V.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(t,s);return this.Zi(t,o,r,i)?V.resolve(null):(rf()<=hs.in.DEBUG&&oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pf(t)),this.Xi(e,o,t,qH(i,-1)).next(a=>a))})}Yi(e,t){let r=new Wt(Rq(e));return t.forEach((i,s)=>{v_(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return rf()<=hs.in.DEBUG&&oe("QueryEngine","Using full collection scan to execute query:",pf(t)),this.Gi.getDocumentsMatchingQuery(e,t,_s.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class tde{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new cn(Ge),this.ns=new Ha(s=>Tc(s),__),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jz(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function qz(n,e,t,r){return new tde(n,e,t,r)}function zz(n,e){return uP.apply(this,arguments)}function uP(){return uP=(0,Q.Z)(function*(n,e){const t=he(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=tt();for(const l of i){o.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}for(const l of s){a.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}),uP.apply(this,arguments)}function Gz(n){const e=he(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function Wz(n,e,t){let r=tt(),i=tt();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Zi();return t.forEach((a,u)=>{const l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Me.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||0===u.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{us:o,cs:i}})}function ide(n,e){const t=he(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function bf(n,e){const t=he(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):t.qr.allocateTargetId(r).next(o=>(i=new za(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}function Df(n,e,t){return lP.apply(this,arguments)}function lP(){return lP=(0,Q.Z)(function*(n,e,t){const r=he(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Zu(o))throw o;oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),lP.apply(this,arguments)}function eT(n,e,t){const r=he(n);let i=Me.min(),s=tt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){const f=he(u),m=f.ns.get(d);return void 0!==m?V.resolve(f.ts.get(m)):f.qr.getTargetData(l,d)}(r,o,Si(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,t?i:Me.min(),t?s:tt())).next(a=>(Qz(r,Sq(e),a),{documents:a,ls:s})))}function Kz(n,e){const t=he(n),r=he(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function Zz(n,e){const t=he(n),r=t.rs.get(e)||Me.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,qH(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Qz(t,e,i),i))}function Qz(n,e,t){let r=n.rs.get(e)||Me.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}function cP(){return cP=(0,Q.Z)(function*(n,e,t,r){const i=he(n);let s=tt(),o=Zi();for(const l of t){const d=e.hs(l.metadata.name);l.document&&(s=s.add(d));const f=e.Ps(l);f.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(d,f)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield bf(i,(d=r,Si(hf(Dt.fromString(`__bundle__/docs/${d}`)))));var d;return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>Wz(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.us,d.cs)).next(()=>d.us)))}),cP.apply(this,arguments)}function ode(n,e){return dP.apply(this,arguments)}function dP(){return dP=(0,Q.Z)(function*(n,e,t=tt()){const r=yield bf(n,Si(ZR(e.bundledQuery))),i=he(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=rr(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(Er.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),dP.apply(this,arguments)}function Yz(n,e){return`firestore_clients_${n}_${e}`}function Xz(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function hP(n,e){return`firestore_targets_${n}_${e}`}class tT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new ne(i.error.code,i.error.message))),o?new tT(e,t,i.state,s):(nr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class F_{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ne(r.error.code,r.error.message))),s?new F_(e,r.state,i):(nr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class nT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=VR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=ZH(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new nT(e,s):(nr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class fP{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new fP(t.clientId,t.onlineState):(nr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class pP{constructor(){this.activeTargetIds=VR()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gP{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new cn(Ge),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Yz(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new pP),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Q.Z)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Rs)continue;const s=e.getItem(Yz(e.persistenceKey,i));if(s){const o=nT.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(hP(this.persistenceKey,e));if(r){const i=F_.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(hP(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return oe("SharedClientState","READ",e,t),t}setItem(e,t){oe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){oe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(oe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,Q.Z)(function*(){if(t.started){if(null!==r.key)if(t.Ss.test(r.key)){if(null==r.newValue){const i=t.Ks(r.key);return t.$s(i,null)}{const i=t.Us(r.key,r.newValue);if(i)return t.$s(i.clientId,i)}}else if(t.bs.test(r.key)){if(null!==r.newValue){const i=t.Ws(r.key,r.newValue);if(i)return t.Gs(i)}}else if(t.Ds.test(r.key)){if(null!==r.newValue){const i=t.zs(r.key,r.newValue);if(i)return t.js(i)}}else if(r.key===t.Cs){if(null!==r.newValue){const i=t.Ms(r.newValue);if(i)return t.xs(i)}}else if(r.key===t.ws){const i=function(o){let a=ys._e;if(null!=o)try{const u=JSON.parse(o);Pe("number"==typeof u),a=u}catch(u){nr("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==ys._e&&t.sequenceNumberHandler(i)}else if(r.key===t.vs){const i=t.Hs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new tT(this.currentUser,e,t,r),s=Xz(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=Xz(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,r){const i=hP(this.persistenceKey,e),s=new F_(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return nT.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]);return tT.Ts(new Nr(void 0!==r[2]?r[2]:null),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return F_.Ts(i,t)}Ms(e){return fP.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,Q.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);oe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=VR();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Jz{constructor(){this.eo=new pP,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new pP,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ade{ro(e){}shutdown(){}}class eG{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let rT=null;function mP(){return null===rT?rT=268435456+Math.round(2147483648*Math.random()):rT++,"0x"+rT.toString(16)}const ude={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lde{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const ai="WebChannelConnection";class cde extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,o){const a=mP(),u=this.So(t,r);oe("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,o),this.Do(t,u,l,i).then(d=>(oe("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Wi("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Co(t,r,i,s,o,a){return this.wo(t,r,i,s,o)}bo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+nf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}So(t,r){return`${this.mo}/v1/${r}:${ude[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=mP();return new Promise((o,a)=>{const u=new ale;u.setWithCredentials(!0),u.listenOnce(ile.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case TR.NO_ERROR:const d=u.getResponseJson();oe(ai,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case TR.TIMEOUT:oe(ai,`RPC '${e}' ${s} timed out`),a(new ne(H.DEADLINE_EXCEEDED,"Request time out"));break;case TR.HTTP_ERROR:const f=u.getStatus();if(oe(ai,`RPC '${e}' ${s} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m?.error;if(_&&_.status&&_.message){const v=function(D){const k=D.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(k)>=0?k:H.UNKNOWN}(_.status);a(new ne(v,_.message))}else a(new ne(H.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new ne(H.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{oe(ai,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);oe(ai,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",l,r,15)})}vo(e,t,r){const i=mP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nle(),a=rle(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new ole({})),this.bo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=s.join("");oe(ai,`Creating RPC '${e}' stream ${i}: ${d}`,u);const f=o.createWebChannel(d,u);let m=!1,_=!1;const v=new lde({co:D=>{_?oe(ai,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(oe(ai,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),oe(ai,`RPC '${e}' stream ${i} sending:`,D),f.send(D))},lo:()=>f.close()}),T=(D,k,P)=>{D.listen(k,O=>{try{P(O)}catch(q){setTimeout(()=>{throw q},0)}})};return T(f,Aw.EventType.OPEN,()=>{_||oe(ai,`RPC '${e}' stream ${i} transport opened.`)}),T(f,Aw.EventType.CLOSE,()=>{_||(_=!0,oe(ai,`RPC '${e}' stream ${i} transport closed`),v.Ro())}),T(f,Aw.EventType.ERROR,D=>{_||(_=!0,Wi(ai,`RPC '${e}' stream ${i} transport errored:`,D),v.Ro(new ne(H.UNAVAILABLE,"The operation could not be completed")))}),T(f,Aw.EventType.MESSAGE,D=>{var k;if(!_){const P=D.data[0];Pe(!!P);const q=P.error||(null===(k=P[0])||void 0===k?void 0:k.error);if(q){oe(ai,`RPC '${e}' stream ${i} received error:`,q);const ue=q.status;let Te=function(Ir){const Qi=lr[Ir];if(void 0!==Qi)return Wq(Qi)}(ue),Ue=q.message;void 0===Te&&(Te=H.INTERNAL,Ue="Unknown error status: "+ue+" with message "+q.message),_=!0,v.Ro(new ne(Te,Ue)),f.close()}else oe(ai,`RPC '${e}' stream ${i} received:`,P),v.Vo(P)}}),T(a,sle.STAT_EVENT,D=>{D.stat===VH.PROXY?oe(ai,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===VH.NOPROXY&&oe(ai,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.Ao()},0),v}}function tG(){return typeof window<"u"?window:null}function iT(){return typeof document<"u"?document:null}function L_(n){return new Ece(n,!0)}class _P{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class nG{constructor(e,t,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new _P(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,Q.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,Q.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var r=this;return(0,Q.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(nr(t.toString()),nr("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):t&&t.code===H.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new ne(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,Q.Z)(function*(){e.state=0,e.start()}))}o_(e){return oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dde extends nG{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function Tce(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:we(),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Pe(void 0===d||"string"==typeof d),Er.fromBase64String(d||"")):(Pe(void 0===d||d instanceof Uint8Array),Er.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const d=void 0===l.code?H.UNKNOWN:Wq(l.code);return new ne(d,l.message||"")}(o);t=new Xq(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=Yo(n,r.document.name),s=rr(r.document.updateTime),o=r.document.createTime?rr(r.document.createTime):Me.min(),a=new zr({mapValue:{fields:r.document.fields}}),u=_n.newFoundDocument(i,s,o,a);t=new Hw(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=Yo(n,r.document),s=r.readTime?rr(r.readTime):Me.min(),o=_n.newNoDocument(i,s);t=new Hw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=Yo(n,r.document);t=new Hw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return we();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new pce(i,s);t=new Yq(r.targetId,o)}}var l;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return Me.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?rr(o.readTime):Me.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=S_(this.serializer),t.addTarget=function(s,o){let a;const u=o.target;if(a=Fw(u)?{documents:uz(s,u)}:{query:KR(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=nz(s,o.resumeToken);const l=qR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Me.min())>0){a.readTime=vf(s,o.snapshotVersion.toTimestamp());const l=qR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const r=function bce(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=S_(this.serializer),t.removeTarget=e,this.e_(t)}}class hde extends nG{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(Pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function Cce(n,e){return n&&n.length>0?(Pe(void 0!==e),n.map(t=>function(i,s){let o=rr(i.updateTime?i.updateTime:s);return o.isEqual(Me.min())&&(o=rr(s)),new cce(o,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=rr(e.commitTime);return this.listener.I_(r,t)}return Pe(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=S_(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>R_(this.serializer,r))};this.e_(t)}}class fde extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new ne(H.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ne(H.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,t,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(H.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class gde{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(nr(t),this.f_=!1):oe("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class mde{constructor(e,t,r,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,Q.Z)(function*(){var u;al(o)&&(oe("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,Q.Z)(function*(d){const f=he(d);f.C_.add(4),yield Af(f),f.M_.set("Unknown"),f.C_.delete(4),yield V_(f)}),function l(d){return u.apply(this,arguments)})(o))}))}),this.M_=new gde(r,i)}}function V_(n){return vP.apply(this,arguments)}function vP(){return vP=(0,Q.Z)(function*(n){if(al(n))for(const e of n.v_)yield e(!0)}),vP.apply(this,arguments)}function Af(n){return EP.apply(this,arguments)}function EP(){return EP=(0,Q.Z)(function*(n){for(const e of n.v_)yield e(!1)}),EP.apply(this,arguments)}function sT(n,e){const t=he(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),TP(t)?wP(t):Rf(t).Ho()&&IP(t,e))}function U_(n,e){const t=he(n),r=Rf(t);t.D_.delete(e),r.Ho()&&rG(t,e),0===t.D_.size&&(r.Ho()?r.Zo():al(t)&&t.M_.set("Unknown"))}function IP(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rf(n).u_(e)}function rG(n,e){n.x_.Oe(e),Rf(n).c_(e)}function wP(n){n.x_=new mce({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Rf(n).start(),n.M_.g_()}function TP(n){return al(n)&&!Rf(n).jo()&&n.D_.size>0}function al(n){return 0===he(n).C_.size}function iG(n){n.x_=void 0}function _de(n){return CP.apply(this,arguments)}function CP(){return CP=(0,Q.Z)(function*(n){n.D_.forEach((e,t)=>{IP(n,e)})}),CP.apply(this,arguments)}function yde(n,e){return bP.apply(this,arguments)}function bP(){return bP=(0,Q.Z)(function*(n,e){iG(n),TP(n)?(n.M_.w_(e),wP(n)):n.M_.set("Unknown")}),bP.apply(this,arguments)}function vde(n,e,t){return DP.apply(this,arguments)}function DP(){return DP=(0,Q.Z)(function*(n,e,t){if(n.M_.set("Online"),e instanceof Xq&&2===e.state&&e.cause)try{yield(r=(0,Q.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(n,e)}catch(r){oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield oT(n,r)}else if(e instanceof Hw?n.x_.$e(e):e instanceof Yq?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(Me.min()))try{const r=yield Gz(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.D_.get(l);d&&s.D_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const d=s.D_.get(u);if(!d)return;s.D_.set(u,d.withResumeToken(Er.EMPTY_BYTE_STRING,d.snapshotVersion)),rG(s,u);const f=new za(d.target,u,l,d.sequenceNumber);IP(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){oe("RemoteStore","Failed to raise snapshot:",r),yield oT(n,r)}var r}),DP.apply(this,arguments)}function oT(n,e,t){return AP.apply(this,arguments)}function AP(){return AP=(0,Q.Z)(function*(n,e,t){if(!Zu(e))throw e;n.C_.add(1),yield Af(n),n.M_.set("Offline"),t||(t=()=>Gz(n.localStore)),n.asyncQueue.enqueueRetryable((0,Q.Z)(function*(){oe("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield V_(n)}))}),AP.apply(this,arguments)}function sG(n,e){return e().catch(t=>oT(n,t,e))}function Sf(n){return SP.apply(this,arguments)}function SP(){return SP=(0,Q.Z)(function*(n){const e=he(n),t=ul(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Ede(e);)try{const i=yield ide(e.localStore,r);if(null===i){0===e.b_.length&&t.Zo();break}r=i.batchId,Ide(e,i)}catch(i){yield oT(e,i)}oG(e)&&aG(e)}),SP.apply(this,arguments)}function Ede(n){return al(n)&&n.b_.length<10}function Ide(n,e){n.b_.push(e);const t=ul(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function oG(n){return al(n)&&!ul(n).jo()&&n.b_.length>0}function aG(n){ul(n).start()}function wde(n){return RP.apply(this,arguments)}function RP(){return RP=(0,Q.Z)(function*(n){ul(n).E_()}),RP.apply(this,arguments)}function Tde(n){return PP.apply(this,arguments)}function PP(){return PP=(0,Q.Z)(function*(n){const e=ul(n);for(const t of n.b_)e.P_(t.mutations)}),PP.apply(this,arguments)}function Cde(n,e,t){return NP.apply(this,arguments)}function NP(){return NP=(0,Q.Z)(function*(n,e,t){const r=n.b_.shift(),i=jR.from(r,e,t);yield sG(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Sf(n)}),NP.apply(this,arguments)}function bde(n,e){return MP.apply(this,arguments)}function MP(){return MP=(0,Q.Z)(function*(n,e){var t;e&&ul(n).h_&&(yield(t=(0,Q.Z)(function*(i,s){if(Gq(a=s.code)&&a!==H.ABORTED){const o=i.b_.shift();ul(i).Yo(),yield sG(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Sf(i)}var a}),function r(i,s){return t.apply(this,arguments)})(n,e)),oG(n)&&aG(n)}),MP.apply(this,arguments)}function uG(n,e){return xP.apply(this,arguments)}function xP(){return xP=(0,Q.Z)(function*(n,e){const t=he(n);t.asyncQueue.verifyOperationInProgress(),oe("RemoteStore","RemoteStore received new credentials");const r=al(t);t.C_.add(3),yield Af(t),r&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield V_(t)}),xP.apply(this,arguments)}function kP(n,e){return OP.apply(this,arguments)}function OP(){return OP=(0,Q.Z)(function*(n,e){const t=he(n);e?(t.C_.delete(2),yield V_(t)):e||(t.C_.add(2),yield Af(t),t.M_.set("Unknown"))}),OP.apply(this,arguments)}function Rf(n){return n.O_||(n.O_=function(t,r,i){const s=he(t);return s.A_(),new dde(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:_de.bind(null,n),Io:yde.bind(null,n),a_:vde.bind(null,n)}),n.v_.push(function(){var e=(0,Q.Z)(function*(t){t?(n.O_.Yo(),TP(n)?wP(n):n.M_.set("Unknown")):(yield n.O_.stop(),iG(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function ul(n){return n.N_||(n.N_=function(t,r,i){const s=he(t);return s.A_(),new hde(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:wde.bind(null,n),Io:bde.bind(null,n),T_:Tde.bind(null,n),I_:Cde.bind(null,n)}),n.v_.push(function(){var e=(0,Q.Z)(function*(t){t?(n.N_.Yo(),yield Sf(n)):(yield n.N_.stop(),n.b_.length>0&&(oe("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class FP{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new FP(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ne(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pf(n,e){if(nr("AsyncQueue",`${e}: ${n}`),Zu(n))return new ne(H.UNAVAILABLE,`${e}: ${n}`);throw n}class Nf{constructor(e){this.comparator=e?(t,r)=>e(t,r)||fe.comparator(t.key,r.key):(t,r)=>fe.comparator(t.key,r.key),this.keyedMap=E_(),this.sortedSet=new cn(this.comparator)}static emptySet(e){return new Nf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Nf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Nf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class lG{constructor(){this.B_=new cn(fe.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):we():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Mf{constructor(e,t,r,i,s,o,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Mf(e,t,Nf.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&y_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Dde{constructor(){this.k_=void 0,this.listeners=[]}}class Ade{constructor(){this.queries=new Ha(e=>Aq(e),y_),this.onlineState="Unknown",this.q_=new Set}}function LP(n,e){return VP.apply(this,arguments)}function VP(){return VP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Dde),i)try{s.k_=yield t.onListen(r)}catch(o){const a=Pf(o,`Initialization of query '${pf(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&jP(t)}),VP.apply(this,arguments)}function UP(n,e){return BP.apply(this,arguments)}function BP(){return BP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),BP.apply(this,arguments)}function Sde(n,e){const t=he(n);let r=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&jP(t)}function Rde(n,e,t){const r=he(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function jP(n){n.q_.forEach(e=>{e.next()})}class $P{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Mf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Mf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Pde{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class cG{constructor(e){this.serializer=e}hs(e){return Yo(this.serializer,e)}Ps(e){return e.metadata.exists?az(this.serializer,e.document,!1):_n.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return rr(e)}}class Nde{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=dG(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=Dt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new cG(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||tt()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,Q.Z)(function*(){const t=yield function sde(n,e,t,r){return cP.apply(this,arguments)}(e.localStore,new cG(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield ode(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function dG(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class hG{constructor(e){this.key=e}}class fG{constructor(e){this.key=e}}class pG{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=tt(),this.mutatedKeys=tt(),this._a=Rq(e),this.aa=new Nf(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new lG,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const m=i.get(d),_=v_(this.query,f)?f:null,v=!!m&&this.mutatedKeys.has(m.key),T=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let D=!1;m&&_?m.data.isEqual(_.data)?v!==T&&(r.track({type:3,doc:_}),D=!0):this.ha(m,_)||(r.track({type:2,doc:_}),D=!0,(u&&this._a(_,u)>0||l&&this._a(_,l)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),D=!0):m&&!_&&(r.track({type:1,doc:m}),D=!0,(u||l)&&(a=!0)),D&&(_?(o=o.add(_),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const d="F"===this.query.limitType?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort((l,d)=>function(m,_){const v=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return v(m)-v(_)}(l.type,d.type)||this._a(l.doc,d.doc)),this.Pa(r);const o=t?this.Ia():[],a=0===this.oa.size&&this.current?1:0,u=a!==this.sa;return this.sa=a,0!==s.length||u?{snapshot:new Mf(this.query,e.aa,i,s,e.mutatedKeys,0===a,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new lG,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=tt(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new fG(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new hG(r))}),t}da(e){this.ia=e.ls,this.oa=tt();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return Mf.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Mde{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class xde{constructor(e){this.key=e,this.Ra=!1}}class kde{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Ha(a=>Aq(a),y_),this.fa=new Map,this.ga=new Set,this.pa=new cn(fe.comparator),this.ya=new Map,this.wa=new nP,this.Sa={},this.ba=new Map,this.Da=Nc.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Ode(n,e){return HP.apply(this,arguments)}function HP(){return HP=(0,Q.Z)(function*(n,e){const t=hN(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield bf(t.localStore,Si(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield qP(t,e,r,"current"===a,o.resumeToken),t.isPrimaryClient&&sT(t.remoteStore,o)}return i}),HP.apply(this,arguments)}function qP(n,e,t,r,i){return zP.apply(this,arguments)}function zP(){return zP=(0,Q.Z)(function*(n,e,t,r,i){n.va=(f,m,_)=>{return(v=(0,Q.Z)(function*(D,k,P,O){let q=k.view.ca(P);q.Zi&&(q=yield eT(D.localStore,k.query,!1).then(({documents:Ue})=>k.view.ca(Ue,q)));const ue=O&&O.targetChanges.get(k.targetId),Te=k.view.applyChanges(q,D.isPrimaryClient,ue);return tN(D,k.targetId,Te.Ta),Te.snapshot}),function T(D,k,P,O){return v.apply(this,arguments)})(n,f,m,_);var v};const s=yield eT(n.localStore,e,!0),o=new pG(e,s.ls),a=o.ca(s.documents),u=D_.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),l=o.applyChanges(a,n.isPrimaryClient,u);tN(n,t,l.Ta);const d=new Mde(e,t,o);return n.ma.set(e,d),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),l.snapshot}),zP.apply(this,arguments)}function Fde(n,e){return GP.apply(this,arguments)}function GP(){return GP=(0,Q.Z)(function*(n,e){const t=he(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!y_(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Df(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),U_(t.remoteStore,r.targetId),xf(t,r.targetId)}).catch(Ku))):(xf(t,r.targetId),yield Df(t.localStore,r.targetId,!0))}),GP.apply(this,arguments)}function WP(){return WP=(0,Q.Z)(function*(n,e,t){const r=fN(n);try{const i=yield function(o,a){const u=he(o),l=Sn.now(),d=a.reduce((_,v)=>_.add(v.key),tt());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=Zi(),T=tt();return u.ss.getEntries(_,d).next(D=>{v=D,v.forEach((k,P)=>{P.isValidDocument()||(T=T.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,v)).next(D=>{f=D;const k=[];for(const P of a){const O=hce(P,f.get(P.key).overlayedDocument);null!=O&&k.push(new qa(P.key,O,hq(O.value.mapValue),Rn.exists(!0)))}return u.mutationQueue.addMutationBatch(_,l,k,a)}).next(D=>{m=D;const k=D.applyToLocalDocumentSet(f,T);return u.documentOverlayCache.saveOverlays(_,D.batchId,k)})}).then(()=>({batchId:m.batchId,changes:Nq(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Sa[o.currentUser.toKey()];l||(l=new cn(Ge)),l=l.insert(a,u),o.Sa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Ga(r,i.changes),yield Sf(r.remoteStore)}catch(i){const s=Pf(i,"Failed to persist write");t.reject(s)}}),WP.apply(this,arguments)}function gG(n,e){return KP.apply(this,arguments)}function KP(){return KP=(0,Q.Z)(function*(n,e){const t=he(n);try{const r=yield function rde(n,e){const t=he(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const a=[];e.targetChanges.forEach((d,f)=>{const m=i.get(f);if(!m)return;a.push(t.qr.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.qr.addMatchingKeys(s,d.addedDocuments,f)));let _=m.withSequenceNumber(s.currentSequenceNumber);var T,D,k;null!==e.targetMismatches.get(f)?_=_.withResumeToken(Er.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(f,_),D=_,k=d,(0===(T=m).resumeToken.approximateByteSize()||D.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8||k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(s,_))});let u=Zi(),l=tt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(Wz(s,o,e.documentUpdates).next(d=>{u=d.us,l=d.cs})),!r.isEqual(Me.min())){const d=t.qr.getLastRemoteSnapshotVersion(s).next(f=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.ts=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.ya.get(s);o&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?Pe(o.Ra):i.removedDocuments.size>0&&(Pe(o.Ra),o.Ra=!1))}),yield Ga(t,r,e)}catch(r){yield Ku(r)}}),KP.apply(this,arguments)}function mG(n,e,t){const r=he(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=he(o);u.onlineState=a;let l=!1;u.queries.forEach((d,f)=>{for(const m of f.listeners)m.Q_(a)&&(l=!0)}),l&&jP(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Vde(n,e,t){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,Q.Z)(function*(n,e,t){const r=he(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new cn(fe.comparator);o=o.insert(s,_n.newNoDocument(s,Me.min()));const a=tt().add(s),u=new b_(Me.min(),new Map,new cn(Ge),o,a);yield gG(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),nN(r)}else yield Df(r.localStore,e,!1).then(()=>xf(r,e,t)).catch(Ku)}),ZP.apply(this,arguments)}function Ude(n,e){return QP.apply(this,arguments)}function QP(){return QP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.batch.batchId;try{const i=yield function nde(n,e){const t=he(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){const f=l.batch,m=f.keys();let _=V.resolve();return m.forEach(v=>{_=_.next(()=>d.getEntry(u,v)).next(T=>{const D=l.docVersions.get(v);Pe(null!==D),T.version.compareTo(D)<0&&(f.applyToRemoteDocument(T,l),T.isValidDocument()&&(T.setReadTime(l.commitVersion),d.addEntry(T)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=tt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);eN(t,r,null),JP(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ga(t,i)}catch(i){yield Ku(i)}}),QP.apply(this,arguments)}function Bde(n,e,t){return YP.apply(this,arguments)}function YP(){return YP=(0,Q.Z)(function*(n,e,t){const r=he(n);try{const i=yield function(o,a){const u=he(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(f=>(Pe(null!==f),d=f.keys(),u.mutationQueue.removeMutationBatch(l,f))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);eN(r,e,t),JP(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ga(r,i)}catch(i){yield Ku(i)}}),YP.apply(this,arguments)}function XP(){return XP=(0,Q.Z)(function*(n,e){const t=he(n);al(t.remoteStore)||oe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=he(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=Pf(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),XP.apply(this,arguments)}function JP(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function eN(n,e,t){const r=he(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function xf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||_G(n,r)})}function _G(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&(U_(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),nN(n))}function tN(n,e,t){for(const r of t)r instanceof hG?(n.wa.addReference(r.key,e),$de(n,r)):r instanceof fG?(oe("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||_G(n,r.key)):we()}function $de(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(oe("SyncEngine","New document in limbo: "+t),n.ga.add(r),nN(n))}function nN(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new fe(Dt.fromString(e)),r=n.Da.next();n.ya.set(r,new xde(t)),n.pa=n.pa.insert(t,r),sT(n.remoteStore,new za(Si(hf(t.path)),r,"TargetPurposeLimboResolution",ys._e))}}function Ga(n,e,t){return rN.apply(this,arguments)}function rN(){return rN=(0,Q.Z)(function*(n,e,t){const r=he(n),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,t).then(l=>{if((l||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const d=aP.Qi(u.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,Q.Z)(function*(l,d){const f=he(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>V.forEach(d,_=>V.forEach(_.ki,v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>V.forEach(_.qi,v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!Zu(m))throw m;oe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const _=m.targetId;if(!m.fromCache){const v=f.ts.get(_),D=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);f.ts=f.ts.insert(_,D)}}}),function u(l,d){return a.apply(this,arguments)})(r.localStore,s))}),rN.apply(this,arguments)}function Hde(n,e){return iN.apply(this,arguments)}function iN(){return iN=(0,Q.Z)(function*(n,e){const t=he(n);if(!t.currentUser.isEqual(e)){oe("SyncEngine","User change. New user:",e.toKey());const r=yield zz(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(a=>{a.forEach(u=>{u.reject(new ne(H.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ga(t,r._s)}var s}),iN.apply(this,arguments)}function qde(n,e){const t=he(n),r=t.ya.get(e);if(r&&r.Ra)return tt().add(r.key);{let i=tt();const s=t.fa.get(e);if(!s)return i;for(const o of s){const a=t.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function zde(n,e){return sN.apply(this,arguments)}function sN(){return sN=(0,Q.Z)(function*(n,e){const t=he(n),r=yield eT(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&tN(t,e.targetId,i.Ta),i}),sN.apply(this,arguments)}function Gde(n,e){return oN.apply(this,arguments)}function oN(){return oN=(0,Q.Z)(function*(n,e){const t=he(n);return Zz(t.localStore,e).then(r=>Ga(t,r))}),oN.apply(this,arguments)}function Wde(n,e,t,r){return aN.apply(this,arguments)}function aN(){return aN=(0,Q.Z)(function*(n,e,t,r){const i=he(n),s=yield function(a,u){const l=he(a),d=he(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Cn(f,u).next(m=>m?l.localDocuments.getDocuments(f,m):V.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===t?yield Sf(i.remoteStore):"acknowledged"===t||"rejected"===t?(eN(i,e,r||null),JP(i,e),u=e,he(he(i.localStore).mutationQueue).Fn(u)):we(),yield Ga(i,s)):oe("SyncEngine","Cannot apply mutation batch with id: "+e)}),aN.apply(this,arguments)}function uN(){return uN=(0,Q.Z)(function*(n,e){const t=he(n);if(hN(t),fN(t),!0===e&&!0!==t.Ca){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield yG(t,r.toArray());t.Ca=!0,yield kP(t.remoteStore,!0);for(const s of i)sT(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const r=[];let i=Promise.resolve();t.fa.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(xf(t,o),Df(t.localStore,o,!0))),U_(t.remoteStore,o)}),yield i,yield yG(t,r),function(o){const a=he(o);a.ya.forEach((u,l)=>{U_(a.remoteStore,l)}),a.wa.Vr(),a.ya=new Map,a.pa=new cn(fe.comparator)}(t),t.Ca=!1,yield kP(t.remoteStore,!1)}}),uN.apply(this,arguments)}function yG(n,e,t){return lN.apply(this,arguments)}function lN(){return lN=(0,Q.Z)(function*(n,e,t){const r=he(n),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield bf(r.localStore,Si(u[0]));for(const l of u){const d=r.ma.get(l),f=yield zde(r,d);f.snapshot&&s.push(f.snapshot)}}else{const l=yield Kz(r.localStore,o);a=yield bf(r.localStore,l),yield qP(r,vG(l),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),lN.apply(this,arguments)}function vG(n){return Cq(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Zde(n){return t=he(n).localStore,he(he(t).persistence).Bi();var t}function Qde(n,e,t,r){return cN.apply(this,arguments)}function cN(){return cN=(0,Q.Z)(function*(n,e,t,r){const i=he(n);if(i.Ca)return void oe("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield Zz(i.localStore,Sq(s[0])),a=b_.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Er.EMPTY_BYTE_STRING);yield Ga(i,o,a);break}case"rejected":yield Df(i.localStore,e,!0),xf(i,e,r);break;default:we()}}),cN.apply(this,arguments)}function Yde(n,e,t){return dN.apply(this,arguments)}function dN(){return dN=(0,Q.Z)(function*(n,e,t){const r=hN(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){oe("SyncEngine","Adding an already active target "+i);continue}const s=yield Kz(r.localStore,i),o=yield bf(r.localStore,s);yield qP(r,vG(s),o.targetId,!1,o.resumeToken),sT(r.remoteStore,o)}for(const i of t)r.fa.has(i)&&(yield Df(r.localStore,i,!1).then(()=>{U_(r.remoteStore,i),xf(r,i)}).catch(Ku))}}),dN.apply(this,arguments)}function hN(n){const e=he(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gG.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qde.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vde.bind(null,e),e.Va.a_=Sde.bind(null,e.eventManager),e.Va.Fa=Rde.bind(null,e.eventManager),e}function fN(n){const e=he(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ude.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bde.bind(null,e),e}class B_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Q.Z)(function*(){t.serializer=L_(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return qz(this.persistence,new Hz,e.initialUser,this.serializer)}createPersistence(e){return new rP(Yw.jr,this.serializer)}createSharedClientState(e){return new Jz}terminate(){var e=this;return(0,Q.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class pN extends B_{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Q.Z)(function*(){yield t().call(r,e),yield r.xa.initialize(r,e),yield fN(r.xa.syncEngine),yield Sf(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return qz(this.persistence,new Hz,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new kz(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new Cle(t,this.persistence);return new Tle(e.asyncQueue,r)}createPersistence(e){const t=oP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?oi.withCacheSize(this.cacheSizeBytes):oi.DEFAULT;return new sP(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,tG(),iT(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Jz}}class EG extends pN{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Q.Z)(function*(){yield t().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof gP&&(r.sharedClientState.syncEngine={Ys:Wde.bind(null,i),Zs:Qde.bind(null,i),Xs:Yde.bind(null,i),Bi:Zde.bind(null,i),Js:Gde.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,Q.Z)(function*(o){yield function Kde(n,e){return uN.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=tG();if(!gP.D(t))throw new ne(H.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=oP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gP(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class kf{initialize(e,t){var r=this;return(0,Q.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>mG(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Hde.bind(null,r.syncEngine),yield kP(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Ade}createDatastore(e){const t=L_(e.databaseInfo.databaseId),r=new cde(e.databaseInfo);return new fde(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=t=>mG(this.syncEngine,t,0),a=eG.D()?new eG:new ade,new mde(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,t){return function(i,s,o,a,u,l,d){const f=new kde(i,s,o,a,u,l);return d&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Q.Z)(function*(r){const i=he(r);oe("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Af(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function IG(n,e=10240){let t=0;return{read:()=>(0,Q.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Q.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class aT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):nr("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class ehe{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new vr,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,Q.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,Q.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,Q.Z)(function*(){const t=yield e.qa();if(null===t)return null;const r=e.La.decode(t),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Pde(JSON.parse(s),t.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,Q.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Ka(e){var t=this;return(0,Q.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const r=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,Q.Z)(function*(){const t=yield e.Ba.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class the{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Q.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new ne(H.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Q.Z)(function*(o,a){const u=he(o),l=S_(u.serializer)+"/documents",d={documents:a.map(v=>A_(u.serializer,v))},f=yield u.Co("BatchGetDocuments",l,d,a.length),m=new Map;f.forEach(v=>{const T=function wce(n,e){return"found"in e?function(r,i){Pe(!!i.found);const s=Yo(r,i.found.name),o=rr(i.found.updateTime),a=i.found.createTime?rr(i.found.createTime):Me.min(),u=new zr({mapValue:{fields:i.found.fields}});return _n.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){Pe(!!i.missing),Pe(!!i.readTime);const s=Yo(r,i.missing),o=rr(i.readTime);return _n.newNoDocument(s,o)}(n,e):we()}(u.serializer,v);m.set(T.key.toString(),T)});const _=[];return a.forEach(v=>{const T=m.get(v.toString());Pe(!!T),_.push(T)}),_}),function s(o,a){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new yf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Q.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=fe.fromPath(i);e.mutations.push(new UR(s,e.precondition(s)))}),yield(r=(0,Q.Z)(function*(s,o){const a=he(s),u=S_(a.serializer)+"/documents",l={writes:o.map(d=>R_(a.serializer,d))};yield a.wo("Commit",u,l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we();t=Me.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ne(H.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Me.min())?Rn.exists(!1):Rn.updateTime(t):Rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Me.min()))throw new ne(H.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rn.updateTime(t)}return Rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class nhe{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new _P(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,Q.Z)(function*(){const t=new the(e.datastore),r=e.za(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const t=this.updateFunction(e);return!c_(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Gq(t)}return!1}}class rhe{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Nr.UNAUTHENTICATED,this.clientId=$H.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,Q.Z)(function*(a){oe("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(oe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,Q.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ne(H.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Q.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Pf(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function uT(n,e){return gN.apply(this,arguments)}function gN(){return gN=(0,Q.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Q.Z)(function*(s){r.isEqual(s)||(yield zz(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),gN.apply(this,arguments)}function mN(n,e){return _N.apply(this,arguments)}function _N(){return _N=(0,Q.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield yN(n);oe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>uG(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>uG(e.remoteStore,s)),n._onlineComponents=e}),_N.apply(this,arguments)}function wG(n){return"FirebaseError"===n.name?n.code===H.FAILED_PRECONDITION||n.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function yN(n){return vN.apply(this,arguments)}function vN(){return vN=(0,Q.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield uT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!wG(t))throw t;Wi("Error using user provided cache. Falling back to memory cache: "+t),yield uT(n,new B_)}}else oe("FirestoreClient","Using default OfflineComponentProvider"),yield uT(n,new B_);return n._offlineComponents}),vN.apply(this,arguments)}function lT(n){return EN.apply(this,arguments)}function EN(){return EN=(0,Q.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield mN(n,n._uninitializedComponentsProvider._online)):(oe("FirestoreClient","Using default OnlineComponentProvider"),yield mN(n,new kf))),n._onlineComponents}),EN.apply(this,arguments)}function TG(n){return yN(n).then(e=>e.persistence)}function Of(n){return yN(n).then(e=>e.localStore)}function CG(n){return lT(n).then(e=>e.remoteStore)}function IN(n){return lT(n).then(e=>e.syncEngine)}function Ff(n){return wN.apply(this,arguments)}function wN(){return wN=(0,Q.Z)(function*(n){const e=yield lT(n),t=e.eventManager;return t.onListen=Ode.bind(null,e.syncEngine),t.onUnlisten=Fde.bind(null,e.syncEngine),t}),wN.apply(this,arguments)}function DG(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function(s,o,a,u,l){const d=new aT({next:m=>{o.enqueueAndForget(()=>UP(s,f));const _=m.docs.has(a);!_&&m.fromCache?l.reject(new ne(H.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&"server"===u.source?l.reject(new ne(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new $P(hf(a.path),d,{includeMetadataChanges:!0,J_:!0});return LP(s,f)}(yield Ff(n),n.asyncQueue,e,t,r)})),r.promise}function AG(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function(s,o,a,u,l){const d=new aT({next:m=>{o.enqueueAndForget(()=>UP(s,f)),m.fromCache&&"server"===u.source?l.reject(new ne(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new $P(a,d,{includeMetadataChanges:!0,J_:!0});return LP(s,f)}(yield Ff(n),n.asyncQueue,e,t,r)})),r.promise}function SG(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const RG=new Map;function TN(n,e,t){if(!t)throw new ne(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PG(n,e,t,r){if(!0===e&&!0===r)throw new ne(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NG(n){if(!fe.isDocumentKey(n))throw new ne(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function MG(n){if(fe.isDocumentKey(n))throw new ne(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cT(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":we()}function mt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cT(n);throw new ne(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xG(n,e){if(e<=0)throw new ne(H.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class kG{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new ne(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ne(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=SG(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class j_{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kG({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ne(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ne(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kG(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new dle;switch(r.type){case"firstParty":return new gle(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=RG.get(t);r&&(oe("ComponentProvider","Removing Datastore"),RG.delete(t),r.terminate())}(this),Promise.resolve()}}class Gr{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Gr(this.firestore,e,this._query)}}class yn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}}class Xo extends Gr{constructor(e,t,r){super(e,t,hf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new fe(e))}withConverter(e){return new Xo(this.firestore,e,this._path)}}function FG(n,e,...t){if(n=(0,b.m9)(n),TN("collection","path",e),n instanceof j_){const r=Dt.fromString(e,...t);return MG(r),new Xo(n,null,r)}{if(!(n instanceof yn||n instanceof Xo))throw new ne(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dt.fromString(e,...t));return MG(r),new Xo(n.firestore,null,r)}}function dT(n,e,...t){if(n=(0,b.m9)(n),1===arguments.length&&(e=$H.newId()),TN("doc","path",e),n instanceof j_){const r=Dt.fromString(e,...t);return NG(r),new yn(n,null,new fe(r))}{if(!(n instanceof yn||n instanceof Xo))throw new ne(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dt.fromString(e,...t));return NG(r),new yn(n.firestore,n instanceof Xo?n.converter:null,new fe(r))}}function LG(n,e){return n=(0,b.m9)(n),e=(0,b.m9)(e),(n instanceof yn||n instanceof Xo)&&(e instanceof yn||e instanceof Xo)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function CN(n,e){return n=(0,b.m9)(n),e=(0,b.m9)(e),n instanceof Gr&&e instanceof Gr&&n.firestore===e.firestore&&y_(n._query,e._query)&&n.converter===e.converter}class ghe{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new _P(this,"async_queue_retry"),this.iu=()=>{const t=iT();t&&oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=iT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=iT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new vr;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,Q.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!Zu(t))throw t;oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,nr("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=FP.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&we()}verifyOperationInProgress(){}uu(){var e=this;return(0,Q.Z)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function bN(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class mhe{constructor(){this._progressObserver={},this._taskCompletionResolver=new vr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class dn extends j_{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ghe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||VG(this),this._firestoreClient.terminate()}}function Wn(n){return n._firestoreClient||VG(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function VG(n){var e,t,r;const i=n._freezeSettings(),s=(u=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new zle(n._databaseId,u,n._persistenceKey,(d=i).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,SG(d.experimentalLongPollingOptions),d.useFetchStreams));var u,d;n._firestoreClient=new rhe(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function UG(n,e,t){const r=new vr;return n.asyncQueue.enqueue((0,Q.Z)(function*(){try{yield uT(n,t),yield mN(n,e),r.resolve()}catch(i){const s=i;if(!wG(s))throw s;Wi("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function BG(n){if(n._initialized||n._terminated)throw new ne(H.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Jo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jo(Er.fromBase64String(e))}catch(t){throw new ne(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jo(Er.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wa{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new ne(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xc{constructor(e){this._methodName=e}}class hT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}}const Ahe=/^__.*__$/;class She{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new qa(e,this.data,this.fieldMask,t,this.fieldTransforms):new _f(e,this.data,t,this.fieldTransforms)}}class jG{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new qa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function $G(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class fT{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new fT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return mT(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if($G(this.Iu)&&Ahe.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Rhe{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||L_(e)}pu(e,t,r,i=!1){return new fT({Iu:e,methodName:t,gu:r,path:mn.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kc(n){const e=n._freezeSettings(),t=L_(n._databaseId);return new Rhe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pT(n,e,t,r,i,s={}){const o=n.pu(s.merge||s.mergeFields?2:0,e,t,i);RN("Data must be an object, but it was:",o,r);const a=zG(r,o);let u,l;if(s.merge)u=new Ki(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const m=q_(e,f,t);if(!o.contains(m))throw new ne(H.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);WG(d,m)||d.push(m)}u=new Ki(d),l=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,l=o.fieldTransforms;return new She(new zr(a),u,l)}class H_ extends xc{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof H_}}function HG(n,e,t){return new fT({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class DN extends xc{_toFieldTransform(e){return new w_(e.path,new gf)}isEqual(e){return e instanceof DN}}class Phe extends xc{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=HG(this,e,!0),r=this.yu.map(s=>Oc(s,t)),i=new Cc(r);return new w_(e.path,i)}isEqual(e){return this===e}}class Nhe extends xc{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=HG(this,e,!0),r=this.yu.map(s=>Oc(s,t)),i=new bc(r);return new w_(e.path,i)}isEqual(e){return this===e}}class Mhe extends xc{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new mf(e.serializer,Oq(e.serializer,this.wu));return new w_(e.path,t)}isEqual(e){return this===e}}function AN(n,e,t,r){const i=n.pu(1,e,t);RN("Data must be an object, but it was:",i,r);const s=[],o=zr.empty();Qu(r,(u,l)=>{const d=gT(e,u,t);l=(0,b.m9)(l);const f=i.Ru(d);if(l instanceof H_)s.push(d);else{const m=Oc(l,f);null!=m&&(s.push(d),o.set(d,m))}});const a=new Ki(s);return new jG(o,a,i.fieldTransforms)}function SN(n,e,t,r,i,s){const o=n.pu(1,e,t),a=[q_(e,r,t)],u=[i];if(s.length%2!=0)throw new ne(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(q_(e,s[m])),u.push(s[m+1]);const l=[],d=zr.empty();for(let m=a.length-1;m>=0;--m)if(!WG(l,a[m])){const _=a[m];let v=u[m];v=(0,b.m9)(v);const T=o.Ru(_);if(v instanceof H_)l.push(_);else{const D=Oc(v,T);null!=D&&(l.push(_),d.set(_,D))}}const f=new Ki(l);return new jG(d,f,o.fieldTransforms)}function qG(n,e,t,r=!1){return Oc(t,n.pu(r?4:3,e))}function Oc(n,e){if(GG(n=(0,b.m9)(n)))return RN("Unsupported field value:",e,n),zG(n,e);if(n instanceof xc)return function(r,i){if(!$G(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=Oc(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,b.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return Oq(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Sn.fromDate(r);return{timestampValue:vf(i.serializer,s)}}if(r instanceof Sn){const s=new Sn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vf(i.serializer,s)}}if(r instanceof hT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jo)return{bytesValue:nz(i.serializer,r._byteString)};if(r instanceof yn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zR(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${cT(r)}`)}(n,e)}function zG(n,e){const t={};return rq(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qu(n,(r,i)=>{const s=Oc(i,e.Eu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function GG(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Sn||n instanceof hT||n instanceof Jo||n instanceof yn||n instanceof xc)}function RN(n,e,t){if(!GG(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=cT(t);throw e.mu("an object"===r?n+" a custom object":n+" "+r)}var i}function q_(n,e,t){if((e=(0,b.m9)(e))instanceof Wa)return e._internalPath;if("string"==typeof e)return gT(n,e);throw mT("Field path arguments must be of type string or ",n,!1,void 0,t)}const xhe=new RegExp("[~\\*/\\[\\]]");function gT(n,e,t){if(e.search(xhe)>=0)throw mT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wa(...e.split("."))._internalPath}catch{throw mT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function mT(n,e,t,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new ne(H.INVALID_ARGUMENT,a+n+u)}function WG(n,e){return n.some(t=>t.isEqual(e))}class z_{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new khe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_T("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class khe extends z_{data(){return super.data()}}function _T(n,e){return"string"==typeof e?gT(n,e):e instanceof Wa?e._internalPath:e._delegate._internalPath}function KG(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new ne(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class PN{}class G_ extends PN{}function ll(n,e,...t){let r=[];e instanceof PN&&r.push(e),r=r.concat(t),function(s){const o=s.filter(u=>u instanceof Lf).length,a=s.filter(u=>u instanceof W_).length;if(o>1||o>0&&a>0)throw new ne(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class W_ extends G_{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new W_(e,t,r)}_apply(e){const t=this._parse(e);return XG(e._query,t),new Gr(e.firestore,e.converter,LR(e._query,t))}_parse(e){const t=kc(e.firestore);return function(s,o,a,u,l,d,f){let m;if(l.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new ne(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if("in"===d||"not-in"===d){YG(f,d);const _=[];for(const v of f)_.push(QG(u,s,v));m={arrayValue:{values:_}}}else m=QG(u,s,f)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||YG(f,d),m=qG(a,"where",f,"in"===d||"not-in"===d);return Tt.create(l,d,m)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Lf extends PN{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Lf(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:zt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)XG(o,u),o=LR(o,u)}(e._query,t),new Gr(e.firestore,e.converter,LR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class NN extends G_{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new NN(e,t)}_apply(e){const t=function(i,s,o){if(null!==i.startAt)throw new ne(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new ne(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new m_(s,o)}(e._query,this._field,this._direction);return new Gr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new $a(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class yT extends G_{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new yT(e,t,r)}_apply(e){return new Gr(e.firestore,e.converter,Vw(e._query,this._limit,this._limitType))}}class vT extends G_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vT(e,t,r)}_apply(e){const t=ZG(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(s=t,new $a((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class ET extends G_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new ET(e,t,r)}_apply(e){const t=ZG(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(s=t,new $a((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function ZG(n,e,t,r){if(t[0]=(0,b.m9)(t[0]),t[0]instanceof z_)return function(s,o,a,u,l){if(!u)throw new ne(H.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of ff(s))if(f.field.isKeyField())d.push(wc(o,u.key));else{const m=u.data.field(f.field);if(Nw(m))throw new ne(H.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const _=f.field.canonicalString();throw new ne(H.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new nl(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=kc(n.firestore);return function(o,a,u,l,d,f){const m=o.explicitOrderBy;if(d.length>m.length)throw new ne(H.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let v=0;v<d.length;v++){const T=d[v];if(m[v].field.isKeyField()){if("string"!=typeof T)throw new ne(H.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof T}`);if(!FR(o)&&-1!==T.indexOf("/"))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${T}' contains a slash.`);const D=o.path.child(Dt.fromString(T));if(!fe.isDocumentKey(D))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const k=new fe(D);_.push(wc(a,k))}else{const D=qG(u,l,T);_.push(D)}}return new nl(_,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function QG(n,e,t){if("string"==typeof(t=(0,b.m9)(t))){if(""===t)throw new ne(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FR(e)&&-1!==t.indexOf("/"))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Dt.fromString(t));if(!fe.isDocumentKey(r))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wc(n,new fe(r))}if(t instanceof yn)return wc(n,t._key);throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cT(t)}.`)}function YG(n,e){if(!Array.isArray(n)||0===n.length)throw new ne(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XG(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new ne(H.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class MN{convertValue(e,t="none"){switch(el(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Qu(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new hT(Gn(e.latitude),Gn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Mw(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(h_(e));default:return null}}convertTimestamp(e){const t=Yu(e);return new Sn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Dt.fromString(e);Pe(hz(r));const i=new Xu(r.get(1),r.get(3)),s=new fe(r.popFirst(5));return i.isEqual(t)||nr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function IT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Hhe extends MN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}class Fc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ka extends z_{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new K_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(_T("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class K_ extends Ka{data(e={}){return super.data(e)}}class cl{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new K_(this._firestore,this._userDataWriter,r.key,r,new Fc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new K_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new K_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,d=-1;return 0!==a.type&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:zhe(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function zhe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}function e4(n,e){return n instanceof Ka&&e instanceof Ka?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof cl&&e instanceof cl&&n._firestore===e._firestore&&CN(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class dl extends MN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}function t4(n,e,t){n=mt(n,yn);const r=mt(n.firestore,dn),i=IT(n.converter,e,t);return Vf(r,[pT(kc(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Rn.none())])}function n4(n,e,t,...r){n=mt(n,yn);const i=mt(n.firestore,dn),s=kc(i);let o;return o="string"==typeof(e=(0,b.m9)(e))||e instanceof Wa?SN(s,"updateDoc",n._key,e,t,r):AN(s,"updateDoc",n._key,e),Vf(i,[o.toMutation(n._key,Rn.exists(!0))])}function r4(n,...e){var t,r,i;n=(0,b.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||bN(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(bN(e[o])){const f=e[o];e[o]=null===(t=f.next)||void 0===t?void 0:t.bind(f),e[o+1]=null===(r=f.error)||void 0===r?void 0:r.bind(f),e[o+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}let u,l,d;if(n instanceof yn)l=mt(n.firestore,dn),d=hf(n._key.path),u={next:f=>{e[o]&&e[o](xN(l,n,f))},error:e[o+1],complete:e[o+2]};else{const f=mt(n,Gr);l=mt(f.firestore,dn),d=f._query;const m=new dl(l);u={next:_=>{e[o]&&e[o](new cl(l,m,f,_))},error:e[o+1],complete:e[o+2]},KG(n._query)}return function(m,_,v,T){const D=new aT(T),k=new $P(_,D,v);return m.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return LP(yield Ff(m),k)})),()=>{D.Na(),m.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return UP(yield Ff(m),k)}))}}(Wn(l),d,a,u)}function Vf(n,e){return function(r,i){const s=new vr;return r.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function Lde(n,e,t){return WP.apply(this,arguments)}(yield IN(r),i,s)})),s.promise}(Wn(n),e)}function xN(n,e,t){const r=t.docs.get(e._key),i=new dl(n);return new Ka(n,i,e._key,r,new Fc(t.hasPendingWrites,t.fromCache),e.converter)}const lfe={maxAttempts:5};class i4{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=kc(e)}set(e,t,r){this._verifyNotCommitted();const i=hl(e,this._firestore),s=IT(i.converter,t,r),o=pT(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Rn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=hl(e,this._firestore);let o;return o="string"==typeof(t=(0,b.m9)(t))||t instanceof Wa?SN(this._dataReader,"WriteBatch.update",s._key,t,r,i):AN(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Rn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hl(e,this._firestore);return this._mutations=this._mutations.concat(new yf(t._key,Rn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ne(H.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hl(n,e){if((n=(0,b.m9)(n)).firestore!==e)throw new ne(H.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class cfe extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=kc(t)}get(t){const r=hl(t,this._firestore),i=new Hhe(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return we();const o=s[0];if(o.isFoundDocument())return new z_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new z_(this._firestore,i,r._key,null,r.converter);throw we()})}set(t,r,i){const s=hl(t,this._firestore),o=IT(s.converter,r,i),a=pT(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=hl(t,this._firestore);let a;return a="string"==typeof(r=(0,b.m9)(r))||r instanceof Wa?SN(this._dataReader,"Transaction.update",o._key,r,i,s):AN(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=hl(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hl(e,this._firestore),r=new dl(this._firestore);return super.get(e).then(i=>new Ka(this._firestore,r,t._key,i._document,new Fc(!1,!1),t.converter))}}function ON(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ne("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function u4(){if(typeof Uint8Array>"u")throw new ne("unimplemented","Uint8Arrays are not available in this environment.")}function l4(){if(!function Hle(){return typeof atob<"u"}())throw new ne("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){nf=qi.SDK_VERSION,(0,qi._registerComponent)(new uo.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new dn(new fle(r.getProvider("auth-internal")),new mle(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new ne(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xu(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(UH,"4.3.2",e),(0,qi.registerVersion)(UH,"4.3.2","esm2017")}();class Z_{constructor(e){this._delegate=e}static fromBase64String(e){return l4(),new Z_(Jo.fromBase64String(e))}static fromUint8Array(e){return u4(),new Z_(Jo.fromUint8Array(e))}toBase64(){return l4(),this._delegate.toBase64()}toUint8Array(){return u4(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function FN(n){return function Efe(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class Ife{enableIndexedDbPersistence(e,t){return function yhe(n,e){BG(n=mt(n,dn));const t=Wn(n);if(t._uninitializedComponentsProvider)throw new ne(H.FAILED_PRECONDITION,"SDK cache is already specified.");Wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new kf;return UG(t,i,new pN(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function vhe(n){BG(n=mt(n,dn));const e=Wn(n);if(e._uninitializedComponentsProvider)throw new ne(H.FAILED_PRECONDITION,"SDK cache is already specified.");Wi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new kf;return UG(e,r,new EG(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Ehe(n){if(n._initialized&&!n._terminated)throw new ne(H.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new vr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Q.Z)(function*(){try{yield(t=(0,Q.Z)(function*(i){if(!mo.D())return Promise.resolve();const s=i+"main";yield mo.delete(s)}),function r(i){return t.apply(this,arguments)})(oP(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class c4{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xu||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Wi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function OG(n,e,t,r={}){var i;const s=(n=mt(n,j_))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=Nr.MOCK_USER;else{a=(0,b.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new ne(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Nr(l)}n._authCredentials=new hle(new BH(a,u))}}(this._delegate,e,t,r)}enableNetwork(){return function whe(n){return function ihe(n){return n.asyncQueue.enqueue((0,Q.Z)(function*(){const e=yield TG(n),t=yield CG(n);return e.setNetworkEnabled(!0),function(i){const s=he(i);return s.C_.delete(0),V_(s)}(t)}))}(Wn(n=mt(n,dn)))}(this._delegate)}disableNetwork(){return function The(n){return function she(n){return n.asyncQueue.enqueue((0,Q.Z)(function*(){const e=yield TG(n),t=yield CG(n);return e.setNetworkEnabled(!1),(r=(0,Q.Z)(function*(s){const o=he(s);o.C_.add(0),yield Af(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(Wn(n=mt(n,dn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,PG("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Ihe(n){return function(t){const r=new vr;return t.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function jde(n,e){return XP.apply(this,arguments)}(yield IN(t),r)})),r.promise}(Wn(n=mt(n,dn)))}(this._delegate)}onSnapshotsInSync(e){return function efe(n,e){return function uhe(n,e){const t=new aT(e);return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return i=yield Ff(n),s=t,he(i).q_.add(s),void s.next();var i,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return i=yield Ff(n),s=t,void he(i).q_.delete(s);var i,s}))}}(Wn(n=mt(n,dn)),bN(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new ne("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Uf(this,FG(this._delegate,e))}catch(t){throw Ri(t,"collection()","Firestore.collection()")}}doc(e){try{return new Gs(this,dT(this._delegate,e))}catch(t){throw Ri(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pi(this,function phe(n,e){if(n=mt(n,j_),TN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ne(H.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gr(n,null,(r=e,new $a(Dt.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw Ri(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function dfe(n,e,t){n=mt(n,dn);const r=Object.assign(Object.assign({},lfe),t);return function(s){if(s.maxAttempts<1)throw new ne(H.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new vr;return s.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){const l=yield function bG(n){return lT(n).then(e=>e.datastore)}(s);new nhe(s.asyncQueue,l,a,o,u).run()})),u.promise}(Wn(n),i=>e(new cfe(n,i)),r)}(this._delegate,t=>e(new d4(this,t)))}batch(){return Wn(this._delegate),new h4(new i4(this._delegate,e=>Vf(this._delegate,e)))}loadBundle(e){return function Che(n,e){const t=Wn(n=mt(n,dn)),r=new mhe;return function lhe(n,e,t,r){const i=function(o,a){let u;return u="string"==typeof o?Kq().encode(o):o,d=function(d,f){if(d instanceof Uint8Array)return IG(d,f);if(d instanceof ArrayBuffer)return IG(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new ehe(d,a);var d}(t,L_(e));n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){!function Xde(n,e,t){const r=he(n);var i;(i=(0,Q.Z)(function*(o,a,u){try{const l=yield a.getMetadata();if(yield function(v,T){const D=he(v),k=rr(T.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",P=>D.Kr.getBundleMetadata(P,T.id)).then(P=>!!P&&P.createTime.compareTo(k)>=0)}(o.localStore,l))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(v=l).totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}),Promise.resolve(new Set);u._updateProgress(dG(l));const d=new Nde(l,o.localStore,a.serializer);let f=yield a.Ma();for(;f;){const _=yield d.ea(f);_&&u._updateProgress(_),f=yield a.Ma()}const m=yield d.complete();return yield Ga(o,m.ra,void 0),yield function(v,T){const D=he(v);return D.persistence.runTransaction("Save bundle","readwrite",k=>D.Kr.saveBundleMetadata(k,T))}(o.localStore,l),u._completeWith(m.progress),Promise.resolve(m.na)}catch(l){return Wi("SyncEngine",`Loading bundle failed with ${l}`),u._failWith(l),Promise.resolve(new Set)}var v}),function s(o,a,u){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield IN(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function bhe(n,e){return function che(n,e){return n.asyncQueue.enqueue((0,Q.Z)(function*(){return function(r,i){const s=he(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Of(n),e)}))}(Wn(n=mt(n,dn)),e).then(t=>t?new Gr(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Pi(this,t):null)}}class TT extends MN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Z_(new Jo(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Gs.forKey(t,this.firestore,null)}}class d4{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new TT(e)}get(e){const t=Vc(e);return this._delegate.get(t).then(r=>new Q_(this._firestore,new Ka(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Vc(e);return r?(ON("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Vc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Vc(e);return this._delegate.delete(t),this}}class h4{constructor(e){this._delegate=e}set(e,t,r){const i=Vc(e);return r?(ON("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Vc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Vc(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Lc{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new K_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Y_(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Lc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Lc(e,new TT(e),t),i.set(t,s)),s}}Lc.INSTANCES=new WeakMap;class Gs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new TT(e)}static forPath(e,t,r){if(e.length%2!=0)throw new ne("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Gs(t,new yn(t._delegate,r,new fe(e)))}static forKey(e,t,r){return new Gs(t,new yn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Uf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Uf(this.firestore,FG(this._delegate,e))}catch(t){throw Ri(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,b.m9)(e))instanceof yn&&LG(this._delegate,e)}set(e,t){t=ON("DocumentReference.set",t);try{return t?t4(this._delegate,e,t):t4(this._delegate,e)}catch(r){throw Ri(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?n4(this._delegate,e):n4(this._delegate,e,t,...r)}catch(i){throw Ri(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Xhe(n){return Vf(mt(n.firestore,dn),[new yf(n._key,Rn.none())])}(this._delegate)}onSnapshot(...e){const t=f4(e),r=p4(e,i=>new Q_(this.firestore,new Ka(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return r4(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function Whe(n){n=mt(n,yn);const e=mt(n.firestore,dn),t=Wn(e),r=new dl(e);return function ohe(n,e){const t=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return(r=(0,Q.Z)(function*(s,o,a){try{const u=yield function(d,f){const m=he(d);return m.persistence.runTransaction("read document","readonly",_=>m.localDocuments.getDocument(_,f))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new ne(H.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const l=Pf(u,`Failed to get document '${o} from cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Of(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Ka(e,r,n._key,i,new Fc(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Khe(n){n=mt(n,yn);const e=mt(n.firestore,dn);return DG(Wn(e),n._key,{source:"server"}).then(t=>xN(e,n,t))}(this._delegate):function Ghe(n){n=mt(n,yn);const e=mt(n.firestore,dn);return DG(Wn(e),n._key).then(t=>xN(e,n,t))}(this._delegate),t.then(r=>new Q_(this.firestore,new Ka(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Gs(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Ri(n,e,t){return n.message=n.message.replace(e,t),n}function f4(n){for(const e of n)if("object"==typeof e&&!FN(e))return e;return{}}function p4(n,e){var t,r;let i;return i=FN(n[0])?n[0]:FN(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Q_{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Gs(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return e4(this._delegate,e._delegate)}}class Y_ extends Q_{data(e){const t=this._delegate.data(e);return this._delegate._converter||function cle(n,e){n||we()}(void 0!==t),t}}class Pi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new TT(e)}where(e,t,r){try{return new Pi(this.firestore,ll(this._delegate,function Ohe(n,e,t){const r=e,i=_T("where",n);return W_._create(i,r,t)}(e,t,r)))}catch(i){throw Ri(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pi(this.firestore,ll(this._delegate,function Fhe(n,e="asc"){const t=e,r=_T("orderBy",n);return NN._create(r,t)}(e,t)))}catch(r){throw Ri(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pi(this.firestore,ll(this._delegate,function Lhe(n){return xG("limit",n),yT._create("limit",n,"F")}(e)))}catch(t){throw Ri(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pi(this.firestore,ll(this._delegate,function Vhe(n){return xG("limitToLast",n),yT._create("limitToLast",n,"L")}(e)))}catch(t){throw Ri(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pi(this.firestore,ll(this._delegate,function Uhe(...n){return vT._create("startAt",n,!0)}(...e)))}catch(t){throw Ri(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pi(this.firestore,ll(this._delegate,function Bhe(...n){return vT._create("startAfter",n,!1)}(...e)))}catch(t){throw Ri(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pi(this.firestore,ll(this._delegate,function jhe(...n){return ET._create("endBefore",n,!1)}(...e)))}catch(t){throw Ri(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pi(this.firestore,ll(this._delegate,function $he(...n){return ET._create("endAt",n,!0)}(...e)))}catch(t){throw Ri(t,"endAt()","Query.endAt()")}}isEqual(e){return CN(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Qhe(n){n=mt(n,Gr);const e=mt(n.firestore,dn),t=Wn(e),r=new dl(e);return function ahe(n,e){const t=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return(r=(0,Q.Z)(function*(s,o,a){try{const u=yield eT(s,o,!0),l=new pG(o,u.ls),d=l.ca(u.documents),f=l.applyChanges(d,!1);a.resolve(f.snapshot)}catch(u){const l=Pf(u,`Failed to execute query '${o} against cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Of(n),e,t);var r})),t.promise}(t,n._query).then(i=>new cl(e,r,n,i))}(this._delegate):"server"===e?.source?function Yhe(n){n=mt(n,Gr);const e=mt(n.firestore,dn),t=Wn(e),r=new dl(e);return AG(t,n._query,{source:"server"}).then(i=>new cl(e,r,n,i))}(this._delegate):function Zhe(n){n=mt(n,Gr);const e=mt(n.firestore,dn),t=Wn(e),r=new dl(e);return KG(n._query),AG(t,n._query).then(i=>new cl(e,r,n,i))}(this._delegate),t.then(r=>new LN(this.firestore,new cl(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=f4(e),r=p4(e,i=>new LN(this.firestore,new cl(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return r4(this._delegate,t,r)}withConverter(e){return new Pi(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}class Tfe{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Y_(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class LN{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Y_(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Tfe(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Y_(this._firestore,r))})}isEqual(e){return e4(this._delegate,e._delegate)}}class Uf extends Pi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Gs(this.firestore,e):null}doc(e){try{return new Gs(this.firestore,void 0===e?dT(this._delegate):dT(this._delegate,e))}catch(t){throw Ri(t,"doc()","CollectionReference.doc()")}}add(e){return function Jhe(n,e){const t=mt(n.firestore,dn),r=dT(n),i=IT(n.converter,e);return Vf(t,[pT(kc(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Rn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Gs(this.firestore,t))}isEqual(e){return LG(this._delegate,e._delegate)}withConverter(e){return new Uf(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Vc(n){return mt(n,yn)}class VN{constructor(...e){this._delegate=new Wa(...e)}static documentId(){return new VN(mn.keyField().canonicalString())}isEqual(e){return(e=(0,b.m9)(e))instanceof Wa&&this._delegate._internalPath.isEqual(e._internalPath)}}class Uc{constructor(e){this._delegate=e}static serverTimestamp(){const e=function ffe(){return new DN("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Uc(e)}static delete(){const e=function hfe(){return new H_("deleteField")}();return e._methodName="FieldValue.delete",new Uc(e)}static arrayUnion(...e){const t=function pfe(...n){return new Phe("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Uc(t)}static arrayRemove(...e){const t=function gfe(...n){return new Nhe("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Uc(t)}static increment(e){const t=function mfe(n){return new Mhe("increment",n)}(e);return t._methodName="FieldValue.increment",new Uc(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Cfe={Firestore:c4,GeoPoint:hT,Timestamp:Sn,Blob:Z_,Transaction:d4,WriteBatch:h4,DocumentReference:Gs,DocumentSnapshot:Q_,Query:Pi,QueryDocumentSnapshot:Y_,QuerySnapshot:LN,CollectionReference:Uf,FieldPath:VN,FieldValue:Uc,setLogLevel:function wfe(n){!function lle(n){Wu.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function g4(n,e){return function Afe(n,e=cI){return new Ze(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function UN(n,e){return g4(n,e).pipe(de(t=>({payload:t,type:"query"})))}!function Dfe(n){(function bfe(n,e){n.INTERNAL.registerComponent(new uo.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Cfe)))})(n,(e,t)=>new c4(e,t,new Ife)),n.registerVersion("@firebase/firestore-compat","0.3.22")}(fs.Z);class m4{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=w4(r,t);return new v4(i,s,this.afs)}snapshotChanges(){return function Sfe(n,e){return g4(n,e).pipe(zE(void 0),OS(),de(t=>{const[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return this.snapshotChanges().pipe(de(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return I(this.ref.get(e)).pipe(tr)}}function CT(n,e){return UN(n,e).pipe(zE(void 0),OS(),de(t=>{const[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const l=s.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function _4(n,e,t){return CT(n,t).pipe(Eh((r,i)=>function Rfe(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function Pfe(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return BN(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return BN(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return BN(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),Fe(),de(r=>r.map(i=>({type:i.type,payload:i}))))}function BN(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function y4(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class v4{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=CT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(de(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(zE(void 0),OS(),js(([r,i])=>i.length>0||!r),de(([,r])=>r),tr)}auditTrail(e){return this.stateChanges(e).pipe(Eh((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=y4(e);return _4(this.query,t,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return UN(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),tr)}get(e){return I(this.query.get(e)).pipe(tr)}add(e){return this.ref.add(e)}doc(e){return new m4(this.ref.doc(e),this.afs)}}class Nfe{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?CT(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.filter(r=>e.indexOf(r.type)>-1)),js(t=>t.length>0),tr):CT(this.query,this.afs.schedulers.outsideAngular).pipe(tr)}auditTrail(e){return this.stateChanges(e).pipe(Eh((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=y4(e);return _4(this.query,t,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return UN(this.query,this.afs.schedulers.outsideAngular).pipe(de(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),tr)}get(e){return I(this.query.get(e)).pipe(tr)}}const E4=new le("angularfire2.enableFirestorePersistence"),I4=new le("angularfire2.firestore.persistenceSettings"),Mfe=new le("angularfire2.firestore.settings"),xfe=new le("angularfire2.firestore.use-emulator");function w4(n,e=(t=>t)){return{query:e(n),ref:n}}let kfe=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,u,l,d,f,m,_,v,T,D,k,P){this.schedulers=u;const O=om(t,a,r),q=d;f&&_A(O,a,m,v,T,D,_,k),[this.firestore,this.persistenceEnabled$]=fI(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{const ue=a.runOutsideAngular(()=>O.firestore());if(s&&ue.settings(s),q&&ue.useEmulator(...q),i&&!SE(o)){const Te=()=>{try{return I(ue.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Ue){return typeof console<"u"&&console.warn(Ue),R(!1)}};return[ue,a.runOutsideAngular(Te)]}return[ue,R(!1)]},[s,q,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=w4(i,r),a=this.schedulers.ngZone.run(()=>s);return new v4(a,o,this)}collectionGroup(t,r){const i=r||(o=>o),s=this.firestore.collectionGroup(t);return new Nfe(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new m4(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(W(xh),W(kh,8),W(E4,8),W(Mfe,8),W(Ls),W(wt),W(hI),W(I4,8),W(xfe,8),W(tc,8),W(dA,8),W(hA,8),W(fA,8),W(pA,8),W(gA,8),W(mA,8),W(dI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Ofe=(()=>{class n{constructor(){fs.Z.registerVersion("angularfire",Ph.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:E4,useValue:!0},{provide:I4,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({providers:[kfe]})}return n})();const T4="firebasestorage.googleapis.com",C4="storageBucket";class Ln extends b.ZR{constructor(e,t,r=0){super(jN(e),`Firebase Storage: ${t} (${jN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ln.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Pn=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Pn||{});function jN(n){return"storage/"+n}function $N(){return new Ln(Pn.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function b4(){return new Ln(Pn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function D4(){return new Ln(Pn.CANCELED,"User canceled the upload/download.")}function A4(){return new Ln(Pn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Bf(n){return new Ln(Pn.INVALID_ARGUMENT,n)}function S4(){return new Ln(Pn.APP_DELETED,"The Firebase app was deleted.")}function R4(n){return new Ln(Pn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function X_(n,e){return new Ln(Pn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function J_(n){throw new Ln(Pn.INTERNAL_ERROR,"Internal error: "+n)}class ui{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ui.makeFromUrl(e,t)}catch{return new ui(e,"")}if(""===r.path)return r;throw function Gfe(n){return new Ln(Pn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function l(q){q.path_=decodeURIComponent(q.path)}const f=t.replace(/[.]/g,"\\."),O=[{regex:a,indices:{bucket:1,path:3},postModify:function s(q){"/"===q.path.charAt(q.path.length-1)&&(q.path_=q.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${f}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp(`^https?://${t===T4?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:l}];for(let q=0;q<O.length;q++){const ue=O[q],Te=ue.regex.exec(e);if(Te){let St=Te[ue.indices.path];St||(St=""),r=new ui(Te[ue.indices.bucket],St),ue.postModify(r);break}}if(null==r)throw function zfe(n){return new Ln(Pn.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return r}}class Yfe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function bT(n){return"string"==typeof n||n instanceof String}function P4(n){return HN()&&n instanceof Blob}function HN(){return typeof Blob<"u"&&!(0,b.UG)()}function qN(n,e,t,r){if(r<e)throw Bf(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Bf(`Invalid value for '${n}'. Expected ${t} or less.`)}function Za(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function N4(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var jf=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(jf||{});function M4(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),s=-1!==e.indexOf(n);return t||i||s}class rpe{constructor(e,t,r,i,s,o,a,u,l,d,f,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,v)=>{this.resolve_=_,this.reject_=v,this.start_()})}start_(){const t=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function epe(n){return void 0!==n}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=$N();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?S4():D4():b4())};this.canceled_?t(0,new DT(!1,null,!0)):this.backoffId_=function Xfe(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function d(...D){l||(l=!0,e.apply(null,D))}function f(D){i=setTimeout(()=>{i=null,n(_,u())},D)}function m(){s&&clearTimeout(s)}function _(D,...k){if(l)return void m();if(D)return m(),void d.call(null,D,...k);if(u()||o)return m(),void d.call(null,D,...k);let O;r<64&&(r*=2),1===a?(a=2,O=0):O=1e3*(r+Math.random()),f(O)}let v=!1;function T(D){v||(v=!0,m(),!l&&(null!==i?(D||(a=2),clearTimeout(i),f(0)):D||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}((r,i)=>{if(i)return void r(!1,new DT(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===jf.NO_ERROR,u=s.getStatus();if(!a||M4(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===jf.ABORT;return void r(!1,new DT(!1,null,d))}const l=-1!==this.successCodes_.indexOf(u);r(!0,new DT(l,s))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function Jfe(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class DT{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function cpe(...n){const e=function lpe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(HN())return new Blob(n);throw new Ln(Pn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const vs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zN{constructor(e,t){this.data=e,this.contentType=t||null}}function GN(n,e){switch(n){case vs.RAW:return new zN(x4(e));case vs.BASE64:case vs.BASE64URL:return new zN(k4(n,e));case vs.DATA_URL:return new zN(function ppe(n){const e=new O4(n);return e.base64?k4(vs.BASE64,e.rest):function fpe(n){let e;try{e=decodeURIComponent(n)}catch{throw X_(vs.DATA_URL,"Malformed data URL.")}return x4(e)}(e.rest)}(e),function gpe(n){return new O4(n).contentType}(e))}throw $N()}function x4(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function k4(n,e){switch(n){case vs.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw X_(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case vs.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw X_(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function hpe(n){if(typeof atob>"u")throw function Qfe(n){return new Ln(Pn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:X_(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class O4{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw X_(vs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function mpe(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class ea{constructor(e,t){let r=0,i="";P4(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(P4(this.data_)){const i=function dpe(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new ea(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new ea(r,!0)}}static getBlob(...e){if(HN()){const t=e.map(r=>r instanceof ea?r.data_:r);return new ea(cpe.apply(null,t))}{const t=e.map(o=>bT(o)?GN(vs.RAW,o).data:o.data_);let r=0;t.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new ea(i,!0)}}uploadData(){return this.data_}}function WN(n){let e;try{e=JSON.parse(n)}catch{return null}return function npe(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function F4(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function vpe(n,e){return e}class Ni{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||vpe}}let AT=null;function ey(){if(AT)return AT;const n=[];n.push(new Ni("bucket")),n.push(new Ni("generation")),n.push(new Ni("metageneration")),n.push(new Ni("name","fullPath",!0));const t=new Ni("name");t.xform=function e(s,o){return function Epe(n){return!bT(n)||n.length<2?n:F4(n)}(o)},n.push(t);const i=new Ni("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},n.push(i),n.push(new Ni("timeCreated")),n.push(new Ni("updated")),n.push(new Ni("md5Hash",null,!0)),n.push(new Ni("cacheControl",null,!0)),n.push(new Ni("contentDisposition",null,!0)),n.push(new Ni("contentEncoding",null,!0)),n.push(new Ni("contentLanguage",null,!0)),n.push(new Ni("contentType",null,!0)),n.push(new Ni("metadata","customMetadata",!0)),AT=n,AT}function L4(n,e,t){const r=WN(e);return null===r?null:function wpe(n,e,t){const r={type:"file"},i=t.length;for(let s=0;s<i;s++){const o=t[s];r[o.local]=o.xform(r,e[o.server])}return function Ipe(n,e){Object.defineProperty(n,"ref",{get:function t(){const s=new ui(n.bucket,n.fullPath);return e._makeStorageReference(s)}})}(r,n),r}(n,r,t)}function KN(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}const V4="prefixes",U4="items";class ta{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function na(n){if(!n)throw $N()}function ST(n,e){return function t(r,i){const s=L4(n,i,e);return na(null!==s),s}}function $f(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function Hfe(){return new Ln(Pn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function $fe(){return new Ln(Pn.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function jfe(n){return new Ln(Pn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function qfe(n){return new Ln(Pn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function ty(n){const e=$f(n);return function t(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function Bfe(n){return new Ln(Pn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),s.serverResponse=i.serverResponse,s}}function B4(n,e,t){const i=Za(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new ta(i,"GET",ST(n,t),o);return a.errorHandler=ty(e),a}function Spe(n,e,t,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=Za(e.bucketOnlyServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new ta(a,"GET",function Dpe(n,e){return function t(r,i){const s=function bpe(n,e,t){const r=WN(t);return null===r?null:function Cpe(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[V4])for(const i of t[V4]){const s=i.replace(/\/$/,""),o=n._makeStorageReference(new ui(e,s));r.prefixes.push(o)}if(t[U4])for(const i of t[U4]){const s=n._makeStorageReference(new ui(e,i.name));r.items.push(s)}return r}(n,e,r)}(n,e,i);return na(null!==s),s}}(n,e.bucket),l);return d.urlParams=s,d.errorHandler=$f(e),d}function $4(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function Mpe(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class RT{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function ZN(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{na(!1)}return na(!!t&&-1!==(e||["active"]).indexOf(t)),t}const Fpe={STATE_CHANGED:"state_changed"},Mi={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function QN(n){switch(n){case"running":case"pausing":case"canceling":return Mi.RUNNING;case"paused":return Mi.PAUSED;case"success":return Mi.SUCCESS;case"canceled":return Mi.CANCELED;default:return Mi.ERROR}}class Lpe{constructor(e,t,r){if(function tpe(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function Hf(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let z4=null;class Vpe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=jf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=jf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=jf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw J_("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw J_("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw J_("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw J_("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw J_("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Upe extends Vpe{initXhr(){this.xhr_.responseType="text"}}function _o(){return z4?z4():new Upe}class G4{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=ey(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Pn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(M4(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=b4()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Pn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function xpe(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),o=$4(e,r,i),a={name:o.fullPath},u=Za(s,n.host,n._protocol),d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=KN(o,t),v=new ta(u,"POST",function _(T){let D;ZN(T);try{D=T.getResponseHeader("X-Goog-Upload-URL")}catch{na(!1)}return na(bT(D)),D},n.maxUploadRetryTime);return v.urlParams=a,v.headers=d,v.body=f,v.errorHandler=$f(e),v}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,_o,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function kpe(n,e,t,r){const u=new ta(t,"POST",function s(l){const d=ZN(l,["active","final"]);let f=null;try{f=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{na(!1)}f||na(!1);const m=Number(f);return na(!isNaN(m)),new RT(m,r.size(),"final"===d)},n.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=$f(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,_o,t,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new RT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function Ope(n,e,t,r,i,s,o,a){const u=new RT(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function Kfe(){return new Ln(Pn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const l=u.total-u.current;let d=l;i>0&&(d=Math.min(d,i));const f=u.current;let _="";_=0===d?"finalize":l===d?"upload, finalize":"upload";const v={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${u.current}`},T=r.slice(f,f+d);if(null===T)throw A4();const O=new ta(t,"POST",function D(q,ue){const Te=ZN(q,["active","final"]),Ue=u.current+d,St=r.size();let Ir;return Ir="final"===Te?ST(e,s)(q,ue):null,new RT(Ue,St,"final"===Te,Ir)},e.maxUploadRetryTime);return O.headers=v,O.body=T.uploadData(),O.progressCallback=a||null,O.errorHandler=$f(n),O}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,_o,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=B4(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,_o,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function H4(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let O="";for(let q=0;q<2;q++)O+=Math.random().toString().slice(2);return O}();o["Content-Type"]="multipart/related; boundary="+u;const l=$4(e,r,i),d=KN(l,t),_=ea.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+d+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===_)throw A4();const v={name:l.fullPath},T=Za(s,n.host,n._protocol),k=n.maxUploadRetryTime,P=new ta(T,"POST",ST(n,t),k);return P.urlParams=v,P.headers=o,P.body=_.uploadData(),P.errorHandler=$f(e),P}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,_o,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=D4(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=QN(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const s=new Lpe(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(QN(this._state)){case Mi.SUCCESS:Hf(this._resolve.bind(null,this.snapshot))();break;case Mi.CANCELED:case Mi.ERROR:Hf(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(QN(this._state)){case Mi.RUNNING:case Mi.PAUSED:e.next&&Hf(e.next.bind(e,this.snapshot))();break;case Mi.SUCCESS:e.complete&&Hf(e.complete.bind(e))();break;default:e.error&&Hf(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Bc{constructor(e,t){this._service=e,this._location=t instanceof ui?t:ui.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Bc(e,t)}get root(){const e=new ui(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return F4(this._location.path)}get storage(){return this._service}get parent(){const e=function _pe(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new ui(this._location.bucket,e);return new Bc(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw R4(e)}}function K4(n,e,t){return YN.apply(this,arguments)}function YN(){return YN=(0,Q.Z)(function*(n,e,t){const i=yield Z4(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield K4(n,e,i.nextPageToken))}),YN.apply(this,arguments)}function Z4(n,e){null!=e&&"number"==typeof e.maxResults&&qN("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=Spe(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,_o)}function Ype(n){n._throwIfRoot("getDownloadURL");const e=function Rpe(n,e,t){const i=Za(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new ta(i,"GET",function Ape(n,e){return function t(r,i){const s=L4(n,i,e);return na(null!==s),function Tpe(n,e,t,r){const i=WN(e);if(null===i||!bT(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(l=>{const f=n.fullPath;return Za("/b/"+o(n.bucket)+"/o/"+o(f),t,r)+N4({alt:"media",token:l})})[0]}(s,i,n.host,n._protocol)}}(n,t),o);return a.errorHandler=ty(e),a}(n.storage,n._location,ey());return n.storage.makeRequestWithTokens(e,_o).then(t=>{if(null===t)throw function Zfe(){return new Ln(Pn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return t})}function Q4(n,e){const t=function ype(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new ui(n._location.bucket,t);return new Bc(n.storage,r)}function Y4(n,e){if(n instanceof XN){const t=n;if(null==t._bucket)throw function Wfe(){return new Ln(Pn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+C4+"' property when initializing the app?")}();const r=new Bc(t,t._bucket);return null!=e?Y4(r,e):r}return void 0!==e?Q4(n,e):n}function tge(n,e){if(e&&function Jpe(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof XN)return function ege(n,e){return new Bc(n,e)}(n,e);throw Bf("To use ref(service, url), the first argument must be a Storage instance.")}return Y4(n,e)}function X4(n,e){const t=e?.[C4];return null==t?null:ui.makeFromBucketSpec(t,n)}class XN{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=T4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ui.makeFromBucketSpec(i,this._host):X4(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ui.makeFromBucketSpec(this._url,e):X4(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Q.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Q.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Bc(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Yfe(S4());{const o=function upe(n,e,t,r,i,s,o=!0){const a=N4(n.urlParams),u=n.url+a,l=Object.assign({},n.headers);return function ope(n,e){e&&(n["X-Firebase-GMPID"]=e)}(l,e),function ipe(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(l,t),function spe(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,s),function ape(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(l,r),new rpe(u,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){var r=this;return(0,Q.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,s).getPromise()})()}}const J4="@firebase/storage";function nW(n,e){return tge(n=(0,b.m9)(n),e)}function dge(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new XN(t,r,i,e,qi.SDK_VERSION)}!function hge(){(0,qi._registerComponent)(new uo.wA("storage",dge,"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(J4,"0.11.2",""),(0,qi.registerVersion)(J4,"0.11.2","esm2017")}();class PT{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class iW{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new PT(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new PT(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(s="function"==typeof t?o=>t(new PT(o,this,this._ref)):{next:t.next?o=>t.next(new PT(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class sW{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Qa(e,this._service))}get items(){return this._delegate.items.map(e=>new Qa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Qa{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function cge(n,e){return Q4(n,e)}(this._delegate,e);return new Qa(t,this.storage)}get root(){return new Qa(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Qa(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new iW(function rge(n,e,t){return function Gpe(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new G4(n,new ea(e),t)}(n=(0,b.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=vs.RAW,r){this._throwIfRoot("putString");const i=GN(t,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new iW(new G4(this._delegate,new ea(i.data,!0),s),this)}listAll(){return function age(n){return function Kpe(n){const e={prefixes:[],items:[]};return K4(n,e).then(()=>e)}(n=(0,b.m9)(n))}(this._delegate).then(e=>new sW(e,this.storage))}list(e){return function oge(n,e){return Z4(n=(0,b.m9)(n),e)}(this._delegate,e||void 0).then(t=>new sW(t,this.storage))}getMetadata(){return function ige(n){return function Zpe(n){n._throwIfRoot("getMetadata");const e=B4(n.storage,n._location,ey());return n.storage.makeRequestWithTokens(e,_o)}(n=(0,b.m9)(n))}(this._delegate)}updateMetadata(e){return function sge(n,e){return function Qpe(n,e){n._throwIfRoot("updateMetadata");const t=function Ppe(n,e,t,r){const s=Za(e.fullServerUrl(),n.host,n._protocol),a=KN(t,r),l=n.maxOperationRetryTime,d=new ta(s,"PATCH",ST(n,r),l);return d.headers={"Content-Type":"application/json; charset=utf-8"},d.body=a,d.errorHandler=ty(e),d}(n.storage,n._location,e,ey());return n.storage.makeRequestWithTokens(t,_o)}(n=(0,b.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function uge(n){return Ype(n=(0,b.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function lge(n){return function Xpe(n){n._throwIfRoot("deleteObject");const e=function Npe(n,e){const r=Za(e.fullServerUrl(),n.host,n._protocol),a=new ta(r,"DELETE",function o(u,l){},n.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=ty(e),a}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,_o)}(n=(0,b.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw R4(e)}}class oW{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(aW(e))throw Bf("ref() expected a child path but got a URL, use refFromURL instead.");return new Qa(nW(this._delegate,e),this)}refFromURL(e){if(!aW(e))throw Bf("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ui.makeFromUrl(e,this._delegate.host)}catch{throw Bf("refFromUrl() expected a valid full URL but got an invalid one.")}return new Qa(nW(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function rW(n,e,t,r={}){!function nge(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,b.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function aW(n){return/^[A-Za-z]+:\/\//.test(n)}function mge(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new oW(t,r)}function uW(n){const e=function yge(n){return new Ze(e=>{const t=o=>e.next(o);t(n.snapshot);const s=n.on("state_changed",t);return n.then(o=>{t(o),e.complete()},o=>{t(n.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function Ffe(n,e=cI){return Y((t,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const l=s;s=null,r.next(l)}};function u(){const l=o+n,d=e.now();if(d<l)return i=this.schedule(void 0,l-d),void r.add(i);a()}t.subscribe(ce(r,l=>{s=l,o=e.now(),i||(i=e.schedule(u,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(de(t=>t.bytesTransferred/t.totalBytes*100))}}function NT(n){return{getDownloadURL:()=>R(void 0).pipe(NU,ve(()=>n.getDownloadURL()),tr),getMetadata:()=>R(void 0).pipe(NU,ve(()=>n.getMetadata()),tr),delete:()=>I(n.delete()),child:e=>NT(n.child(e)),updateMetadata:e=>I(n.updateMetadata(e)),put:(e,t)=>uW(n.put(e,t)),putString:(e,t,r)=>uW(n.putString(e,t,r)),list:e=>I(n.list(e)),listAll:()=>I(n.listAll())}}!function _ge(n){const e={TaskState:Mi,TaskEvent:Fpe,StringFormat:vs,Storage:oW,Reference:Qa};n.INTERNAL.registerComponent(new uo.wA("storage-compat",mge,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(fs.Z);const vge=new le("angularfire2.storageBucket"),Ege=new le("angularfire2.storage.maxUploadRetryTime"),Ige=new le("angularfire2.storage.maxOperationRetryTime"),wge=new le("angularfire2.storage.use-emulator");let Tge=(()=>{class n{storage;constructor(t,r,i,s,o,a,u,l,d,f){const m=om(t,o,r);this.storage=fI(`${m.name}.storage.${i}`,"AngularFireStorage",m.name,()=>{const _=o.runOutsideAngular(()=>m.storage(i||void 0)),v=d;return v&&_.useEmulator(...v),u&&_.setMaxUploadRetryTime(u),l&&_.setMaxOperationRetryTime(l),_},[u,l])}ref(t){return NT(this.storage.ref(t))}refFromURL(t){return NT(this.storage.refFromURL(t))}upload(t,r,i){return NT(this.storage.ref(t)).put(r,i)}static \u0275fac=function(r){return new(r||n)(W(xh),W(kh,8),W(vge,8),W(Ls),W(wt),W(hI),W(Ege,8),W(Ige,8),W(wge,8),W(dI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Cge=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({})}return n})(),bge=(()=>{class n{constructor(){fs.Z.registerVersion("angularfire",Ph.full,"gcs-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=nn({type:n});static \u0275inj=Cn({providers:[Tge],imports:[Cge]})}return n})();function lW(n){return new L(3e3,!1)}function fl(n){switch(n.length){case 0:return new um;case 1:return n[0];default:return new BU(n)}}function cW(n,e,t=new Map,r=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(u=>{const l=u.get("offset"),d=l==o,f=d&&a||new Map;u.forEach((m,_)=>{let v=_,T=m;if("offset"!==_)switch(v=n.normalizePropertyName(v,i),T){case"!":T=t.get(_);break;case Fa:T=r.get(_);break;default:T=n.normalizeStyleValue(_,v,T,i)}f.set(v,T)}),d||s.push(f),a=f,o=l}),i.length)throw function Kge(n){return new L(3502,!1)}();return s}function JN(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&eM(t,"start",n)));break;case"done":n.onDone(()=>r(t&&eM(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&eM(t,"destroy",n)))}}function eM(n,e,t){const s=tM(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function tM(n,e,t,r,i="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function Es(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function dW(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const ome=(()=>typeof document>"u"?null:document.documentElement)();function nM(n){const e=n.parentNode||n.host||null;return e===ome?null:e}let jc=null,hW=!1;function fW(n,e){for(;e;){if(e===n)return!0;e=nM(e)}return!1}function pW(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const r=n.querySelector(e);return r?[r]:[]}let gW=(()=>{class n{validateStyleProperty(t){return function ume(n){jc||(jc=function lme(){return typeof document<"u"?document.body:null}()||{},hW=!!jc.style&&"WebkitAppearance"in jc.style);let e=!0;return jc.style&&!function ame(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in jc.style,!e&&hW&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in jc.style)),e}(t)}matchesElement(t,r){return!1}containsElement(t,r){return fW(t,r)}getParentElement(t){return nM(t)}query(t,r,i){return pW(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,s,o,a=[],u){return new um(i,s)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),rM=(()=>{class n{static#e=this.NOOP=new gW}return n})();const cme=1e3,iM="ng-enter",MT="ng-leave",xT="ng-trigger",kT=".ng-trigger",_W="ng-animating",sM=".ng-animating";function Ya(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:oM(parseFloat(e[1]),e[2])}function oM(n,e){return"s"===e?n*cme:n}function OT(n,e,t){return n.hasOwnProperty("duration")?n:function hme(n,e,t){let i,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(lW()),{duration:0,delay:0,easing:""};i=oM(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(s=oM(parseFloat(u),a[4]));const l=a[5];l&&(o=l)}else i=n;if(!t){let a=!1,u=e.length;i<0&&(e.push(function Dge(){return new L(3100,!1)}()),a=!0),s<0&&(e.push(function Age(){return new L(3101,!1)}()),a=!0),a&&e.splice(u,0,lW())}return{duration:i,delay:s,easing:o}}(n,e,t)}function ny(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function yW(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function pl(n,e=new Map,t){if(t)for(let[r,i]of t)e.set(r,i);for(let[r,i]of n)e.set(r,i);return e}function ra(n,e,t){e.forEach((r,i)=>{const s=uM(i);t&&!t.has(i)&&t.set(i,n.style[s]),n.style[s]=r})}function $c(n,e){e.forEach((t,r)=>{const i=uM(r);n.style[i]=""})}function ry(n){return Array.isArray(n)?1==n.length?n[0]:VU(n):n}const aM=new RegExp("{{\\s*(.+?)\\s*}}","g");function EW(n){let e=[];if("string"==typeof n){let t;for(;t=aM.exec(n);)e.push(t[1]);aM.lastIndex=0}return e}function iy(n,e,t){const r=n.toString(),i=r.replace(aM,(s,o)=>{let a=e[o];return null==a&&(t.push(function Rge(n){return new L(3003,!1)}()),a=""),a.toString()});return i==r?n:i}function FT(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const gme=/-+([a-z0-9])/g;function uM(n){return n.replace(gme,(...e)=>e[1].toUpperCase())}function Is(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Pge(n){return new L(3004,!1)}()}}function IW(n,e){return window.getComputedStyle(n)[e]}const LT="*";function yme(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function vme(n,e,t){if(":"==n[0]){const u=function Eme(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(function qge(n){return new L(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof u)return void e.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return t.push(function Hge(n){return new L(3015,!1)}()),e;const i=r[1],s=r[2],o=r[3];e.push(wW(i,o));"<"==s[0]&&!(i==LT&&o==LT)&&e.push(wW(o,i))}(r,t,e)):t.push(n),t}const VT=new Set(["true","1"]),UT=new Set(["false","0"]);function wW(n,e){const t=VT.has(n)||UT.has(n),r=VT.has(e)||UT.has(e);return(i,s)=>{let o=n==LT||n==i,a=e==LT||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?VT.has(n):UT.has(n)),!a&&r&&"boolean"==typeof s&&(a=s?VT.has(e):UT.has(e)),o&&a}}const Ime=new RegExp("s*:selfs*,?","g");function lM(n,e,t,r){return new wme(n).build(e,t,r)}class wme{constructor(e){this._driver=e}build(e,t,r){const i=new bme(t);return this._resetContextStyleTimingState(i),Is(this,ry(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Mge(){return new L(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const u=a,l=u.name;l.toString().split(/\s*,\s*/).forEach(d=>{u.name=d,s.push(this.visitState(u,t))}),u.name=l}else if(1==a.type){const u=this.visitTransition(a,t);r+=u.queryCount,i+=u.depCount,o.push(u)}else t.errors.push(function xge(){return new L(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(e,t){const r=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(u=>{EW(u).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(FT(s.values()),t.errors.push(function kge(n,e){return new L(3008,!1)}()))}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const r=Is(this,ry(e.animation),t);return{type:1,matchers:yme(e.expr,t.errors),animation:r,queryCount:t.queryCount,depCount:t.depCount,options:Hc(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(r=>Is(this,r,t)),options:Hc(e.options)}}visitGroup(e,t){const r=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=r;const a=Is(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:Hc(e.options)}}visitAnimate(e,t){const r=function Ame(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return cM(OT(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=cM(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=OT(t,e);return cM(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;let i,s=e.styles?e.styles:am({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};r.easing&&(l.easing=r.easing),o=am(l)}t.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,t);u.isEmptyStep=a,i=u}return t.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,t){const r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){const r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===Fa?r.push(a):t.errors.push(new L(3002,!1)):r.push(yW(a));let s=!1,o=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let u of a.values())if(u.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:r,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const r=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;r&&s>0&&(s-=r.duration+r.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,u)=>{const l=t.collectedStyles.get(t.currentQuerySelector),d=l.get(u);let f=!0;d&&(s!=i&&s>=d.startTime&&i<=d.endTime&&(t.errors.push(function Fge(n,e,t,r,i){return new L(3010,!1)}()),f=!1),s=d.startTime),f&&l.set(u,{startTime:s,endTime:i}),t.options&&function pme(n,e,t){const r=e.params||{},i=EW(n);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||t.push(function Sge(n){return new L(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Lge(){return new L(3011,!1)}()),r;let s=0;const o=[];let a=!1,u=!1,l=0;const d=e.steps.map(k=>{const P=this._makeStyleAst(k,t);let O=null!=P.offset?P.offset:function Dme(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(P.styles),q=0;return null!=O&&(s++,q=P.offset=O),u=u||q<0||q>1,a=a||q<l,l=q,o.push(q),P});u&&t.errors.push(function Vge(){return new L(3012,!1)}()),a&&t.errors.push(function Uge(){return new L(3200,!1)}());const f=e.steps.length;let m=0;s>0&&s<f?t.errors.push(function Bge(){return new L(3202,!1)}()):0==s&&(m=1/(f-1));const _=f-1,v=t.currentTime,T=t.currentAnimateTimings,D=T.duration;return d.forEach((k,P)=>{const O=m>0?P==_?1:m*P:o[P],q=O*D;t.currentTime=v+T.delay+q,T.duration=q,this._validateStyleAst(k,t),k.offset=O,r.styles.push(k)}),r}visitReference(e,t){return{type:8,animation:Is(this,ry(e.animation),t),options:Hc(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Hc(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Hc(e.options)}}visitQuery(e,t){const r=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Tme(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Ime,"")),n=n.replace(/@\*/g,kT).replace(/@\w+/g,t=>kT+"-"+t.slice(1)).replace(/:animating/g,sM),[n,e]}(e.selector);t.currentQuerySelector=r.length?r+" "+s:s,Es(t.collectedStyles,t.currentQuerySelector,new Map);const a=Is(this,ry(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Hc(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function jge(){return new L(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:OT(e.timings,t.errors,!0);return{type:12,animation:Is(this,ry(e.animation),t),timings:r,options:null}}}class bme{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Hc(n){return n?(n=ny(n)).params&&(n.params=function Cme(n){return n?ny(n):null}(n.params)):n={},n}function cM(n,e,t){return{duration:n,delay:e,easing:t}}function dM(n,e,t,r,i,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class BT{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Pme=new RegExp(":enter","g"),Mme=new RegExp(":leave","g");function hM(n,e,t,r,i,s=new Map,o=new Map,a,u,l=[]){return(new xme).buildKeyframes(n,e,t,r,i,s,o,a,u,l)}class xme{buildKeyframes(e,t,r,i,s,o,a,u,l,d=[]){l=l||new BT;const f=new fM(e,t,l,i,s,d,[]);f.options=u;const m=u.delay?Ya(u.delay):0;f.currentTimeline.delayNextStep(m),f.currentTimeline.setStyles([o],null,f.errors,u),Is(this,r,f);const _=f.timelines.filter(v=>v.containsAnimation());if(_.length&&a.size){let v;for(let T=_.length-1;T>=0;T--){const D=_[T];if(D.element===t){v=D;break}}v&&!v.allowOnlyTimelineStyles()&&v.setStyles([a],null,f.errors,u)}return _.length?_.map(v=>v.buildKeyframes()):[dM(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const r=t.subInstructions.get(t.element);if(r){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,r){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:Ya(iy(s,i?.params??{},t.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,t,r){let s=t.currentTimeline.currentTime;const o=null!=r.duration?Ya(r.duration):null,a=null!=r.delay?Ya(r.delay):null;return 0!==o&&e.forEach(u=>{const l=t.appendInstructionToTimeline(u,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Is(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const r=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=jT);const o=Ya(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Is(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const r=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Ya(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Is(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const r=e.strValue;return OT(t.params?iy(r,t.params,t.errors):r,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const r=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(r.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const r=t.currentTimeline,i=t.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(s):r.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const r=t.currentAnimateTimings,i=t.currentTimeline.duration,s=r.duration,a=t.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(u=>{a.forwardTime((u.offset||0)*s),a.setStyles(u.styles,u.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const r=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?Ya(i.delay):0;s&&(6===t.previousNode.type||0==r&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=jT);let o=r;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let u=null;a.forEach((l,d)=>{t.currentQueryIndex=d;const f=t.createSubContext(e.options,l);s&&f.delayNextStep(s),l===t.element&&(u=f.currentTimeline),Is(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const r=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let u=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const d=t.currentTimeline;u&&d.delayNextStep(u);const f=d.currentTime;Is(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=i.currentTime-f+(i.startTime-r.currentTimeline.startTime)}}const jT={};class fM{constructor(e,t,r,i,s,o,a,u){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=jT,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new $T(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const r=e;let i=this.options;null!=r.duration&&(i.duration=Ya(r.duration)),null!=r.delay&&(i.delay=Ya(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=iy(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const r=e.params={};Object.keys(t).forEach(i=>{r[i]=t[i]})}}return e}createSubContext(e=null,t,r){const i=t||this.element,s=new fM(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=jT,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},s=new kme(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(Pme,"."+this._enterClassName)).replace(Mme,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=r);0!==r&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!s&&0==a.length&&o.push(function $ge(n){return new L(3014,!1)}()),a}}class $T{constructor(e,t,r,i){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new $T(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||Fa),this._currentKeyframe.set(t,Fa);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function Ome(n,e){const t=new Map;let r;return n.forEach(i=>{if("*"===i){r=r||e.keys();for(let s of r)t.set(s,Fa)}else pl(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,u]of o){const l=iy(u,s,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Fa),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{const i=this._styleSummary.get(r);(!i||t.time>i.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,u)=>{const l=pl(a,new Map,this._backFill);l.forEach((d,f)=>{"!"===d?e.add(f):d===Fa&&t.add(f)}),r||l.set("offset",u/this.duration),i.push(l)});const s=e.size?FT(e.values()):[],o=t.size?FT(t.values()):[];if(r){const a=i[0],u=new Map(a);a.set("offset",0),u.set("offset",1),i=[a,u]}return dM(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class kme extends $T{constructor(e,t,r,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=r+t,a=t/o,u=pl(e[0]);u.set("offset",0),s.push(u);const l=pl(e[0]);l.set("offset",bW(a)),s.push(l);const d=e.length-1;for(let f=1;f<=d;f++){let m=pl(e[f]);const _=m.get("offset");m.set("offset",bW((t+_*r)/o)),s.push(m)}r=o,t=0,i="",e=s}return dM(this.element,e,this.preStyleProps,this.postStyleProps,r,t,i,!0)}}function bW(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class pM{}const Fme=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Lme extends pM{normalizePropertyName(e,t){return uM(e)}normalizeStyleValue(e,t,r,i){let s="";const o=r.toString().trim();if(Fme.has(t)&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function Nge(n,e){return new L(3005,!1)}())}return o+s}}function DW(n,e,t,r,i,s,o,a,u,l,d,f,m){return{type:0,element:n,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:d,totalTime:f,errors:m}}const gM={};class AW{constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,i){return function Vme(n,e,t,r,i){return n.some(s=>s(e,t,r,i))}(this.ast.matchers,e,t,r,i)}buildStyles(e,t,r){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,r):new Map}build(e,t,r,i,s,o,a,u,l,d){const f=[],m=this.ast.options&&this.ast.options.params||gM,v=this.buildStyles(r,a&&a.params||gM,f),T=u&&u.params||gM,D=this.buildStyles(i,T,f),k=new Set,P=new Map,O=new Map,q="void"===i,ue={params:Ume(T,m),delay:this.ast.options?.delay},Te=d?[]:hM(e,t,this.ast.animation,s,o,v,D,ue,l,f);let Ue=0;if(Te.forEach(Ir=>{Ue=Math.max(Ir.duration+Ir.delay,Ue)}),f.length)return DW(t,this._triggerName,r,i,q,v,D,[],[],P,O,Ue,f);Te.forEach(Ir=>{const Qi=Ir.element,GT=Es(P,Qi,new Set);Ir.preStyleProps.forEach(qc=>GT.add(qc));const oy=Es(O,Qi,new Set);Ir.postStyleProps.forEach(qc=>oy.add(qc)),Qi!==t&&k.add(Qi)});const St=FT(k.values());return DW(t,this._triggerName,r,i,q,v,D,Te,St,P,O,Ue)}}function Ume(n,e){const t=ny(e);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(t[r]=n[r]);return t}class Bme{constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){const r=new Map,i=ny(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=iy(o,i,t));const u=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,u,o,t),r.set(a,o)})}),r}}class $me{constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new Bme(i.style,i.options&&i.options.params||{},r))}),SW(this.states,"true","1"),SW(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new AW(e,i,this.states))}),this.fallbackTransition=function Hme(n,e,t){return new AW(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,i){return this.transitionFactories.find(o=>o.match(e,t,r,i))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}}function SW(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const qme=new BT;class zme{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const r=[],s=lM(this._driver,t,r,[]);if(r.length)throw function Zge(n){return new L(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,r){const i=e.element,s=cW(this._normalizer,e.keyframes,t,r);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=hM(this._driver,t,s,iM,MT,new Map,new Map,r,qme,i),o.forEach(d=>{const f=Es(a,d.element,new Map);d.postStyleProps.forEach(m=>f.set(m,null))})):(i.push(function Qge(){return new L(3300,!1)}()),o=[]),i.length)throw function Yge(n){return new L(3504,!1)}();a.forEach((d,f)=>{d.forEach((m,_)=>{d.set(_,this._driver.computeStyle(f,_,Fa))})});const l=fl(o.map(d=>{const f=a.get(d.element);return this._buildPlayer(d,new Map,f)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Xge(n){return new L(3301,!1)}();return t}listen(e,t,r,i){const s=tM(t,"","","");return JN(this._getPlayer(e),r,s,i),()=>{}}command(e,t,r,i){if("register"==r)return void this.register(e,i[0]);if("create"==r)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const RW="ng-animate-queued",mM="ng-animate-disabled",Qme=[],PW={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Yme={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},yo="__ng_removed";class _M{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const r=e&&e.hasOwnProperty("value");if(this.value=function t_e(n){return n??null}(r?e.value:e),r){const s=ny(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const r=this.options.params;Object.keys(t).forEach(i=>{null==r[i]&&(r[i]=t[i])})}}}const sy="void",yM=new _M(sy);class Xme{constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ws(t,this._hostClassName)}listen(e,t,r,i){if(!this._triggers.has(t))throw function Jge(n,e){return new L(3302,!1)}();if(null==r||0==r.length)throw function eme(n){return new L(3303,!1)}();if(!function n_e(n){return"start"==n||"done"==n}(r))throw function tme(n,e){return new L(3400,!1)}();const s=Es(this._elementListeners,e,[]),o={name:t,phase:r,callback:i};s.push(o);const a=Es(this._engine.statesByElement,e,new Map);return a.has(t)||(Ws(e,xT),Ws(e,xT+"-"+t),a.set(t,yM)),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(o);u>=0&&s.splice(u,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function nme(n){return new L(3401,!1)}();return t}trigger(e,t,r,i=!0){const s=this._getTrigger(t),o=new vM(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Ws(e,xT),Ws(e,xT+"-"+t),this._engine.statesByElement.set(e,a=new Map));let u=a.get(t);const l=new _M(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&l.absorbOptions(u.options),a.set(t,l),u||(u=yM),l.value!==sy&&u.value===l.value){if(!function s_e(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(u.params,l.params)){const T=[],D=s.matchStyles(u.value,u.params,T),k=s.matchStyles(l.value,l.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{$c(e,D),ra(e,k)})}return}const m=Es(this._engine.playersByElement,e,[]);m.forEach(T=>{T.namespaceId==this.id&&T.triggerName==t&&T.queued&&T.destroy()});let _=s.matchTransition(u.value,l.value,e,l.params),v=!1;if(!_){if(!i)return;_=s.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:_,fromState:u,toState:l,player:o,isFallbackTransition:v}),v||(Ws(e,RW),o.onStart(()=>{qf(e,RW)})),o.onDone(()=>{let T=this.players.indexOf(o);T>=0&&this.players.splice(T,1);const D=this._engine.playersByElement.get(e);if(D){let k=D.indexOf(o);k>=0&&D.splice(k,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const r=this._engine.driver.query(e,kT,!0);r.forEach(i=>{if(i[yo])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,r,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((u,l)=>{if(o.set(l,u.value),this._triggers.has(l)){const d=this.trigger(e,l,sy,i);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),r&&fl(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const u=this._triggers.get(o).fallbackTransition,l=r.get(o)||yM,d=new _M(sy),f=new vM(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:u,fromState:l,toState:d,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{const s=e[yo];(!s||s===PW)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){Ws(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){const u=tM(s,r.triggerName,r.fromState.value,r.toState.value);u._data=e,JN(r.player,a.phase,u,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(r)}),this._queue=[],t.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Jme{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){const r=new Xme(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const u=i.get(a);if(u){const l=r.indexOf(u);r.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||r.unshift(e)}else r.push(e);return i.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let i=this._namespaceLookup[e];i&&i.register(t,r)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,r=this.statesByElement.get(e);if(r)for(let i of r.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,r,i){if(HT(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,r,i),!0}return!1}insertNode(e,t,r,i){if(!HT(t))return;const s=t[yo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,r)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ws(e,mM)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),qf(e,mM))}removeNode(e,t,r){if(HT(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,r)}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,r,i,s){this.collectedLeaveElements.push(t),t[yo]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,r,i,s){return HT(t)?this._fetchNamespace(e).listen(t,r,i,s):()=>{}}_buildInstruction(e,t,r,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,kT,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,sM,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return fl(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[yo];if(t&&t.setForRemoval){if(e[yo]=PW,t.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(mM)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Ws(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{t=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],t.length?fl(t).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw function rme(n){return new L(3402,!1)}()}_flushAnimations(e,t){const r=new BT,i=[],s=new Map,o=[],a=new Map,u=new Map,l=new Map,d=new Set;this.disabledNodes.forEach(Se=>{d.add(Se);const Oe=this.driver.query(Se,".ng-animate-queued",!0);for(let je=0;je<Oe.length;je++)d.add(Oe[je])});const f=this.bodyNode,m=Array.from(this.statesByElement.keys()),_=xW(m,this.collectedEnterElements),v=new Map;let T=0;_.forEach((Se,Oe)=>{const je=iM+T++;v.set(Oe,je),Se.forEach(Pt=>Ws(Pt,je))});const D=[],k=new Set,P=new Set;for(let Se=0;Se<this.collectedLeaveElements.length;Se++){const Oe=this.collectedLeaveElements[Se],je=Oe[yo];je&&je.setForRemoval&&(D.push(Oe),k.add(Oe),je.hasAnimation?this.driver.query(Oe,".ng-star-inserted",!0).forEach(Pt=>k.add(Pt)):P.add(Oe))}const O=new Map,q=xW(m,Array.from(k));q.forEach((Se,Oe)=>{const je=MT+T++;O.set(Oe,je),Se.forEach(Pt=>Ws(Pt,je))}),e.push(()=>{_.forEach((Se,Oe)=>{const je=v.get(Oe);Se.forEach(Pt=>qf(Pt,je))}),q.forEach((Se,Oe)=>{const je=O.get(Oe);Se.forEach(Pt=>qf(Pt,je))}),D.forEach(Se=>{this.processLeaveNode(Se)})});const ue=[],Te=[];for(let Se=this._namespaceList.length-1;Se>=0;Se--)this._namespaceList[Se].drainQueuedTransitions(t).forEach(je=>{const Pt=je.player,kr=je.element;if(ue.push(Pt),this.collectedEnterElements.length){const li=kr[yo];if(li&&li.setForMove){if(li.previousTriggersValues&&li.previousTriggersValues.has(je.triggerName)){const zc=li.previousTriggersValues.get(je.triggerName),Ks=this.statesByElement.get(je.element);if(Ks&&Ks.has(je.triggerName)){const WT=Ks.get(je.triggerName);WT.value=zc,Ks.set(je.triggerName,WT)}}return void Pt.destroy()}}const ia=!f||!this.driver.containsElement(f,kr),ws=O.get(kr),gl=v.get(kr),Vn=this._buildInstruction(je,r,gl,ws,ia);if(Vn.errors&&Vn.errors.length)return void Te.push(Vn);if(ia)return Pt.onStart(()=>$c(kr,Vn.fromStyles)),Pt.onDestroy(()=>ra(kr,Vn.toStyles)),void i.push(Pt);if(je.isFallbackTransition)return Pt.onStart(()=>$c(kr,Vn.fromStyles)),Pt.onDestroy(()=>ra(kr,Vn.toStyles)),void i.push(Pt);const qW=[];Vn.timelines.forEach(li=>{li.stretchStartingKeyframe=!0,this.disabledNodes.has(li.element)||qW.push(li)}),Vn.timelines=qW,r.append(kr,Vn.timelines),o.push({instruction:Vn,player:Pt,element:kr}),Vn.queriedElements.forEach(li=>Es(a,li,[]).push(Pt)),Vn.preStyleProps.forEach((li,zc)=>{if(li.size){let Ks=u.get(zc);Ks||u.set(zc,Ks=new Set),li.forEach((WT,wM)=>Ks.add(wM))}}),Vn.postStyleProps.forEach((li,zc)=>{let Ks=l.get(zc);Ks||l.set(zc,Ks=new Set),li.forEach((WT,wM)=>Ks.add(wM))})});if(Te.length){const Se=[];Te.forEach(Oe=>{Se.push(function ime(n,e){return new L(3505,!1)}())}),ue.forEach(Oe=>Oe.destroy()),this.reportError(Se)}const Ue=new Map,St=new Map;o.forEach(Se=>{const Oe=Se.element;r.has(Oe)&&(St.set(Oe,Oe),this._beforeAnimationBuild(Se.player.namespaceId,Se.instruction,Ue))}),i.forEach(Se=>{const Oe=Se.element;this._getPreviousPlayers(Oe,!1,Se.namespaceId,Se.triggerName,null).forEach(Pt=>{Es(Ue,Oe,[]).push(Pt),Pt.destroy()})});const Ir=D.filter(Se=>OW(Se,u,l)),Qi=new Map;MW(Qi,this.driver,P,l,Fa).forEach(Se=>{OW(Se,u,l)&&Ir.push(Se)});const oy=new Map;_.forEach((Se,Oe)=>{MW(oy,this.driver,new Set(Se),u,"!")}),Ir.forEach(Se=>{const Oe=Qi.get(Se),je=oy.get(Se);Qi.set(Se,new Map([...Oe?.entries()??[],...je?.entries()??[]]))});const qc=[],$W=[],HW={};o.forEach(Se=>{const{element:Oe,player:je,instruction:Pt}=Se;if(r.has(Oe)){if(d.has(Oe))return je.onDestroy(()=>ra(Oe,Pt.toStyles)),je.disabled=!0,je.overrideTotalTime(Pt.totalTime),void i.push(je);let kr=HW;if(St.size>1){let ws=Oe;const gl=[];for(;ws=ws.parentNode;){const Vn=St.get(ws);if(Vn){kr=Vn;break}gl.push(ws)}gl.forEach(Vn=>St.set(Vn,kr))}const ia=this._buildAnimation(je.namespaceId,Pt,Ue,s,oy,Qi);if(je.setRealPlayer(ia),kr===HW)qc.push(je);else{const ws=this.playersByElement.get(kr);ws&&ws.length&&(je.parentPlayer=fl(ws)),i.push(je)}}else $c(Oe,Pt.fromStyles),je.onDestroy(()=>ra(Oe,Pt.toStyles)),$W.push(je),d.has(Oe)&&i.push(je)}),$W.forEach(Se=>{const Oe=s.get(Se.element);if(Oe&&Oe.length){const je=fl(Oe);Se.setRealPlayer(je)}}),i.forEach(Se=>{Se.parentPlayer?Se.syncPlayerEvents(Se.parentPlayer):Se.destroy()});for(let Se=0;Se<D.length;Se++){const Oe=D[Se],je=Oe[yo];if(qf(Oe,MT),je&&je.hasAnimation)continue;let Pt=[];if(a.size){let ia=a.get(Oe);ia&&ia.length&&Pt.push(...ia);let ws=this.driver.query(Oe,sM,!0);for(let gl=0;gl<ws.length;gl++){let Vn=a.get(ws[gl]);Vn&&Vn.length&&Pt.push(...Vn)}}const kr=Pt.filter(ia=>!ia.destroyed);kr.length?r_e(this,Oe,kr):this.processLeaveNode(Oe)}return D.length=0,qc.forEach(Se=>{this.players.push(Se),Se.onDone(()=>{Se.destroy();const Oe=this.players.indexOf(Se);this.players.splice(Oe,1)}),Se.play()}),qc}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const u=!s||s==sy;a.forEach(l=>{l.queued||!u&&l.triggerName!=i||o.push(l)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,r){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const u of t.timelines){const l=u.element,d=l!==s,f=Es(r,l,[]);this._getPreviousPlayers(l,d,o,a,t.toState).forEach(_=>{const v=_.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),_.destroy(),f.push(_)})}$c(s,t.fromStyles)}_buildAnimation(e,t,r,i,s,o){const a=t.triggerName,u=t.element,l=[],d=new Set,f=new Set,m=t.timelines.map(v=>{const T=v.element;d.add(T);const D=T[yo];if(D&&D.removedBeforeQueried)return new um(v.duration,v.delay);const k=T!==u,P=function i_e(n){const e=[];return kW(n,e),e}((r.get(T)||Qme).map(Ue=>Ue.getRealPlayer())).filter(Ue=>!!Ue.element&&Ue.element===T),O=s.get(T),q=o.get(T),ue=cW(this._normalizer,v.keyframes,O,q),Te=this._buildPlayer(v,ue,P);if(v.subTimeline&&i&&f.add(T),k){const Ue=new vM(e,a,T);Ue.setRealPlayer(Te),l.push(Ue)}return Te});l.forEach(v=>{Es(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>function e_e(n,e,t){let r=n.get(e);if(r){if(r.length){const i=r.indexOf(t);r.splice(i,1)}0==r.length&&n.delete(e)}return r}(this.playersByQueriedElement,v.element,v))}),d.forEach(v=>Ws(v,_W));const _=fl(m);return _.onDestroy(()=>{d.forEach(v=>qf(v,_W)),ra(u,t.toStyles)}),f.forEach(v=>{Es(i,v,[]).push(_)}),_}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new um(e.duration,e.delay)}}class vM{constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r,this._player=new um,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(i=>JN(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Es(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function HT(n){return n&&1===n.nodeType}function NW(n,e){const t=n.style.display;return n.style.display=e??"none",t}function MW(n,e,t,r,i){const s=[];t.forEach(u=>s.push(NW(u)));const o=[];r.forEach((u,l)=>{const d=new Map;u.forEach(f=>{const m=e.computeStyle(l,f,i);d.set(f,m),(!m||0==m.length)&&(l[yo]=Yme,o.push(l))}),n.set(l,d)});let a=0;return t.forEach(u=>NW(u,s[a++])),o}function xW(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let u=s.get(a);if(u)return u;const l=a.parentNode;return u=t.has(l)?l:i.has(l)?1:o(l),s.set(a,u),u}return e.forEach(a=>{const u=o(a);1!==u&&t.get(u).push(a)}),t}function Ws(n,e){n.classList?.add(e)}function qf(n,e){n.classList?.remove(e)}function r_e(n,e,t){fl(t).onDone(()=>n.processLeaveNode(e))}function kW(n,e){for(let t=0;t<n.length;t++){const r=n[t];r instanceof BU?kW(r.players,e):e.push(r)}}function OW(n,e,t){const r=t.get(n);if(!r)return!1;let i=e.get(n);return i?r.forEach(s=>i.add(s)):e.set(n,r),t.delete(n),!0}class qT{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new Jme(e,t,r),this._timelineEngine=new zme(e,t,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,r,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const u=[],d=lM(this._driver,s,u,[]);if(u.length)throw function Wge(n,e){return new L(3404,!1)}();a=function jme(n,e,t){return new $me(n,e,t)}(i,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,i){this._transitionEngine.insertNode(e,t,r,i)}onRemove(e,t,r){this._transitionEngine.removeNode(e,t,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,i){if("@"==r.charAt(0)){const[s,o]=dW(r);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,r,i)}listen(e,t,r,i,s){if("@"==r.charAt(0)){const[o,a]=dW(r);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,r,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let a_e=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,r,i){this._element=t,this._startStyles=r,this._endStyles=i,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&ra(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ra(this._element,this._initialStyles),this._endStyles&&(ra(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&($c(this._element,this._startStyles),this._endStyles=null),this._endStyles&&($c(this._element,this._endStyles),this._endStyles=null),ra(this._element,this._initialStyles),this._state=3)}}return n})();function EM(n){let e=null;return n.forEach((t,r)=>{(function u_e(n){return"display"===n||"position"===n})(r)&&(e=e||new Map,e.set(r,t))}),e}class FW{constructor(e,t,r,i){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&e.set(i,this._finished?r:IW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class l_e{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return fW(e,t)}getParentElement(e){return nM(e)}query(e,t,r){return pW(e,t,r)}computeStyle(e,t,r){return window.getComputedStyle(e)[t]}animate(e,t,r,i,s,o=[]){const u={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(u.easing=s);const l=new Map,d=o.filter(_=>_ instanceof FW);(function mme(n,e){return 0===n||0===e})(r,i)&&d.forEach(_=>{_.currentSnapshot.forEach((v,T)=>l.set(T,v))});let f=function fme(n){return n.length?n[0]instanceof Map?n:n.map(e=>yW(e)):[]}(t).map(_=>pl(_));f=function _me(n,e,t){if(t.size&&e.length){let r=e[0],i=[];if(t.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,IW(n,a)))}}return e}(e,f,l);const m=function o_e(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=EM(e[0]),e.length>1&&(r=EM(e[e.length-1]))):e instanceof Map&&(t=EM(e)),t||r?new a_e(n,t,r):null}(e,f);return new FW(e,f,u,m)}}let c_e=(()=>{class n extends FU{constructor(t,r){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(r.body,{id:"0",encapsulation:Oi.None,styles:[],data:{animation:[]}})}build(t){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(t)?VU(t):t;return LW(this._renderer,null,r,"register",[i]),new d_e(r,this._renderer)}static#e=this.\u0275fac=function(r){return new(r||n)(W(ag),W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class d_e extends Vne{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new h_e(this._id,e,t||{},this._renderer)}}class h_e{constructor(e,t,r,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return LW(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function LW(n,e,t,r,i){return n.setProperty(e,`@@${t}:${r}`,i)}const VW="@.disabled";let f_e=(()=>{class n{constructor(t,r,i){this.delegate=t,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,r.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,r){const s=this.delegate.createRenderer(t,r);if(!(t&&r&&r.data&&r.data.animation)){let d=this._rendererCache.get(s);return d||(d=new UW("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=r.id,a=r.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const u=d=>{Array.isArray(d)?d.forEach(u):this.engine.registerTrigger(o,a,t,d.name,d)};return r.data.animation.forEach(u),new p_e(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,r,i){t>=0&&t<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(r){return new(r||n)(W(ag),W(qT),W(wt))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class UW{constructor(e,t,r,i){this.namespaceId=e,this.delegate=t,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,i=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){"@"==t.charAt(0)&&t==VW?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.delegate.listen(e,t,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class p_e extends UW{constructor(e,t,r,i,s){super(t,r,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&t==VW?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r){if("@"==t.charAt(0)){const i=function g_e(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function m_e(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(e,t,r)}}let __e=(()=>{class n extends qT{constructor(t,r,i,s){super(t.body,r,i)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(rM),W(pM),W(Pa))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const BW=[{provide:FU,useClass:c_e},{provide:pM,useFactory:function y_e(){return new Lme}},{provide:qT,useClass:__e},{provide:ag,useFactory:function v_e(n,e,t){return new f_e(n,e,t)},deps:[pD,qT,wt]}],IM=[{provide:rM,useFactory:()=>new l_e},{provide:nk,useValue:"BrowserAnimations"},...BW],jW=[{provide:rM,useClass:gW},{provide:nk,useValue:"NoopAnimations"},...BW];let E_e=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?jW:IM}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n});static#n=this.\u0275inj=Cn({providers:IM,imports:[iV]})}return n})(),I_e=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=nn({type:n,bootstrap:[Hre]});static#n=this.\u0275inj=Cn({imports:[Nne.initializeApp(qre_firebase),Fne,iV,$re,jJ,$J,Ofe,bge,tue,are.forRoot(),Nre,E_e]})}return n})();MX().bootstrapModule(I_e).catch(n=>console.error(n))},106:(Ts,Kn,ke)=>{ke.d(Kn,{Z:()=>Zn});var A=ke(58),Z=ke(537),F=ke(534),Ae=ke(879);class _t{constructor($e,He){this._delegate=$e,this.firebase=He,(0,F._addComponent)($e,new Z.wA("app-compat",()=>this,"PUBLIC")),this.container=$e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled($e){this._delegate.automaticDataCollectionEnabled=$e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise($e=>{this._delegate.checkDestroyed(),$e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,F.deleteApp)(this._delegate)))}_getService($e,He=F._DEFAULT_ENTRY_NAME){var ir;this._delegate.checkDestroyed();const vn=this._delegate.container.getProvider($e);return!vn.isInitialized()&&"EXPLICIT"===(null===(ir=vn.getComponent())||void 0===ir?void 0:ir.instantiationMode)&&vn.initialize(),vn.getImmediate({identifier:He})}_removeServiceInstance($e,He=F._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider($e).clearInstance(He)}_addComponent($e){(0,F._addComponent)(this._delegate,$e)}_addOrOverwriteComponent($e){(0,F._addOrOverwriteComponent)(this._delegate,$e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Nn=new A.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),X=function yt(){const ct=function Ut(ct){const $e={},He={__esModule:!0,initializeApp:function ot(Xe,se={}){const pt=F.initializeApp(Xe,se);if((0,A.r3)($e,pt.name))return $e[pt.name];const Kt=new ct(pt,He);return $e[pt.name]=Kt,Kt},app:vn,registerVersion:F.registerVersion,setLogLevel:F.setLogLevel,onLog:F.onLog,apps:null,SDK_VERSION:F.SDK_VERSION,INTERNAL:{registerComponent:function ci(Xe){const se=Xe.name,pt=se.replace("-compat","");if(F._registerComponent(Xe)&&"PUBLIC"===Xe.type){const Kt=(En=vn())=>{if("function"!=typeof En[pt])throw Nn.create("invalid-app-argument",{appName:se});return En[pt]()};void 0!==Xe.serviceProps&&(0,A.ZB)(Kt,Xe.serviceProps),He[pt]=Kt,ct.prototype[pt]=function(...En){return this._getService.bind(this,se).apply(this,Xe.multipleInstances?En:[])}}return"PUBLIC"===Xe.type?He[pt]:null},removeApp:function ir(Xe){delete $e[Xe]},useAsService:function Un(Xe,se){return"serverAuth"===se?null:se},modularAPIs:F}};function vn(Xe){if(!(0,A.r3)($e,Xe=Xe||F._DEFAULT_ENTRY_NAME))throw Nn.create("no-app",{appName:Xe});return $e[Xe]}return He.default=He,Object.defineProperty(He,"apps",{get:function Mt(){return Object.keys($e).map(Xe=>$e[Xe])}}),vn.App=ct,He}(_t);return ct.INTERNAL=Object.assign(Object.assign({},ct.INTERNAL),{createFirebaseNamespace:yt,extendNamespace:function $e(He){(0,A.ZB)(ct,He)},createSubscribe:A.ne,ErrorFactory:A.LL,deepExtend:A.ZB}),ct}(),ae=new Ae.Yd("@firebase/app-compat");if((0,A.jU)()&&void 0!==self.firebase){ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const ct=self.firebase.SDK_VERSION;ct&&ct.indexOf("LITE")>=0&&ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Zn=X;!function Ct(ct){(0,F.registerVersion)("@firebase/app-compat","0.2.23",ct)}()},534:(Ts,Kn,ke)=>{ke.r(Kn),ke.d(Kn,{FirebaseError:()=>Ae.ZR,SDK_VERSION:()=>ts,_DEFAULT_ENTRY_NAME:()=>Ji,_addComponent:()=>hi,_addOrOverwriteComponent:()=>fi,_apps:()=>cr,_clearComponents:()=>wn,_components:()=>di,_getProvider:()=>xt,_registerComponent:()=>dr,_removeServiceInstance:()=>Zr,deleteApp:()=>jn,getApp:()=>ns,getApps:()=>Yn,initializeApp:()=>ki,onLog:()=>Xa,registerVersion:()=>pi,setLogLevel:()=>vo});var A=ke(861),Z=ke(537),F=ke(879),Ae=ke(58);const _t=(U,x)=>x.some(ie=>U instanceof ie);let Xt,Nn;const X=new WeakMap,ae=new WeakMap,be=new WeakMap,We=new WeakMap,Ct=new WeakMap;let $e={get(U,x,ie){if(U instanceof IDBTransaction){if("done"===x)return ae.get(U);if("objectStoreNames"===x)return U.objectStoreNames||be.get(U);if("store"===x)return ie.objectStoreNames[1]?void 0:ie.objectStore(ie.objectStoreNames[0])}return ot(U[x])},set:(U,x,ie)=>(U[x]=ie,!0),has:(U,x)=>U instanceof IDBTransaction&&("done"===x||"store"===x)||x in U};function vn(U){return"function"==typeof U?function ir(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function yt(){return Nn||(Nn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...x){return U.apply(Mt(this),x),ot(X.get(this))}:function(...x){return ot(U.apply(Mt(this),x))}:function(x,...ie){const De=U.call(Mt(this),x,...ie);return be.set(De,x.sort?x.sort():[x]),ot(De)}}(U):(U instanceof IDBTransaction&&function ct(U){if(ae.has(U))return;const x=new Promise((ie,De)=>{const Je=()=>{U.removeEventListener("complete",nt),U.removeEventListener("error",L),U.removeEventListener("abort",L)},nt=()=>{ie(),Je()},L=()=>{De(U.error||new DOMException("AbortError","AbortError")),Je()};U.addEventListener("complete",nt),U.addEventListener("error",L),U.addEventListener("abort",L)});ae.set(U,x)}(U),_t(U,function Ut(){return Xt||(Xt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,$e):U)}function ot(U){if(U instanceof IDBRequest)return function Zn(U){const x=new Promise((ie,De)=>{const Je=()=>{U.removeEventListener("success",nt),U.removeEventListener("error",L)},nt=()=>{ie(ot(U.result)),Je()},L=()=>{De(U.error),Je()};U.addEventListener("success",nt),U.addEventListener("error",L)});return x.then(ie=>{ie instanceof IDBCursor&&X.set(ie,U)}).catch(()=>{}),Ct.set(x,U),x}(U);if(We.has(U))return We.get(U);const x=vn(U);return x!==U&&(We.set(U,x),Ct.set(x,U)),x}const Mt=U=>Ct.get(U),Xe=["get","getKey","getAll","getAllKeys","count"],se=["put","add","delete","clear"],pt=new Map;function Kt(U,x){if(!(U instanceof IDBDatabase)||x in U||"string"!=typeof x)return;if(pt.get(x))return pt.get(x);const ie=x.replace(/FromIndex$/,""),De=x!==ie,Je=se.includes(ie);if(!(ie in(De?IDBIndex:IDBObjectStore).prototype)||!Je&&!Xe.includes(ie))return;const nt=function(){var L=(0,A.Z)(function*(Mn,...Ce){const st=this.transaction(Mn,Je?"readwrite":"readonly");let _l=st.store;return De&&(_l=_l.index(Ce.shift())),(yield Promise.all([_l[ie](...Ce),Je&&st.done]))[0]});return function(Ce){return L.apply(this,arguments)}}();return pt.set(x,nt),nt}!function He(U){$e=U($e)}(U=>({...U,get:(x,ie,De)=>Kt(x,ie)||U.get(x,ie,De),has:(x,ie)=>!!Kt(x,ie)||U.has(x,ie)}));class En{constructor(x){this.container=x}getPlatformInfoString(){return this.container.getProviders().map(ie=>{if(function In(U){const x=U.getComponent();return"VERSION"===x?.type}(ie)){const De=ie.getImmediate();return`${De.library}/${De.version}`}return null}).filter(ie=>ie).join(" ")}}const Yi="@firebase/app",Ze=new F.Yd("@firebase/app"),Ji="[DEFAULT]",es={[Yi]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cr=new Map,di=new Map;function hi(U,x){try{U.container.addComponent(x)}catch(ie){Ze.debug(`Component ${x.name} failed to register with FirebaseApp ${U.name}`,ie)}}function fi(U,x){U.container.addOrOverwriteComponent(x)}function dr(U){const x=U.name;if(di.has(x))return Ze.debug(`There were multiple attempts to register component ${x}.`),!1;di.set(x,U);for(const ie of cr.values())hi(ie,U);return!0}function xt(U,x){const ie=U.container.getProvider("heartbeat").getImmediate({optional:!0});return ie&&ie.triggerHeartbeat(),U.container.getProvider(x)}function Zr(U,x,ie=Ji){xt(U,x).clearInstance(ie)}function wn(){di.clear()}const tn=new Ae.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Tn{constructor(x,ie,De){this._isDeleted=!1,this._options=Object.assign({},x),this._config=Object.assign({},ie),this._name=ie.name,this._automaticDataCollectionEnabled=ie.automaticDataCollectionEnabled,this._container=De,this.container.addComponent(new Z.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(x){this.checkDestroyed(),this._automaticDataCollectionEnabled=x}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(x){this._isDeleted=x}checkDestroyed(){if(this.isDeleted)throw tn.create("app-deleted",{appName:this._name})}}const ts="10.6.0";function ki(U,x={}){let ie=U;"object"!=typeof x&&(x={name:x});const De=Object.assign({name:Ji,automaticDataCollectionEnabled:!1},x),Je=De.name;if("string"!=typeof Je||!Je)throw tn.create("bad-app-name",{appName:String(Je)});if(ie||(ie=(0,Ae.aH)()),!ie)throw tn.create("no-options");const nt=cr.get(Je);if(nt){if((0,Ae.vZ)(ie,nt.options)&&(0,Ae.vZ)(De,nt.config))return nt;throw tn.create("duplicate-app",{appName:Je})}const L=new Z.H0(Je);for(const Ce of di.values())L.addComponent(Ce);const Mn=new Tn(ie,De,L);return cr.set(Je,Mn),Mn}function ns(U=Ji){const x=cr.get(U);if(!x&&U===Ji&&(0,Ae.aH)())return ki();if(!x)throw tn.create("no-app",{appName:U});return x}function Yn(){return Array.from(cr.values())}function jn(U){return Or.apply(this,arguments)}function Or(){return(Or=(0,A.Z)(function*(U){const x=U.name;cr.has(x)&&(cr.delete(x),yield Promise.all(U.container.getProviders().map(ie=>ie.delete())),U.isDeleted=!0)})).apply(this,arguments)}function pi(U,x,ie){var De;let Je=null!==(De=es[U])&&void 0!==De?De:U;ie&&(Je+=`-${ie}`);const nt=Je.match(/\s|\//),L=x.match(/\s|\//);if(nt||L){const Mn=[`Unable to register library "${Je}" with version "${x}":`];return nt&&Mn.push(`library name "${Je}" contains illegal characters (whitespace or "/")`),nt&&L&&Mn.push("and"),L&&Mn.push(`version name "${x}" contains illegal characters (whitespace or "/")`),void Ze.warn(Mn.join(" "))}dr(new Z.wA(`${Je}-version`,()=>({library:Je,version:x}),"VERSION"))}function Xa(U,x){if(null!==U&&"function"!=typeof U)throw tn.create("invalid-log-argument");(0,F.Am)(U,x)}function vo(U){(0,F.Ub)(U)}const sa="firebase-heartbeat-database",Ss=1,N="firebase-heartbeat-store";let S=null;function I(){return S||(S=function ci(U,x,{blocked:ie,upgrade:De,blocking:Je,terminated:nt}={}){const L=indexedDB.open(U,x),Mn=ot(L);return De&&L.addEventListener("upgradeneeded",Ce=>{De(ot(L.result),Ce.oldVersion,Ce.newVersion,ot(L.transaction),Ce)}),ie&&L.addEventListener("blocked",Ce=>ie(Ce.oldVersion,Ce.newVersion,Ce)),Mn.then(Ce=>{nt&&Ce.addEventListener("close",()=>nt()),Je&&Ce.addEventListener("versionchange",st=>Je(st.oldVersion,st.newVersion,st))}).catch(()=>{}),Mn}(sa,Ss,{upgrade:(U,x)=>{0===x&&U.createObjectStore(N)}}).catch(U=>{throw tn.create("idb-open",{originalErrorMessage:U.message})})),S}function E(){return(E=(0,A.Z)(function*(U){try{return yield(yield I()).transaction(N).objectStore(N).get(Ie(U))}catch(x){if(x instanceof Ae.ZR)Ze.warn(x.message);else{const ie=tn.create("idb-get",{originalErrorMessage:x?.message});Ze.warn(ie.message)}}})).apply(this,arguments)}function R(U,x){return K.apply(this,arguments)}function K(){return(K=(0,A.Z)(function*(U,x){try{const De=(yield I()).transaction(N,"readwrite");yield De.objectStore(N).put(x,Ie(U)),yield De.done}catch(ie){if(ie instanceof Ae.ZR)Ze.warn(ie.message);else{const De=tn.create("idb-set",{originalErrorMessage:ie?.message});Ze.warn(De.message)}}})).apply(this,arguments)}function Ie(U){return`${U.name}!${U.options.appId}`}class Et{constructor(x){this.container=x,this._heartbeatsCache=null;const ie=this.container.getProvider("app").getImmediate();this._storage=new Re(ie),this._heartbeatsCachePromise=this._storage.read().then(De=>(this._heartbeatsCache=De,De))}triggerHeartbeat(){var x=this;return(0,A.Z)(function*(){var ie;const Je=x.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),nt=ge();if(null==(null===(ie=x._heartbeatsCache)||void 0===ie?void 0:ie.heartbeats)&&(x._heartbeatsCache=yield x._heartbeatsCachePromise),x._heartbeatsCache.lastSentHeartbeatDate!==nt&&!x._heartbeatsCache.heartbeats.some(L=>L.date===nt))return x._heartbeatsCache.heartbeats.push({date:nt,agent:Je}),x._heartbeatsCache.heartbeats=x._heartbeatsCache.heartbeats.filter(L=>{const Mn=new Date(L.date).valueOf();return Date.now()-Mn<=2592e6}),x._storage.overwrite(x._heartbeatsCache)})()}getHeartbeatsHeader(){var x=this;return(0,A.Z)(function*(){var ie;if(null===x._heartbeatsCache&&(yield x._heartbeatsCachePromise),null==(null===(ie=x._heartbeatsCache)||void 0===ie?void 0:ie.heartbeats)||0===x._heartbeatsCache.heartbeats.length)return"";const De=ge(),{heartbeatsToSend:Je,unsentEntries:nt}=function Ft(U,x=1024){const ie=[];let De=U.slice();for(const Je of U){const nt=ie.find(L=>L.agent===Je.agent);if(nt){if(nt.dates.push(Je.date),or(ie)>x){nt.dates.pop();break}}else if(ie.push({agent:Je.agent,dates:[Je.date]}),or(ie)>x){ie.pop();break}De=De.slice(1)}return{heartbeatsToSend:ie,unsentEntries:De}}(x._heartbeatsCache.heartbeats),L=(0,Ae.L)(JSON.stringify({version:2,heartbeats:Je}));return x._heartbeatsCache.lastSentHeartbeatDate=De,nt.length>0?(x._heartbeatsCache.heartbeats=nt,yield x._storage.overwrite(x._heartbeatsCache)):(x._heartbeatsCache.heartbeats=[],x._storage.overwrite(x._heartbeatsCache)),L})()}}function ge(){return(new Date).toISOString().substring(0,10)}class Re{constructor(x){this.app=x,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,A.Z)(function*(){return!!(0,Ae.hl)()&&(0,Ae.eu)().then(()=>!0).catch(()=>!1)})()}read(){var x=this;return(0,A.Z)(function*(){return(yield x._canUseIndexedDBPromise)&&(yield function C(U){return E.apply(this,arguments)}(x.app))||{heartbeats:[]}})()}overwrite(x){var ie=this;return(0,A.Z)(function*(){var De;if(yield ie._canUseIndexedDBPromise){const nt=yield ie.read();return R(ie.app,{lastSentHeartbeatDate:null!==(De=x.lastSentHeartbeatDate)&&void 0!==De?De:nt.lastSentHeartbeatDate,heartbeats:x.heartbeats})}})()}add(x){var ie=this;return(0,A.Z)(function*(){var De;if(yield ie._canUseIndexedDBPromise){const nt=yield ie.read();return R(ie.app,{lastSentHeartbeatDate:null!==(De=x.lastSentHeartbeatDate)&&void 0!==De?De:nt.lastSentHeartbeatDate,heartbeats:[...nt.heartbeats,...x.heartbeats]})}})()}}function or(U){return(0,Ae.L)(JSON.stringify({version:2,heartbeats:U})).length}!function oa(U){dr(new Z.wA("platform-logger",x=>new En(x),"PRIVATE")),dr(new Z.wA("heartbeat",x=>new Et(x),"PRIVATE")),pi(Yi,"0.9.23",U),pi(Yi,"0.9.23","esm2017"),pi("fire-js","")}("")},537:(Ts,Kn,ke)=>{ke.d(Kn,{H0:()=>Ut,wA:()=>F,zt:()=>_t});var A=ke(861),Z=ke(58);class F{constructor(X,ae,be){this.name=X,this.instanceFactory=ae,this.type=be,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(X){return this.instantiationMode=X,this}setMultipleInstances(X){return this.multipleInstances=X,this}setServiceProps(X){return this.serviceProps=X,this}setInstanceCreatedCallback(X){return this.onInstanceCreated=X,this}}const Ae="[DEFAULT]";class _t{constructor(X,ae){this.name=X,this.container=ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(X){const ae=this.normalizeInstanceIdentifier(X);if(!this.instancesDeferred.has(ae)){const be=new Z.BH;if(this.instancesDeferred.set(ae,be),this.isInitialized(ae)||this.shouldAutoInitialize())try{const We=this.getOrInitializeService({instanceIdentifier:ae});We&&be.resolve(We)}catch{}}return this.instancesDeferred.get(ae).promise}getImmediate(X){var ae;const be=this.normalizeInstanceIdentifier(X?.identifier),We=null!==(ae=X?.optional)&&void 0!==ae&&ae;if(!this.isInitialized(be)&&!this.shouldAutoInitialize()){if(We)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:be})}catch(Ct){if(We)return null;throw Ct}}getComponent(){return this.component}setComponent(X){if(X.name!==this.name)throw Error(`Mismatching Component ${X.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=X,this.shouldAutoInitialize()){if(function Nn(yt){return"EAGER"===yt.instantiationMode}(X))try{this.getOrInitializeService({instanceIdentifier:Ae})}catch{}for(const[ae,be]of this.instancesDeferred.entries()){const We=this.normalizeInstanceIdentifier(ae);try{const Ct=this.getOrInitializeService({instanceIdentifier:We});be.resolve(Ct)}catch{}}}}clearInstance(X=Ae){this.instancesDeferred.delete(X),this.instancesOptions.delete(X),this.instances.delete(X)}delete(){var X=this;return(0,A.Z)(function*(){const ae=Array.from(X.instances.values());yield Promise.all([...ae.filter(be=>"INTERNAL"in be).map(be=>be.INTERNAL.delete()),...ae.filter(be=>"_delete"in be).map(be=>be._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(X=Ae){return this.instances.has(X)}getOptions(X=Ae){return this.instancesOptions.get(X)||{}}initialize(X={}){const{options:ae={}}=X,be=this.normalizeInstanceIdentifier(X.instanceIdentifier);if(this.isInitialized(be))throw Error(`${this.name}(${be}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const We=this.getOrInitializeService({instanceIdentifier:be,options:ae});for(const[Ct,Zn]of this.instancesDeferred.entries())be===this.normalizeInstanceIdentifier(Ct)&&Zn.resolve(We);return We}onInit(X,ae){var be;const We=this.normalizeInstanceIdentifier(ae),Ct=null!==(be=this.onInitCallbacks.get(We))&&void 0!==be?be:new Set;Ct.add(X),this.onInitCallbacks.set(We,Ct);const Zn=this.instances.get(We);return Zn&&X(Zn,We),()=>{Ct.delete(X)}}invokeOnInitCallbacks(X,ae){const be=this.onInitCallbacks.get(ae);if(be)for(const We of be)try{We(X,ae)}catch{}}getOrInitializeService({instanceIdentifier:X,options:ae={}}){let be=this.instances.get(X);if(!be&&this.component&&(be=this.component.instanceFactory(this.container,{instanceIdentifier:(yt=X,yt===Ae?void 0:yt),options:ae}),this.instances.set(X,be),this.instancesOptions.set(X,ae),this.invokeOnInitCallbacks(be,X),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,X,be)}catch{}var yt;return be||null}normalizeInstanceIdentifier(X=Ae){return this.component?this.component.multipleInstances?X:Ae:X}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ut{constructor(X){this.name=X,this.providers=new Map}addComponent(X){const ae=this.getProvider(X.name);if(ae.isComponentSet())throw new Error(`Component ${X.name} has already been registered with ${this.name}`);ae.setComponent(X)}addOrOverwriteComponent(X){this.getProvider(X.name).isComponentSet()&&this.providers.delete(X.name),this.addComponent(X)}getProvider(X){if(this.providers.has(X))return this.providers.get(X);const ae=new _t(X,this);return this.providers.set(X,ae),ae}getProviders(){return Array.from(this.providers.values())}}},879:(Ts,Kn,ke)=>{ke.d(Kn,{Am:()=>yt,Ub:()=>Ut,Yd:()=>Nn,in:()=>Z});const A=[];var Z=function(X){return X[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT",X}(Z||{});const F={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},Ae=Z.INFO,_t={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},Xt=(X,ae,...be)=>{if(ae<X.logLevel)return;const We=(new Date).toISOString(),Ct=_t[ae];if(!Ct)throw new Error(`Attempted to log a message with an invalid logType (value: ${ae})`);console[Ct](`[${We}]  ${X.name}:`,...be)};class Nn{constructor(ae){this.name=ae,this._logLevel=Ae,this._logHandler=Xt,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(ae){if(!(ae in Z))throw new TypeError(`Invalid value "${ae}" assigned to \`logLevel\``);this._logLevel=ae}setLogLevel(ae){this._logLevel="string"==typeof ae?F[ae]:ae}get logHandler(){return this._logHandler}set logHandler(ae){if("function"!=typeof ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(ae){this._userLogHandler=ae}debug(...ae){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...ae),this._logHandler(this,Z.DEBUG,...ae)}log(...ae){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...ae),this._logHandler(this,Z.VERBOSE,...ae)}info(...ae){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...ae),this._logHandler(this,Z.INFO,...ae)}warn(...ae){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...ae),this._logHandler(this,Z.WARN,...ae)}error(...ae){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...ae),this._logHandler(this,Z.ERROR,...ae)}}function Ut(X){A.forEach(ae=>{ae.setLogLevel(X)})}function yt(X,ae){for(const be of A){let We=null;ae&&ae.level&&(We=F[ae.level]),be.userLogHandler=null===X?null:(Ct,Zn,...ct)=>{const $e=ct.map(He=>{if(null==He)return null;if("string"==typeof He)return He;if("number"==typeof He||"boolean"==typeof He)return He.toString();if(He instanceof Error)return He.message;try{return JSON.stringify(He)}catch{return null}}).filter(He=>He).join(" ");Zn>=(We??Ct.logLevel)&&X({level:Z[Zn].toLowerCase(),message:$e,args:ct,type:Ct.name})}}}},365:(Ts,Kn,ke)=>{ke.r(Kn);var A=ke(861),Z=ke(106),F=ke(562),Ae=ke(58),Nn=(ke(534),ke(879),ke(537));function Ut(){return window}function ae(){return ae=(0,A.Z)(function*(I,C,E){var R;const{BuildInfo:K}=Ut();(0,F.au)(C.sessionId,"AuthEvent did not contain a session ID");const Ie=yield function He(I){return ir.apply(this,arguments)}(C.sessionId),ve={};return(0,F.av)()?ve.ibi=K.packageName:(0,F.aw)()?ve.apn=K.packageName:(0,F.ax)(I,"operation-not-supported-in-this-environment"),K.displayName&&(ve.appDisplayName=K.displayName),ve.sessionId=Ie,(0,F.ay)(I,E,C.type,void 0,null!==(R=C.eventId)&&void 0!==R?R:void 0,ve)}),ae.apply(this,arguments)}function We(){return(We=(0,A.Z)(function*(I){const{BuildInfo:C}=Ut(),E={};(0,F.av)()?E.iosBundleId=C.packageName:(0,F.aw)()?E.androidPackageName=C.packageName:(0,F.ax)(I,"operation-not-supported-in-this-environment"),yield(0,F.az)(I,E)})).apply(this,arguments)}function ct(){return(ct=(0,A.Z)(function*(I,C,E){const{cordova:R}=Ut();let K=()=>{};try{yield new Promise((Ie,ve)=>{let Fe=null;function Et(){var Re;Ie();const or=null===(Re=R.plugins.browsertab)||void 0===Re?void 0:Re.close;"function"==typeof or&&or(),"function"==typeof E?.close&&E.close()}function ge(){Fe||(Fe=window.setTimeout(()=>{ve((0,F.aB)(I,"redirect-cancelled-by-user"))},2e3))}function Ft(){"visible"===document?.visibilityState&&ge()}C.addPassiveListener(Et),document.addEventListener("resume",ge,!1),(0,F.aw)()&&document.addEventListener("visibilitychange",Ft,!1),K=()=>{C.removePassiveListener(Et),document.removeEventListener("resume",ge,!1),document.removeEventListener("visibilitychange",Ft,!1),Fe&&window.clearTimeout(Fe)}})}finally{K()}})).apply(this,arguments)}function ir(){return(ir=(0,A.Z)(function*(I){const C=function vn(I){if((0,F.au)(/[0-9a-zA-Z]+/.test(I),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(I);const C=new ArrayBuffer(I.length),E=new Uint8Array(C);for(let R=0;R<I.length;R++)E[R]=I.charCodeAt(R);return E}(I),E=yield crypto.subtle.digest("SHA-256",C);return Array.from(new Uint8Array(E)).map(K=>K.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Mt extends F.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(C=>{this.resolveInialized=C})}addPassiveListener(C){this.passiveListeners.add(C)}removePassiveListener(C){this.passiveListeners.delete(C)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(C){return this.resolveInialized(),this.passiveListeners.forEach(E=>E(C)),super.onEvent(C)}initialized(){var C=this;return(0,A.Z)(function*(){yield C.initPromise})()}}function Xe(I){return se.apply(this,arguments)}function se(){return(se=(0,A.Z)(function*(I){const C=yield En()._get(In(I));return C&&(yield En()._remove(In(I))),C})).apply(this,arguments)}function Kt(){const I=[];for(let E=0;E<20;E++){const R=Math.floor(62*Math.random());I.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(R))}return I.join("")}function En(){return(0,F.aE)(F.b)}function In(I){return(0,F.aF)("authEvent",I.config.apiKey,I.name)}function Ze(I){if(!I?.includes("?"))return{};const[C,...E]=I.split("?");return(0,Ae.zd)(E.join("?"))}const $=class Cs{constructor(){this._redirectPersistence=F.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=F.aG,this._overrideRedirectResult=F.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){const R=C._key();let K=E.eventManagers.get(R);return K||(K=new Mt(C),E.eventManagers.set(R,K),E.attachCallbackListeners(C,K)),K})()}_openPopup(C){(0,F.ax)(C,"operation-not-supported-in-this-environment")}_openRedirect(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){!function $e(I){var C,E,R,K,Ie,ve,Fe,Et,ge,Ft;const Re=Ut();(0,F.aC)("function"==typeof(null===(C=Re?.universalLinks)||void 0===C?void 0:C.subscribe),I,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,F.aC)(typeof(null===(E=Re?.BuildInfo)||void 0===E?void 0:E.packageName)<"u",I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,F.aC)("function"==typeof(null===(Ie=null===(K=null===(R=Re?.cordova)||void 0===R?void 0:R.plugins)||void 0===K?void 0:K.browsertab)||void 0===Ie?void 0:Ie.openUrl),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,F.aC)("function"==typeof(null===(Et=null===(Fe=null===(ve=Re?.cordova)||void 0===ve?void 0:ve.plugins)||void 0===Fe?void 0:Fe.browsertab)||void 0===Et?void 0:Et.isAvailable),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,F.aC)("function"==typeof(null===(Ft=null===(ge=Re?.cordova)||void 0===ge?void 0:ge.InAppBrowser)||void 0===Ft?void 0:Ft.open),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(C);const ve=yield Ie._initialize(C);yield ve.initialized(),ve.resetRedirect(),(0,F.aI)(),yield Ie._originValidation(C);const Fe=function ci(I,C,E=null){return{type:C,eventId:E,urlResponse:null,sessionId:Kt(),postBody:null,tenantId:I.tenantId,error:(0,F.aB)(I,"no-auth-event")}}(C,R,K);yield function Un(I,C){return En()._set(In(I),C)}(C,Fe);const Et=yield function X(I,C,E){return ae.apply(this,arguments)}(C,Fe,E),ge=yield function Ct(I){const{cordova:C}=Ut();return new Promise(E=>{C.plugins.browsertab.isAvailable(R=>{let K=null;R?C.plugins.browsertab.openUrl(I):K=C.InAppBrowser.open(I,(0,F.aA)()?"_blank":"_system","location=yes"),E(K)})})}(Et);return function Zn(I,C,E){return ct.apply(this,arguments)}(C,ve,ge)})()}_isIframeWebStorageSupported(C,E){throw new Error("Method not implemented.")}_originValidation(C){const E=C._key();return this.originValidationPromises[E]||(this.originValidationPromises[E]=function be(I){return We.apply(this,arguments)}(C)),this.originValidationPromises[E]}attachCallbackListeners(C,E){const{universalLinks:R,handleOpenURL:K,BuildInfo:Ie}=Ut(),ve=setTimeout((0,A.Z)(function*(){yield Xe(C),E.onEvent(G())}),500),Fe=function(){var Ft=(0,A.Z)(function*(Re){clearTimeout(ve);const or=yield Xe(C);let oa=null;or&&Re?.url&&(oa=function pt(I,C){var E,R;const K=function Xi(I){const C=Ze(I),E=C.link?decodeURIComponent(C.link):void 0,R=Ze(E).link,K=C.deep_link_id?decodeURIComponent(C.deep_link_id):void 0;return Ze(K).link||K||R||E||I}(C);if(K.includes("/__/auth/callback")){const Ie=Ze(K),ve=Ie.firebaseError?function Yi(I){try{return JSON.parse(I)}catch{return null}}(decodeURIComponent(Ie.firebaseError)):null,Fe=null===(R=null===(E=ve?.code)||void 0===E?void 0:E.split("auth/"))||void 0===R?void 0:R[1],Et=Fe?(0,F.aB)(Fe):null;return Et?{type:I.type,eventId:I.eventId,tenantId:I.tenantId,error:Et,urlResponse:null,sessionId:null,postBody:null}:{type:I.type,eventId:I.eventId,tenantId:I.tenantId,sessionId:I.sessionId,urlResponse:K,postBody:null}}return null}(or,Re.url)),E.onEvent(oa||G())});return function(or){return Ft.apply(this,arguments)}}();typeof R<"u"&&"function"==typeof R.subscribe&&R.subscribe(null,Fe);const Et=K,ge=`${Ie.packageName.toLowerCase()}://`;Ut().handleOpenURL=function(){var Ft=(0,A.Z)(function*(Re){if(Re.toLowerCase().startsWith(ge)&&Fe({url:Re}),"function"==typeof Et)try{Et(Re)}catch(or){console.error(or)}});return function(Re){return Ft.apply(this,arguments)}}()}};function G(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,F.aB)("no-auth-event")}}function ce(){var I;return(null===(I=self?.location)||void 0===I?void 0:I.protocol)||null}function de(I=(0,Ae.z$)()){return!("file:"!==ce()&&"ionic:"!==ce()&&"capacitor:"!==ce()||!I.toLowerCase().match(/iphone|ipad|ipod|android/))}function en(){try{const I=self.localStorage,C=F.aN();if(I)return I.setItem(C,"1"),I.removeItem(C),!function Bt(I=(0,Ae.z$)()){return function vt(){return(0,Ae.w1)()&&11===document?.documentMode}()||function Jt(I=(0,Ae.z$)()){return/Edge\/\d+/.test(I)}(I)}()||(0,Ae.hl)()}catch{return Bn()&&(0,Ae.hl)()}return!1}function Bn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Qn(){return(function it(){return"http:"===ce()||"https:"===ce()}()||(0,Ae.ru)()||de())&&!function Ne(){return(0,Ae.b$)()||(0,Ae.UG)()}()&&en()&&!Bn()}function sr(){return de()&&typeof document<"u"}function xi(){return(xi=(0,A.Z)(function*(){return!!sr()&&new Promise(I=>{const C=setTimeout(()=>{I(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(C),I(!0)})})})).apply(this,arguments)}const gt={LOCAL:"local",NONE:"none",SESSION:"session"},Ds=F.aC,As="persistence";function es(I){return cr.apply(this,arguments)}function cr(){return(cr=(0,A.Z)(function*(I){yield I._initializationPromise;const C=hi(),E=F.aF(As,I.config.apiKey,I.name);C&&C.setItem(E,I._getPersistence())})).apply(this,arguments)}function hi(){var I;try{return(null===(I=function bs(){return typeof window<"u"?window:null}())||void 0===I?void 0:I.sessionStorage)||null}catch{return null}}const fi=F.aC;class dr{constructor(){this.browserResolver=F.aE(F.k),this.cordovaResolver=F.aE($),this.underlyingResolver=null,this._redirectPersistence=F.a,this._completeRedirectFn=F.aG,this._overrideRedirectResult=F.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){return yield E.selectUnderlyingResolver(),E.assertedUnderlyingResolver._initialize(C)})()}_openPopup(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){return yield Ie.selectUnderlyingResolver(),Ie.assertedUnderlyingResolver._openPopup(C,E,R,K)})()}_openRedirect(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){return yield Ie.selectUnderlyingResolver(),Ie.assertedUnderlyingResolver._openRedirect(C,E,R,K)})()}_isIframeWebStorageSupported(C,E){this.assertedUnderlyingResolver._isIframeWebStorageSupported(C,E)}_originValidation(C){return this.assertedUnderlyingResolver._originValidation(C)}get _shouldInitProactively(){return sr()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return fi(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var C=this;return(0,A.Z)(function*(){if(C.underlyingResolver)return;const E=yield function Kr(){return xi.apply(this,arguments)}();C.underlyingResolver=E?C.cordovaResolver:C.browserResolver})()}}function xt(I){return I.unwrap()}function wn(I){return tn(I)}function tn(I){const{_tokenResponse:C}=I instanceof Ae.ZR?I.customData:I;if(!C)return null;if(!(I instanceof Ae.ZR)&&"temporaryProof"in C&&"phoneNumber"in C)return F.P.credentialFromResult(I);const E=C.providerId;if(!E||E===F.p.PASSWORD)return null;let R;switch(E){case F.p.GOOGLE:R=F.X;break;case F.p.FACEBOOK:R=F.W;break;case F.p.GITHUB:R=F.Y;break;case F.p.TWITTER:R=F.$;break;default:const{oauthIdToken:K,oauthAccessToken:Ie,oauthTokenSecret:ve,pendingToken:Fe,nonce:Et}=C;return Ie||ve||K||Fe?Fe?E.startsWith("saml.")?F.aQ._create(E,Fe):F.N._fromParams({providerId:E,signInMethod:E,pendingToken:Fe,idToken:K,accessToken:Ie}):new F.Z(E).credential({idToken:K,accessToken:Ie,rawNonce:Et}):null}return I instanceof Ae.ZR?R.credentialFromError(I):R.credentialFromResult(I)}function Tn(I,C){return C.catch(E=>{throw E instanceof Ae.ZR&&function ml(I,C){var E;const R=null===(E=C.customData)||void 0===E?void 0:E._tokenResponse;if("auth/multi-factor-auth-required"===C?.code)C.resolver=new ns(I,F.as(I,C));else if(R){const K=tn(C),Ie=C;K&&(Ie.credential=K,Ie.tenantId=R.tenantId||void 0,Ie.email=R.email||void 0,Ie.phoneNumber=R.phoneNumber||void 0)}}(I,E),E}).then(E=>{const K=E.user;return{operationType:E.operationType,credential:wn(E),additionalUserInfo:F.aq(E),user:Yn.getOrCreate(K)}})}function ts(I,C){return ki.apply(this,arguments)}function ki(){return(ki=(0,A.Z)(function*(I,C){const E=yield C;return{verificationId:E.verificationId,confirm:R=>Tn(I,E.confirm(R))}})).apply(this,arguments)}class ns{constructor(C,E){this.resolver=E,this.auth=function Zr(I){return I.wrapped()}(C)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(C){return Tn(xt(this.auth),this.resolver.resolveSignIn(C))}}class Yn{constructor(C){this._delegate=C,this.multiFactor=F.at(C)}static getOrCreate(C){return Yn.USER_MAP.has(C)||Yn.USER_MAP.set(C,new Yn(C)),Yn.USER_MAP.get(C)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(C){return this._delegate.getIdTokenResult(C)}getIdToken(C){return this._delegate.getIdToken(C)}linkAndRetrieveDataWithCredential(C){return this.linkWithCredential(C)}linkWithCredential(C){var E=this;return(0,A.Z)(function*(){return Tn(E.auth,F.a2(E._delegate,C))})()}linkWithPhoneNumber(C,E){var R=this;return(0,A.Z)(function*(){return ts(R.auth,F.l(R._delegate,C,E))})()}linkWithPopup(C){var E=this;return(0,A.Z)(function*(){return Tn(E.auth,F.d(E._delegate,C,dr))})()}linkWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield es(F.aJ(E.auth)),F.g(E._delegate,C,dr)})()}reauthenticateAndRetrieveDataWithCredential(C){return this.reauthenticateWithCredential(C)}reauthenticateWithCredential(C){var E=this;return(0,A.Z)(function*(){return Tn(E.auth,F.a3(E._delegate,C))})()}reauthenticateWithPhoneNumber(C,E){return ts(this.auth,F.r(this._delegate,C,E))}reauthenticateWithPopup(C){return Tn(this.auth,F.e(this._delegate,C,dr))}reauthenticateWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield es(F.aJ(E.auth)),F.h(E._delegate,C,dr)})()}sendEmailVerification(C){return F.ag(this._delegate,C)}unlink(C){var E=this;return(0,A.Z)(function*(){return yield F.ap(E._delegate,C),E})()}updateEmail(C){return F.al(this._delegate,C)}updatePassword(C){return F.am(this._delegate,C)}updatePhoneNumber(C){return F.u(this._delegate,C)}updateProfile(C){return F.ak(this._delegate,C)}verifyBeforeUpdateEmail(C,E){return F.ah(this._delegate,C,E)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Yn.USER_MAP=new WeakMap;const jn=F.aC;let Or=(()=>{class I{constructor(E,R){if(this.app=E,R.isInitialized())return this._delegate=R.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:K}=E.options;jn(K,"invalid-api-key",{appName:E.name}),jn(K,"invalid-api-key",{appName:E.name});const Ie=typeof window<"u"?dr:void 0;this._delegate=R.initialize({options:{persistence:Xa(K,E.name),popupRedirectResolver:Ie}}),this._delegate._updateErrorMap(F.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Yn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(E){this._delegate.languageCode=E}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(E){this._delegate.tenantId=E}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(E,R){F.K(this._delegate,E,R)}applyActionCode(E){return F.a7(this._delegate,E)}checkActionCode(E){return F.a8(this._delegate,E)}confirmPasswordReset(E,R){return F.a6(this._delegate,E,R)}createUserWithEmailAndPassword(E,R){var K=this;return(0,A.Z)(function*(){return Tn(K._delegate,F.aa(K._delegate,E,R))})()}fetchProvidersForEmail(E){return this.fetchSignInMethodsForEmail(E)}fetchSignInMethodsForEmail(E){return F.af(this._delegate,E)}isSignInWithEmailLink(E){return F.ad(this._delegate,E)}getRedirectResult(){var E=this;return(0,A.Z)(function*(){jn(Qn(),E._delegate,"operation-not-supported-in-this-environment");const R=yield F.j(E._delegate,dr);return R?Tn(E._delegate,Promise.resolve(R)):{credential:null,user:null}})()}addFrameworkForLogging(E){!function z(I,C){(0,F.aJ)(I)._logFramework(C)}(this._delegate,E)}onAuthStateChanged(E,R,K){const{next:Ie,error:ve,complete:Fe}=pi(E,R,K);return this._delegate.onAuthStateChanged(Ie,ve,Fe)}onIdTokenChanged(E,R,K){const{next:Ie,error:ve,complete:Fe}=pi(E,R,K);return this._delegate.onIdTokenChanged(Ie,ve,Fe)}sendSignInLinkToEmail(E,R){return F.ac(this._delegate,E,R)}sendPasswordResetEmail(E,R){return F.a5(this._delegate,E,R||void 0)}setPersistence(E){var R=this;return(0,A.Z)(function*(){let K;switch(function Ji(I,C){Ds(Object.values(gt).includes(C),I,"invalid-persistence-type"),(0,Ae.b$)()?Ds(C!==gt.SESSION,I,"unsupported-persistence-type"):(0,Ae.UG)()?Ds(C===gt.NONE,I,"unsupported-persistence-type"):Bn()?Ds(C===gt.NONE||C===gt.LOCAL&&(0,Ae.hl)(),I,"unsupported-persistence-type"):Ds(C===gt.NONE||en(),I,"unsupported-persistence-type")}(R._delegate,E),E){case gt.SESSION:K=F.a;break;case gt.LOCAL:K=(yield F.aE(F.i)._isAvailable())?F.i:F.b;break;case gt.NONE:K=F.U;break;default:return F.ax("argument-error",{appName:R._delegate.name})}return R._delegate.setPersistence(K)})()}signInAndRetrieveDataWithCredential(E){return this.signInWithCredential(E)}signInAnonymously(){return Tn(this._delegate,F.a0(this._delegate))}signInWithCredential(E){return Tn(this._delegate,F.a1(this._delegate,E))}signInWithCustomToken(E){return Tn(this._delegate,F.a4(this._delegate,E))}signInWithEmailAndPassword(E,R){return Tn(this._delegate,F.ab(this._delegate,E,R))}signInWithEmailLink(E,R){return Tn(this._delegate,F.ae(this._delegate,E,R))}signInWithPhoneNumber(E,R){return ts(this._delegate,F.s(this._delegate,E,R))}signInWithPopup(E){var R=this;return(0,A.Z)(function*(){return jn(Qn(),R._delegate,"operation-not-supported-in-this-environment"),Tn(R._delegate,F.c(R._delegate,E,dr))})()}signInWithRedirect(E){var R=this;return(0,A.Z)(function*(){return jn(Qn(),R._delegate,"operation-not-supported-in-this-environment"),yield es(R._delegate),F.f(R._delegate,E,dr)})()}updateCurrentUser(E){return this._delegate.updateCurrentUser(E)}verifyPasswordResetCode(E){return F.a9(this._delegate,E)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return I.Persistence=gt,I})();function pi(I,C,E){let R=I;"function"!=typeof I&&({next:R,error:C,complete:E}=I);const K=R;return{next:ve=>K(ve&&Yn.getOrCreate(ve)),error:C,complete:E}}function Xa(I,C){const E=function di(I,C){const E=hi();if(!E)return[];const R=F.aF(As,I,C);switch(E.getItem(R)){case gt.NONE:return[F.U];case gt.LOCAL:return[F.i,F.a];case gt.SESSION:return[F.a];default:return[]}}(I,C);if(typeof self<"u"&&!E.includes(F.i)&&E.push(F.i),typeof window<"u")for(const R of[F.b,F.a])E.includes(R)||E.push(R);return E.includes(F.U)||E.push(F.U),E}class vo{constructor(){this.providerId="phone",this._delegate=new F.P(xt(Z.Z.auth()))}static credential(C,E){return F.P.credential(C,E)}verifyPhoneNumber(C,E){return this._delegate.verifyPhoneNumber(C,E)}unwrap(){return this._delegate}}vo.PHONE_SIGN_IN_METHOD=F.P.PHONE_SIGN_IN_METHOD,vo.PROVIDER_ID=F.P.PROVIDER_ID;const sa=F.aC;class Ss{constructor(C,E,R=Z.Z.app()){var K;sa(null===(K=R.options)||void 0===K?void 0:K.apiKey,"invalid-api-key",{appName:R.name}),this._delegate=new F.R(R.auth(),C,E),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function S(I){I.INTERNAL.registerComponent(new Nn.wA("auth-compat",C=>{const E=C.getProvider("app-compat").getImmediate(),R=C.getProvider("auth");return new Or(E,R)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:F.A.EMAIL_SIGNIN,PASSWORD_RESET:F.A.PASSWORD_RESET,RECOVER_EMAIL:F.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:F.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:F.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:F.A.VERIFY_EMAIL}},EmailAuthProvider:F.V,FacebookAuthProvider:F.W,GithubAuthProvider:F.Y,GoogleAuthProvider:F.X,OAuthProvider:F.Z,SAMLAuthProvider:F._,PhoneAuthProvider:vo,PhoneMultiFactorGenerator:F.m,RecaptchaVerifier:Ss,TwitterAuthProvider:F.$,Auth:Or,AuthCredential:F.L,Error:Ae.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),I.registerVersion("@firebase/auth-compat","0.4.9")}(Z.Z)},861:(Ts,Kn,ke)=>{function A(F,Ae,_t,Xt,Nn,Ut,yt){try{var X=F[Ut](yt),ae=X.value}catch(be){return void _t(be)}X.done?Ae(ae):Promise.resolve(ae).then(Xt,Nn)}function Z(F){return function(){var Ae=this,_t=arguments;return new Promise(function(Xt,Nn){var Ut=F.apply(Ae,_t);function yt(ae){A(Ut,Xt,Nn,yt,X,"next",ae)}function X(ae){A(Ut,Xt,Nn,yt,X,"throw",ae)}yt(void 0)})}}ke.d(Kn,{Z:()=>Z})},582:(Ts,Kn,ke)=>{function Ae($,G){var z={};for(var B in $)Object.prototype.hasOwnProperty.call($,B)&&G.indexOf(B)<0&&(z[B]=$[B]);if(null!=$&&"function"==typeof Object.getOwnPropertySymbols){var J=0;for(B=Object.getOwnPropertySymbols($);J<B.length;J++)G.indexOf(B[J])<0&&Object.prototype.propertyIsEnumerable.call($,B[J])&&(z[B[J]]=$[B[J]])}return z}function be($,G,z,B){return new(z||(z=Promise))(function(Y,ce){function it(vt){try{Ne(B.next(vt))}catch(Jt){ce(Jt)}}function de(vt){try{Ne(B.throw(vt))}catch(Jt){ce(Jt)}}function Ne(vt){vt.done?Y(vt.value):function J(Y){return Y instanceof z?Y:new z(function(ce){ce(Y)})}(vt.value).then(it,de)}Ne((B=B.apply($,G||[])).next())})}function ot($){return this instanceof ot?(this.v=$,this):new ot($)}function Mt($,G,z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J,B=z.apply($,G||[]),Y=[];return J={},ce("next"),ce("throw"),ce("return"),J[Symbol.asyncIterator]=function(){return this},J;function ce(Bt){B[Bt]&&(J[Bt]=function(en){return new Promise(function(Bn,Qn){Y.push([Bt,en,Bn,Qn])>1||it(Bt,en)})})}function it(Bt,en){try{!function de(Bt){Bt.value instanceof ot?Promise.resolve(Bt.value.v).then(Ne,vt):Jt(Y[0][2],Bt)}(B[Bt](en))}catch(Bn){Jt(Y[0][3],Bn)}}function Ne(Bt){it("next",Bt)}function vt(Bt){it("throw",Bt)}function Jt(Bt,en){Bt(en),Y.shift(),Y.length&&it(Y[0][0],Y[0][1])}}function Un($){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var z,G=$[Symbol.asyncIterator];return G?G.call($):($=function ct($){var G="function"==typeof Symbol&&Symbol.iterator,z=G&&$[G],B=0;if(z)return z.call($);if($&&"number"==typeof $.length)return{next:function(){return $&&B>=$.length&&($=void 0),{value:$&&$[B++],done:!$}}};throw new TypeError(G?"Object is not iterable.":"Symbol.iterator is not defined.")}($),z={},B("next"),B("throw"),B("return"),z[Symbol.asyncIterator]=function(){return this},z);function B(Y){z[Y]=$[Y]&&function(ce){return new Promise(function(it,de){!function J(Y,ce,it,de){Promise.resolve(de).then(function(Ne){Y({value:Ne,done:it})},ce)}(it,de,(ce=$[Y](ce)).done,ce.value)})}}}ke.d(Kn,{FC:()=>Mt,KL:()=>Un,_T:()=>Ae,mG:()=>be,qq:()=>ot}),"function"==typeof SuppressedError&&SuppressedError}},Ts=>{Ts(Ts.s=838)}]);