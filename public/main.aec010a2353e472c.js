"use strict";(self.webpackChunkweedcobot_angular=self.webpackChunkweedcobot_angular||[]).push([[179],{562:(Cs,Zn,ke)=>{ke.d(Zn,{$:()=>vy,A:()=>ae,G:()=>bt,K:()=>eC,L:()=>eu,N:()=>_i,P:()=>Ed,R:()=>Hy,U:()=>ve,V:()=>ip,W:()=>nd,X:()=>Fi,Y:()=>Ps,Z:()=>yi,_:()=>iu,a:()=>ks,a0:()=>ap,a1:()=>ad,a2:()=>fp,a3:()=>Ty,a4:()=>sC,a5:()=>hr,a6:()=>ou,a7:()=>Cy,a8:()=>wl,a9:()=>oC,aA:()=>Je,aB:()=>kt,aC:()=>se,aD:()=>Fs,aE:()=>K,aF:()=>Fe,aG:()=>kl,aH:()=>Ky,aI:()=>gu,aJ:()=>pn,aN:()=>On,aQ:()=>Xs,aa:()=>me,ab:()=>on,ac:()=>is,ad:()=>Cr,ae:()=>au,af:()=>ze,ag:()=>by,ah:()=>kn,ak:()=>Tl,al:()=>So,am:()=>Js,ap:()=>Ey,aq:()=>bl,as:()=>FM,at:()=>jM,au:()=>Qt,av:()=>De,aw:()=>U,ax:()=>ot,ay:()=>_u,az:()=>Xy,b:()=>uC,c:()=>Po,d:()=>Wy,e:()=>IC,f:()=>TC,g:()=>gr,h:()=>wt,i:()=>_d,j:()=>Os,k:()=>uv,l:()=>yC,m:()=>OC,p:()=>$t,r:()=>vC,s:()=>qy,u:()=>Kt});var A=ke(861),Z=ke(58),F=ke(534),Ae=ke(879),yt=ke(582),Jt=ke(537);const $t={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ae={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const bt=function be(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Qn=function We(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ct=new Z.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),He=new Ae.Yd("@firebase/auth");function In(p,...c){He.logLevel<=Ae.in.ERROR&&He.error(`Auth (${F.SDK_VERSION}): ${p}`,...c)}function ot(p,...c){throw Xe(p,...c)}function kt(p,...c){return Xe(p,...c)}function di(p,c,h){const g=Object.assign(Object.assign({},Qn()),{[c]:h});return new Z.LL("auth","Firebase",g).create(c,{appName:p.name})}function Bn(p,c,h){if(!(c instanceof h))throw h.name!==c.constructor.name&&ot(p,"argument-error"),di(p,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xe(p,...c){if("string"!=typeof p){const h=c[0],g=[...c.slice(1)];return g[0]&&(g[0].appName=p.name),p._errorFactory.create(h,...g)}return ct.create(p,...c)}function se(p,c,...h){if(!p)throw Xe(c,...h)}function pt(p){const c="INTERNAL ASSERTION FAILED: "+p;throw In(c),new Error(c)}function Qt(p,c){p||pt(c)}function wn(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.href)||""}function Tn(){return"http:"===Xi()||"https:"===Xi()}function Xi(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.protocol)||null}class Kr{constructor(c,h){this.shortDelay=c,this.longDelay=h,Qt(h>c,"Short delay should be less than long delay!"),this.isMobile=(0,Z.uI)()||(0,Z.b$)()}get(){return function Ji(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Tn()||(0,Z.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function bs(p,c){Qt(p.emulator,"Emulator should always be set here");const{url:h}=p.emulator;return c?`${h}${c.startsWith("/")?c.slice(1):c}`:h}class ${static initialize(c,h,g){this.fetchImpl=c,h&&(this.headersImpl=h),g&&(this.responseImpl=g)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const G={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},z=new Kr(3e4,6e4);function B(p,c){return p.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:p.tenantId}):c}function ee(p,c,h,g){return Y.apply(this,arguments)}function Y(){return(Y=(0,A.Z)(function*(p,c,h,g,y={}){return ce(p,y,(0,A.Z)(function*(){let w={},M={};g&&("GET"===c?M=g:w={body:JSON.stringify(g)});const j=(0,Z.xO)(Object.assign({key:p.config.apiKey},M)).slice(1),re=yield p._getAdditionalHeaders();return re["Content-Type"]="application/json",p.languageCode&&(re["X-Firebase-Locale"]=p.languageCode),$.fetch()(Et(p,p.config.apiHost,h,j),Object.assign({method:c,headers:re,referrerPolicy:"no-referrer"},w))}))})).apply(this,arguments)}function ce(p,c,h){return it.apply(this,arguments)}function it(){return(it=(0,A.Z)(function*(p,c,h){p._canInitEmulator=!1;const g=Object.assign(Object.assign({},G),c);try{const y=new Ht(p),w=yield Promise.race([h(),y.promise]);y.clearNetworkTimeout();const M=yield w.json();if("needConfirmation"in M)throw tn(p,"account-exists-with-different-credential",M);if(w.ok&&!("errorMessage"in M))return M;{const j=w.ok?M.errorMessage:M.error.message,[re,Ee]=j.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===re)throw tn(p,"credential-already-in-use",M);if("EMAIL_EXISTS"===re)throw tn(p,"email-already-in-use",M);if("USER_DISABLED"===re)throw tn(p,"user-disabled",M);const xe=g[re]||re.toLowerCase().replace(/[_\s]+/g,"-");if(Ee)throw di(p,xe,Ee);ot(p,xe)}}catch(y){if(y instanceof Z.ZR)throw y;ot(p,"network-request-failed",{message:String(y)})}})).apply(this,arguments)}function de(p,c,h,g){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,A.Z)(function*(p,c,h,g,y={}){const w=yield ee(p,c,h,g,y);return"mfaPendingCredential"in w&&ot(p,"multi-factor-auth-required",{_serverResponse:w}),w})).apply(this,arguments)}function Et(p,c,h,g){const y=`${c}${h}?${g}`;return p.config.emulator?bs(p.config,y):`${p.config.apiScheme}://${y}`}function en(p){switch(p){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ht{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((h,g)=>{this.timer=setTimeout(()=>g(kt(this.auth,"network-request-failed")),z.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tn(p,c,h){const g={appName:p.name};h.email&&(g.email=h.email),h.phoneNumber&&(g.phoneNumber=h.phoneNumber);const y=kt(p,c,g);return y.customData._tokenResponse=h,y}function jn(p){return void 0!==p&&void 0!==p.getResponse}function Yn(p){return void 0!==p&&void 0!==p.enterprise}class sr{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const h of this.recaptchaEnforcementState)if(h.provider&&h.provider===c)return en(h.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function ki(){return(ki=(0,A.Z)(function*(p){return(yield ee(p,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ds(p,c){return gt.apply(this,arguments)}function gt(){return(gt=(0,A.Z)(function*(p,c){return ee(p,"GET","/v2/recaptchaConfig",B(p,c))})).apply(this,arguments)}function Ss(){return(Ss=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function ts(){return(ts=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function hi(){return(hi=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function fi(p){if(p)try{const c=new Date(Number(p));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function Ot(){return(Ot=(0,A.Z)(function*(p,c=!1){const h=(0,Z.m9)(p),g=yield h.getIdToken(c),y=Cn(g);se(y&&y.exp&&y.auth_time&&y.iat,h.auth,"internal-error");const w="object"==typeof y.firebase?y.firebase:void 0,M=w?.sign_in_provider;return{claims:y,token:g,authTime:fi(Qr(y.auth_time)),issuedAtTime:fi(Qr(y.iat)),expirationTime:fi(Qr(y.exp)),signInProvider:M||null,signInSecondFactor:w?.sign_in_second_factor||null}})).apply(this,arguments)}function Qr(p){return 1e3*Number(p)}function Cn(p){const[c,h,g]=p.split(".");if(void 0===c||void 0===h||void 0===g)return In("JWT malformed, contained fewer than 3 sections"),null;try{const y=(0,Z.tV)(h);return y?JSON.parse(y):(In("Failed to decode base64 JWT payload"),null)}catch(y){return In("Caught error parsing JWT payload as JSON",y?.toString()),null}}function nn(p,c){return bn.apply(this,arguments)}function bn(){return(bn=(0,A.Z)(function*(p,c,h=!1){if(h)return c;try{return yield c}catch(g){throw g instanceof Z.ZR&&function ns({code:p}){return"auth/user-disabled"===p||"auth/user-token-expired"===p}(g)&&p.auth.currentUser===p&&(yield p.auth.signOut()),g}})).apply(this,arguments)}class Oi{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var h;if(c){const g=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),g}{this.errorBackoff=3e4;const y=(null!==(h=this.user.stsTokenManager.expirationTime)&&void 0!==h?h:0)-Date.now()-3e5;return Math.max(0,y)}}schedule(c=!1){var h=this;if(!this.isRunning)return;const g=this.getInterval(c);this.timerId=setTimeout((0,A.Z)(function*(){yield h.iteration()}),g)}iteration(){var c=this;return(0,A.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(h){return void("auth/network-request-failed"===h?.code&&c.schedule(!0))}c.schedule()})()}}class rs{constructor(c,h){this.createdAt=c,this.lastLoginAt=h,this._initializeTime()}_initializeTime(){this.lastSignInTime=fi(this.lastLoginAt),this.creationTime=fi(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Xn(p){return $n.apply(this,arguments)}function $n(){return $n=(0,A.Z)(function*(p){var c;const h=p.auth,g=yield p.getIdToken(),y=yield nn(p,function cr(p,c){return hi.apply(this,arguments)}(h,{idToken:g}));se(y?.users.length,h,"internal-error");const w=y.users[0];p._notifyReloadListener(w);const M=null!==(c=w.providerUserInfo)&&void 0!==c&&c.length?function Eo(p){return p.map(c=>{var{providerId:h}=c,g=(0,yt._T)(c,["providerId"]);return{providerId:h,uid:g.rawId||"",displayName:g.displayName||null,email:g.email||null,phoneNumber:g.phoneNumber||null,photoURL:g.photoUrl||null}})}(w.providerUserInfo):[],j=function Ja(p,c){return[...p.filter(g=>!c.some(y=>y.providerId===g.providerId)),...c]}(p.providerData,M),xe=!!p.isAnonymous&&!(p.email&&w.passwordHash||j?.length),ht={uid:w.localId,displayName:w.displayName||null,photoURL:w.photoUrl||null,email:w.email||null,emailVerified:w.emailVerified||!1,phoneNumber:w.phoneNumber||null,tenantId:w.tenantId||null,providerData:j,metadata:new rs(w.createdAt,w.lastLoginAt),isAnonymous:xe};Object.assign(p,ht)}),$n.apply(this,arguments)}function gi(){return(gi=(0,A.Z)(function*(p){const c=(0,Z.m9)(p);yield Xn(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function Rs(){return(Rs=(0,A.Z)(function*(p,c){const h=yield ce(p,{},(0,A.Z)(function*(){const g=(0,Z.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:y,apiKey:w}=p.config,M=Et(p,y,"/v1/token",`key=${w}`),j=yield p._getAdditionalHeaders();return j["Content-Type"]="application/x-www-form-urlencoded",$.fetch()(M,{method:"POST",headers:j,body:g})}));return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}})).apply(this,arguments)}function S(){return(S=(0,A.Z)(function*(p,c){return ee(p,"POST","/v2/accounts:revokeToken",B(p,c))})).apply(this,arguments)}class I{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){se(c.idToken,"internal-error"),se(typeof c.idToken<"u","internal-error"),se(typeof c.refreshToken<"u","internal-error");const h="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function _l(p){const c=Cn(p);return se(c,"internal-error"),se(typeof c.exp<"u","internal-error"),se(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,h)}getToken(c,h=!1){var g=this;return(0,A.Z)(function*(){return se(!g.accessToken||g.refreshToken,c,"user-token-expired"),h||!g.accessToken||g.isExpired?g.refreshToken?(yield g.refresh(c,g.refreshToken),g.accessToken):null:g.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,h){var g=this;return(0,A.Z)(function*(){const{accessToken:y,refreshToken:w,expiresIn:M}=yield function sa(p,c){return Rs.apply(this,arguments)}(c,h);g.updateTokensAndExpiration(y,w,Number(M))})()}updateTokensAndExpiration(c,h,g){this.refreshToken=h||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*g}static fromJSON(c,h){const{refreshToken:g,accessToken:y,expirationTime:w}=h,M=new I;return g&&(se("string"==typeof g,"internal-error",{appName:c}),M.refreshToken=g),y&&(se("string"==typeof y,"internal-error",{appName:c}),M.accessToken=y),w&&(se("number"==typeof w,"internal-error",{appName:c}),M.expirationTime=w),M}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new I,this.toJSON())}_performRefresh(){return pt("not implemented")}}function C(p,c){se("string"==typeof p||typeof p>"u","internal-error",{appName:c})}class E{constructor(c){var{uid:h,auth:g,stsTokenManager:y}=c,w=(0,yt._T)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Oi(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=h,this.auth=g,this.stsTokenManager=y,this.accessToken=y.accessToken,this.displayName=w.displayName||null,this.email=w.email||null,this.emailVerified=w.emailVerified||!1,this.phoneNumber=w.phoneNumber||null,this.photoURL=w.photoURL||null,this.isAnonymous=w.isAnonymous||!1,this.tenantId=w.tenantId||null,this.providerData=w.providerData?[...w.providerData]:[],this.metadata=new rs(w.createdAt||void 0,w.lastLoginAt||void 0)}getIdToken(c){var h=this;return(0,A.Z)(function*(){const g=yield nn(h,h.stsTokenManager.getToken(h.auth,c));return se(g,h.auth,"internal-error"),h.accessToken!==g&&(h.accessToken=g,yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)),g})()}getIdTokenResult(c){return function dr(p){return Ot.apply(this,arguments)}(this,c)}reload(){return function Or(p){return gi.apply(this,arguments)}(this)}_assign(c){this!==c&&(se(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(h=>Object.assign({},h)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const h=new E(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return h.metadata._copy(this.metadata),h}_onReload(c){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,h=!1){var g=this;return(0,A.Z)(function*(){let y=!1;c.idToken&&c.idToken!==g.stsTokenManager.accessToken&&(g.stsTokenManager.updateFromServerResponse(c),y=!0),h&&(yield Xn(g)),yield g.auth._persistUserIfCurrent(g),y&&g.auth._notifyListenersIfCurrent(g)})()}delete(){var c=this;return(0,A.Z)(function*(){const h=yield c.getIdToken();return yield nn(c,function As(p,c){return Ss.apply(this,arguments)}(c.auth,{idToken:h})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,h){var g,y,w,M,j,re,Ee,xe;const ht=null!==(g=h.displayName)&&void 0!==g?g:void 0,Ur=null!==(y=h.email)&&void 0!==y?y:void 0,no=null!==(w=h.phoneNumber)&&void 0!==w?w:void 0,Ul=null!==(M=h.photoURL)&&void 0!==M?M:void 0,cv=null!==(j=h.tenantId)&&void 0!==j?j:void 0,Eu=null!==(re=h._redirectEventId)&&void 0!==re?re:void 0,Mo=null!==(Ee=h.createdAt)&&void 0!==Ee?Ee:void 0,dv=null!==(xe=h.lastLoginAt)&&void 0!==xe?xe:void 0,{uid:xd,emailVerified:zp,isAnonymous:Iu,providerData:Gp,stsTokenManager:Dr}=h;se(xd&&Dr,c,"internal-error");const UC=I.fromJSON(this.name,Dr);se("string"==typeof xd,c,"internal-error"),C(ht,c.name),C(Ur,c.name),se("boolean"==typeof zp,c,"internal-error"),se("boolean"==typeof Iu,c,"internal-error"),C(no,c.name),C(Ul,c.name),C(cv,c.name),C(Eu,c.name),C(Mo,c.name),C(dv,c.name);const Jn=new E({uid:xd,auth:c,email:Ur,emailVerified:zp,displayName:ht,isAnonymous:Iu,photoURL:Ul,phoneNumber:no,tenantId:cv,stsTokenManager:UC,createdAt:Mo,lastLoginAt:dv});return Gp&&Array.isArray(Gp)&&(Jn.providerData=Gp.map(Wp=>Object.assign({},Wp))),Eu&&(Jn._redirectEventId=Eu),Jn}static _fromIdTokenResponse(c,h,g=!1){return(0,A.Z)(function*(){const y=new I;y.updateFromServerResponse(h);const w=new E({uid:h.localId,auth:c,stsTokenManager:y,isAnonymous:g});return yield Xn(w),w})()}}const R=new Map;function K(p){Qt(p instanceof Function,"Expected a class definition");let c=R.get(p);return c?(Qt(c instanceof p,"Instance stored in cache mismatched with class"),c):(c=new p,R.set(p,c),c)}const ve=(()=>{class p{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,A.Z)(function*(){return!0})()}_set(h,g){var y=this;return(0,A.Z)(function*(){y.storage[h]=g})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=g.storage[h];return void 0===y?null:y})()}_remove(h){var g=this;return(0,A.Z)(function*(){delete g.storage[h]})()}_addListener(h,g){}_removeListener(h,g){}}return p.type="NONE",p})();function Fe(p,c,h){return`firebase:${p}:${c}:${h}`}class It{constructor(c,h,g){this.persistence=c,this.auth=h,this.userKey=g;const{config:y,name:w}=this.auth;this.fullUserKey=Fe(this.userKey,y.apiKey,w),this.fullPersistenceKey=Fe("persistence",y.apiKey,w),this.boundEventHandler=h._onStorageEvent.bind(h),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,A.Z)(function*(){const h=yield c.persistence._get(c.fullUserKey);return h?E._fromJSON(c.auth,h):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var h=this;return(0,A.Z)(function*(){if(h.persistence===c)return;const g=yield h.getCurrentUser();return yield h.removeCurrentUser(),h.persistence=c,g?h.setCurrentUser(g):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,h,g="authUser"){return(0,A.Z)(function*(){if(!h.length)return new It(K(ve),c,g);const y=(yield Promise.all(h.map(function(){var Ee=(0,A.Z)(function*(xe){if(yield xe._isAvailable())return xe});return function(xe){return Ee.apply(this,arguments)}}()))).filter(Ee=>Ee);let w=y[0]||K(ve);const M=Fe(g,c.config.apiKey,c.name);let j=null;for(const Ee of h)try{const xe=yield Ee._get(M);if(xe){const ht=E._fromJSON(c,xe);Ee!==w&&(j=ht),w=Ee;break}}catch{}const re=y.filter(Ee=>Ee._shouldAllowMigration);return w._shouldAllowMigration&&re.length?(w=re[0],j&&(yield w._set(M,j.toJSON())),yield Promise.all(h.map(function(){var Ee=(0,A.Z)(function*(xe){if(xe!==w)try{yield xe._remove(M)}catch{}});return function(xe){return Ee.apply(this,arguments)}}())),new It(w,c,g)):new It(w,c,g)})()}}function ge(p){const c=p.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(oa(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(Vt(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(x(c))return"Blackberry";if(ie(c))return"Webos";if(Re(c))return"Safari";if((c.includes("chrome/")||or(c))&&!c.includes("edge/"))return"Chrome";if(U(c))return"Android";{const g=p.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===g?.length)return g[1]}return"Other"}function Vt(p=(0,Z.z$)()){return/firefox\//i.test(p)}function Re(p=(0,Z.z$)()){const c=p.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function or(p=(0,Z.z$)()){return/crios\//i.test(p)}function oa(p=(0,Z.z$)()){return/iemobile/i.test(p)}function U(p=(0,Z.z$)()){return/android/i.test(p)}function x(p=(0,Z.z$)()){return/blackberry/i.test(p)}function ie(p=(0,Z.z$)()){return/webos/i.test(p)}function De(p=(0,Z.z$)()){return/iphone|ipad|ipod/i.test(p)||/macintosh/i.test(p)&&/mobile/i.test(p)}function Je(p=(0,Z.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(p)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(p)}function xn(p=(0,Z.z$)()){return De(p)||U(p)||ie(p)||x(p)||/windows phone/i.test(p)||oa(p)}function st(p,c=[]){let h;switch(p){case"Browser":h=ge((0,Z.z$)());break;case"Worker":h=`${ge((0,Z.z$)())}-${p}`;break;default:h=p}const g=c.length?c.join(","):"FirebaseCore-web";return`${h}/JsCore/${F.SDK_VERSION}/${g}`}class yl{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,h){const g=w=>new Promise((M,j)=>{try{M(c(w))}catch(re){j(re)}});g.onAbort=h,this.queue.push(g);const y=this.queue.length-1;return()=>{this.queue[y]=()=>Promise.resolve()}}runMiddleware(c){var h=this;return(0,A.Z)(function*(){if(h.auth.currentUser===c)return;const g=[];try{for(const y of h.queue)yield y(c),y.onAbort&&g.push(y.onAbort)}catch(y){g.reverse();for(const w of g)try{w()}catch{}throw h.auth._errorFactory.create("login-blocked",{originalMessage:y?.message})}})()}}function Gf(){return(Gf=(0,A.Z)(function*(p,c={}){return ee(p,"GET","/v2/passwordPolicy",B(p,c))})).apply(this,arguments)}class mi{constructor(c){var h,g,y,w;const M=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(h=M.minPasswordLength)&&void 0!==h?h:6,M.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=M.maxPasswordLength),void 0!==M.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=M.containsLowercaseCharacter),void 0!==M.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=M.containsUppercaseCharacter),void 0!==M.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=M.containsNumericCharacter),void 0!==M.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=M.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(y=null===(g=c.allowedNonAlphanumericCharacters)||void 0===g?void 0:g.join(""))&&void 0!==y?y:"",this.forceUpgradeOnSignin=null!==(w=c.forceUpgradeOnSignin)&&void 0!==w&&w,this.schemaVersion=c.schemaVersion}validatePassword(c){var h,g,y,w,M,j;const re={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,re),this.validatePasswordCharacterOptions(c,re),re.isValid&&(re.isValid=null===(h=re.meetsMinPasswordLength)||void 0===h||h),re.isValid&&(re.isValid=null===(g=re.meetsMaxPasswordLength)||void 0===g||g),re.isValid&&(re.isValid=null===(y=re.containsLowercaseLetter)||void 0===y||y),re.isValid&&(re.isValid=null===(w=re.containsUppercaseLetter)||void 0===w||w),re.isValid&&(re.isValid=null===(M=re.containsNumericCharacter)||void 0===M||M),re.isValid&&(re.isValid=null===(j=re.containsNonAlphanumericCharacter)||void 0===j||j),re}validatePasswordLengthOptions(c,h){const g=this.customStrengthOptions.minPasswordLength,y=this.customStrengthOptions.maxPasswordLength;g&&(h.meetsMinPasswordLength=c.length>=g),y&&(h.meetsMaxPasswordLength=c.length<=y)}validatePasswordCharacterOptions(c,h){let g;this.updatePasswordCharacterOptionsStatuses(h,!1,!1,!1,!1);for(let y=0;y<c.length;y++)g=c.charAt(y),this.updatePasswordCharacterOptionsStatuses(h,g>="a"&&g<="z",g>="A"&&g<="Z",g>="0"&&g<="9",this.allowedNonAlphanumericCharacters.includes(g))}updatePasswordCharacterOptionsStatuses(c,h,g,y,w){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=h)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=g)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=y)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=w))}}class AM{constructor(c,h,g,y){this.app=c,this.heartbeatServiceProvider=h,this.appCheckServiceProvider=g,this.config=y,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new QT(this),this.idTokenSubscription=new QT(this),this.beforeStateQueue=new yl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ct,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=y.sdkClientVersion}_initializeWithPersistence(c,h){var g=this;return h&&(this._popupRedirectResolver=K(h)),this._initializationPromise=this.queue((0,A.Z)(function*(){var y,w;if(!g._deleted&&(g.persistenceManager=yield It.create(g,c),!g._deleted)){if(null!==(y=g._popupRedirectResolver)&&void 0!==y&&y._shouldInitProactively)try{yield g._popupRedirectResolver._initialize(g)}catch{}yield g.initializeCurrentUser(h),g.lastNotifiedUid=(null===(w=g.currentUser)||void 0===w?void 0:w.uid)||null,!g._deleted&&(g._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,A.Z)(function*(){if(c._deleted)return;const h=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||h){if(c.currentUser&&h&&c.currentUser.uid===h.uid)return c._currentUser._assign(h),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(h,!0)}})()}initializeCurrentUser(c){var h=this;return(0,A.Z)(function*(){var g;const y=yield h.assertedPersistence.getCurrentUser();let w=y,M=!1;if(c&&h.config.authDomain){yield h.getOrInitRedirectPersistenceManager();const j=null===(g=h.redirectUser)||void 0===g?void 0:g._redirectEventId,re=w?._redirectEventId,Ee=yield h.tryRedirectSignIn(c);(!j||j===re)&&Ee?.user&&(w=Ee.user,M=!0)}if(!w)return h.directlySetCurrentUser(null);if(!w._redirectEventId){if(M)try{yield h.beforeStateQueue.runMiddleware(w)}catch(j){w=y,h._popupRedirectResolver._overrideRedirectResult(h,()=>Promise.reject(j))}return w?h.reloadAndSetCurrentUserOrClear(w):h.directlySetCurrentUser(null)}return se(h._popupRedirectResolver,h,"argument-error"),yield h.getOrInitRedirectPersistenceManager(),h.redirectUser&&h.redirectUser._redirectEventId===w._redirectEventId?h.directlySetCurrentUser(w):h.reloadAndSetCurrentUserOrClear(w)})()}tryRedirectSignIn(c){var h=this;return(0,A.Z)(function*(){let g=null;try{g=yield h._popupRedirectResolver._completeRedirectFn(h,c,!0)}catch{yield h._setRedirectUser(null)}return g})()}reloadAndSetCurrentUserOrClear(c){var h=this;return(0,A.Z)(function*(){try{yield Xn(c)}catch(g){if("auth/network-request-failed"!==g?.code)return h.directlySetCurrentUser(null)}return h.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function Ze(){if(typeof navigator>"u")return null;const p=navigator;return p.languages&&p.languages[0]||p.language||null}()}_delete(){var c=this;return(0,A.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var h=this;return(0,A.Z)(function*(){const g=c?(0,Z.m9)(c):null;return g&&se(g.auth.config.apiKey===h.config.apiKey,h,"invalid-user-token"),h._updateCurrentUser(g&&g._clone(h))})()}_updateCurrentUser(c,h=!1){var g=this;return(0,A.Z)(function*(){if(!g._deleted)return c&&se(g.tenantId===c.tenantId,g,"tenant-id-mismatch"),h||(yield g.beforeStateQueue.runMiddleware(c)),g.queue((0,A.Z)(function*(){yield g.directlySetCurrentUser(c),g.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,A.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var h=this;return this.queue((0,A.Z)(function*(){yield h.assertedPersistence.setPersistence(K(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var h=this;return(0,A.Z)(function*(){h._getPasswordPolicyInternal()||(yield h._updatePasswordPolicy());const g=h._getPasswordPolicyInternal();return g.schemaVersion!==h.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(h._errorFactory.create("unsupported-password-policy-schema-version",{})):g.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,A.Z)(function*(){const h=yield function DM(p){return Gf.apply(this,arguments)}(c),g=new mi(h);null===c.tenantId?c._projectPasswordPolicy=g:c._tenantPasswordPolicies[c.tenantId]=g})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new Z.LL("auth","Firebase",c())}onAuthStateChanged(c,h,g){return this.registerStateListener(this.authStateSubscription,c,h,g)}beforeAuthStateChanged(c,h){return this.beforeStateQueue.pushCallback(c,h)}onIdTokenChanged(c,h,g){return this.registerStateListener(this.idTokenSubscription,c,h,g)}authStateReady(){return new Promise((c,h)=>{if(this.currentUser)c();else{const g=this.onAuthStateChanged(()=>{g(),c()},h)}})}revokeAccessToken(c){var h=this;return(0,A.Z)(function*(){if(h.currentUser){const g=yield h.currentUser.getIdToken(),y={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:g};null!=h.tenantId&&(y.tenantId=h.tenantId),yield function N(p,c){return S.apply(this,arguments)}(h,y)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,h){var g=this;return(0,A.Z)(function*(){const y=yield g.getOrInitRedirectPersistenceManager(h);return null===c?y.removeCurrentUser():y.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var h=this;return(0,A.Z)(function*(){if(!h.redirectPersistenceManager){const g=c&&K(c)||h._popupRedirectResolver;se(g,h,"argument-error"),h.redirectPersistenceManager=yield It.create(h,[K(g._redirectPersistence)],"redirectUser"),h.redirectUser=yield h.redirectPersistenceManager.getCurrentUser()}return h.redirectPersistenceManager})()}_redirectUserForId(c){var h=this;return(0,A.Z)(function*(){var g,y;return h._isInitialized&&(yield h.queue((0,A.Z)(function*(){}))),(null===(g=h._currentUser)||void 0===g?void 0:g._redirectEventId)===c?h._currentUser:(null===(y=h.redirectUser)||void 0===y?void 0:y._redirectEventId)===c?h.redirectUser:null})()}_persistUserIfCurrent(c){var h=this;return(0,A.Z)(function*(){if(c===h.currentUser)return h.queue((0,A.Z)(function*(){return h.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,h;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const g=null!==(h=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==h?h:null;this.lastNotifiedUid!==g&&(this.lastNotifiedUid=g,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,h,g,y){if(this._deleted)return()=>{};const w="function"==typeof h?h:h.next.bind(h);let M=!1;const j=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(j,this,"internal-error"),j.then(()=>{M||w(this.currentUser)}),"function"==typeof h){const re=c.addObserver(h,g,y);return()=>{M=!0,re()}}{const re=c.addObserver(h);return()=>{M=!0,re()}}}directlySetCurrentUser(c){var h=this;return(0,A.Z)(function*(){h.currentUser&&h.currentUser!==c&&h._currentUser._stopProactiveRefresh(),c&&h.isProactiveRefreshEnabled&&c._startProactiveRefresh(),h.currentUser=c,c?yield h.assertedPersistence.setCurrentUser(c):yield h.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=st(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,A.Z)(function*(){var h;const g={"X-Client-Version":c.clientVersion};c.app.options.appId&&(g["X-Firebase-gmpid"]=c.app.options.appId);const y=yield null===(h=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getHeartbeatsHeader();y&&(g["X-Firebase-Client"]=y);const w=yield c._getAppCheckToken();return w&&(g["X-Firebase-AppCheck"]=w),g})()}_getAppCheckToken(){var c=this;return(0,A.Z)(function*(){var h;const g=yield null===(h=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getToken();return g?.error&&function ir(p,...c){He.logLevel<=Ae.in.WARN&&He.warn(`Auth (${F.SDK_VERSION}): ${p}`,...c)}(`Error while retrieving App Check token: ${g.error}`),g?.token})()}}function pn(p){return(0,Z.m9)(p)}class QT{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,Z.ne)(h=>this.observer=h)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function cy(p){return new Promise((c,h)=>{const g=document.createElement("script");g.setAttribute("src",p),g.onload=c,g.onerror=y=>{const w=kt("internal-error");w.customData=y,h(w)},g.type="text/javascript",g.charset="UTF-8",function aa(){var p,c;return null!==(c=null===(p=document.getElementsByTagName("head"))||void 0===p?void 0:p[0])&&void 0!==c?c:document}().appendChild(g)})}function YT(p){return`__${p}${Math.floor(1e6*Math.random())}`}class JT{constructor(c){this.type="recaptcha-enterprise",this.auth=pn(c)}verify(c="verify",h=!1){var g=this;return(0,A.Z)(function*(){function w(){return w=(0,A.Z)(function*(j){if(!h){if(null==j.tenantId&&null!=j._agentRecaptchaConfig)return j._agentRecaptchaConfig.siteKey;if(null!=j.tenantId&&void 0!==j._tenantRecaptchaConfigs[j.tenantId])return j._tenantRecaptchaConfigs[j.tenantId].siteKey}return new Promise(function(){var re=(0,A.Z)(function*(Ee,xe){Ds(j,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ht=>{if(void 0!==ht.recaptchaKey){const Ur=new sr(ht);return null==j.tenantId?j._agentRecaptchaConfig=Ur:j._tenantRecaptchaConfigs[j.tenantId]=Ur,Ee(Ur.siteKey)}xe(new Error("recaptcha Enterprise site key undefined"))}).catch(ht=>{xe(ht)})});return function(Ee,xe){return re.apply(this,arguments)}}())}),w.apply(this,arguments)}function M(j,re,Ee){const xe=window.grecaptcha;Yn(xe)?xe.enterprise.ready(()=>{xe.enterprise.execute(j,{action:c}).then(ht=>{re(ht)}).catch(()=>{re("NO_RECAPTCHA")})}):Ee(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((j,re)=>{(function y(j){return w.apply(this,arguments)})(g.auth).then(Ee=>{if(!h&&Yn(window.grecaptcha))M(Ee,j,re);else{if(typeof window>"u")return void re(new Error("RecaptchaVerifier is only supported in browser"));cy("https://www.google.com/recaptcha/enterprise.js?render="+Ee).then(()=>{M(Ee,j,re)}).catch(xe=>{re(xe)})}}).catch(Ee=>{re(Ee)})})})()}}function dy(p,c,h){return hy.apply(this,arguments)}function hy(){return(hy=(0,A.Z)(function*(p,c,h,g=!1){const y=new JT(p);let w;try{w=yield y.verify(h)}catch{w=yield y.verify(h,!0)}const M=Object.assign({},c);return Object.assign(M,g?{captchaResp:w}:{captchaResponse:w}),Object.assign(M,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(M,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),M})).apply(this,arguments)}function wr(p,c,h,g){return Le.apply(this,arguments)}function Le(){return Le=(0,A.Z)(function*(p,c,h,g){var y;if(null!==(y=p._getRecaptchaConfig())&&void 0!==y&&y.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const w=yield dy(p,c,h,"getOobCode"===h);return g(p,w)}return g(p,c).catch(function(){var w=(0,A.Z)(function*(M){if("auth/missing-recaptcha-token"===M.code){console.log(`${h} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const j=yield dy(p,c,h,"getOobCode"===h);return g(p,j)}return Promise.reject(M)});return function(M){return w.apply(this,arguments)}}())}),Le.apply(this,arguments)}function eC(p,c,h){const g=pn(p);se(g._canInitEmulator,g,"emulator-config-failed"),se(/^https?:\/\//.test(c),g,"invalid-emulator-scheme");const y=!!h?.disableWarnings,w=Dn(c),{host:M,port:j}=function Wc(p){const c=Dn(p),h=/(\/\/)?([^?#/]+)/.exec(p.substr(c.length));if(!h)return{host:"",port:null};const g=h[2].split("@").pop()||"",y=/^(\[[^\]]+\])(:|$)/.exec(g);if(y){const w=y[1];return{host:w,port:py(g.substr(w.length+1))}}{const[w,M]=g.split(":");return{host:w,port:py(M)}}}(c);g.config.emulator={url:`${w}//${M}${null===j?"":`:${j}`}/`},g.settings.appVerificationDisabledForTesting=!0,g.emulatorConfig=Object.freeze({host:M,port:j,protocol:w.replace(":",""),options:Object.freeze({disableWarnings:y})}),y||function gy(){function p(){const c=document.createElement("p"),h=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",h.position="fixed",h.width="100%",h.backgroundColor="#ffffff",h.border=".1em solid #000000",h.color="#b50000",h.bottom="0px",h.left="0px",h.margin="0px",h.zIndex="10000",h.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p())}()}function Dn(p){const c=p.indexOf(":");return c<0?"":p.substr(0,c+1)}function py(p){if(!p)return null;const c=Number(p);return isNaN(c)?null:c}class eu{constructor(c,h){this.providerId=c,this.signInMethod=h}toJSON(){return pt("not implemented")}_getIdTokenResponse(c){return pt("not implemented")}_linkToIdToken(c,h){return pt("not implemented")}_getReauthenticationResolver(c){return pt("not implemented")}}function vl(p,c){return tu.apply(this,arguments)}function tu(){return(tu=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:resetPassword",B(p,c))})).apply(this,arguments)}function Kc(){return(Kc=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function tC(p,c){return rt.apply(this,arguments)}function rt(){return(rt=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function Zc(){return(Zc=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:update",B(p,c))})).apply(this,arguments)}function Yr(p,c){return Qc.apply(this,arguments)}function Qc(){return(Qc=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPassword",B(p,c))})).apply(this,arguments)}function Qf(p,c){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:sendOobCode",B(p,c))})).apply(this,arguments)}function my(){return(my=(0,A.Z)(function*(p,c){return Qf(p,c)})).apply(this,arguments)}function le(p,c){return El.apply(this,arguments)}function El(){return(El=(0,A.Z)(function*(p,c){return Qf(p,c)})).apply(this,arguments)}function Yf(p,c){return Yc.apply(this,arguments)}function Yc(){return(Yc=(0,A.Z)(function*(p,c){return Qf(p,c)})).apply(this,arguments)}function Jf(){return(Jf=(0,A.Z)(function*(p,c){return Qf(p,c)})).apply(this,arguments)}function _y(){return(_y=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}function yy(){return(yy=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}class Xc extends eu{constructor(c,h,g,y=null){super("password",g),this._email=c,this._password=h,this._tenantId=y}static _fromEmailAndPassword(c,h){return new Xc(c,h,"password")}static _fromEmailAndCode(c,h,g=null){return new Xc(c,h,"emailLink",g)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c;if(h?.email&&h?.password){if("password"===h.signInMethod)return this._fromEmailAndPassword(h.email,h.password);if("emailLink"===h.signInMethod)return this._fromEmailAndCode(h.email,h.password,h.tenantId)}return null}_getIdTokenResponse(c){var h=this;return(0,A.Z)(function*(){switch(h.signInMethod){case"password":return wr(c,{returnSecureToken:!0,email:h._email,password:h._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Yr);case"emailLink":return function ep(p,c){return _y.apply(this,arguments)}(c,{email:h._email,oobCode:h._password});default:ot(c,"internal-error")}})()}_linkToIdToken(c,h){var g=this;return(0,A.Z)(function*(){switch(g.signInMethod){case"password":return wr(c,{idToken:h,returnSecureToken:!0,email:g._email,password:g._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tC);case"emailLink":return function xM(p,c){return yy.apply(this,arguments)}(c,{idToken:h,email:g._email,oobCode:g._password});default:ot(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function Io(p,c){return ua.apply(this,arguments)}function ua(){return(ua=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithIdp",B(p,c))})).apply(this,arguments)}class _i extends eu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const h=new _i(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(h.idToken=c.idToken),c.accessToken&&(h.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(h.nonce=c.nonce),c.pendingToken&&(h.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(h.accessToken=c.oauthToken,h.secret=c.oauthTokenSecret):ot("argument-error"),h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y}=h,w=(0,yt._T)(h,["providerId","signInMethod"]);if(!g||!y)return null;const M=new _i(g,y);return M.idToken=w.idToken||void 0,M.accessToken=w.accessToken||void 0,M.secret=w.secret,M.nonce=w.nonce,M.pendingToken=w.pendingToken||null,M}_getIdTokenResponse(c){return Io(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,Io(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,Io(c,h)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const h={};this.idToken&&(h.id_token=this.idToken),this.accessToken&&(h.access_token=this.accessToken),this.secret&&(h.oauth_token_secret=this.secret),h.providerId=this.providerId,this.nonce&&!this.pendingToken&&(h.nonce=this.nonce),c.postBody=(0,Z.xO)(h)}return c}}function np(){return(np=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:sendVerificationCode",B(p,c))})).apply(this,arguments)}function Jc(){return(Jc=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c))})).apply(this,arguments)}function rp(){return(rp=(0,A.Z)(function*(p,c){const h=yield de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c));if(h.temporaryProof)throw tn(p,"account-exists-with-different-credential",h);return h})).apply(this,arguments)}const wo={USER_NOT_FOUND:"user-not-found"};function W(){return(W=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,Object.assign(Object.assign({},c),{operation:"REAUTH"})),wo)})).apply(this,arguments)}class To extends eu{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,h){return new To({verificationId:c,verificationCode:h})}static _fromTokenResponse(c,h){return new To({phoneNumber:c,temporaryProof:h})}_getIdTokenResponse(c){return function rC(p,c){return Jc.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,h){return function nu(p,c){return rp.apply(this,arguments)}(c,Object.assign({idToken:h},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function iC(p,c){return W.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:h,verificationId:g,verificationCode:y}=this.params;return c&&h?{temporaryProof:c,phoneNumber:h}:{sessionInfo:g,code:y}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}=c;return g||h||y||w?new To({verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}):null}}class la{constructor(c){var h,g,y,w,M,j;const re=(0,Z.zd)((0,Z.pd)(c)),Ee=null!==(h=re.apiKey)&&void 0!==h?h:null,xe=null!==(g=re.oobCode)&&void 0!==g?g:null,ht=function pe(p){switch(p){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(y=re.mode)&&void 0!==y?y:null);se(Ee&&xe&&ht,"argument-error"),this.apiKey=Ee,this.operation=ht,this.code=xe,this.continueUrl=null!==(w=re.continueUrl)&&void 0!==w?w:null,this.languageCode=null!==(M=re.languageCode)&&void 0!==M?M:null,this.tenantId=null!==(j=re.tenantId)&&void 0!==j?j:null}static parseLink(c){const h=function ed(p){const c=(0,Z.zd)((0,Z.pd)(p)).link,h=c?(0,Z.zd)((0,Z.pd)(c)).deep_link_id:null,g=(0,Z.zd)((0,Z.pd)(p)).deep_link_id;return(g?(0,Z.zd)((0,Z.pd)(g)).link:null)||g||h||c||p}(c);try{return new la(h)}catch{return null}}}let ip=(()=>{class p{constructor(){this.providerId=p.PROVIDER_ID}static credential(h,g){return Xc._fromEmailAndPassword(h,g)}static credentialWithLink(h,g){const y=la.parseLink(g);return se(y,"argument-error"),Xc._fromEmailAndCode(h,y.code,y.tenantId)}}return p.PROVIDER_ID="password",p.EMAIL_PASSWORD_SIGN_IN_METHOD="password",p.EMAIL_LINK_SIGN_IN_METHOD="emailLink",p})();class Ys{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class ru extends Ys{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class yi extends ru{static credentialFromJSON(c){const h="string"==typeof c?JSON.parse(c):c;return se("providerId"in h&&"signInMethod"in h,"argument-error"),_i._fromParams(h)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return se(c.idToken||c.accessToken,"argument-error"),_i._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return yi.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return yi.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:h,oauthAccessToken:g,oauthTokenSecret:y,pendingToken:w,nonce:M,providerId:j}=c;if(!g&&!y&&!h&&!w||!j)return null;try{return new yi(j)._credential({idToken:h,accessToken:g,nonce:M,pendingToken:w})}catch{return null}}}let nd=(()=>{class p extends ru{constructor(){super("facebook.com")}static credential(h){return _i._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.FACEBOOK_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.FACEBOOK_SIGN_IN_METHOD="facebook.com",p.PROVIDER_ID="facebook.com",p})(),Fi=(()=>{class p extends ru{constructor(){super("google.com"),this.addScope("profile")}static credential(h,g){return _i._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GOOGLE_SIGN_IN_METHOD,idToken:h,accessToken:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:g,oauthAccessToken:y}=h;if(!g&&!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.GOOGLE_SIGN_IN_METHOD="google.com",p.PROVIDER_ID="google.com",p})(),Ps=(()=>{class p extends ru{constructor(){super("github.com")}static credential(h){return _i._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GITHUB_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.GITHUB_SIGN_IN_METHOD="github.com",p.PROVIDER_ID="github.com",p})();class Xs extends eu{constructor(c,h){super(c,c),this.pendingToken=h}_getIdTokenResponse(c){return Io(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,Io(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,Io(c,h)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y,pendingToken:w}=h;return g&&y&&w&&g===y?new Xs(g,w):null}static _create(c,h){return new Xs(c,h)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class iu extends Ys{constructor(c){se(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return iu.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return iu.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const h=Xs.fromJSON(c);return se(h,"argument-error"),h}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:h,providerId:g}=c;if(!h||!g)return null;try{return Xs._create(g,h)}catch{return null}}}let vy=(()=>{class p extends ru{constructor(){super("twitter.com")}static credential(h,g){return _i._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.TWITTER_SIGN_IN_METHOD,oauthToken:h,oauthTokenSecret:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthAccessToken:g,oauthTokenSecret:y}=h;if(!g||!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.TWITTER_SIGN_IN_METHOD="twitter.com",p.PROVIDER_ID="twitter.com",p})();function Ns(p,c){return ca.apply(this,arguments)}function ca(){return(ca=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signUp",B(p,c))})).apply(this,arguments)}class vi{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,h,g,y=!1){return(0,A.Z)(function*(){const w=yield E._fromIdTokenResponse(c,g,y),M=op(g);return new vi({user:w,providerId:M,_tokenResponse:g,operationType:h})})()}static _forOperation(c,h,g){return(0,A.Z)(function*(){yield c._updateTokensIfNecessary(g,!0);const y=op(g);return new vi({user:c,providerId:y,_tokenResponse:g,operationType:h})})()}}function op(p){return p.providerId?p.providerId:"phoneNumber"in p?"phone":null}function ap(p){return rd.apply(this,arguments)}function rd(){return(rd=(0,A.Z)(function*(p){var c;const h=pn(p);if(yield h._initializationPromise,null!==(c=h.currentUser)&&void 0!==c&&c.isAnonymous)return new vi({user:h.currentUser,providerId:null,operationType:"signIn"});const g=yield Ns(h,{returnSecureToken:!0}),y=yield vi._fromIdTokenResponse(h,"signIn",g,!0);return yield h._updateCurrentUser(y.user),y})).apply(this,arguments)}class Il extends Z.ZR{constructor(c,h,g,y){var w;super(h.code,h.message),this.operationType=g,this.user=y,Object.setPrototypeOf(this,Il.prototype),this.customData={appName:c.name,tenantId:null!==(w=c.tenantId)&&void 0!==w?w:void 0,_serverResponse:h.customData._serverResponse,operationType:g}}static _fromErrorAndOperation(c,h,g,y){return new Il(c,h,g,y)}}function su(p,c,h,g){return("reauthenticate"===c?h._getReauthenticationResolver(p):h._getIdTokenResponse(p)).catch(w=>{throw"auth/multi-factor-auth-required"===w.code?Il._fromErrorAndOperation(p,w,c,g):w})}function up(p){return new Set(p.map(({providerId:c})=>c).filter(c=>!!c))}function Ey(p,c){return lp.apply(this,arguments)}function lp(){return lp=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p);yield sd(!0,h,c);const{providerUserInfo:g}=yield function es(p,c){return ts.apply(this,arguments)}(h.auth,{idToken:yield h.getIdToken(),deleteProvider:[c]}),y=up(g||[]);return h.providerData=h.providerData.filter(w=>y.has(w.providerId)),y.has("phone")||(h.phoneNumber=null),yield h.auth._persistUserIfCurrent(h),h}),lp.apply(this,arguments)}function id(p,c){return cp.apply(this,arguments)}function cp(){return(cp=(0,A.Z)(function*(p,c,h=!1){const g=yield nn(p,c._linkToIdToken(p.auth,yield p.getIdToken()),h);return vi._forOperation(p,"link",g)})).apply(this,arguments)}function sd(p,c,h){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,A.Z)(function*(p,c,h){yield Xn(c);const y=!1===p?"provider-already-linked":"no-such-provider";se(up(c.providerData).has(h)===p,c.auth,y)})).apply(this,arguments)}function Iy(p,c){return od.apply(this,arguments)}function od(){return(od=(0,A.Z)(function*(p,c,h=!1){const{auth:g}=p,y="reauthenticate";try{const w=yield nn(p,su(g,y,c,p),h);se(w.idToken,g,"internal-error");const M=Cn(w.idToken);se(M,g,"internal-error");const{sub:j}=M;return se(p.uid===j,g,"user-mismatch"),vi._forOperation(p,y,w)}catch(w){throw"auth/user-not-found"===w?.code&&ot(g,"user-mismatch"),w}})).apply(this,arguments)}function wy(p,c){return dp.apply(this,arguments)}function dp(){return(dp=(0,A.Z)(function*(p,c,h=!1){const g="signIn",y=yield su(p,g,c),w=yield vi._fromIdTokenResponse(p,g,y);return h||(yield p._updateCurrentUser(w.user)),w})).apply(this,arguments)}function ad(p,c){return hp.apply(this,arguments)}function hp(){return(hp=(0,A.Z)(function*(p,c){return wy(pn(p),c)})).apply(this,arguments)}function fp(p,c){return pp.apply(this,arguments)}function pp(){return(pp=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p);return yield sd(!1,h,c.providerId),id(h,c)})).apply(this,arguments)}function Ty(p,c){return gp.apply(this,arguments)}function gp(){return(gp=(0,A.Z)(function*(p,c){return Iy((0,Z.m9)(p),c)})).apply(this,arguments)}function mp(){return(mp=(0,A.Z)(function*(p,c){return de(p,"POST","/v1/accounts:signInWithCustomToken",B(p,c))})).apply(this,arguments)}function sC(p,c){return _p.apply(this,arguments)}function _p(){return _p=(0,A.Z)(function*(p,c){const h=pn(p),g=yield function Co(p,c){return mp.apply(this,arguments)}(h,{token:c,returnSecureToken:!0}),y=yield vi._fromIdTokenResponse(h,"signIn",g);return yield h._updateCurrentUser(y.user),y}),_p.apply(this,arguments)}class rn{constructor(c,h){this.factorId=c,this.uid=h.mfaEnrollmentId,this.enrollmentTime=new Date(h.enrolledAt).toUTCString(),this.displayName=h.displayName}static _fromServerResponse(c,h){return"phoneInfo"in h?yp._fromServerResponse(c,h):"totpInfo"in h?ud._fromServerResponse(c,h):ot(c,"internal-error")}}class yp extends rn{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,h){return new yp(h)}}class ud extends rn{constructor(c){super("totp",c)}static _fromServerResponse(c,h){return new ud(h)}}function Ve(p,c,h){var g;se((null===(g=h.url)||void 0===g?void 0:g.length)>0,p,"invalid-continue-uri"),se(typeof h.dynamicLinkDomain>"u"||h.dynamicLinkDomain.length>0,p,"invalid-dynamic-link-domain"),c.continueUrl=h.url,c.dynamicLinkDomain=h.dynamicLinkDomain,c.canHandleCodeInApp=h.handleCodeInApp,h.iOS&&(se(h.iOS.bundleId.length>0,p,"missing-ios-bundle-id"),c.iOSBundleId=h.iOS.bundleId),h.android&&(se(h.android.packageName.length>0,p,"missing-android-pkg-name"),c.androidInstallApp=h.android.installApp,c.androidMinimumVersionCode=h.android.minimumVersion,c.androidPackageName=h.android.packageName)}function Tr(p){return dt.apply(this,arguments)}function dt(){return(dt=(0,A.Z)(function*(p){const c=pn(p);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function hr(p,c,h){return fr.apply(this,arguments)}function fr(){return(fr=(0,A.Z)(function*(p,c,h){const g=pn(p),y={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};h&&Ve(g,y,h),yield wr(g,y,"getOobCode",le)})).apply(this,arguments)}function ou(p,c,h){return Fr.apply(this,arguments)}function Fr(){return Fr=(0,A.Z)(function*(p,c,h){yield vl((0,Z.m9)(p),{oobCode:c,newPassword:h}).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&Tr(p),y});return function(y){return g.apply(this,arguments)}}())}),Fr.apply(this,arguments)}function Cy(p,c){return ld.apply(this,arguments)}function ld(){return ld=(0,A.Z)(function*(p,c){yield function Zf(p,c){return Zc.apply(this,arguments)}((0,Z.m9)(p),{oobCode:c})}),ld.apply(this,arguments)}function wl(p,c){return vp.apply(this,arguments)}function vp(){return(vp=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p),g=yield vl(h,{oobCode:c}),y=g.requestType;switch(se(y,h,"internal-error"),y){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":se(g.newEmail,h,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":se(g.mfaInfo,h,"internal-error");default:se(g.email,h,"internal-error")}let w=null;return g.mfaInfo&&(w=rn._fromServerResponse(pn(h),g.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.newEmail:g.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.email:g.newEmail)||null,multiFactorInfo:w},operation:y}})).apply(this,arguments)}function oC(p,c){return sn.apply(this,arguments)}function sn(){return(sn=(0,A.Z)(function*(p,c){const{data:h}=yield wl((0,Z.m9)(p),c);return h.email})).apply(this,arguments)}function me(p,c,h){return qe.apply(this,arguments)}function qe(){return(qe=(0,A.Z)(function*(p,c,h){const g=pn(p),M=yield wr(g,{returnSecureToken:!0,email:c,password:h,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ns).catch(re=>{throw"auth/password-does-not-meet-requirements"===re.code&&Tr(p),re}),j=yield vi._fromIdTokenResponse(g,"signIn",M);return yield g._updateCurrentUser(j.user),j})).apply(this,arguments)}function on(p,c,h){return ad((0,Z.m9)(p),ip.credential(c,h)).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&Tr(p),y});return function(y){return g.apply(this,arguments)}}())}function is(p,c,h){return da.apply(this,arguments)}function da(){return(da=(0,A.Z)(function*(p,c,h){const g=pn(p),y={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function w(M,j){se(j.handleCodeInApp,g,"argument-error"),j&&Ve(g,M,j)})(y,h),yield wr(g,y,"getOobCode",Yf)})).apply(this,arguments)}function Cr(p,c){const h=la.parseLink(c);return"EMAIL_SIGNIN"===h?.operation}function au(p,c,h){return gn.apply(this,arguments)}function gn(){return(gn=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),y=ip.credentialWithLink(c,h||wn());return se(y._tenantId===(g.tenantId||null),g,"tenant-id-mismatch"),ad(g,y)})).apply(this,arguments)}function Do(){return(Do=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:createAuthUri",B(p,c))})).apply(this,arguments)}function ze(p,c){return ha.apply(this,arguments)}function ha(){return ha=(0,A.Z)(function*(p,c){const g={identifier:c,continueUri:Tn()?wn():"http://localhost"},{signinMethods:y}=yield function bo(p,c){return Do.apply(this,arguments)}((0,Z.m9)(p),g);return y||[]}),ha.apply(this,arguments)}function by(p,c){return Ao.apply(this,arguments)}function Ao(){return Ao=(0,A.Z)(function*(p,c){const h=(0,Z.m9)(p),y={requestType:"VERIFY_EMAIL",idToken:yield p.getIdToken()};c&&Ve(h.auth,y,c);const{email:w}=yield function MM(p,c){return my.apply(this,arguments)}(h.auth,y);w!==p.email&&(yield p.reload())}),Ao.apply(this,arguments)}function kn(p,c,h){return fa.apply(this,arguments)}function fa(){return fa=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),w={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield p.getIdToken(),newEmail:c};h&&Ve(g.auth,w,h);const{email:M}=yield function Xf(p,c){return Jf.apply(this,arguments)}(g.auth,w);M!==p.email&&(yield p.reload())}),fa.apply(this,arguments)}function Li(){return(Li=(0,A.Z)(function*(p,c){return ee(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Tl(p,c){return cd.apply(this,arguments)}function cd(){return cd=(0,A.Z)(function*(p,{displayName:c,photoURL:h}){if(void 0===c&&void 0===h)return;const g=(0,Z.m9)(p),w={idToken:yield g.getIdToken(),displayName:c,photoUrl:h,returnSecureToken:!0},M=yield nn(g,function uu(p,c){return Li.apply(this,arguments)}(g.auth,w));g.displayName=M.displayName||null,g.photoURL=M.photoUrl||null;const j=g.providerData.find(({providerId:re})=>"password"===re);j&&(j.displayName=g.displayName,j.photoURL=g.photoURL),yield g._updateTokensIfNecessary(M)}),cd.apply(this,arguments)}function So(p,c){return lu((0,Z.m9)(p),c,null)}function Js(p,c){return lu((0,Z.m9)(p),null,c)}function lu(p,c,h){return pa.apply(this,arguments)}function pa(){return pa=(0,A.Z)(function*(p,c,h){const{auth:g}=p,w={idToken:yield p.getIdToken(),returnSecureToken:!0};c&&(w.email=c),h&&(w.password=h);const M=yield nn(p,function Kf(p,c){return Kc.apply(this,arguments)}(g,w));yield p._updateTokensIfNecessary(M,!0)}),pa.apply(this,arguments)}class Cl{constructor(c,h,g={}){this.isNewUser=c,this.providerId=h,this.profile=g}}class dd extends Cl{constructor(c,h,g,y){super(c,h,g),this.username=y}}class Dy extends Cl{constructor(c,h){super(c,"facebook.com",h)}}class Ms extends dd{constructor(c,h){super(c,"github.com",h,"string"==typeof h?.login?h?.login:null)}}class hd extends Cl{constructor(c,h){super(c,"google.com",h)}}class cu extends dd{constructor(c,h,g){super(c,"twitter.com",h,g)}}function bl(p){const{user:c,_tokenResponse:h}=p;return c.isAnonymous&&!h?{providerId:null,isNewUser:!1,profile:null}:function at(p){var c,h;if(!p)return null;const{providerId:g}=p,y=p.rawUserInfo?JSON.parse(p.rawUserInfo):{},w=p.isNewUser||"identitytoolkit#SignupNewUserResponse"===p.kind;if(!g&&p?.idToken){const M=null===(h=null===(c=Cn(p.idToken))||void 0===c?void 0:c.firebase)||void 0===h?void 0:h.sign_in_provider;if(M)return new Cl(w,"anonymous"!==M&&"custom"!==M?M:null)}if(!g)return null;switch(g){case"facebook.com":return new Dy(w,y);case"github.com":return new Ms(w,y);case"google.com":return new hd(w,y);case"twitter.com":return new cu(w,y,p.screenName||null);case"custom":case"anonymous":return new Cl(w,null);default:return new Cl(w,g,y)}}(h)}class ma{constructor(c,h,g){this.type=c,this.credential=h,this.user=g}static _fromIdtoken(c,h){return new ma("enroll",c,h)}static _fromMfaPendingCredential(c){return new ma("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var h,g;if(c?.multiFactorSession){if(null!==(h=c.multiFactorSession)&&void 0!==h&&h.pendingCredential)return ma._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(g=c.multiFactorSession)&&void 0!==g&&g.idToken)return ma._fromIdtoken(c.multiFactorSession.idToken)}return null}}class Sy{constructor(c,h,g){this.session=c,this.hints=h,this.signInResolver=g}static _fromError(c,h){const g=pn(c),y=h.customData._serverResponse,w=(y.mfaInfo||[]).map(j=>rn._fromServerResponse(g,j));se(y.mfaPendingCredential,g,"internal-error");const M=ma._fromMfaPendingCredential(y.mfaPendingCredential);return new Sy(M,w,function(){var j=(0,A.Z)(function*(re){const Ee=yield re._process(g,M);delete y.mfaInfo,delete y.mfaPendingCredential;const xe=Object.assign(Object.assign({},y),{idToken:Ee.idToken,refreshToken:Ee.refreshToken});switch(h.operationType){case"signIn":const ht=yield vi._fromIdTokenResponse(g,h.operationType,xe);return yield g._updateCurrentUser(ht.user),ht;case"reauthenticate":return se(h.user,g,"internal-error"),vi._forOperation(h.user,h.operationType,xe);default:ot(g,"internal-error")}});return function(re){return j.apply(this,arguments)}}())}resolveSignIn(c){var h=this;return(0,A.Z)(function*(){return h.signInResolver(c)})()}}function FM(p,c){var h;const g=(0,Z.m9)(p),y=c;return se(c.customData.operationType,g,"argument-error"),se(null===(h=y.customData._serverResponse)||void 0===h?void 0:h.mfaPendingCredential,g,"argument-error"),Sy._fromError(g,y)}class Ry{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(h=>{h.mfaInfo&&(this.enrolledFactors=h.mfaInfo.map(g=>rn._fromServerResponse(c.auth,g)))})}static _fromUser(c){return new Ry(c)}getSession(){var c=this;return(0,A.Z)(function*(){return ma._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,h){var g=this;return(0,A.Z)(function*(){const y=c,w=yield g.getSession(),M=yield nn(g.user,y._process(g.user.auth,w,h));return yield g.user._updateTokensIfNecessary(M),g.user.reload()})()}unenroll(c){var h=this;return(0,A.Z)(function*(){const g="string"==typeof c?c:c.uid,y=yield h.user.getIdToken();try{const w=yield nn(h.user,function BM(p,c){return ee(p,"POST","/v2/accounts/mfaEnrollment:withdraw",B(p,c))}(h.user.auth,{idToken:y,mfaEnrollmentId:g}));h.enrolledFactors=h.enrolledFactors.filter(({uid:M})=>M!==g),yield h.user._updateTokensIfNecessary(w),yield h.user.reload()}catch(w){throw w}})()}}const Py=new WeakMap;function jM(p){const c=(0,Z.m9)(p);return Py.has(c)||Py.set(c,Ry._fromUser(c)),Py.get(c)}const Tp="__sak";class aC{constructor(c,h){this.storageRetriever=c,this.type=h}_isAvailable(){try{return this.storage?(this.storage.setItem(Tp,"1"),this.storage.removeItem(Tp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,h){return this.storage.setItem(c,JSON.stringify(h)),Promise.resolve()}_get(c){const h=this.storage.getItem(c);return Promise.resolve(h?JSON.parse(h):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const uC=(()=>{class p extends aC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(h,g)=>this.onStorageEvent(h,g),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Ny(){const p=(0,Z.z$)();return Re(p)||De(p)}()&&function Ce(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=xn(),this._shouldAllowMigration=!0}forAllChangedKeys(h){for(const g of Object.keys(this.listeners)){const y=this.storage.getItem(g),w=this.localCache[g];y!==w&&h(g,w,y)}}onStorageEvent(h,g=!1){if(!h.key)return void this.forAllChangedKeys((j,re,Ee)=>{this.notifyListeners(j,Ee)});const y=h.key;if(g?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const j=this.storage.getItem(y);if(h.newValue!==j)null!==h.newValue?this.storage.setItem(y,h.newValue):this.storage.removeItem(y);else if(this.localCache[y]===h.newValue&&!g)return}const w=()=>{const j=this.storage.getItem(y);!g&&this.localCache[y]===j||this.notifyListeners(y,j)},M=this.storage.getItem(y);!function L(){return(0,Z.w1)()&&10===document.documentMode}()||M===h.newValue||h.newValue===h.oldValue?w():setTimeout(w,10)}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g&&JSON.parse(g))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((h,g,y)=>{this.onStorageEvent(new StorageEvent("storage",{key:h,oldValue:g,newValue:y}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(h,g){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[h]||(this.listeners[h]=new Set,this.localCache[h]=this.storage.getItem(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(h,g){var y=()=>super._set,w=this;return(0,A.Z)(function*(){yield y().call(w,h,g),w.localCache[h]=JSON.stringify(g)})()}_get(h){var g=()=>super._get,y=this;return(0,A.Z)(function*(){const w=yield g().call(y,h);return y.localCache[h]=JSON.stringify(w),w})()}_remove(h){var g=()=>super._remove,y=this;return(0,A.Z)(function*(){yield g().call(y,h),delete y.localCache[h]})()}}return p.type="LOCAL",p})(),ks=(()=>{class p extends aC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(h,g){}_removeListener(h,g){}}return p.type="SESSION",p})();let qM=(()=>{class p{constructor(h){this.eventTarget=h,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(h){const g=this.receivers.find(w=>w.isListeningto(h));if(g)return g;const y=new p(h);return this.receivers.push(y),y}isListeningto(h){return this.eventTarget===h}handleEvent(h){var g=this;return(0,A.Z)(function*(){const y=h,{eventId:w,eventType:M,data:j}=y.data,re=g.handlersMap[M];if(!re?.size)return;y.ports[0].postMessage({status:"ack",eventId:w,eventType:M});const Ee=Array.from(re).map(function(){var ht=(0,A.Z)(function*(Ur){return Ur(y.origin,j)});return function(Ur){return ht.apply(this,arguments)}}()),xe=yield function HM(p){return Promise.all(p.map(function(){var c=(0,A.Z)(function*(h){try{return{fulfilled:!0,value:yield h}}catch(g){return{fulfilled:!1,reason:g}}});return function(h){return c.apply(this,arguments)}}()))}(Ee);y.ports[0].postMessage({status:"done",eventId:w,eventType:M,response:xe})})()}_subscribe(h,g){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[h]||(this.handlersMap[h]=new Set),this.handlersMap[h].add(g)}_unsubscribe(h,g){this.handlersMap[h]&&g&&this.handlersMap[h].delete(g),(!g||0===this.handlersMap[h].size)&&delete this.handlersMap[h],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return p.receivers=[],p})();function On(p="",c=10){let h="";for(let g=0;g<c;g++)h+=Math.floor(10*Math.random());return p+h}class fd{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,h,g=50){var y=this;return(0,A.Z)(function*(){const w=typeof MessageChannel<"u"?new MessageChannel:null;if(!w)throw new Error("connection_unavailable");let M,j;return new Promise((re,Ee)=>{const xe=On("",20);w.port1.start();const ht=setTimeout(()=>{Ee(new Error("unsupported_event"))},g);j={messageChannel:w,onMessage(Ur){const no=Ur;if(no.data.eventId===xe)switch(no.data.status){case"ack":clearTimeout(ht),M=setTimeout(()=>{Ee(new Error("timeout"))},3e3);break;case"done":clearTimeout(M),re(no.data.response);break;default:clearTimeout(ht),clearTimeout(M),Ee(new Error("invalid_response"))}}},y.handlers.add(j),w.port1.addEventListener("message",j.onMessage),y.target.postMessage({eventType:c,eventId:xe,data:h},[w.port2])}).finally(()=>{j&&y.removeMessageHandler(j)})})()}}function Nt(){return window}function pd(){return typeof Nt().WorkerGlobalScope<"u"&&"function"==typeof Nt().importScripts}function gd(){return(gd=(0,A.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const md="firebaseLocalStorageDb",Dl="firebaseLocalStorage",Dp="fbase_key";class hu{constructor(c){this.request=c}toPromise(){return new Promise((c,h)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{h(this.request.error)})})}}function _a(p,c){return p.transaction([Dl],c?"readwrite":"readonly").objectStore(Dl)}function Ro(){const p=indexedDB.open(md,1);return new Promise((c,h)=>{p.addEventListener("error",()=>{h(p.error)}),p.addEventListener("upgradeneeded",()=>{const g=p.result;try{g.createObjectStore(Dl,{keyPath:Dp})}catch(y){h(y)}}),p.addEventListener("success",(0,A.Z)(function*(){const g=p.result;g.objectStoreNames.contains(Dl)?c(g):(g.close(),yield function Al(){const p=indexedDB.deleteDatabase(md);return new hu(p).toPromise()}(),c(yield Ro()))}))})}function Ap(p,c,h){return Fy.apply(this,arguments)}function Fy(){return(Fy=(0,A.Z)(function*(p,c,h){const g=_a(p,!0).put({[Dp]:c,value:h});return new hu(g).toPromise()})).apply(this,arguments)}function Ly(){return(Ly=(0,A.Z)(function*(p,c){const h=_a(p,!1).get(c),g=yield new hu(h).toPromise();return void 0===g?null:g.value})).apply(this,arguments)}function Vy(p,c){const h=_a(p,!0).delete(c);return new hu(h).toPromise()}const _d=(()=>{class p{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var h=this;return(0,A.Z)(function*(){return h.db||(h.db=yield Ro()),h.db})()}_withRetries(h){var g=this;return(0,A.Z)(function*(){let y=0;for(;;)try{const w=yield g._openDb();return yield h(w)}catch(w){if(y++>3)throw w;g.db&&(g.db.close(),g.db=void 0)}})()}initializeServiceWorkerMessaging(){var h=this;return(0,A.Z)(function*(){return pd()?h.initializeReceiver():h.initializeSender()})()}initializeReceiver(){var h=this;return(0,A.Z)(function*(){h.receiver=qM._getInstance(function Oy(){return pd()?self:null}()),h.receiver._subscribe("keyChanged",function(){var g=(0,A.Z)(function*(y,w){return{keyProcessed:(yield h._poll()).includes(w.key)}});return function(y,w){return g.apply(this,arguments)}}()),h.receiver._subscribe("ping",function(){var g=(0,A.Z)(function*(y,w){return["keyChanged"]});return function(y,w){return g.apply(this,arguments)}}())})()}initializeSender(){var h=this;return(0,A.Z)(function*(){var g,y;if(h.activeServiceWorker=yield function ky(){return gd.apply(this,arguments)}(),!h.activeServiceWorker)return;h.sender=new fd(h.activeServiceWorker);const w=yield h.sender._send("ping",{},800);w&&null!==(g=w[0])&&void 0!==g&&g.fulfilled&&null!==(y=w[0])&&void 0!==y&&y.value.includes("keyChanged")&&(h.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(h){var g=this;return(0,A.Z)(function*(){if(g.sender&&g.activeServiceWorker&&function Cp(){var p;return(null===(p=navigator?.serviceWorker)||void 0===p?void 0:p.controller)||null}()===g.activeServiceWorker)try{yield g.sender._send("keyChanged",{key:h},g.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,A.Z)(function*(){try{if(!indexedDB)return!1;const h=yield Ro();return yield Ap(h,Tp,"1"),yield Vy(h,Tp),!0}catch{}return!1})()}_withPendingWrite(h){var g=this;return(0,A.Z)(function*(){g.pendingWrites++;try{yield h()}finally{g.pendingWrites--}})()}_set(h,g){var y=this;return(0,A.Z)(function*(){return y._withPendingWrite((0,A.Z)(function*(){return yield y._withRetries(w=>Ap(w,h,g)),y.localCache[h]=g,y.notifyServiceWorker(h)}))})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=yield g._withRetries(w=>function zM(p,c){return Ly.apply(this,arguments)}(w,h));return g.localCache[h]=y,y})()}_remove(h){var g=this;return(0,A.Z)(function*(){return g._withPendingWrite((0,A.Z)(function*(){return yield g._withRetries(y=>Vy(y,h)),delete g.localCache[h],g.notifyServiceWorker(h)}))})()}_poll(){var h=this;return(0,A.Z)(function*(){const g=yield h._withRetries(M=>{const j=_a(M,!1).getAll();return new hu(j).toPromise()});if(!g)return[];if(0!==h.pendingWrites)return[];const y=[],w=new Set;for(const{fbase_key:M,value:j}of g)w.add(M),JSON.stringify(h.localCache[M])!==JSON.stringify(j)&&(h.notifyListeners(M,j),y.push(M));for(const M of Object.keys(h.localCache))h.localCache[M]&&!w.has(M)&&(h.notifyListeners(M,null),y.push(M));return y})()}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g)}startPolling(){var h=this;this.stopPolling(),this.pollTimer=setInterval((0,A.Z)(function*(){return h._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(h,g){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[h]||(this.listeners[h]=new Set,this._get(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return p.type="LOCAL",p})(),Sl=1e12;class Uy{constructor(c){this.auth=c,this.counter=Sl,this._widgets=new Map}render(c,h){const g=this.counter;return this._widgets.set(g,new fC(c,this.auth.name,h||{})),this.counter++,g}reset(c){var h;const g=c||Sl;null===(h=this._widgets.get(g))||void 0===h||h.delete(),this._widgets.delete(g)}getResponse(c){var h;return(null===(h=this._widgets.get(c||Sl))||void 0===h?void 0:h.getResponse())||""}execute(c){var h=this;return(0,A.Z)(function*(){var g;return null===(g=h._widgets.get(c||Sl))||void 0===g||g.execute(),""})()}}class fC{constructor(c,h,g){this.params=g,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const y="string"==typeof c?document.getElementById(c):c;se(y,"argument-error",{appName:h}),this.container=y,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function pC(p){const c=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let g=0;g<p;g++)c.push(h.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":h}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,h)try{h()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Rp=YT("rcb"),By=new Kr(3e4,6e4);class jy{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=Nt().grecaptcha)||void 0===c||!c.render)}load(c,h=""){return se(function mC(p){return p.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(p)}(h),c,"argument-error"),this.shouldResolveImmediately(h)&&jn(Nt().grecaptcha)?Promise.resolve(Nt().grecaptcha):new Promise((g,y)=>{const w=Nt().setTimeout(()=>{y(kt(c,"network-request-failed"))},By.get());Nt()[Rp]=()=>{Nt().clearTimeout(w),delete Nt()[Rp];const j=Nt().grecaptcha;if(!j||!jn(j))return void y(kt(c,"internal-error"));const re=j.render;j.render=(Ee,xe)=>{const ht=re(Ee,xe);return this.counter++,ht},this.hostLanguage=h,g(j)},cy(`https://www.google.com/recaptcha/api.js??${(0,Z.xO)({onload:Rp,render:"explicit",hl:h})}`).catch(()=>{clearTimeout(w),y(kt(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var h;return!(null===(h=Nt().grecaptcha)||void 0===h||!h.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ZM{load(c){return(0,A.Z)(function*(){return new Uy(c)})()}clearedOneInstance(){}}const $y="recaptcha",Vi={theme:"light",type:"image"};class Hy{constructor(c,h,g=Object.assign({},Vi)){this.parameters=g,this.type=$y,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=pn(c),this.isInvisible="invisible"===this.parameters.size,se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const y="string"==typeof h?document.getElementById(h):h;se(y,this.auth,"argument-error"),this.container=y,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ZM:new jy,this.validateStartingState()}verify(){var c=this;return(0,A.Z)(function*(){c.assertNotDestroyed();const h=yield c.render(),g=c.getAssertedRecaptcha();return g.getResponse(h)||new Promise(w=>{const M=j=>{j&&(c.tokenChangeListeners.delete(M),w(j))};c.tokenChangeListeners.add(M),c.isInvisible&&g.execute(h)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){se(!this.parameters.sitekey,this.auth,"argument-error"),se(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return h=>{if(this.tokenChangeListeners.forEach(g=>g(h)),"function"==typeof c)c(h);else if("string"==typeof c){const g=Nt()[c];"function"==typeof g&&g(h)}}}assertNotDestroyed(){se(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,A.Z)(function*(){if(yield c.init(),!c.widgetId){let h=c.container;if(!c.isInvisible){const g=document.createElement("div");h.appendChild(g),h=g}c.widgetId=c.getAssertedRecaptcha().render(h,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,A.Z)(function*(){se(Tn()&&!pd(),c.auth,"internal-error"),yield function _C(){let p=null;return new Promise(c=>{"complete"!==document.readyState?(p=()=>c(),window.addEventListener("load",p)):c()}).catch(c=>{throw p&&window.removeEventListener("load",p),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const h=yield function Zr(p){return ki.apply(this,arguments)}(c.auth);se(h,c.auth,"internal-error"),c.parameters.sitekey=h})()}getAssertedRecaptcha(){return se(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Pp{constructor(c,h){this.verificationId=c,this.onConfirmation=h}confirm(c){const h=To._fromVerification(this.verificationId,c);return this.onConfirmation(h)}}function qy(p,c,h){return yd.apply(this,arguments)}function yd(){return(yd=(0,A.Z)(function*(p,c,h){const g=pn(p),y=yield Pl(g,c,(0,Z.m9)(h));return new Pp(y,w=>ad(g,w))})).apply(this,arguments)}function yC(p,c,h){return Rl.apply(this,arguments)}function Rl(){return(Rl=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);yield sd(!1,g,"phone");const y=yield Pl(g.auth,c,(0,Z.m9)(h));return new Pp(y,w=>fp(g,w))})).apply(this,arguments)}function vC(p,c,h){return Ui.apply(this,arguments)}function Ui(){return(Ui=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p),y=yield Pl(g.auth,c,(0,Z.m9)(h));return new Pp(y,w=>Ty(g,w))})).apply(this,arguments)}function Pl(p,c,h){return vd.apply(this,arguments)}function vd(){return vd=(0,A.Z)(function*(p,c,h){var g;const y=yield h.verify();try{let w;if(se("string"==typeof y,p,"argument-error"),se(h.type===$y,p,"argument-error"),w="string"==typeof c?{phoneNumber:c}:c,"session"in w){const M=w.session;if("phoneNumber"in w)return se("enroll"===M.type,p,"internal-error"),(yield function LM(p,c){return ee(p,"POST","/v2/accounts/mfaEnrollment:start",B(p,c))}(p,{idToken:M.credential,phoneEnrollmentInfo:{phoneNumber:w.phoneNumber,recaptchaToken:y}})).phoneSessionInfo.sessionInfo;{se("signin"===M.type,p,"internal-error");const j=(null===(g=w.multiFactorHint)||void 0===g?void 0:g.uid)||w.multiFactorUid;return se(j,p,"missing-multi-factor-info"),(yield function dC(p,c){return ee(p,"POST","/v2/accounts/mfaSignIn:start",B(p,c))}(p,{mfaPendingCredential:M.credential,mfaEnrollmentId:j,phoneSignInInfo:{recaptchaToken:y}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:M}=yield function nC(p,c){return np.apply(this,arguments)}(p,{phoneNumber:w.phoneNumber,recaptchaToken:y});return M}}finally{h._reset()}}),vd.apply(this,arguments)}function Kt(p,c){return Nl.apply(this,arguments)}function Nl(){return(Nl=(0,A.Z)(function*(p,c){yield id((0,Z.m9)(p),c)})).apply(this,arguments)}let Ed=(()=>{class p{constructor(h){this.providerId=p.PROVIDER_ID,this.auth=pn(h)}verifyPhoneNumber(h,g){return Pl(this.auth,h,(0,Z.m9)(g))}static credential(h,g){return To._fromVerification(h,g)}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{phoneNumber:g,temporaryProof:y}=h;return g&&y?To._fromTokenResponse(g,y):null}}return p.PROVIDER_ID="phone",p.PHONE_SIGN_IN_METHOD="phone",p})();function Hn(p,c){return c?K(c):(se(p._popupRedirectResolver,p,"argument-error"),p._popupRedirectResolver)}class Np extends eu{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return Io(c,this._buildIdpRequest())}_linkToIdToken(c,h){return Io(c,this._buildIdpRequest(h))}_getReauthenticationResolver(c){return Io(c,this._buildIdpRequest())}_buildIdpRequest(c){const h={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(h.idToken=c),h}}function zy(p){return wy(p.auth,new Np(p),p.bypassAuthState)}function fu(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),Iy(h,new Np(p),p.bypassAuthState)}function wi(p){return Mp.apply(this,arguments)}function Mp(){return(Mp=(0,A.Z)(function*(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),id(h,new Np(p),p.bypassAuthState)})).apply(this,arguments)}class Gy{constructor(c,h,g,y,w=!1){this.auth=c,this.resolver=g,this.user=y,this.bypassAuthState=w,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(h)?h:[h]}execute(){var c=this;return new Promise(function(){var h=(0,A.Z)(function*(g,y){c.pendingPromise={resolve:g,reject:y};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(w){c.reject(w)}});return function(g,y){return h.apply(this,arguments)}}())}onAuthEvent(c){var h=this;return(0,A.Z)(function*(){const{urlResponse:g,sessionId:y,postBody:w,tenantId:M,error:j,type:re}=c;if(j)return void h.reject(j);const Ee={auth:h.auth,requestUri:g,sessionId:y,tenantId:M||void 0,postBody:w||void 0,user:h.user,bypassAuthState:h.bypassAuthState};try{h.resolve(yield h.getIdpTask(re)(Ee))}catch(xe){h.reject(xe)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return zy;case"linkViaPopup":case"linkViaRedirect":return wi;case"reauthViaPopup":case"reauthViaRedirect":return fu;default:ot(this.auth,"internal-error")}}resolve(c){Qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){Qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const EC=new Kr(2e3,1e4);function Po(p,c,h){return Id.apply(this,arguments)}function Id(){return(Id=(0,A.Z)(function*(p,c,h){const g=pn(p);Bn(p,c,Ys);const y=Hn(g,h);return new xp(g,"signInViaPopup",c,y).executeNotNull()})).apply(this,arguments)}function IC(p,c,h){return wd.apply(this,arguments)}function wd(){return(wd=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Bn(g.auth,c,Ys);const y=Hn(g.auth,h);return new xp(g.auth,"reauthViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}function Wy(p,c,h){return Td.apply(this,arguments)}function Td(){return(Td=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Bn(g.auth,c,Ys);const y=Hn(g.auth,h);return new xp(g.auth,"linkViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}let xp=(()=>{class p extends Gy{constructor(h,g,y,w,M){super(h,g,w,M),this.provider=y,this.authWindow=null,this.pollId=null,p.currentPopupAction&&p.currentPopupAction.cancel(),p.currentPopupAction=this}executeNotNull(){var h=this;return(0,A.Z)(function*(){const g=yield h.execute();return se(g,h.auth,"internal-error"),g})()}onExecution(){var h=this;return(0,A.Z)(function*(){Qt(1===h.filter.length,"Popup operations only handle one event");const g=On();h.authWindow=yield h.resolver._openPopup(h.auth,h.provider,h.filter[0],g),h.authWindow.associatedEvent=g,h.resolver._originValidation(h.auth).catch(y=>{h.reject(y)}),h.resolver._isIframeWebStorageSupported(h.auth,y=>{y||h.reject(kt(h.auth,"web-storage-unsupported"))}),h.pollUserCancellation()})()}get eventId(){var h;return(null===(h=this.authWindow)||void 0===h?void 0:h.associatedEvent)||null}cancel(){this.reject(kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,p.currentPopupAction=null}pollUserCancellation(){const h=()=>{var g,y;this.pollId=null!==(y=null===(g=this.authWindow)||void 0===g?void 0:g.window)&&void 0!==y&&y.closed?window.setTimeout(()=>{this.pollId=null,this.reject(kt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(h,EC.get())};h()}}return p.currentPopupAction=null,p})();const Be="pendingRedirect",pu=new Map;class QM extends Gy{constructor(c,h,g=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],h,void 0,g),this.eventId=null}execute(){var c=()=>super.execute,h=this;return(0,A.Z)(function*(){let g=pu.get(h.auth._key());if(!g){try{const w=(yield function wC(p,c){return kp.apply(this,arguments)}(h.resolver,h.auth))?yield c().call(h):null;g=()=>Promise.resolve(w)}catch(y){g=()=>Promise.reject(y)}pu.set(h.auth._key(),g)}return h.bypassAuthState||pu.set(h.auth._key(),()=>Promise.resolve(null)),g()})()}onAuthEvent(c){var h=()=>super.onAuthEvent,g=this;return(0,A.Z)(function*(){if("signInViaRedirect"===c.type)return h().call(g,c);if("unknown"!==c.type){if(c.eventId){const y=yield g.auth._redirectUserForId(c.eventId);if(y)return g.user=y,h().call(g,c);g.resolve(null)}}else g.resolve(null)})()}onExecution(){return(0,A.Z)(function*(){})()}cleanUp(){}}function kp(){return(kp=(0,A.Z)(function*(p,c){const h=Qy(c),g=Zy(p);if(!(yield g._isAvailable()))return!1;const y="true"===(yield g._get(h));return yield g._remove(h),y})).apply(this,arguments)}function Op(p,c){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,A.Z)(function*(p,c){return Zy(p)._set(Qy(c),"true")})).apply(this,arguments)}function gu(){pu.clear()}function Ky(p,c){pu.set(p._key(),c)}function Zy(p){return K(p._redirectPersistence)}function Qy(p){return Fe(Be,p.config.apiKey,p.name)}function TC(p,c,h){return function CC(p,c,h){return te.apply(this,arguments)}(p,c,h)}function te(){return(te=(0,A.Z)(function*(p,c,h){const g=pn(p);Bn(p,c,Ys),yield g._initializationPromise;const y=Hn(g,h);return yield Op(y,g),y._openRedirect(g,c,"signInViaRedirect")})).apply(this,arguments)}function wt(p,c,h){return function Fp(p,c,h){return Ml.apply(this,arguments)}(p,c,h)}function Ml(){return(Ml=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Bn(g.auth,c,Ys),yield g.auth._initializationPromise;const y=Hn(g.auth,h);yield Op(y,g.auth);const w=yield bC(g);return y._openRedirect(g.auth,c,"reauthViaRedirect",w)})).apply(this,arguments)}function gr(p,c,h){return function Yy(p,c,h){return ya.apply(this,arguments)}(p,c,h)}function ya(){return(ya=(0,A.Z)(function*(p,c,h){const g=(0,Z.m9)(p);Bn(g.auth,c,Ys),yield g.auth._initializationPromise;const y=Hn(g.auth,h);yield sd(!1,g,c.providerId),yield Op(y,g.auth);const w=yield bC(g);return y._openRedirect(g.auth,c,"linkViaRedirect",w)})).apply(this,arguments)}function Os(p,c){return xl.apply(this,arguments)}function xl(){return(xl=(0,A.Z)(function*(p,c){return yield pn(p)._initializationPromise,kl(p,c,!1)})).apply(this,arguments)}function kl(p,c){return Lp.apply(this,arguments)}function Lp(){return(Lp=(0,A.Z)(function*(p,c,h=!1){const g=pn(p),y=Hn(g,c),M=yield new QM(g,y,h).execute();return M&&!h&&(delete M.user._redirectEventId,yield g._persistUserIfCurrent(M.user),yield g._setRedirectUser(null,c)),M})).apply(this,arguments)}function bC(p){return bd.apply(this,arguments)}function bd(){return(bd=(0,A.Z)(function*(p){const c=On(`${p.uid}:::`);return p._redirectEventId=c,yield p.auth._setRedirectUser(p),yield p.auth._persistUserIfCurrent(p),c})).apply(this,arguments)}class Fs{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let h=!1;return this.consumers.forEach(g=>{this.isEventForConsumer(c,g)&&(h=!0,this.sendToConsumer(c,g),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function eo(p){switch(p.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return va(p);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,h||(this.queuedRedirectEvent=c,h=!0)),h}sendToConsumer(c,h){var g;if(c.error&&!va(c)){const y=(null===(g=c.error.code)||void 0===g?void 0:g.split("auth/")[1])||"internal-error";h.onError(kt(this.auth,y))}else h.onAuthEvent(c)}isEventForConsumer(c,h){const g=null===h.eventId||!!c.eventId&&c.eventId===h.eventId;return h.filter.includes(c.type)&&g}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vp(c))}saveEventToCache(c){this.cachedEventUids.add(Vp(c)),this.lastProcessedEventTime=Date.now()}}function Vp(p){return[p.type,p.eventId,p.sessionId,p.tenantId].filter(c=>c).join("-")}function va({type:p,error:c}){return"unknown"===p&&"auth/no-auth-event"===c?.code}function Xy(p){return Dd.apply(this,arguments)}function Dd(){return(Dd=(0,A.Z)(function*(p,c={}){return ee(p,"GET","/v1/projects",c)})).apply(this,arguments)}const DC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AC=/^https?/;function Ol(){return(Ol=(0,A.Z)(function*(p){if(p.config.emulator)return;const{authorizedDomains:c}=yield Xy(p);for(const h of c)try{if(Jy(h))return}catch{}ot(p,"unauthorized-domain")})).apply(this,arguments)}function Jy(p){const c=wn(),{protocol:h,hostname:g}=new URL(c);if(p.startsWith("chrome-extension://")){const M=new URL(p);return""===M.hostname&&""===g?"chrome-extension:"===h&&p.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===h&&M.hostname===g}if(!AC.test(h))return!1;if(DC.test(p))return g===p;const y=p.replace(/\./g,"\\.");return new RegExp("^(.+\\."+y+"|"+y+")$","i").test(g)}const Bp=new Kr(3e4,6e4);function ev(){const p=Nt().___jsl;if(p?.H)for(const c of Object.keys(p.H))if(p.H[c].r=p.H[c].r||[],p.H[c].L=p.H[c].L||[],p.H[c].r=[...p.H[c].L],p.CP)for(let h=0;h<p.CP.length;h++)p.CP[h]=null}let mu=null;const rv=new Kr(5e3,15e3),iv="__/auth/iframe",sv="emulator/auth/iframe",jp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RC(p){const c=p.config;se(c.authDomain,p,"auth-domain-config-required");const h=c.emulator?bs(c,sv):`https://${p.config.authDomain}/${iv}`,g={apiKey:c.apiKey,appName:p.name,v:F.SDK_VERSION},y=SC.get(p.config.apiHost);y&&(g.eid=y);const w=p._getFrameworks();return w.length&&(g.fw=w.join(",")),`${h}?${(0,Z.xO)(g).slice(1)}`}function to(){return to=(0,A.Z)(function*(p){const c=yield function nv(p){return mu=mu||function tv(p){return new Promise((c,h)=>{var g,y,w;function M(){ev(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{ev(),h(kt(p,"network-request-failed"))},timeout:Bp.get()})}if(null!==(y=null===(g=Nt().gapi)||void 0===g?void 0:g.iframes)&&void 0!==y&&y.Iframe)c(gapi.iframes.getContext());else{if(null===(w=Nt().gapi)||void 0===w||!w.load){const j=YT("iframefcb");return Nt()[j]=()=>{gapi.load?M():h(kt(p,"network-request-failed"))},cy(`https://apis.google.com/js/api.js?onload=${j}`).catch(re=>h(re))}M()}}).catch(c=>{throw mu=null,c})}(p),mu}(p),h=Nt().gapi;return se(h,p,"internal-error"),c.open({where:document.body,url:RC(p),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jp,dontclear:!0},g=>new Promise(function(){var y=(0,A.Z)(function*(w,M){yield g.restyle({setHideOnLeave:!1});const j=kt(p,"network-request-failed"),re=Nt().setTimeout(()=>{M(j)},rv.get());function Ee(){Nt().clearTimeout(re),w(g)}g.ping(Ee).then(Ee,()=>{M(j)})});return function(w,M){return y.apply(this,arguments)}}()))}),to.apply(this,arguments)}const mn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class $p{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const No="__/auth/handler",kC="emulator/auth/handler",Sd=encodeURIComponent("fac");function _u(p,c,h,g,y,w){return yu.apply(this,arguments)}function yu(){return(yu=(0,A.Z)(function*(p,c,h,g,y,w){se(p.config.authDomain,p,"auth-domain-config-required"),se(p.config.apiKey,p,"invalid-api-key");const M={apiKey:p.config.apiKey,appName:p.name,authType:h,redirectUrl:g,v:F.SDK_VERSION,eventId:y};if(c instanceof Ys){c.setDefaultLanguage(p.languageCode),M.providerId=c.providerId||"",(0,Z.xb)(c.getCustomParameters())||(M.customParameters=JSON.stringify(c.getCustomParameters()));for(const[xe,ht]of Object.entries(w||{}))M[xe]=ht}if(c instanceof ru){const xe=c.getScopes().filter(ht=>""!==ht);xe.length>0&&(M.scopes=xe.join(","))}p.tenantId&&(M.tid=p.tenantId);const j=M;for(const xe of Object.keys(j))void 0===j[xe]&&delete j[xe];const re=yield p._getAppCheckToken(),Ee=re?`#${Sd}=${encodeURIComponent(re)}`:"";return`${function Hp({config:p}){return p.emulator?bs(p,kC):`https://${p.authDomain}/${No}`}(p)}?${(0,Z.xO)(j).slice(1)}${Ee}`})).apply(this,arguments)}const Rd="webStorageSupport",uv=class av{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ks,this._completeRedirectFn=kl,this._overrideRedirectResult=Ky}_openPopup(c,h,g,y){var w=this;return(0,A.Z)(function*(){var M;Qt(null===(M=w.eventManagers[c._key()])||void 0===M?void 0:M.manager,"_initialize() not called before _openPopup()");const j=yield _u(c,h,g,wn(),y);return function ov(p,c,h,g=500,y=600){const w=Math.max((window.screen.availHeight-y)/2,0).toString(),M=Math.max((window.screen.availWidth-g)/2,0).toString();let j="";const re=Object.assign(Object.assign({},mn),{width:g.toString(),height:y.toString(),top:w,left:M}),Ee=(0,Z.z$)().toLowerCase();h&&(j=or(Ee)?"_blank":h),Vt(Ee)&&(c=c||"http://localhost",re.scrollbars="yes");const xe=Object.entries(re).reduce((Ur,[no,Ul])=>`${Ur}${no}=${Ul},`,"");if(function nt(p=(0,Z.z$)()){var c;return De(p)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(Ee)&&"_self"!==j)return function Ad(p,c){const h=document.createElement("a");h.href=p,h.target=c;const g=document.createEvent("MouseEvent");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(g)}(c||"",j),new $p(null);const ht=window.open(c||"",j,xe);se(ht,p,"popup-blocked");try{ht.focus()}catch{}return new $p(ht)}(c,j,On())})()}_openRedirect(c,h,g,y){var w=this;return(0,A.Z)(function*(){return yield w._originValidation(c),function xy(p){Nt().location.href=p}(yield _u(c,h,g,wn(),y)),new Promise(()=>{})})()}_initialize(c){const h=c._key();if(this.eventManagers[h]){const{manager:y,promise:w}=this.eventManagers[h];return y?Promise.resolve(y):(Qt(w,"If manager is not set, promise should be"),w)}const g=this.initAndGetManager(c);return this.eventManagers[h]={promise:g},g.catch(()=>{delete this.eventManagers[h]}),g}initAndGetManager(c){var h=this;return(0,A.Z)(function*(){const g=yield function Vr(p){return to.apply(this,arguments)}(c),y=new Fs(c);return g.register("authEvent",w=>(se(w?.authEvent,c,"invalid-auth-event"),{status:y.onEvent(w.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),h.eventManagers[c._key()]={manager:y},h.iframes[c._key()]=g,y})()}_isIframeWebStorageSupported(c,h){this.iframes[c._key()].send(Rd,{type:Rd},y=>{var w;const M=null===(w=y?.[0])||void 0===w?void 0:w[Rd];void 0!==M&&h(!!M),ot(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const h=c._key();return this.originValidationPromises[h]||(this.originValidationPromises[h]=function Up(p){return Ol.apply(this,arguments)}(c)),this.originValidationPromises[h]}get _shouldInitProactively(){return xn()||Re()||De()}};class vu{constructor(c){this.factorId=c}_process(c,h,g){switch(h.type){case"enroll":return this._finalizeEnroll(c,h.credential,g);case"signin":return this._finalizeSignIn(c,h.credential);default:return pt("unexpected MultiFactorSessionType")}}}class Ea extends vu{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new Ea(c)}_finalizeEnroll(c,h,g){return function VM(p,c){return ee(p,"POST","/v2/accounts/mfaEnrollment:finalize",B(p,c))}(c,{idToken:h,displayName:g,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,h){return function Sp(p,c){return ee(p,"POST","/v2/accounts/mfaSignIn:finalize",B(p,c))}(c,{mfaPendingCredential:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let OC=(()=>{class p{constructor(){}static assertion(h){return Ea._fromCredential(h)}}return p.FACTOR_ID="phone",p})();var lv="@firebase/auth";class YM{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var h=this;return(0,A.Z)(function*(){return h.assertAuthConfigured(),yield h.auth._initializationPromise,h.auth.currentUser?{accessToken:yield h.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const h=this.auth.onIdTokenChanged(g=>{c(g?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,h),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const h=this.internalListeners.get(c);h&&(this.internalListeners.delete(c),h(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,Z.Pz)("authIdTokenMaxAge"),function Ll(p){(0,F._registerComponent)(new Jt.wA("auth",(c,{options:h})=>{const g=c.getProvider("app").getImmediate(),y=c.getProvider("heartbeat"),w=c.getProvider("app-check-internal"),{apiKey:M,authDomain:j}=g.options;se(M&&!M.includes(":"),"invalid-api-key",{appName:g.name});const re={apiKey:M,authDomain:j,clientPlatform:p,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:st(p)},Ee=new AM(g,y,w,re);return function ye(p,c){const h=c?.persistence||[],g=(Array.isArray(h)?h:[h]).map(K);c?.errorMap&&p._updateErrorMap(c.errorMap),p._initializeWithPersistence(g,c?.popupRedirectResolver)}(Ee,h),Ee},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,h,g)=>{c.getProvider("auth-internal").initialize()})),(0,F._registerComponent)(new Jt.wA("auth-internal",c=>{const h=pn(c.getProvider("auth").getImmediate());return new YM(h)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,F.registerVersion)(lv,"1.4.0",function qp(p){switch(p){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(p)),(0,F.registerVersion)(lv,"1.4.0","esm2017")}("Browser")},58:(Cs,Zn,ke)=>{ke.d(Zn,{BH:()=>di,DV:()=>sr,Dv:()=>Qr,G6:()=>bs,GJ:()=>jn,L:()=>vt,LL:()=>Y,Pz:()=>kt,Sg:()=>Bn,UG:()=>pt,UI:()=>ki,US:()=>Jt,Wj:()=>nn,Wl:()=>Ne,Yr:()=>Kr,ZB:()=>be,ZR:()=>ee,aH:()=>ot,b$:()=>Tn,cI:()=>de,dS:()=>ns,eu:()=>G,g5:()=>F,gK:()=>Cn,gQ:()=>cr,h$:()=>$t,hl:()=>$,hu:()=>Z,jU:()=>Qt,lb:()=>bn,m9:()=>Rs,ne:()=>hi,p$:()=>ae,pd:()=>ts,r3:()=>Yn,ru:()=>wn,tV:()=>X,uI:()=>se,ug:()=>Oi,vZ:()=>Ds,w1:()=>Ji,w9:()=>tn,xO:()=>Ss,xb:()=>Zr,z$:()=>Xe,zd:()=>es});const A={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Z=function(N,S){if(!N)throw F(S)},F=function(N){return new Error("Firebase Database ("+A.SDK_VERSION+") INTERNAL ASSERT FAILED: "+N)},Ae=function(N){const S=[];let I=0;for(let C=0;C<N.length;C++){let E=N.charCodeAt(C);E<128?S[I++]=E:E<2048?(S[I++]=E>>6|192,S[I++]=63&E|128):55296==(64512&E)&&C+1<N.length&&56320==(64512&N.charCodeAt(C+1))?(E=65536+((1023&E)<<10)+(1023&N.charCodeAt(++C)),S[I++]=E>>18|240,S[I++]=E>>12&63|128,S[I++]=E>>6&63|128,S[I++]=63&E|128):(S[I++]=E>>12|224,S[I++]=E>>6&63|128,S[I++]=63&E|128)}return S},Jt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(N,S){if(!Array.isArray(N))throw Error("encodeByteArray takes an array as a parameter");this.init_();const I=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,C=[];for(let E=0;E<N.length;E+=3){const R=N[E],K=E+1<N.length,Ie=K?N[E+1]:0,ve=E+2<N.length,Fe=ve?N[E+2]:0;let Vt=(15&Ie)<<2|Fe>>6,Re=63&Fe;ve||(Re=64,K||(Vt=64)),C.push(I[R>>2],I[(3&R)<<4|Ie>>4],I[Vt],I[Re])}return C.join("")},encodeString(N,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(N):this.encodeByteArray(Ae(N),S)},decodeString(N,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(N):function(N){const S=[];let I=0,C=0;for(;I<N.length;){const E=N[I++];if(E<128)S[C++]=String.fromCharCode(E);else if(E>191&&E<224){const R=N[I++];S[C++]=String.fromCharCode((31&E)<<6|63&R)}else if(E>239&&E<365){const ve=((7&E)<<18|(63&N[I++])<<12|(63&N[I++])<<6|63&N[I++])-65536;S[C++]=String.fromCharCode(55296+(ve>>10)),S[C++]=String.fromCharCode(56320+(1023&ve))}else{const R=N[I++],K=N[I++];S[C++]=String.fromCharCode((15&E)<<12|(63&R)<<6|63&K)}}return S.join("")}(this.decodeStringToByteArray(N,S))},decodeStringToByteArray(N,S){this.init_();const I=S?this.charToByteMapWebSafe_:this.charToByteMap_,C=[];for(let E=0;E<N.length;){const R=I[N.charAt(E++)],Ie=E<N.length?I[N.charAt(E)]:0;++E;const Fe=E<N.length?I[N.charAt(E)]:64;++E;const ge=E<N.length?I[N.charAt(E)]:64;if(++E,null==R||null==Ie||null==Fe||null==ge)throw new Mn;C.push(R<<2|Ie>>4),64!==Fe&&(C.push(Ie<<4&240|Fe>>2),64!==ge&&C.push(Fe<<6&192|ge))}return C},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let N=0;N<this.ENCODED_VALS.length;N++)this.byteToCharMap_[N]=this.ENCODED_VALS.charAt(N),this.charToByteMap_[this.byteToCharMap_[N]]=N,this.byteToCharMapWebSafe_[N]=this.ENCODED_VALS_WEBSAFE.charAt(N),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[N]]=N,N>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(N)]=N,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(N)]=N)}}};class Mn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $t=function(N){const S=Ae(N);return Jt.encodeByteArray(S,!0)},vt=function(N){return $t(N).replace(/\./g,"")},X=function(N){try{return Jt.decodeString(N,!0)}catch(S){console.error("base64Decode failed: ",S)}return null};function ae(N){return be(void 0,N)}function be(N,S){if(!(S instanceof Object))return S;switch(S.constructor){case Date:return new Date(S.getTime());case Object:void 0===N&&(N={});break;case Array:N=[];break;default:return S}for(const I in S)!S.hasOwnProperty(I)||!We(I)||(N[I]=be(N[I],S[I]));return N}function We(N){return"__proto__"!==N}const He=()=>{try{return function bt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const N=process.env.__FIREBASE_DEFAULTS__;return N?JSON.parse(N):void 0})()||(()=>{if(typeof document>"u")return;let N;try{N=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const S=N&&X(N[1]);return S&&JSON.parse(S)})()}catch(N){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${N}`)}},ot=()=>{var N;return null===(N=He())||void 0===N?void 0:N.config},kt=N=>{var S;return null===(S=He())||void 0===S?void 0:S[`_${N}`]};class di{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((S,I)=>{this.resolve=S,this.reject=I})}wrapCallback(S){return(I,C)=>{I?this.reject(I):this.resolve(C),"function"==typeof S&&(this.promise.catch(()=>{}),1===S.length?S(I):S(I,C))}}}function Bn(N,S){if(N.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const C=S||"demo-project",E=N.iat||0,R=N.sub||N.user_id;if(!R)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const K=Object.assign({iss:`https://securetoken.google.com/${C}`,aud:C,iat:E,exp:E+3600,auth_time:E,sub:R,user_id:R,firebase:{sign_in_provider:"custom",identities:{}}},N);return[vt(JSON.stringify({alg:"none",type:"JWT"})),vt(JSON.stringify(K)),""].join(".")}function Xe(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function se(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xe())}function pt(){var N;const S=null===(N=He())||void 0===N?void 0:N.forceEnvironment;if("node"===S)return!0;if("browser"===S)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Qt(){return"object"==typeof self&&self.self===self}function wn(){const N="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof N&&void 0!==N.id}function Tn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ji(){const N=Xe();return N.indexOf("MSIE ")>=0||N.indexOf("Trident/")>=0}function Kr(){return!0===A.NODE_CLIENT||!0===A.NODE_ADMIN}function bs(){return!pt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $(){try{return"object"==typeof indexedDB}catch{return!1}}function G(){return new Promise((N,S)=>{try{let I=!0;const C="validate-browser-context-for-indexeddb-analytics-module",E=self.indexedDB.open(C);E.onsuccess=()=>{E.result.close(),I||self.indexedDB.deleteDatabase(C),N(!0)},E.onupgradeneeded=()=>{I=!1},E.onerror=()=>{var R;S((null===(R=E.error)||void 0===R?void 0:R.message)||"")}}catch(I){S(I)}})}class ee extends Error{constructor(S,I,C){super(I),this.code=S,this.customData=C,this.name="FirebaseError",Object.setPrototypeOf(this,ee.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y.prototype.create)}}class Y{constructor(S,I,C){this.service=S,this.serviceName=I,this.errors=C}create(S,...I){const C=I[0]||{},E=`${this.service}/${S}`,R=this.errors[S],K=R?function ce(N,S){return N.replace(it,(I,C)=>{const E=S[C];return null!=E?String(E):`<${C}?>`})}(R,C):"Error";return new ee(E,`${this.serviceName}: ${K} (${E}).`,C)}}const it=/\{\$([^}]+)}/g;function de(N){return JSON.parse(N)}function Ne(N){return JSON.stringify(N)}const Et=function(N){let S={},I={},C={},E="";try{const R=N.split(".");S=de(X(R[0])||""),I=de(X(R[1])||""),E=R[2],C=I.d||{},delete I.d}catch{}return{header:S,claims:I,data:C,signature:E}},tn=function(N){const I=Et(N).claims;return!!I&&"object"==typeof I&&I.hasOwnProperty("iat")},jn=function(N){const S=Et(N).claims;return"object"==typeof S&&!0===S.admin};function Yn(N,S){return Object.prototype.hasOwnProperty.call(N,S)}function sr(N,S){if(Object.prototype.hasOwnProperty.call(N,S))return N[S]}function Zr(N){for(const S in N)if(Object.prototype.hasOwnProperty.call(N,S))return!1;return!0}function ki(N,S,I){const C={};for(const E in N)Object.prototype.hasOwnProperty.call(N,E)&&(C[E]=S.call(I,N[E],E,N));return C}function Ds(N,S){if(N===S)return!0;const I=Object.keys(N),C=Object.keys(S);for(const E of I){if(!C.includes(E))return!1;const R=N[E],K=S[E];if(gt(R)&&gt(K)){if(!Ds(R,K))return!1}else if(R!==K)return!1}for(const E of C)if(!I.includes(E))return!1;return!0}function gt(N){return null!==N&&"object"==typeof N}function Ss(N){const S=[];for(const[I,C]of Object.entries(N))Array.isArray(C)?C.forEach(E=>{S.push(encodeURIComponent(I)+"="+encodeURIComponent(E))}):S.push(encodeURIComponent(I)+"="+encodeURIComponent(C));return S.length?"&"+S.join("&"):""}function es(N){const S={};return N.replace(/^\?/,"").split("&").forEach(C=>{if(C){const[E,R]=C.split("=");S[decodeURIComponent(E)]=decodeURIComponent(R)}}),S}function ts(N){const S=N.indexOf("?");if(!S)return"";const I=N.indexOf("#",S);return N.substring(S,I>0?I:void 0)}class cr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let S=1;S<this.blockSize;++S)this.pad_[S]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(S,I){I||(I=0);const C=this.W_;if("string"==typeof S)for(let ge=0;ge<16;ge++)C[ge]=S.charCodeAt(I)<<24|S.charCodeAt(I+1)<<16|S.charCodeAt(I+2)<<8|S.charCodeAt(I+3),I+=4;else for(let ge=0;ge<16;ge++)C[ge]=S[I]<<24|S[I+1]<<16|S[I+2]<<8|S[I+3],I+=4;for(let ge=16;ge<80;ge++){const Vt=C[ge-3]^C[ge-8]^C[ge-14]^C[ge-16];C[ge]=4294967295&(Vt<<1|Vt>>>31)}let Fe,It,E=this.chain_[0],R=this.chain_[1],K=this.chain_[2],Ie=this.chain_[3],ve=this.chain_[4];for(let ge=0;ge<80;ge++){ge<40?ge<20?(Fe=Ie^R&(K^Ie),It=1518500249):(Fe=R^K^Ie,It=1859775393):ge<60?(Fe=R&K|Ie&(R|K),It=2400959708):(Fe=R^K^Ie,It=3395469782);const Vt=(E<<5|E>>>27)+Fe+ve+It+C[ge]&4294967295;ve=Ie,Ie=K,K=4294967295&(R<<30|R>>>2),R=E,E=Vt}this.chain_[0]=this.chain_[0]+E&4294967295,this.chain_[1]=this.chain_[1]+R&4294967295,this.chain_[2]=this.chain_[2]+K&4294967295,this.chain_[3]=this.chain_[3]+Ie&4294967295,this.chain_[4]=this.chain_[4]+ve&4294967295}update(S,I){if(null==S)return;void 0===I&&(I=S.length);const C=I-this.blockSize;let E=0;const R=this.buf_;let K=this.inbuf_;for(;E<I;){if(0===K)for(;E<=C;)this.compress_(S,E),E+=this.blockSize;if("string"==typeof S){for(;E<I;)if(R[K]=S.charCodeAt(E),++K,++E,K===this.blockSize){this.compress_(R),K=0;break}}else for(;E<I;)if(R[K]=S[E],++K,++E,K===this.blockSize){this.compress_(R),K=0;break}}this.inbuf_=K,this.total_+=I}digest(){const S=[];let I=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let E=this.blockSize-1;E>=56;E--)this.buf_[E]=255&I,I/=256;this.compress_(this.buf_);let C=0;for(let E=0;E<5;E++)for(let R=24;R>=0;R-=8)S[C]=this.chain_[E]>>R&255,++C;return S}}function hi(N,S){const I=new fi(N,S);return I.subscribe.bind(I)}class fi{constructor(S,I){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=I,this.task.then(()=>{S(this)}).catch(C=>{this.error(C)})}next(S){this.forEachObserver(I=>{I.next(S)})}error(S){this.forEachObserver(I=>{I.error(S)}),this.close(S)}complete(){this.forEachObserver(S=>{S.complete()}),this.close()}subscribe(S,I,C){let E;if(void 0===S&&void 0===I&&void 0===C)throw new Error("Missing Observer.");E=function dr(N,S){if("object"!=typeof N||null===N)return!1;for(const I of S)if(I in N&&"function"==typeof N[I])return!0;return!1}(S,["next","error","complete"])?S:{next:S,error:I,complete:C},void 0===E.next&&(E.next=Ot),void 0===E.error&&(E.error=Ot),void 0===E.complete&&(E.complete=Ot);const R=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?E.error(this.finalError):E.complete()}catch{}}),this.observers.push(E),R}unsubscribeOne(S){void 0===this.observers||void 0===this.observers[S]||(delete this.observers[S],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(S){if(!this.finalized)for(let I=0;I<this.observers.length;I++)this.sendOne(I,S)}sendOne(S,I){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[S])try{I(this.observers[S])}catch(C){typeof console<"u"&&console.error&&console.error(C)}})}close(S){this.finalized||(this.finalized=!0,void 0!==S&&(this.finalError=S),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ot(){}const Qr=function(N,S,I,C){let E;if(C<S?E="at least "+S:C>I&&(E=0===I?"none":"no more than "+I),E)throw new Error(N+" failed: Was called with "+C+(1===C?" argument.":" arguments.")+" Expects "+E+".")};function Cn(N,S){return`${N} failed: ${S} argument `}function nn(N,S,I,C){if((!C||I)&&"function"!=typeof I)throw new Error(Cn(N,S)+"must be a valid function.")}function bn(N,S,I,C){if((!C||I)&&("object"!=typeof I||null===I))throw new Error(Cn(N,S)+"must be a valid context object.")}const ns=function(N){const S=[];let I=0;for(let C=0;C<N.length;C++){let E=N.charCodeAt(C);if(E>=55296&&E<=56319){const R=E-55296;C++,Z(C<N.length,"Surrogate pair missing trail surrogate."),E=65536+(R<<10)+(N.charCodeAt(C)-56320)}E<128?S[I++]=E:E<2048?(S[I++]=E>>6|192,S[I++]=63&E|128):E<65536?(S[I++]=E>>12|224,S[I++]=E>>6&63|128,S[I++]=63&E|128):(S[I++]=E>>18|240,S[I++]=E>>12&63|128,S[I++]=E>>6&63|128,S[I++]=63&E|128)}return S},Oi=function(N){let S=0;for(let I=0;I<N.length;I++){const C=N.charCodeAt(I);C<128?S++:C<2048?S+=2:C>=55296&&C<=56319?(S+=4,I++):S+=3}return S};function Rs(N){return N&&N._delegate?N._delegate:N}},838:(Cs,Zn,ke)=>{function A(n){return"function"==typeof n}function Z(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const F=Z(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Ae(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class yt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(A(r))try{r()}catch(s){e=s instanceof F?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{$t(s)}catch(o){e=e??[],o instanceof F?e=[...e,...o.errors]:e.push(o)}}if(e)throw new F(e)}}add(e){var t;if(e&&e!==this)if(this.closed)$t(e);else{if(e instanceof yt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ae(t,e)}remove(e){const{_finalizers:t}=this;t&&Ae(t,e),e instanceof yt&&e._removeParent(this)}}yt.EMPTY=(()=>{const n=new yt;return n.closed=!0,n})();const Jt=yt.EMPTY;function Mn(n){return n instanceof yt||n&&"closed"in n&&A(n.remove)&&A(n.add)&&A(n.unsubscribe)}function $t(n){A(n)?n():n.unsubscribe()}const vt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},X={setTimeout(n,e,...t){const{delegate:r}=X;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=X;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ae(n){X.setTimeout(()=>{const{onUnhandledError:e}=vt;if(!e)throw n;e(n)})}function be(){}const We=ct("C",void 0,void 0);function ct(n,e,t){return{kind:n,value:e,error:t}}let $e=null;function He(n){if(vt.useDeprecatedSynchronousErrorHandling){const e=!$e;if(e&&($e={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=$e;if($e=null,t)throw r}}else n()}class In extends yt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Mn(e)&&e.add(this)):this.destination=Qt}static create(e,t,r){return new Bn(e,t,r)}next(e){this.isStopped?pt(function Qn(n){return ct("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?pt(function bt(n){return ct("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?pt(We,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ot=Function.prototype.bind;function kt(n,e){return ot.call(n,e)}class di{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Xe(r)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Xe(r)}else Xe(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xe(t)}}}class Bn extends In{constructor(e,t,r){let i;if(super(),A(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&vt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&kt(e.next,s),error:e.error&&kt(e.error,s),complete:e.complete&&kt(e.complete,s)}):i=e}this.destination=new di(i)}}function Xe(n){vt.useDeprecatedSynchronousErrorHandling?function ir(n){vt.useDeprecatedSynchronousErrorHandling&&$e&&($e.errorThrown=!0,$e.error=n)}(n):ae(n)}function pt(n,e){const{onStoppedNotification:t}=vt;t&&X.setTimeout(()=>t(n,e))}const Qt={closed:!0,next:be,error:function se(n){throw n},complete:be},wn="function"==typeof Symbol&&Symbol.observable||"@@observable";function Tn(n){return n}function Ji(n){return 0===n.length?Tn:1===n.length?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}let Ze=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){const s=function $(n){return n&&n instanceof In||function bs(n){return n&&A(n.next)&&A(n.error)&&A(n.complete)}(n)&&Mn(n)}(t)?t:new Bn(t,r,i);return He(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=Kr(r))((i,s)=>{const o=new Bn({next:a=>{try{t(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[wn](){return this}pipe(...t){return Ji(t)(this)}toPromise(t){return new(t=Kr(t))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Kr(n){var e;return null!==(e=n??vt.Promise)&&void 0!==e?e:Promise}const G=Z(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let z=(()=>{class n extends Ze{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new B(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new G}next(t){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){He(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Jt:(this.currentObservers=null,s.push(t),new yt(()=>{this.currentObservers=null,Ae(s,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){const t=new Ze;return t.source=this,t}}return n.create=(e,t)=>new B(e,t),n})();class B extends z{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:Jt}}function ee(n){return A(n?.lift)}function Y(n){return e=>{if(ee(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(n,e,t,r,i){return new it(n,e,t,r,i)}class it extends In{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function de(n,e){return Y((t,r)=>{let i=0;t.subscribe(ce(r,s=>{r.next(n.call(e,s,i++))}))})}var Ne=ke(582);const Et=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function en(n){return A(n?.then)}function Ht(n){return A(n[wn])}function tn(n){return Symbol.asyncIterator&&A(n?.[Symbol.asyncIterator])}function jn(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const sr=function Yn(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Zr(n){return A(n?.[sr])}function ki(n){return(0,Ne.FC)(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:i}=yield(0,Ne.qq)(t.read());if(i)return yield(0,Ne.qq)(void 0);yield yield(0,Ne.qq)(r)}}finally{t.releaseLock()}})}function Ds(n){return A(n?.getReader)}function gt(n){if(n instanceof Ze)return n;if(null!=n){if(Ht(n))return function As(n){return new Ze(e=>{const t=n[wn]();if(A(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Et(n))return function Ss(n){return new Ze(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(en(n))return function es(n){return new Ze(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ae)})}(n);if(tn(n))return cr(n);if(Zr(n))return function ts(n){return new Ze(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Ds(n))return function hi(n){return cr(ki(n))}(n)}throw jn(n)}function cr(n){return new Ze(e=>{(function fi(n,e){var t,r,i,s;return(0,Ne.mG)(this,void 0,void 0,function*(){try{for(t=(0,Ne.KL)(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function pi(n,e,t,r=0,i=!1){const s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Ot(n,e,t=1/0){return A(e)?Ot((r,i)=>de((s,o)=>e(r,s,i,o))(gt(n(r,i))),t):("number"==typeof e&&(t=e),Y((r,i)=>function dr(n,e,t,r,i,s,o,a){const u=[];let l=0,d=0,f=!1;const m=()=>{f&&!u.length&&!l&&e.complete()},_=T=>l<r?v(T):u.push(T),v=T=>{s&&e.next(T),l++;let D=!1;gt(t(T,d++)).subscribe(ce(e,k=>{i?.(k),s?_(k):e.next(k)},()=>{D=!0},void 0,()=>{if(D)try{for(l--;u.length&&l<r;){const k=u.shift();o?pi(e,o,()=>v(k)):v(k)}m()}catch(k){e.error(k)}}))};return n.subscribe(ce(e,_,()=>{f=!0,m()})),()=>{a?.()}}(r,i,n,t)))}function Qr(n=1/0){return Ot(Tn,n)}const Cn=new Ze(n=>n.complete());function ns(n){return n[n.length-1]}function Oi(n){return A(ns(n))?n.pop():void 0}function rs(n){return function bn(n){return n&&A(n.schedule)}(ns(n))?n.pop():void 0}function $n(n,e=0){return Y((t,r)=>{t.subscribe(ce(r,i=>pi(r,n,()=>r.next(i),e),()=>pi(r,n,()=>r.complete(),e),i=>pi(r,n,()=>r.error(i),e)))})}function Or(n,e=0){return Y((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Rs(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ze(t=>{pi(t,e,()=>{const r=n[Symbol.asyncIterator]();pi(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function I(n,e){return e?function S(n,e){if(null!=n){if(Ht(n))return function gi(n,e){return gt(n).pipe(Or(e),$n(e))}(n,e);if(Et(n))return function Eo(n,e){return new Ze(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(en(n))return function Ja(n,e){return gt(n).pipe(Or(e),$n(e))}(n,e);if(tn(n))return Rs(n,e);if(Zr(n))return function sa(n,e){return new Ze(t=>{let r;return pi(t,e,()=>{r=n[sr](),pi(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>A(r?.return)&&r.return()})}(n,e);if(Ds(n))return function N(n,e){return Rs(ki(n),e)}(n,e)}throw jn(n)}(n,e):gt(n)}function C(...n){const e=rs(n),t=function Xn(n,e){return"number"==typeof ns(n)?n.pop():e}(n,1/0),r=n;return r.length?1===r.length?gt(r[0]):Qr(t)(I(r,e)):Cn}class E extends z{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function R(...n){return I(n,rs(n))}function K(n={}){const{connector:e=(()=>new z),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,l=0,d=!1,f=!1;const m=()=>{a?.unsubscribe(),a=void 0},_=()=>{m(),o=u=void 0,d=f=!1},v=()=>{const T=o;_(),T?.unsubscribe()};return Y((T,D)=>{l++,!f&&!d&&m();const k=u=u??e();D.add(()=>{l--,0===l&&!f&&!d&&(a=Ie(v,i))}),k.subscribe(D),!o&&l>0&&(o=new Bn({next:P=>k.next(P),error:P=>{f=!0,m(),a=Ie(_,t,P),k.error(P)},complete:()=>{d=!0,m(),a=Ie(_,r),k.complete()}}),gt(T).subscribe(o))})(s)}}function Ie(n,e,...t){if(!0===e)return void n();if(!1===e)return;const r=new Bn({next:()=>{r.unsubscribe(),n()}});return gt(e(...t)).subscribe(r)}function ve(n,e){return Y((t,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();t.subscribe(ce(r,u=>{i?.unsubscribe();let l=0;const d=s++;gt(n(u,d)).subscribe(i=ce(r,f=>r.next(e?e(u,f,d,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Fe(n,e=Tn){return n=n??It,Y((t,r)=>{let i,s=!0;t.subscribe(ce(r,o=>{const a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function It(n,e){return n===e}function ge(n){for(let e in n)if(n[e]===ge)return e;throw Error("Could not find renamed property on target object.")}function Vt(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Re(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Re).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function or(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const oa=ge({__forward_ref__:ge});function U(n){return n.__forward_ref__=U,n.toString=function(){return Re(this())},n}function x(n){return ie(n)?n():n}function ie(n){return"function"==typeof n&&n.hasOwnProperty(oa)&&n.__forward_ref__===U}function De(n){return n&&!!n.\u0275providers}const nt="https://g.co/ng/security#xss";class L extends Error{constructor(e,t){super(function xn(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Ce(n){return"string"==typeof n?n:null==n?"":String(n)}function Wf(n,e){throw new L(-201,!1)}function wr(n,e){null==n&&function Le(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}(e,n,null,"!=")}function ye(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Dn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Wc(n){return gy(n,tu)||gy(n,Kc)}function gy(n,e){return n.hasOwnProperty(e)?n[e]:null}function vl(n){return n&&(n.hasOwnProperty(Kf)||n.hasOwnProperty(tC))?n[Kf]:null}const tu=ge({\u0275prov:ge}),Kf=ge({\u0275inj:ge}),Kc=ge({ngInjectableDef:ge}),tC=ge({ngInjectorDef:ge});var rt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(rt||{});let Zf;function Yr(n){const e=Zf;return Zf=n,e}function Qc(n,e,t){const r=Wc(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&rt.Optional?null:void 0!==e?e:void Wf(Re(n))}const Ut=globalThis;class le{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=ye({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ua={},tp="__NG_DI_FLAG__",_i="ngTempTokenPath",np=/\n/gm,Jc="__source";let nu;function wo(n){const e=nu;return nu=n,e}function iC(n,e=rt.Default){if(void 0===nu)throw new L(-203,!1);return null===nu?Qc(n,void 0,e):nu.get(n,e&rt.Optional?null:void 0,e)}function W(n,e=rt.Default){return(function Zc(){return Zf}()||iC)(x(n),e)}function pe(n,e=rt.Default){return W(n,ed(e))}function ed(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function la(n){const e=[];for(let t=0;t<n.length;t++){const r=x(n[t]);if(Array.isArray(r)){if(0===r.length)throw new L(900,!1);let i,s=rt.Default;for(let o=0;o<r.length;o++){const a=r[o],u=ip(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(W(i,s))}else e.push(W(r))}return e}function td(n,e){return n[tp]=e,n.prototype[tp]=e,n}function ip(n){return n[tp]}function yi(n){return{toString:n}.toString()}var nd=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(nd||{}),Fi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Fi||{});const Ps={},Dt=[],Xs=ge({\u0275cmp:ge}),sp=ge({\u0275dir:ge}),iu=ge({\u0275pipe:ge}),vy=ge({\u0275mod:ge}),Ns=ge({\u0275fac:ge}),ca=ge({__NG_ELEMENT_ID__:ge}),vi=ge({__NG_ENV_ID__:ge});function op(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function ap(n,e,t){let r=0;for(;r<t.length;){const i=t[r];if("number"==typeof i){if(0!==i)break;r++;const s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{const s=i,o=t[++r];Il(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function rd(n){return 3===n||4===n||6===n}function Il(n){return 64===n.charCodeAt(0)}function su(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||up(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function up(n,e,t,r,i){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}const Ey="ng-template";function lp(n,e,t){let r=0,i=!0;for(;r<n.length;){let s=n[r++];if("string"==typeof s&&i){const o=n[r++];if(t&&"class"===s&&-1!==op(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function id(n){return 4===n.type&&n.value!==Ey}function cp(n,e,t){return e===(4!==n.type||t?n.value:Ey)}function sd(n,e,t){let r=4;const i=n.attrs||[],s=function dp(n){for(let e=0;e<n.length;e++)if(rd(n[e]))return e;return n.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!cp(n,u,t)||""===u&&1===e.length){if(Ei(r))return!1;o=!0}}else{const l=8&r?u:e[++a];if(8&r&&null!==n.attrs){if(!lp(n.attrs,l,t)){if(Ei(r))return!1;o=!0}continue}const f=Iy(8&r?"class":u,i,id(n),t);if(-1===f){if(Ei(r))return!1;o=!0;continue}if(""!==l){let m;m=f>s?"":i[f+1].toLowerCase();const _=8&r?m:null;if(_&&-1!==op(_,l,0)||2&r&&l!==m){if(Ei(r))return!1;o=!0}}}}else{if(!o&&!Ei(r)&&!Ei(u))return!1;if(o&&Ei(u))continue;o=!1,r=u|1&r}}return Ei(r)||o}function Ei(n){return 0==(1&n)}function Iy(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function ad(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function od(n,e,t=!1){for(let r=0;r<e.length;r++)if(sd(n,e[r],t))return!0;return!1}function fp(n,e){return n?":not("+e.trim()+")":e}function pp(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Ei(o)&&(e+=fp(s,i),i=""),r=o,s=s||!Ei(r);t++}return""!==i&&(e+=fp(s,i)),e}function Co(n){return yi(()=>{const e=Cy(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===nd.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Fi.Emulated,styles:n.styles||Dt,_:null,schemas:n.schemas||null,tView:null,id:""};ld(t);const r=n.dependencies;return t.directiveDefs=wl(r,!1),t.pipeDefs=wl(r,!0),t.id=function oC(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function sC(n){return dt(n)||hr(n)}function _p(n){return null!==n}function rn(n){return yi(()=>({type:n.type,bootstrap:n.bootstrap||Dt,declarations:n.declarations||Dt,imports:n.imports||Dt,exports:n.exports||Dt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ud(n,e){if(null==n)return Ps;const t={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=r,e&&(e[i]=s)}return t}function Ve(n){return yi(()=>{const e=Cy(n);return ld(e),e})}function dt(n){return n[Xs]||null}function hr(n){return n[sp]||null}function fr(n){return n[iu]||null}function Fr(n,e){const t=n[vy]||null;if(!t&&!0===e)throw new Error(`Type ${Re(n)} does not have '\u0275mod' property.`);return t}function Cy(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ps,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Dt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ud(n.inputs,e),outputs:ud(n.outputs)}}function ld(n){n.features?.forEach(e=>e(n))}function wl(n,e){if(!n)return null;const t=e?fr:sC;return()=>("function"==typeof n?n():n).map(r=>t(r)).filter(_p)}const sn=0,me=1,qe=2,on=3,is=4,da=5,Cr=6,au=7,gn=8,bo=9,Do=10,ze=11,ha=12,by=13,Ao=14,kn=15,fa=16,uu=17,Li=18,Tl=19,cd=20,So=21,Js=22,lu=23,pa=24,at=25,dd=1,Dy=2,Ms=7,cu=9,br=11;function Ii(n){return Array.isArray(n)&&"object"==typeof n[dd]}function pr(n){return Array.isArray(n)&&!0===n[dd]}function Ep(n){return 0!=(4&n.flags)}function ga(n){return n.componentOffset>-1}function Ip(n){return 1==(1&n.flags)}function xs(n){return!!n.template}function Ay(n){return 0!=(512&n[qe])}function du(n,e){return n.hasOwnProperty(Ns)?n[Ns]:null}let On=null,fd=!1;function Nt(n){const e=On;return On=n,e}const xy={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function ky(n){if(!Al(n)||n.dirty){if(!n.producerMustRecompute(n)&&!Dl(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function Oy(n){n.dirty=!0,function gd(n){if(void 0===n.liveConsumerNode)return;const e=fd;fd=!0;try{for(const t of n.liveConsumerNode)t.dirty||Oy(t)}finally{fd=e}}(n),n.consumerMarkedDirty?.(n)}function md(n){return n&&(n.nextProducerIndex=0),Nt(n)}function bp(n,e){if(Nt(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Al(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)_a(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Dl(n){Ro(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(ky(t),r!==t.version))return!0}return!1}function Dp(n){if(Ro(n),Al(n))for(let e=0;e<n.producerNode.length;e++)_a(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function _a(n,e){if(function Ap(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),Ro(n),1===n.liveConsumerNode.length)for(let r=0;r<n.producerNode.length;r++)_a(n.producerNode[r],n.producerIndexOfThis[r]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Ro(i),i.producerIndexOfThis[r]=e}}function Al(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Ro(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let cC=null;const jy=()=>{},mC=(()=>({...xy,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:jy}))();class $y{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Vi(){return Hy}function Hy(n){return n.type.prototype.ngOnChanges&&(n.setInput=Pp),_C}function _C(){const n=yd(this),e=n?.current;if(e){const t=n.previous;if(t===Ps)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Pp(n,e,t,r){const i=this.declaredInputs[t],s=yd(n)||function yC(n,e){return n[qy]=e}(n,{previous:Ps,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new $y(u&&u.currentValue,e,a===Ps),n[r]=e}Vi.ngInherit=!0;const qy="__ngSimpleChanges__";function yd(n){return n[qy]||null}const Ui=function(n,e,t){};function Kt(n){for(;Array.isArray(n);)n=n[sn];return n}function Ed(n,e){return Kt(e[n])}function Hn(n,e){return Kt(e[n.index])}function zy(n,e){return n.data[e]}function wi(n,e){const t=e[n];return Ii(t)?t:t[sn]}function Po(n,e){return null==e?null:n[e]}function Id(n){n[uu]=0}function IC(n){1024&n[qe]||(n[qe]|=1024,Wy(n,1))}function wd(n){1024&n[qe]&&(n[qe]&=-1025,Wy(n,-1))}function Wy(n,e){let t=n[on];if(null===t)return;t[da]+=e;let r=t;for(t=t[on];null!==t&&(1===e&&1===r[da]||-1===e&&0===r[da]);)t[da]+=e,r=t,t=t[on]}const Be={lFrame:rv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Cd(){return Be.bindingsEnabled}function te(){return Be.lFrame.lView}function wt(){return Be.lFrame.tView}function Fp(n){return Be.lFrame.contextLView=n,n[gn]}function Ml(n){return Be.lFrame.contextLView=null,n}function gr(){let n=Yy();for(;null!==n&&64===n.type;)n=n.parent;return n}function Yy(){return Be.lFrame.currentTNode}function Os(n,e){const t=Be.lFrame;t.currentTNode=n,t.isParent=e}function xl(){return Be.lFrame.isParent}function kl(){Be.lFrame.isParent=!1}function va(){return Be.lFrame.bindingIndex++}function eo(n){const e=Be.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function DC(n,e){const t=Be.lFrame;t.bindingIndex=t.bindingRootIndex=n,Up(e)}function Up(n){Be.lFrame.currentDirectiveIndex=n}function Ol(n){const e=Be.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function Bp(n){Be.lFrame.currentQueryIndex=n}function ev(n){const e=n[me];return 2===e.type?e.declTNode:1===e.type?n[Cr]:null}function tv(n,e,t){if(t&rt.SkipSelf){let i=e,s=n;for(;!(i=i.parent,null!==i||t&rt.Host||(i=ev(s),null===i||(s=s[Ao],10&i.type))););if(null===i)return!1;e=i,n=s}const r=Be.lFrame=nv();return r.currentTNode=e,r.lView=n,!0}function mu(n){const e=nv(),t=n[me];Be.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function nv(){const n=Be.lFrame,e=null===n?null:n.child;return null===e?rv(n):e}function rv(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function iv(){const n=Be.lFrame;return Be.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const sv=iv;function jp(){const n=iv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Vr(){return Be.lFrame.selectedIndex}function to(n){Be.lFrame.selectedIndex=n}function mn(){const n=Be.lFrame;return zy(n.tView,n.selectedIndex)}let ov=!0;function Ad(){return ov}function No(n){ov=n}function Sd(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function _u(n,e,t){Rd(n,e,3,t)}function yu(n,e,t,r){(3&n[qe])===t&&Rd(n,e,t,r)}function Hp(n,e){let t=n[qe];(3&t)===e&&(t&=8191,t+=1,n[qe]=t)}function Rd(n,e,t,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&n[uu]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(n[uu]+=65536),(a<s||-1==s)&&(uv(n,t,e,u),n[uu]=(4294901760&n[uu])+u+2),u++}function av(n,e){Ui(4,n,e);const t=Nt(null);try{e.call(n)}finally{Nt(t),Ui(5,n,e)}}function uv(n,e,t,r){const i=t[r]<0,s=t[r+1],a=n[i?-t[r]:t[r]];i?n[qe]>>13<n[uu]>>16&&(3&n[qe])===e&&(n[qe]+=8192,av(a,s)):av(a,s)}const vu=-1;class Ea{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function qp(n){return n!==vu}function Ll(n){return 32767&n}function Vl(n,e){let t=function VC(n){return n>>16}(n),r=e;for(;t>0;)r=r[Ao],t--;return r}let Nd=!0;function Md(n){const e=Nd;return Nd=n,e}const p=255,c=5;let h=0;const g={};function w(n,e){const t=j(n,e);if(-1!==t)return t;const r=e[me];r.firstCreatePass&&(n.injectorIndex=e.length,M(r.data,n),M(e,null),M(r.blueprint,null));const i=re(n,e),s=n.injectorIndex;if(qp(i)){const o=Ll(i),a=Vl(i,e),u=a[me].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function M(n,e){n.push(0,0,0,0,0,0,0,0,e)}function j(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function re(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){if(r=XM(i),null===r)return vu;if(t++,i=i[Ao],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return vu}function Ee(n,e,t){!function y(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(ca)&&(r=t[ca]),null==r&&(r=t[ca]=h++);const i=r&p;e.data[n+(i>>c)]|=1<<i}(n,e,t)}function ht(n,e,t){if(t&rt.Optional||void 0!==n)return n;Wf()}function Ur(n,e,t,r){if(t&rt.Optional&&void 0===r&&(r=null),!(t&(rt.Self|rt.Host))){const i=n[bo],s=Yr(void 0);try{return i?i.get(e,r,t&rt.Optional):Qc(e,r,t&rt.Optional)}finally{Yr(s)}}return ht(r,0,t)}function no(n,e,t,r=rt.Default,i){if(null!==n){if(2048&e[qe]&&!(r&rt.Self)){const o=function JW(n,e,t,r,i){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[qe]&&!(512&o[qe]);){const a=Ul(s,o,t,r|rt.Self,g);if(a!==g)return a;let u=s.parent;if(!u){const l=o[cd];if(l){const d=l.get(t,g,r);if(d!==g)return d}u=XM(o),o=o[Ao]}s=u}return i}(n,e,t,r,g);if(o!==g)return o}const s=Ul(n,e,t,r,g);if(s!==g)return s}return Ur(e,t,r,i)}function Ul(n,e,t,r,i){const s=function dv(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ca)?n[ca]:void 0;return"number"==typeof e?e>=0?e&p:UC:e}(t);if("function"==typeof s){if(!tv(e,n,r))return r&rt.Host?ht(i,0,r):Ur(e,t,r,i);try{let o;if(o=s(r),null!=o||r&rt.Optional)return o;Wf()}finally{sv()}}else if("number"==typeof s){let o=null,a=j(n,e),u=vu,l=r&rt.Host?e[kn][Cr]:null;for((-1===a||r&rt.SkipSelf)&&(u=-1===a?re(n,e):e[a+8],u!==vu&&zp(r,!1)?(o=e[me],a=Ll(u),e=Vl(u,e)):a=-1);-1!==a;){const d=e[me];if(xd(s,a,d.data)){const f=cv(a,e,t,o,r,l);if(f!==g)return f}u=e[a+8],u!==vu&&zp(r,e[me].data[a+8]===l)&&xd(s,a,e)?(o=d,a=Ll(u),e=Vl(u,e)):a=-1}}return i}function cv(n,e,t,r,i,s){const o=e[me],a=o.data[n+8],d=function Eu(n,e,t,r,i){const s=n.providerIndexes,o=e.data,a=1048575&s,u=n.directiveStart,d=s>>20,m=i?a+d:n.directiveEnd;for(let _=r?a:a+d;_<m;_++){const v=o[_];if(_<u&&t===v||_>=u&&v.type===t)return _}if(i){const _=o[u];if(_&&xs(_)&&_.type===t)return u}return null}(a,o,t,null==r?ga(a)&&Nd:r!=o&&0!=(3&a.type),i&rt.Host&&s===a);return null!==d?Mo(e,o,d,a):g}function Mo(n,e,t,r){let i=n[t];const s=e.data;if(function OC(n){return n instanceof Ea}(i)){const o=i;o.resolving&&function yl(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new L(-200,`Circular dependency in DI detected for ${n}${t}`)}(function st(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ce(n)}(s[t]));const a=Md(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Yr(o.injectImpl):null;tv(n,r,rt.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&function kC(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=Hy(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&Yr(l),Md(a),o.resolving=!1,sv()}}return i}function xd(n,e,t){return!!(t[e+(n>>c)]&1<<n)}function zp(n,e){return!(n&rt.Self||n&rt.Host&&e)}class Dr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return no(this._tNode,this._lView,e,ed(r),t)}}function UC(){return new Dr(gr(),te())}function Jn(n){return yi(()=>{const e=n.prototype.constructor,t=e[Ns]||Wp(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[Ns]||Wp(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Wp(n){return ie(n)?()=>{const e=Wp(x(n));return e&&e()}:du(n)}function XM(n){const e=n[me],t=e.type;return 2===t?e.declTNode:1===t?n[Cr]:null}const Od="__parameters__";function Ld(n,e,t){return yi(()=>{const r=function BC(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,l,d){const f=u.hasOwnProperty(Od)?u[Od]:Object.defineProperty(u,Od,{value:[]})[Od];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Ud(n,e){n.forEach(t=>Array.isArray(t)?Ud(t,e):e(t))}function ex(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function fv(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function ss(n,e,t){let r=Bd(n,e);return r>=0?n[1|r]=t:(r=~r,function o3(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function jC(n,e){const t=Bd(n,e);if(t>=0)return n[1|t]}function Bd(n,e){return function tx(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}(n,e,1)}const Qp=td(Ld("Optional"),8),gv=td(Ld("SkipSelf"),4);function Ev(n){return 128==(128&n.flags)}var wu=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(wu||{});const A3=/^>|^->|<!--|-->|--!>|<!-$/g,S3=/(<|>)/g,R3="\u200b$1\u200b";const GC=new Map;let P3=0;const KC="__ngContext__";function Xr(n,e){Ii(e)?(n[KC]=e[Tl],function M3(n){GC.set(n[Tl],n)}(e)):n[KC]=e}let ZC;function QC(n,e){return ZC(n,e)}function Jp(n){const e=n[on];return pr(e)?e[on]:e}function Ix(n){return Tx(n[ha])}function wx(n){return Tx(n[is])}function Tx(n){for(;null!==n&&!pr(n);)n=n[is];return n}function Hd(n,e,t,r,i){if(null!=r){let s,o=!1;pr(r)?s=r:Ii(r)&&(o=!0,r=r[sn]);const a=Kt(r);0===n&&null!==t?null==i?Ax(e,t,a):Bl(e,t,a,i||null,!0):1===n&&null!==t?Bl(e,t,a,i||null,!0):2===n?function Av(n,e,t){const r=bv(n,e);r&&function Y3(n,e,t,r){n.removeChild(e,t,r)}(n,r,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function e9(n,e,t,r,i){const s=t[Ms];s!==Kt(t)&&Hd(e,n,r,s,i);for(let a=br;a<t.length;a++){const u=t[a];tg(u[me],u,n,e,r,s)}}(e,n,s,t,i)}}function YC(n,e){return n.createComment(function fx(n){return n.replace(A3,e=>e.replace(S3,R3))}(e))}function Tv(n,e,t){return n.createElement(e,t)}function bx(n,e){const t=n[cu],r=t.indexOf(e);wd(e),t.splice(r,1)}function Cv(n,e){if(n.length<=br)return;const t=br+e,r=n[t];if(r){const i=r[fa];null!==i&&i!==n&&bx(i,r),e>0&&(n[t-1][is]=r[is]);const s=fv(n,br+e);!function H3(n,e){tg(n,e,e[ze],2,null,null),e[sn]=null,e[Cr]=null}(r[me],r);const o=s[Li];null!==o&&o.detachView(s[me]),r[on]=null,r[is]=null,r[qe]&=-129}return r}function XC(n,e){if(!(256&e[qe])){const t=e[ze];e[lu]&&Dp(e[lu]),e[pa]&&Dp(e[pa]),t.destroyNode&&tg(n,e,t,3,null,null),function G3(n){let e=n[ha];if(!e)return JC(n[me],n);for(;e;){let t=null;if(Ii(e))t=e[ha];else{const r=e[br];r&&(t=r)}if(!t){for(;e&&!e[is]&&e!==n;)Ii(e)&&JC(e[me],e),e=e[on];null===e&&(e=n),Ii(e)&&JC(e[me],e),t=e&&e[is]}e=t}}(e)}}function JC(n,e){if(!(256&e[qe])){e[qe]&=-129,e[qe]|=256,function Q3(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof Ea)){const s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];Ui(4,a,u);try{u.call(a)}finally{Ui(5,a,u)}}else{Ui(4,i,s);try{s.call(i)}finally{Ui(5,i,s)}}}}}(n,e),function Z3(n,e){const t=n.cleanup,r=e[au];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else t[s].call(r[t[s+1]]);null!==r&&(e[au]=null);const i=e[So];if(null!==i){e[So]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(n,e),1===e[me].type&&e[ze].destroy();const t=e[fa];if(null!==t&&pr(e[on])){t!==e[on]&&bx(t,e);const r=e[Li];null!==r&&r.detachView(n)}!function x3(n){GC.delete(n[Tl])}(e)}}function e0(n,e,t){return function Dx(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[sn];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=n.data[r.directiveStart+i];if(s===Fi.None||s===Fi.Emulated)return null}return Hn(r,t)}}(n,e.parent,t)}function Bl(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Ax(n,e,t){n.appendChild(e,t)}function Sx(n,e,t,r,i){null!==r?Bl(n,e,t,r,i):Ax(n,e,t)}function bv(n,e){return n.parentNode(e)}let t0,Sv,o0,Rv,Nx=function Px(n,e,t){return 40&n.type?Hn(n,t):null};function Dv(n,e,t,r){const i=e0(n,r,e),s=e[ze],a=function Rx(n,e,t){return Nx(n,e,t)}(r.parent||e[Cr],r,e);if(null!=i)if(Array.isArray(t))for(let u=0;u<t.length;u++)Sx(s,i,t[u],a,!1);else Sx(s,i,t,a,!1);void 0!==t0&&t0(s,r,e,t,i)}function eg(n,e){if(null!==e){const t=e.type;if(3&t)return Hn(e,n);if(4&t)return n0(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return eg(n,r);{const i=n[e.index];return pr(i)?n0(-1,i):Kt(i)}}if(32&t)return QC(e,n)()||Kt(n[e.index]);{const r=xx(n,e);return null!==r?Array.isArray(r)?r[0]:eg(Jp(n[kn]),r):eg(n,e.next)}}return null}function xx(n,e){return null!==e?n[kn][Cr].projection[e.projection]:null}function n0(n,e){const t=br+n+1;if(t<e.length){const r=e[t],i=r[me].firstChild;if(null!==i)return eg(r,i)}return e[Ms]}function r0(n,e,t,r,i,s,o){for(;null!=t;){const a=r[t.index],u=t.type;if(o&&0===e&&(a&&Xr(Kt(a),r),t.flags|=2),32!=(32&t.flags))if(8&u)r0(n,e,t.child,r,i,s,!1),Hd(e,n,i,a,s);else if(32&u){const l=QC(t,r);let d;for(;d=l();)Hd(e,n,i,d,s);Hd(e,n,i,a,s)}else 16&u?Ox(n,e,r,t,i,s):Hd(e,n,i,a,s);t=o?t.projectionNext:t.next}}function tg(n,e,t,r,i,s){r0(t,r,n.firstChild,e,i,s,!1)}function Ox(n,e,t,r,i,s){const o=t[kn],u=o[Cr].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)Hd(e,n,i,u[l],s);else{let l=u;const d=o[on];Ev(r)&&(l.flags|=128),r0(n,e,l,d,i,s,!0)}}function Fx(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Lx(n,e,t){const{mergedAttrs:r,classes:i,styles:s}=t;null!==r&&ap(n,e,r),null!==i&&Fx(n,e,i),null!==s&&function n9(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function qd(n){return function s0(){if(void 0===Sv&&(Sv=null,Ut.trustedTypes))try{Sv=Ut.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Sv}()?.createHTML(n)||n}function zd(){if(void 0!==o0)return o0;if(typeof document<"u")return document;throw new L(210,!1)}function Vx(n){return function a0(){if(void 0===Rv&&(Rv=null,Ut.trustedTypes))try{Rv=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Rv}()?.createHTML(n)||n}class jl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nt})`}}class a9 extends jl{getTypeName(){return"HTML"}}class u9 extends jl{getTypeName(){return"Style"}}class l9 extends jl{getTypeName(){return"Script"}}class c9 extends jl{getTypeName(){return"URL"}}class d9 extends jl{getTypeName(){return"ResourceURL"}}function os(n){return n instanceof jl?n.changingThisBreaksApplicationSecurity:n}function xo(n,e){const t=function h9(n){return n instanceof jl&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${nt})`)}return t===e}class y9{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(qd(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class v9{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=qd(e),t}}const I9=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Pv(n){return(n=String(n)).match(I9)?n:"unsafe:"+n}function Ia(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function ng(...n){const e={};for(const t of n)for(const r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}const $x=Ia("area,br,col,hr,img,wbr"),Hx=Ia("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),qx=Ia("rp,rt"),u0=ng($x,ng(Hx,Ia("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ng(qx,Ia("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ng(qx,Hx)),l0=Ia("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),zx=ng(l0,Ia("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ia("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),w9=Ia("script,style,template");class T9{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,r=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!u0.hasOwnProperty(t))return this.sanitizedSomething=!0,!w9.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=e.attributes;for(let i=0;i<r.length;i++){const s=r.item(i),o=s.name,a=o.toLowerCase();if(!zx.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let u=s.value;l0[a]&&(u=Pv(u)),this.buf.push(" ",o,'="',Gx(u),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();u0.hasOwnProperty(t)&&!$x.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Gx(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const C9=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b9=/([^\#-~ |!])/g;function Gx(n){return n.replace(/&/g,"&amp;").replace(C9,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(b9,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Nv;function Wx(n,e){let t=null;try{Nv=Nv||function jx(n){const e=new v9(n);return function E9(){try{return!!(new window.DOMParser).parseFromString(qd(""),"text/html")}catch{return!1}}()?new y9(e):e}(n);let r=e?String(e):"";t=Nv.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=t.innerHTML,t=Nv.getInertBodyElement(r)}while(r!==s);return qd((new T9).sanitizeChildren(c0(t)||t))}finally{if(t){const r=c0(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function c0(n){return"content"in n&&function D9(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var as=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(as||{});function d0(n){const e=function rg(){const n=te();return n&&n[Do].sanitizer}();return e?Vx(e.sanitize(as.HTML,n)||""):xo(n,"HTML")?Vx(os(n)):Wx(zd(),Ce(n))}const ig=new le("ENVIRONMENT_INITIALIZER"),Yx=new le("INJECTOR",-1),Xx=new le("INJECTOR_DEF_TYPES");class h0{get(e,t=ua){if(t===ua){const r=new Error(`NullInjectorError: No provider for ${Re(e)}!`);throw r.name="NullInjectorError",r}return t}}function Mv(n){return{\u0275providers:n}}function M9(...n){return{\u0275providers:Jx(0,n),\u0275fromNgModule:!0}}function Jx(n,...e){const t=[],r=new Set;let i;const s=o=>{t.push(o)};return Ud(e,o=>{const a=o;xv(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&ek(i,s),t}function ek(n,e){for(let t=0;t<n.length;t++){const{ngModule:r,providers:i}=n[t];f0(i,s=>{e(s,r)})}}function xv(n,e,t,r){if(!(n=x(n)))return!1;let i=null,s=vl(n);const o=!s&&dt(n);if(s||o){if(o&&!o.standalone)return!1;i=n}else{const u=n.ngModule;if(s=vl(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of u)xv(l,e,t,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{Ud(s.imports,d=>{xv(d,e,t,r)&&(l||=[],l.push(d))})}finally{}void 0!==l&&ek(l,e)}if(!a){const l=du(i)||(()=>new i);e({provide:i,useFactory:l,deps:Dt},i),e({provide:Xx,useValue:i,multi:!0},i),e({provide:ig,useValue:()=>W(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const l=n;f0(u,d=>{e(d,l)})}}}return i!==n&&void 0!==n.providers}function f0(n,e){for(let t of n)De(t)&&(t=t.\u0275providers),Array.isArray(t)?f0(t,e):e(t)}const x9=ge({provide:String,useValue:ge});function p0(n){return null!==n&&"object"==typeof n&&x9 in n}function $l(n){return"function"==typeof n}const g0=new le("Set Injector scope."),kv={},O9={};let m0;function Ov(){return void 0===m0&&(m0=new h0),m0}class us{}class Gd extends us{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,y0(e,o=>this.processProvider(o)),this.records.set(Yx,Wd(void 0,this)),i.has("environment")&&this.records.set(us,Wd(void 0,this));const s=this.records.get(g0);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Xx.multi,Dt,rt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=wo(this),r=Yr(void 0);try{return e()}finally{wo(t),Yr(r)}}get(e,t=ua,r=rt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vi))return e[vi](this);r=ed(r);const s=wo(this),o=Yr(void 0);try{if(!(r&rt.SkipSelf)){let u=this.records.get(e);if(void 0===u){const l=function B9(n){return"function"==typeof n||"object"==typeof n&&n instanceof le}(e)&&Wc(e);u=l&&this.injectableDefInScope(l)?Wd(_0(e),kv):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&rt.Self?Ov():this.parent).get(e,t=r&rt.Optional&&t===ua?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[_i]=a[_i]||[]).unshift(Re(e)),s)throw a;return function Ys(n,e,t,r){const i=n[_i];throw e[Jc]&&i.unshift(e[Jc]),n.message=function ru(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let i=Re(e);if(Array.isArray(e))i=e.map(Re).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Re(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(np,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[_i]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Yr(o),wo(s)}}resolveInjectorInitializers(){const e=wo(this),t=Yr(void 0);try{const i=this.get(ig.multi,Dt,rt.Self);for(const s of i)s()}finally{wo(e),Yr(t)}}toString(){const e=[],t=this.records;for(const r of t.keys())e.push(Re(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new L(205,!1)}processProvider(e){let t=$l(e=x(e))?e:x(e&&e.provide);const r=function L9(n){return p0(n)?Wd(void 0,n.useValue):Wd(rk(n),kv)}(e);if($l(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=Wd(void 0,kv,!0),i.factory=()=>la(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){return t.value===kv&&(t.value=O9,t.value=t.factory()),"object"==typeof t.value&&t.value&&function U9(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=x(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function _0(n){const e=Wc(n),t=null!==e?e.factory:du(n);if(null!==t)return t;if(n instanceof le)throw new L(204,!1);if(n instanceof Function)return function F9(n){const e=n.length;if(e>0)throw function Zp(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}(e,"?"),new L(204,!1);const t=function eu(n){return n&&(n[tu]||n[Kc])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new L(204,!1)}function rk(n,e,t){let r;if($l(n)){const i=x(n);return du(i)||_0(i)}if(p0(n))r=()=>x(n.useValue);else if(function nk(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...la(n.deps||[]));else if(function tk(n){return!(!n||!n.useExisting)}(n))r=()=>W(x(n.useExisting));else{const i=x(n&&(n.useClass||n.provide));if(!function V9(n){return!!n.deps}(n))return du(i)||_0(i);r=()=>new i(...la(n.deps))}return r}function Wd(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function y0(n,e){for(const t of n)Array.isArray(t)?y0(t,e):t&&De(t)?y0(t.\u0275providers,e):e(t)}const Fv=new le("AppId",{providedIn:"root",factory:()=>j9}),j9="ng",ik=new le("Platform Initializer"),Vs=new le("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),sk=new le("AnimationModuleType"),ok=new le("CSP nonce",{providedIn:"root",factory:()=>zd().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let ak=(n,e,t)=>null;function D0(n,e,t=!1){return ak(n,e,t)}class Y9{}class ck{}class J9{resolveComponentFactory(e){throw function X9(n){const e=Error(`No component factory found for ${Re(n)}.`);return e.ngComponent=n,e}(e)}}let ag=(()=>{class n{static#e=this.NULL=new J9}return n})();function e6(){return Qd(gr(),te())}function Qd(n,e){return new ls(Hn(n,e))}let ls=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=e6}return n})();class ug{}let wa=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function n6(){const n=te(),t=wi(gr().index,n);return(Ii(t)?t:n)[ze]}()}return n})(),r6=(()=>{class n{static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>null})}return n})();class Yd{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const hk=new Yd("16.2.12"),R0={};function mk(n,e=null,t=null,r){const i=_k(n,e,t,r);return i.resolveInjectorInitializers(),i}function _k(n,e=null,t=null,r,i=new Set){const s=[t||Dt,M9(n)];return r=r||("object"==typeof n?void 0:Re(n)),new Gd(s,e||Ov(),r||null,i)}let Jr=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=ua;static#t=this.NULL=new h0;static create(t,r){if(Array.isArray(t))return mk({name:""},r,t,"");{const i=t.name??"";return mk({name:i},t.parent,t.providers,i)}}static#n=this.\u0275prov=ye({token:n,providedIn:"any",factory:()=>W(Yx)});static#r=this.__NG_ELEMENT_ID__=-1}return n})();function N0(n){return n.ngOriginalError}class Ta{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&N0(e);for(;t&&N0(t);)t=N0(t);return t||null}}function x0(n){return e=>{setTimeout(n,void 0,e)}}const qn=class c6 extends z{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=x0(s),i&&(i=x0(i)),o&&(o=x0(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof yt&&e.add(a),a}};function vk(...n){}class Tt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qn(!1),this.onMicrotaskEmpty=new qn(!1),this.onStable=new qn(!1),this.onError=new qn(!1),typeof Zone>"u")throw new L(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function d6(){const n="function"==typeof Ut.requestAnimationFrame;let e=Ut[n?"requestAnimationFrame":"setTimeout"],t=Ut[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function p6(n){const e=()=>{!function f6(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ut,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,O0(n),n.isCheckStableRunning=!0,k0(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),O0(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(function m6(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(i,s,o,a);try{return Ek(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),Ik(n)}},onInvoke:(t,r,i,s,o,a,u)=>{try{return Ek(n),t.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),Ik(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,O0(n),k0(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Tt.isInAngularZone())throw new L(909,!1)}static assertNotInAngularZone(){if(Tt.isInAngularZone())throw new L(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,h6,vk,vk);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const h6={};function k0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function O0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Ek(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Ik(n){n._nesting--,k0(n)}class g6{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qn,this.onMicrotaskEmpty=new qn,this.onStable=new qn,this.onError=new qn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}const wk=new le("",{providedIn:"root",factory:Tk});function Tk(){const n=pe(Tt);let e=!0;return C(new Ze(i=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{i.next(e),i.complete()})}),new Ze(i=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Tt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Tt.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(K()))}function Ca(n){return n instanceof Function?n():n}let F0=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new n})}return n})();function lg(n){for(;n;){n[qe]|=64;const e=Jp(n);if(Ay(n)&&!e)return n;n=e}return null}const Sk=new le("",{providedIn:"root",factory:()=>!1});let Hv=null;function Mk(n,e){return n[e]??Ok()}function xk(n,e){const t=Ok();t.producerNode?.length&&(n[e]=Hv,t.lView=n,Hv=kk())}const D6={...xy,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{lg(n.lView)},lView:null};function kk(){return Object.create(D6)}function Ok(){return Hv??=kk(),Hv}const Qe={};function an(n){Fk(wt(),te(),Vr()+n,!1)}function Fk(n,e,t,r){if(!r)if(3==(3&e[qe])){const s=n.preOrderCheckHooks;null!==s&&_u(e,s,t)}else{const s=n.preOrderHooks;null!==s&&yu(e,s,0,t)}to(t)}function J(n,e=rt.Default){const t=te();return null===t?W(n,e):no(gr(),t,x(n),e)}function qv(n,e,t,r,i,s,o,a,u,l,d){const f=e.blueprint.slice();return f[sn]=i,f[qe]=140|r,(null!==l||n&&2048&n[qe])&&(f[qe]|=2048),Id(f),f[on]=f[Ao]=n,f[gn]=t,f[Do]=o||n&&n[Do],f[ze]=a||n&&n[ze],f[bo]=u||n&&n[bo]||null,f[Cr]=s,f[Tl]=function N3(){return P3++}(),f[Js]=d,f[cd]=l,f[kn]=2==e.type?n[kn]:f,f}function eh(n,e,t,r,i){let s=n.data[e];if(null===s)s=function L0(n,e,t,r,i){const s=Yy(),o=xl(),u=n.data[e]=function k6(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function gu(){return null!==Be.skipHydrationRootTNode}()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,r,i);return null===n.firstChild&&(n.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(n,e,t,r,i),function Xy(){return Be.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=r,s.attrs=i;const o=function ya(){const n=Be.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Os(s,!0),s}function cg(n,e,t,r){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Vk(n,e,t,r,i){const s=Mk(e,lu),o=Vr(),a=2&r;try{to(-1),a&&e.length>at&&Fk(n,e,at,!1),Ui(a?2:0,i);const l=a?s:null,d=md(l);try{null!==l&&(l.dirty=!1),t(r,i)}finally{bp(l,d)}}finally{a&&null===e[lu]&&xk(e,lu),to(o),Ui(a?3:1,i)}}function V0(n,e,t){if(Ep(e)){const r=Nt(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Nt(r)}}}function U0(n,e,t){Cd()&&(function j6(n,e,t,r){const i=t.directiveStart,s=t.directiveEnd;ga(t)&&function K6(n,e,t){const r=Hn(e,n),i=Uk(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=zv(n,qv(n,i,null,o,r,e,null,n[Do].rendererFactory.createRenderer(r,t),null,null,null));n[e.index]=a}(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||w(t,e),Xr(r,e);const o=t.initialInputs;for(let a=i;a<s;a++){const u=n.data[a],l=Mo(e,n,a,t);Xr(l,e),null!==o&&Z6(0,a-i,l,u,0,o),xs(u)&&(wi(t.index,e)[gn]=Mo(e,n,a,t))}}(n,e,t,Hn(t,e)),64==(64&t.flags)&&qk(n,e,t))}function B0(n,e,t=Hn){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?t(e,n):n[o];n[i++]=a}}}function Uk(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=j0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function j0(n,e,t,r,i,s,o,a,u,l,d){const f=at+r,m=f+i,_=function S6(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:Qe);return t}(f,m),v="function"==typeof l?l():l;return _[me]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:v,incompleteFirstPass:!1,ssrId:d}}let Bk=n=>null;function jk(n,e,t,r){for(let i in n)if(n.hasOwnProperty(i)){t=null===t?{}:t;const s=n[i];null===r?$k(t,e,i,s):r.hasOwnProperty(i)&&$k(t,e,r[i],s)}return t}function $k(n,e,t,r){n.hasOwnProperty(t)?n[t].push(e,r):n[t]=[e,r]}function cs(n,e,t,r,i,s,o,a){const u=Hn(e,t);let d,l=e.inputs;!a&&null!=l&&(d=l[r])?(G0(n,t,d,r,i),ga(e)&&function L6(n,e){const t=wi(e,n);16&t[qe]||(t[qe]|=64)}(t,e.index)):3&e.type&&(r=function F6(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}function $0(n,e,t,r){if(Cd()){const i=null===r?null:{"":-1},s=function H6(n,e){const t=n.directiveRegistry;let r=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(od(e,o.selectors,!1))if(r||(r=[]),xs(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),H0(n,e,a.length)}else r.unshift(o),H0(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Hk(n,e,t,o,i,a),i&&function q6(n,e,t){if(e){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new L(-301,!1);r.push(e[i],s)}}}(t,r,i)}t.mergedAttrs=su(t.mergedAttrs,t.attrs)}function Hk(n,e,t,r,i,s){for(let l=0;l<r.length;l++)Ee(w(t,e),n,r[l].type);!function G6(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,r.length);for(let l=0;l<r.length;l++){const d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=cg(n,e,r.length,null);for(let l=0;l<r.length;l++){const d=r[l];t.mergedAttrs=su(t.mergedAttrs,d.hostAttrs),W6(n,t,e,u,d),z6(u,d,i),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}!function O6(n,e,t){const i=e.directiveEnd,s=n.data,o=e.attrs,a=[];let u=null,l=null;for(let d=e.directiveStart;d<i;d++){const f=s[d],m=t?t.get(f):null,v=m?m.outputs:null;u=jk(f.inputs,d,u,m?m.inputs:null),l=jk(f.outputs,d,l,v);const T=null===u||null===o||id(e)?null:Q6(u,d,o);a.push(T)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}(n,t,s)}function qk(n,e,t){const r=t.directiveStart,i=t.directiveEnd,s=t.index,o=function AC(){return Be.lFrame.currentDirectiveIndex}();try{to(s);for(let a=r;a<i;a++){const u=n.data[a],l=e[a];Up(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&$6(u,l)}}finally{to(-1),Up(o)}}function $6(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function H0(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function z6(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;xs(e)&&(t[""]=n)}}function W6(n,e,t,r,i){n.data[r]=i;const s=i.factory||(i.factory=du(i.type)),o=new Ea(s,xs(i),J);n.blueprint[r]=o,t[r]=o,function U6(n,e,t,r,i){const s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function B6(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,r,s)}}(n,e,r,cg(n,t,i.hostVars,Qe),i)}function ko(n,e,t,r,i,s){const o=Hn(n,e);!function q0(n,e,t,r,i,s,o){if(null==s)n.removeAttribute(e,i,t);else{const a=null==o?Ce(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}(e[ze],o,s,n.value,t,r,i)}function Z6(n,e,t,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)zk(r,t,o[a++],o[a++],o[a++])}function zk(n,e,t,r,i){const s=Nt(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==n.setInput?n.setInput(e,i,t,r):e[r]=i}finally{Nt(s)}}function Q6(n,e,t){let r=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===r&&(r=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function Gk(n,e,t,r){return[n,!0,!1,e,null,0,r,t,null,null,null]}function Wk(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const s=t[r+1];if(-1!==s){const o=n.data[s];Bp(t[r]),o.contentQueries(2,e[s],s)}}}function zv(n,e){return n[ha]?n[by][is]=e:n[ha]=e,n[by]=e,e}function z0(n,e,t){Bp(0);const r=Nt(null);try{e(n,t)}finally{Nt(r)}}function Qk(n,e,t){return(null===n||xs(n))&&(t=function Nl(n){for(;Array.isArray(n);){if("object"==typeof n[dd])return n;n=n[sn]}return null}(t[e.index])),t[ze]}function Yk(n,e){const t=n[bo],r=t?t.get(Ta,null):null;r&&r.handleError(e)}function G0(n,e,t,r,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];zk(n.data[o],e[o],r,a,i)}}function Y6(n,e){const t=wi(e,n),r=t[me];!function X6(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(r,t);const i=t[sn];null!==i&&null===t[Js]&&(t[Js]=D0(i,t[bo])),W0(r,t,t[gn])}function W0(n,e,t){mu(e);try{const r=n.viewQuery;null!==r&&z0(1,r,t);const i=n.template;null!==i&&Vk(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Wk(n,e),n.staticViewQueries&&z0(2,n.viewQuery,t);const s=n.components;null!==s&&function J6(n,e){for(let t=0;t<e.length;t++)Y6(n,e[t])}(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[qe]&=-5,jp()}}let Xk=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,r,i){const s=typeof Zone>"u"?null:Zone.current,o=function gC(n,e,t){const r=Object.create(mC);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;const i=o=>{r.cleanupFn=o};return r.ref={notify:()=>Oy(r),run:()=>{if(r.dirty=!1,r.hasRun&&!Dl(r))return;r.hasRun=!0;const o=md(r);try{r.cleanupFn(),r.cleanupFn=jy,r.fn(i)}finally{bp(r,o)}},cleanup:()=>r.cleanupFn()},r.ref}(t,l=>{this.all.has(l)&&this.queue.set(l,s)},i);let a;this.all.add(o),o.notify();const u=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=r?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[t,r]of this.queue)this.queue.delete(t),r?r.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new n})}return n})();function Gv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=or(i,a):2==s&&(r=or(r,a+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function dg(n,e,t,r,i=!1){for(;null!==t;){const s=e[t.index];null!==s&&r.push(Kt(s)),pr(s)&&Jk(s,r);const o=t.type;if(8&o)dg(n,e,t.child,r);else if(32&o){const a=QC(t,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=xx(e,t);if(Array.isArray(a))r.push(...a);else{const u=Jp(e[kn]);dg(u[me],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Jk(n,e){for(let t=br;t<n.length;t++){const r=n[t],i=r[me].firstChild;null!==i&&dg(r[me],r,i,e)}n[Ms]!==n[sn]&&e.push(n[Ms])}function Wv(n,e,t,r=!0){const i=e[Do],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{eO(n,e,n.template,t)}catch(u){throw r&&Yk(e,u),u}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function eO(n,e,t,r){const i=e[qe];if(256!=(256&i)){e[Do].effectManager?.flush(),mu(e);try{Id(e),function Vp(n){return Be.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Vk(n,e,t,2,r);const o=3==(3&i);if(o){const l=n.preOrderCheckHooks;null!==l&&_u(e,l,null)}else{const l=n.preOrderHooks;null!==l&&yu(e,l,0,null),Hp(e,0)}if(function n5(n){for(let e=Ix(n);null!==e;e=wx(e)){if(!e[Dy])continue;const t=e[cu];for(let r=0;r<t.length;r++){IC(t[r])}}}(e),tO(e,2),null!==n.contentQueries&&Wk(n,e),o){const l=n.contentCheckHooks;null!==l&&_u(e,l)}else{const l=n.contentHooks;null!==l&&yu(e,l,1),Hp(e,1)}!function A6(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const r=Mk(e,pa);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)to(~s);else{const o=s,a=t[++i],u=t[++i];DC(a,o),r.dirty=!1;const l=md(r);try{u(2,e[o])}finally{bp(r,l)}}}}finally{null===e[pa]&&xk(e,pa),to(-1)}}(n,e);const a=n.components;null!==a&&rO(e,a,0);const u=n.viewQuery;if(null!==u&&z0(2,u,r),o){const l=n.viewCheckHooks;null!==l&&_u(e,l)}else{const l=n.viewHooks;null!==l&&yu(e,l,2),Hp(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[qe]&=-73,wd(e)}finally{jp()}}}function tO(n,e){for(let t=Ix(n);null!==t;t=wx(t))for(let r=br;r<t.length;r++)nO(t[r],e)}function r5(n,e,t){nO(wi(e,n),t)}function nO(n,e){if(!function Gy(n){return 128==(128&n[qe])}(n))return;const t=n[me],r=n[qe];if(80&r&&0===e||1024&r||2===e)eO(t,n,t.template,n[gn]);else if(n[da]>0){tO(n,1);const i=t.components;null!==i&&rO(n,i,1)}}function rO(n,e,t){for(let r=0;r<e.length;r++)r5(n,e[r],t)}class hg{get rootNodes(){const e=this._lView,t=e[me];return dg(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[gn]}set context(e){this._lView[gn]=e}get destroyed(){return 256==(256&this._lView[qe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[on];if(pr(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(Cv(e,r),fv(t,r))}this._attachedToViewContainer=!1}XC(this._lView[me],this._lView)}onDestroy(e){!function Td(n,e){if(256==(256&n[qe]))throw new L(911,!1);null===n[So]&&(n[So]=[]),n[So].push(e)}(this._lView,e)}markForCheck(){lg(this._cdRefInjectingView||this._lView)}detach(){this._lView[qe]&=-129}reattach(){this._lView[qe]|=128}detectChanges(){Wv(this._lView[me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new L(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function z3(n,e){tg(n,e,e[ze],2,null,null)}(this._lView[me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new L(902,!1);this._appRef=e}}class i5 extends hg{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Wv(e[me],e,e[gn],!1)}checkNoChanges(){}get context(){return null}}class iO extends ag{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=dt(e);return new fg(t,this.ngModule)}}function sO(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class o5{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=ed(r);const i=this.injector.get(e,R0,r);return i!==R0||t===R0?i:this.parentInjector.get(e,t,r)}}class fg extends ck{get inputs(){const e=this.componentDef,t=e.inputTransforms,r=sO(e.inputs);if(null!==t)for(const i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return sO(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ty(n){return n.map(pp).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=(i=i||this.ngModule)instanceof us?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new o5(e,s):e,a=o.get(ug,null);if(null===a)throw new L(407,!1);const f={rendererFactory:a,sanitizer:o.get(r6,null),effectManager:o.get(Xk,null),afterRenderEventManager:o.get(F0,null)},m=a.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",v=r?function R6(n,e,t,r){const s=r.get(Sk,!1)||t===Fi.ShadowDom,o=n.selectRootElement(e,s);return function P6(n){Bk(n)}(o),o}(m,r,this.componentDef.encapsulation,o):Tv(m,_,function s5(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(_)),k=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let P=null;null!==v&&(P=D0(v,o,!0));const O=j0(0,null,null,1,0,null,null,null,null,null,null),q=qv(null,O,null,k,null,null,f,m,o,null,P);let ue,Te;mu(q);try{const Ue=this.componentDef;let Pt,Ir=null;Ue.findHostDirectiveDefs?(Pt=[],Ir=new Map,Ue.findHostDirectiveDefs(Ue,Pt,Ir),Pt.push(Ue)):Pt=[Ue];const Yi=function u5(n,e){const t=n[me],r=at;return n[r]=e,eh(t,r,2,"#host",null)}(q,v),KT=function l5(n,e,t,r,i,s,o){const a=i[me];!function c5(n,e,t,r){for(const i of n)e.mergedAttrs=su(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Gv(e,e.mergedAttrs,!0),null!==t&&Lx(r,t,e))}(r,n,e,o);let u=null;null!==e&&(u=D0(e,i[bo]));const l=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const f=qv(i,Uk(t),null,d,i[n.index],n,s,l,null,null,u);return a.firstCreatePass&&H0(a,n,r.length-1),zv(i,f),i[n.index]=f}(Yi,v,Ue,Pt,q,f,m);Te=zy(O,at),v&&function h5(n,e,t,r){if(r)ap(n,t,["ng-version",hk.full]);else{const{attrs:i,classes:s}=function gp(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&e.push(s,n[++r]):8===i&&t.push(s);else{if(!Ei(i))break;i=s}r++}return{attrs:e,classes:t}}(e.selectors[0]);i&&ap(n,t,i),s&&s.length>0&&Fx(n,t,s.join(" "))}}(m,Ue,v,r),void 0!==t&&function f5(n,e,t){const r=n.projection=[];for(let i=0;i<e.length;i++){const s=t[i];r.push(null!=s?Array.from(s):null)}}(Te,this.ngContentSelectors,t),ue=function d5(n,e,t,r,i,s){const o=gr(),a=i[me],u=Hn(o,i);Hk(a,i,o,t,null,r);for(let d=0;d<t.length;d++)Xr(Mo(i,a,o.directiveStart+d,o),i);qk(a,i,o),u&&Xr(u,i);const l=Mo(i,a,o.directiveStart+o.componentOffset,o);if(n[gn]=i[gn]=l,null!==s)for(const d of s)d(l,e);return V0(a,o,n),l}(KT,Ue,Pt,Ir,q,[p5]),W0(O,q,null)}finally{jp()}return new a5(this.componentType,ue,Qd(Te,q),q,Te)}}class a5 extends Y9{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new i5(i),this.componentType=e}setInput(e,t){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;G0(s[me],s,i,e,t),this.previousInputValues.set(e,t),lg(wi(this._tNode.index,s))}}get injector(){return new Dr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function p5(){const n=gr();Sd(te()[me],n)}function qt(n){let e=function oO(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(xs(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new L(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);const o=n;o.inputs=Kv(n.inputs),o.inputTransforms=Kv(n.inputTransforms),o.declaredInputs=Kv(n.declaredInputs),o.outputs=Kv(n.outputs);const a=i.hostBindings;a&&y5(n,a);const u=i.viewQuery,l=i.contentQueries;if(u&&m5(n,u),l&&_5(n,l),Vt(n.inputs,i.inputs),Vt(n.declaredInputs,i.declaredInputs),Vt(n.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Vt(o.inputTransforms,i.inputTransforms)),xs(i)&&i.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===qt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function g5(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=su(i.hostAttrs,t=su(t,i.hostAttrs))}}(r)}function Kv(n){return n===Ps?{}:n===Dt?[]:n}function m5(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function _5(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,s)=>{e(r,i,s),t(r,i,s)}:e}function y5(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}function ei(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ji(n,e,t,r){const i=te();return ei(i,va(),e)&&(wt(),ko(mn(),i,n,e,t,r)),ji}function ti(n,e,t,r,i,s,o,a){const u=te(),l=wt(),d=n+at,f=l.firstCreatePass?function H5(n,e,t,r,i,s,o,a,u){const l=e.consts,d=eh(e,n,4,o||null,Po(l,a));$0(e,t,d,Po(l,u)),Sd(e,d);const f=d.tView=j0(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,l,u,e,t,r,i,s,o):l.data[d];Os(f,!1);const m=TO(l,u,f,n);Ad()&&Dv(l,u,m,f),Xr(m,u),zv(u,u[d]=Gk(m,u,m,f)),Ip(f)&&U0(l,u,f),null!=o&&B0(u,f,a)}let TO=function CO(n,e,t,r){return No(!0),e[ze].createComment("")};function Fn(n,e,t){const r=te();return ei(r,va(),e)&&cs(wt(),mn(),r,n,e,r[ze],t,!1),Fn}function eb(n,e,t,r,i){const o=i?"class":"style";G0(n,t,e.inputs[o],o,r)}function mt(n,e,t,r){const i=te(),s=wt(),o=at+n,a=i[ze],u=s.firstCreatePass?function K5(n,e,t,r,i,s){const o=e.consts,u=eh(e,n,2,r,Po(o,i));return $0(e,t,u,Po(o,s)),null!==u.attrs&&Gv(u,u.attrs,!1),null!==u.mergedAttrs&&Gv(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,t,r):s.data[o],l=bO(s,i,u,a,e,n);i[o]=l;const d=Ip(u);return Os(u,!0),Lx(a,l,u),32!=(32&u.flags)&&Ad()&&Dv(s,i,l,u),0===function wC(){return Be.lFrame.elementDepthCount}()&&Xr(l,i),function kp(){Be.lFrame.elementDepthCount++}(),d&&(U0(s,i,u),V0(s,u,i)),null!==r&&B0(i,u),mt}function At(){let n=gr();xl()?kl():(n=n.parent,Os(n,!1));const e=n;(function Ky(n){return Be.skipHydrationRootTNode===n})(e)&&function CC(){Be.skipHydrationRootTNode=null}(),function Op(){Be.lFrame.elementDepthCount--}();const t=wt();return t.firstCreatePass&&(Sd(t,n),Ep(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Pd(n){return 0!=(8&n.flags)}(e)&&eb(t,e,te(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function lv(n){return 0!=(16&n.flags)}(e)&&eb(t,e,te(),e.stylesWithoutHost,!1),At}function Br(n,e,t,r){return mt(n,e,t,r),At(),Br}let bO=(n,e,t,r,i,s)=>(No(!0),Tv(r,i,function $p(){return Be.lFrame.currentNamespace}()));function yg(n,e,t){const r=te(),i=wt(),s=n+at,o=i.firstCreatePass?function Y5(n,e,t,r,i){const s=e.consts,o=Po(s,r),a=eh(e,n,8,"ng-container",o);return null!==o&&Gv(a,o,!0),$0(e,t,a,Po(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,r,e,t):i.data[s];Os(o,!0);const a=AO(i,r,o,n);return r[s]=a,Ad()&&Dv(i,r,a,o),Xr(a,r),Ip(o)&&(U0(i,r,o),V0(i,o,r)),null!=t&&B0(r,o),yg}function vg(){let n=gr();const e=wt();return xl()?kl():(n=n.parent,Os(n,!1)),e.firstCreatePass&&(Sd(e,n),Ep(n)&&e.queries.elementEnd(n)),vg}let AO=(n,e,t,r)=>(No(!0),YC(e[ze],""));function tb(){return te()}function Eg(n){return!!n&&"function"==typeof n.then}function SO(n){return!!n&&"function"==typeof n.subscribe}function ar(n,e,t,r){const i=te(),s=wt(),o=gr();return function PO(n,e,t,r,i,s,o){const a=Ip(r),l=n.firstCreatePass&&function Zk(n){return n.cleanup||(n.cleanup=[])}(n),d=e[gn],f=function Kk(n){return n[au]||(n[au]=[])}(e);let m=!0;if(3&r.type||o){const T=Hn(r,e),D=o?o(T):T,k=f.length,P=o?q=>o(Kt(q[r.index])):r.index;let O=null;if(!o&&a&&(O=function e8(n,e,t,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===r){const a=e[au],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(n,e,i,r.index)),null!==O)(O.__ngLastListenerFn__||O).__ngNextListenerFn__=s,O.__ngLastListenerFn__=s,m=!1;else{s=MO(r,e,d,s,!1);const q=t.listen(D,i,s);f.push(s,q),l&&l.push(i,P,k,k+1)}}else s=MO(r,e,d,s,!1);const _=r.outputs;let v;if(m&&null!==_&&(v=_[i])){const T=v.length;if(T)for(let D=0;D<T;D+=2){const ue=e[v[D]][v[D+1]].subscribe(s),Te=f.length;f.push(s,ue),l&&l.push(i,r.index,Te,-(Te+1))}}}(s,i,i[ze],o,n,e,r),ar}function NO(n,e,t,r){try{return Ui(6,e,t),!1!==t(r)}catch(i){return Yk(n,i),!1}finally{Ui(7,e,t)}}function MO(n,e,t,r,i){return function s(o){if(o===Function)return r;lg(n.componentOffset>-1?wi(n.index,e):e);let u=NO(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)u=NO(e,t,l,o)&&u,l=l.__ngNextListenerFn__;return i&&!1===u&&o.preventDefault(),u}}function ds(n=1){return function SC(n){return(Be.lFrame.contextLView=function RC(n,e){for(;n>0;)e=e[Ao],n--;return e}(n,Be.lFrame.contextLView))[gn]}(n)}function eE(n,e){return n<<17|e<<2}function Tu(n){return n>>17&32767}function rb(n){return 2|n}function ql(n){return(131068&n)>>2}function ib(n,e){return-131069&n|e<<2}function sb(n){return 1|n}function $O(n,e,t,r,i){const s=n[t+1],o=null===e;let a=r?Tu(s):ql(s),u=!1;for(;0!==a&&(!1===u||o);){const d=n[a+1];l8(n[a],e)&&(u=!0,n[a+1]=r?sb(d):rb(d)),a=r?Tu(d):ql(d)}u&&(n[t+1]=r?rb(s):sb(s))}function l8(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Bd(n,e)>=0}const _r={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function HO(n){return n.substring(_r.key,_r.keyEnd)}function qO(n,e){const t=_r.textEnd;return t===e?-1:(e=_r.keyEnd=function f8(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,_r.key=e,t),ch(n,e,t))}function ch(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function dh(n,e,t){return ro(n,e,t,!1),dh}function tE(n,e){return ro(n,e,null,!0),tE}function Da(n){!function io(n,e,t,r){const i=wt(),s=eo(2);i.firstUpdatePass&&QO(i,null,s,r);const o=te();if(t!==Qe&&ei(o,s,t)){const a=i.data[Vr()];if(e1(a,r)&&!ZO(i,s)){let u=r?a.classesWithoutHost:a.stylesWithoutHost;null!==u&&(t=or(u,t||"")),eb(i,a,o,t,r)}else!function T8(n,e,t,r,i,s,o,a){i===Qe&&(i=Dt);let u=0,l=0,d=0<i.length?i[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const m=u<i.length?i[u+1]:void 0,_=l<s.length?s[l+1]:void 0;let T,v=null;d===f?(u+=2,l+=2,m!==_&&(v=f,T=_)):null===f||null!==d&&d<f?(u+=2,v=d):(l+=2,v=f,T=_),null!==v&&XO(n,e,t,r,v,T,o,a),d=u<i.length?i[u]:null,f=l<s.length?s[l]:null}}(i,a,o,o[ze],o[s+1],o[s+1]=function I8(n,e,t){if(null==t||""===t)return Dt;const r=[],i=os(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)n(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&n(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(n,e,t),r,s)}}(w8,Lo,n,!0)}function Lo(n,e){for(let t=function d8(n){return function GO(n){_r.key=0,_r.keyEnd=0,_r.value=0,_r.valueEnd=0,_r.textEnd=n.length}(n),qO(n,ch(n,0,_r.textEnd))}(e);t>=0;t=qO(e,t))ss(n,HO(e),!0)}function ro(n,e,t,r){const i=te(),s=wt(),o=eo(2);s.firstUpdatePass&&QO(s,n,o,r),e!==Qe&&ei(i,o,e)&&XO(s,s.data[Vr()],i,i[ze],n,i[o+1]=function C8(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Re(os(n)))),n}(e,t),r,o)}function ZO(n,e){return e>=n.expandoStartIndex}function QO(n,e,t,r){const i=n.data;if(null===i[t+1]){const s=i[Vr()],o=ZO(n,t);e1(s,r)&&null===e&&!o&&(e=!1),e=function _8(n,e,t,r){const i=Ol(n);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=Ig(t=ob(null,n,e,t,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==i)if(t=ob(i,n,e,t,r),null===s){let u=function y8(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==ql(r))return n[Tu(r)]}(n,e,r);void 0!==u&&Array.isArray(u)&&(u=ob(null,n,e,u[1],r),u=Ig(u,e.attrs,r),function v8(n,e,t,r){n[Tu(t?e.classBindings:e.styleBindings)]=r}(n,e,r,u))}else s=function E8(n,e,t){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Ig(r,n[s].hostAttrs,t);return Ig(r,e.attrs,t)}(n,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,r),function a8(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Tu(o),u=ql(o);n[r]=t;let d,l=!1;if(Array.isArray(t)?(d=t[1],(null===d||Bd(t,d)>0)&&(l=!0)):d=t,i)if(0!==u){const m=Tu(n[a+1]);n[r+1]=eE(m,a),0!==m&&(n[m+1]=ib(n[m+1],r)),n[a+1]=function s8(n,e){return 131071&n|e<<17}(n[a+1],r)}else n[r+1]=eE(a,0),0!==a&&(n[a+1]=ib(n[a+1],r)),a=r;else n[r+1]=eE(u,0),0===a?a=r:n[u+1]=ib(n[u+1],r),u=r;l&&(n[r+1]=rb(n[r+1])),$O(n,d,r,!0),$O(n,d,r,!1),function u8(n,e,t,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Bd(s,e)>=0&&(t[r+1]=sb(t[r+1]))}(e,d,n,r,s),o=eE(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,r)}}function ob(n,e,t,r,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],r=Ig(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),r}function Ig(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ss(n,o,!!t||e[++s]))}return void 0===n?null:n}function w8(n,e,t){const r=String(e);""!==r&&!r.includes(" ")&&ss(n,r,t)}function XO(n,e,t,r,i,s,o,a){if(!(3&e.type))return;const u=n.data,l=u[a+1],d=function o8(n){return 1==(1&n)}(l)?JO(u,e,t,i,ql(l),o):void 0;nE(d)||(nE(s)||function i8(n){return 2==(2&n)}(l)&&(s=JO(u,null,t,i,a,o)),function t9(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=-1===r.indexOf("-")?void 0:wu.DashCase;null==i?n.removeStyle(t,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=wu.Important),n.setStyle(t,r,i,s))}}(r,o,Ed(Vr(),t),i,s))}function JO(n,e,t,r,i,s){const o=null===e;let a;for(;i>0;){const u=n[i],l=Array.isArray(u),d=l?u[1]:u,f=null===d;let m=t[i+1];m===Qe&&(m=f?Dt:void 0);let _=f?jC(m,r):d===r?m:void 0;if(l&&!nE(_)&&(_=jC(u,r)),nE(_)&&(a=_,o))return a;const v=n[i+1];i=o?Tu(v):ql(v)}if(null!==e){let u=s?e.residualClasses:e.residualStyles;null!=u&&(a=jC(u,r))}return a}function nE(n){return void 0!==n}function e1(n,e){return 0!=(n.flags&(e?8:16))}function Bt(n,e=""){const t=te(),r=wt(),i=n+at,s=r.firstCreatePass?eh(r,i,1,e,null):r.data[i],o=t1(r,t,s,e,n);t[i]=o,Ad()&&Dv(r,t,o,s),Os(s,!1)}let t1=(n,e,t,r,i)=>(No(!0),function wv(n,e){return n.createText(e)}(e[ze],r));function Aa(n,e,t){const r=te(),i=function nh(n,e,t,r){return ei(n,va(),t)?e+Ce(t)+r:Qe}(r,n,e,t);return i!==Qe&&function ba(n,e,t){const r=Ed(e,n);!function Cx(n,e,t){n.setValue(e,t)}(n[ze],r,t)}(r,Vr(),i),Aa}function ab(n,e,t){const r=te();if(ei(r,va(),e)){const s=wt(),o=mn();cs(s,o,r,n,e,Qk(Ol(s.data),o,r),t,!0)}return ab}const fh="en-US";let T1=fh;function cb(n,e,t,r,i){if(n=x(n),Array.isArray(n))for(let s=0;s<n.length;s++)cb(n[s],e,t,r,i);else{const s=wt(),o=te(),a=gr();let u=$l(n)?n:x(n.provide);const l=rk(n),d=1048575&a.providerIndexes,f=a.directiveStart,m=a.providerIndexes>>20;if($l(n)||!n.multi){const _=new Ea(l,i,J),v=hb(u,e,i?d:d+m,f);-1===v?(Ee(w(a,o),s,u),db(s,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[v]=_,o[v]=_)}else{const _=hb(u,e,d+m,f),v=hb(u,e,d,d+m),D=v>=0&&t[v];if(i&&!D||!i&&!(_>=0&&t[_])){Ee(w(a,o),s,u);const k=function zK(n,e,t,r,i){const s=new Ea(n,t,J);return s.multi=[],s.index=e,s.componentProviders=0,K1(s,i,r&&!t),s}(i?qK:HK,t.length,i,r,l);!i&&D&&(t[v].providerFactory=k),db(s,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(k),o.push(k)}else db(s,n,_>-1?_:v,K1(t[i?v:_],l,!i&&r));!i&&r&&D&&t[v].componentProviders++}}}function db(n,e,t,r){const i=$l(e),s=function k9(n){return!!n.useClass}(e);if(i||s){const u=(s?x(e.useClass):e).prototype.ngOnDestroy;if(u){const l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const d=l.indexOf(t);-1===d?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function K1(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function hb(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function HK(n,e,t,r){return fb(this.multi,[])}function qK(n,e,t,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Mo(t,t[me],this.providerFactory.index,r);s=a.slice(0,o),fb(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],fb(i,s);return s}function fb(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function An(n,e=[]){return t=>{t.providersResolver=(r,i)=>function $K(n,e,t){const r=wt();if(r.firstCreatePass){const i=xs(n);cb(t,r.data,r.blueprint,i,!0),cb(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}class Gl{}class Z1{}class pb extends Gl{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new iO(this);const i=Fr(e);this._bootstrapComponents=Ca(i.bootstrap),this._r3Injector=_k(e,t,[{provide:Gl,useValue:this},{provide:ag,useValue:this.componentFactoryResolver},...r],Re(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class gb extends Z1{constructor(e){super(),this.moduleType=e}create(e){return new pb(this.moduleType,e,[])}}class Q1 extends Gl{constructor(e){super(),this.componentFactoryResolver=new iO(this),this.instance=null;const t=new Gd([...e.providers,{provide:Gl,useValue:this},{provide:ag,useValue:this.componentFactoryResolver}],e.parent||Ov(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function mb(n,e,t=null){return new Q1({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let KK=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=Jx(0,t.type),i=r.length>0?mb([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ye({token:n,providedIn:"environment",factory:()=>new n(W(us))})}return n})();function aE(n){n.getStandaloneInjector=e=>e.get(KK).getOrCreateStandaloneInjector(n)}function wZ(n,e,t,r=!0){const i=e[me];if(function W3(n,e,t,r){const i=br+r,s=t.length;r>0&&(t[i-1][is]=e),r<s-br?(e[is]=t[i],ex(t,br+r,e)):(t.push(e),e[is]=null),e[on]=t;const o=e[fa];null!==o&&t!==o&&function K3(n,e){const t=n[cu];e[kn]!==e[on][on][kn]&&(n[Dy]=!0),null===t?n[cu]=[e]:t.push(e)}(o,e);const a=e[Li];null!==a&&a.insertView(n),e[qe]|=128}(i,e,n,t),r){const s=n0(t,n),o=e[ze],a=bv(o,n[Ms]);null!==a&&function q3(n,e,t,r,i,s){r[sn]=i,r[Cr]=e,tg(n,r,t,1,i,s)}(i,n[Cr],o,e,a,s)}}Symbol;let Sa=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=bZ}return n})();const TZ=Sa,CZ=class extends TZ{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){const i=function IZ(n,e,t,r){const i=e.tView,a=qv(n,i,t,4096&n[qe]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[fa]=n[e.index];const l=n[Li];return null!==l&&(a[Li]=l.createEmbeddedView(i)),W0(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:r});return new hg(i)}};function bZ(){return function uE(n,e){return 4&n.type?new CZ(e,n,Qd(n,e)):null}(gr(),te())}let so=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=NZ}return n})();function NZ(){return function pF(n,e){let t;const r=e[n.index];return pr(r)?t=r:(t=Gk(r,e,null,n),e[n.index]=t,zv(e,t)),gF(t,e,n,r),new hF(t,n,e)}(gr(),te())}const MZ=so,hF=class extends MZ{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Qd(this._hostTNode,this._hostLView)}get injector(){return new Dr(this._hostTNode,this._hostLView)}get parentInjector(){const e=re(this._hostTNode,this._hostLView);if(qp(e)){const t=Vl(e,this._hostLView),r=Ll(e);return new Dr(t[me].data[r+8],t)}return new Dr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=fF(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-br}createEmbeddedView(e,t,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,r,i,s){const o=e&&!function Kp(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const T=t||{};a=T.index,r=T.injector,i=T.projectableNodes,s=T.environmentInjector||T.ngModuleRef}const u=o?e:new fg(dt(e)),l=r||this.parentInjector;if(!s&&null==u.ngModule){const D=(o?l:this.parentInjector).get(us,null);D&&(s=D)}dt(u.componentType??{});const _=u.create(l,i,null,s);return this.insertImpl(_.hostView,a,false),_}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,r){const i=e._lView;if(function EC(n){return pr(n[on])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const l=i[on],d=new hF(l,l[Cr],l[on]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return wZ(a,i,o,!r),e.attachToViewContainerRef(),ex(vb(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=fF(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=Cv(this._lContainer,t);r&&(fv(vb(this._lContainer),t),XC(r[me],r))}detach(e){const t=this._adjustIndex(e,-1),r=Cv(this._lContainer,t);return r&&null!=fv(vb(this._lContainer),t)?new hg(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function fF(n){return n[8]}function vb(n){return n[8]||(n[8]=[])}let gF=function mF(n,e,t,r){if(n[Ms])return;let i;i=8&t.type?Kt(r):function xZ(n,e){const t=n[ze],r=t.createComment(""),i=Hn(e,n);return Bl(t,bv(t,i),r,function X3(n,e){return n.nextSibling(e)}(t,i),!1),r}(e,t),n[Ms]=i};const Pb=new le("Application Initializer");let Nb=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=pe(Pb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const i of this.appInits){const s=i();if(Eg(s))t.push(s);else if(SO(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});t.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jF=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Ra=new le("LocaleId",{providedIn:"root",factory:()=>pe(Ra,rt.Optional|rt.SkipSelf)||function c7(){return typeof $localize<"u"&&$localize.locale||fh}()});let dE=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new E(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class f7{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let $F=(()=>{class n{compileModuleSync(t){return new gb(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),s=Ca(Fr(t).declarations).reduce((o,a)=>{const u=dt(a);return u&&o.push(new fg(u)),o},[]);return new f7(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const GF=new le(""),fE=new le("");let Fb,kb=(()=>{class n{constructor(t,r,i){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Fb||(function O7(n){Fb=n}(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Tt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||n)(W(Tt),W(Ob),W(fE))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),Ob=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Fb?.findTestabilityInTree(this,t,r)??null}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Cu=null;const WF=new le("AllowMultipleToken"),Lb=new le("PlatformDestroyListeners"),Vb=new le("appBootstrapListener");class ZF{constructor(e,t){this.name=e,this.token=t}}function YF(n,e,t=[]){const r=`Platform: ${e}`,i=new le(r);return(s=[])=>{let o=Ub();if(!o||o.injector.get(WF,!1)){const a=[...t,...s,{provide:i,useValue:!0}];n?n(a):function V7(n){if(Cu&&!Cu.get(WF,!1))throw new L(400,!1);(function KF(){!function dC(n){cC=n}(()=>{throw new L(600,!1)})})(),Cu=n;const e=n.get(JF);(function QF(n){n.get(ik,null)?.forEach(t=>t())})(n)}(function XF(n=[],e){return Jr.create({name:e,providers:[{provide:g0,useValue:"platform"},{provide:Lb,useValue:new Set([()=>Cu=null])},...n]})}(a,r))}return function B7(n){const e=Ub();if(!e)throw new L(401,!1);return e}()}}function Ub(){return Cu?.get(JF)??null}let JF=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const i=function j7(n="zone.js",e){return"noop"===n?new g6:"zone.js"===n?new Tt(e):n}(r?.ngZone,function eL(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function WK(n,e,t){return new pb(n,e,t)}(t.moduleType,this.injector,function sL(n){return[{provide:Tt,useFactory:n},{provide:ig,multi:!0,useFactory:()=>{const e=pe(H7,{optional:!0});return()=>e.initialize()}},{provide:iL,useFactory:$7},{provide:wk,useFactory:Tk}]}(()=>i)),o=s.injector.get(Ta,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:u=>{o.handleError(u)}});s.onDestroy(()=>{pE(this._modules,s),a.unsubscribe()})}),function tL(n,e,t){try{const r=t();return Eg(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(Nb);return a.runInitializers(),a.donePromise.then(()=>(function C1(n){wr(n,"Expected localeId to be defined"),"string"==typeof n&&(T1=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ra,fh)||fh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,r=[]){const i=nL({},r);return function F7(n,e,t){const r=new gb(t);return Promise.resolve(r)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){const r=t.injector.get(Pa);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new L(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new L(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(Lb,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||n)(W(Jr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function nL(n,e){return Array.isArray(e)?e.reduce(nL,n):{...n,...e}}let Pa=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=pe(iL),this.zoneIsStable=pe(wk),this.componentTypes=[],this.components=[],this.isStable=pe(dE).hasPendingTasks.pipe(ve(t=>t?R(!1):this.zoneIsStable),Fe(),K()),this._injector=pe(us)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const i=t instanceof ck;if(!this._injector.get(Nb).done)throw!i&&function ou(n){const e=dt(n)||hr(n)||fr(n);return null!==e&&e.standalone}(t),new L(405,!1);let o;o=i?t:this._injector.get(ag).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function L7(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Gl),l=o.create(Jr.NULL,[],r||o.selector,a),d=l.location.nativeElement,f=l.injector.get(GF,null);return f?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),pE(this.components,l),f?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new L(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;pE(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(Vb,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>pE(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new L(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const iL=new le("",{providedIn:"root",factory:()=>pe(Ta).handleError.bind(void 0)});function $7(){const n=pe(Tt),e=pe(Ta);return t=>n.runOutsideAngular(()=>e.handleError(t))}let H7=(()=>{class n{constructor(){this.zone=pe(Tt),this.applicationRef=pe(Pa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let gE=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=z7}return n})();function z7(n){return function G7(n,e,t){if(ga(n)&&!t){const r=wi(n.index,e);return new hg(r,r)}return 47&n.type?new hg(e[kn],e):null}(gr(),te(),16==(16&n))}const sQ=YF(null,"core",[]);let oQ=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(r){return new(r||n)(W(Pa))};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({})}return n})(),zb=null;function bu(){return zb}class EQ{}const yr=new le("DocumentToken");let Gb=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(wQ)},providedIn:"platform"})}return n})();const IQ=new le("Location Initialized");let wQ=(()=>{class n extends Gb{constructor(){super(),this._doc=pe(yr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return bu().getBaseHref(this._doc)}onPopState(t){const r=bu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=bu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function Wb(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function CL(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Na(n){return n&&"?"!==n[0]?"?"+n:n}let Kl=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(DL)},providedIn:"root"})}return n})();const bL=new le("appBaseHref");let DL=(()=>{class n extends Kl{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??pe(yr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Wb(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Na(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){const o=this.prepareExternalUrl(i+Na(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){const o=this.prepareExternalUrl(i+Na(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(Gb),W(bL,8))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),TQ=(()=>{class n extends Kl{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Wb(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Na(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Na(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(Gb),W(bL,8))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),Kb=(()=>{class n{constructor(t){this._subject=new qn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function DQ(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(CL(AL(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Na(r))}normalize(t){return n.stripTrailingSlash(function bQ(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,AL(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Na(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Na(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static#e=this.normalizeQueryParams=Na;static#t=this.joinWithSlash=Wb;static#n=this.stripTrailingSlash=CL;static#r=this.\u0275fac=function(r){return new(r||n)(W(Kl))};static#i=this.\u0275prov=ye({token:n,factory:function(){return function CQ(){return new Kb(W(Kl))}()},providedIn:"root"})}return n})();function AL(n){return n.replace(/\/index.html$/,"")}function FL(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,s]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}let PE=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new pY,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){BL("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){BL("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static#e=this.\u0275fac=function(r){return new(r||n)(J(so),J(Sa))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class pY{constructor(){this.$implicit=null,this.ngIf=null}}function BL(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Re(e)}'.`)}let UY=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({})}return n})();function NE(n){return"server"===n}let HY=(()=>{class n{static#e=this.\u0275prov=ye({token:n,providedIn:"root",factory:()=>new qY(W(yr),window)})}return n})();class qY{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function zY(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class qL{}class pX extends EQ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class dD extends pX{static makeCurrent(){!function vQ(n){zb||(zb=n)}(new dD)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function gX(){return Og=Og||document.querySelector("base"),Og?Og.getAttribute("href"):null}();return null==t?null:function mX(n){kE=kE||document.createElement("a"),kE.setAttribute("href",n);const e=kE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Og=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return FL(document.cookie,e)}}let kE,Og=null,yX=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const hD=new le("EventManagerPlugins");let ZL=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new L(5101,!1);return this._eventNameToPlugin.set(t,r),r}static#e=this.\u0275fac=function(r){return new(r||n)(W(hD),W(Tt))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class QL{constructor(e){this._doc=e}}const fD="ng-app-id";let YL=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=NE(s),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${fD}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){const i=this.styleRef;if(i.has(t)){const s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(fD),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(fD,this.appId),o}}addStyleToHost(t,r){const i=this.getStyleElement(t,r);t.appendChild(i);const s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(Fv),W(ok,8),W(Vs))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const pD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},gD=/%COMP%/g,wX=new le("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function JL(n,e){return e.map(t=>t.replace(gD,n))}let mD=(()=>{class n{constructor(t,r,i,s,o,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=NE(a),this.defaultRenderer=new _D(t,o,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Fi.ShadowDom&&(r={...r,encapsulation:Fi.Emulated});const i=this.getOrCreateRenderer(t,r);return i instanceof tV?i.applyToHost(t):i instanceof yD&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Fi.Emulated:s=new tV(u,l,r,this.appId,d,o,a,f);break;case Fi.ShadowDom:return new DX(u,l,t,r,o,a,this.nonce,f);default:s=new yD(u,l,r,d,o,a,f)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||n)(W(ZL),W(YL),W(Fv),W(wX),W(yr),W(Vs),W(Tt),W(ok))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class _D{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(pD[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(eV(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(eV(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new L(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const s=pD[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=pD[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(wu.DashCase|wu.Important)?e.style.setProperty(t,r,i&wu.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&wu.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){if("string"==typeof e&&!(e=bu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function eV(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class DX extends _D{constructor(e,t,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=JL(i.id,i.styles);for(const d of l){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class yD extends _D{constructor(e,t,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?JL(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class tV extends yD{constructor(e,t,r,i,s,o,a,u){const l=i+"-"+r.id;super(e,t,r,s,o,a,u,l),this.contentAttr=function TX(n){return"_ngcontent-%COMP%".replace(gD,n)}(l),this.hostAttr=function CX(n){return"_nghost-%COMP%".replace(gD,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let AX=(()=>{class n extends QL{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const nV=["alt","control","meta","shift"],SX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},RX={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let PX=(()=>{class n extends QL{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bu().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),nV.forEach(l=>{const d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=SX[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),nV.forEach(o=>{o!==i&&(0,RX[o])(t)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const iV=[{provide:Vs,useValue:"browser"},{provide:ik,useValue:function NX(){dD.makeCurrent()},multi:!0},{provide:yr,useFactory:function xX(){return function o9(n){o0=n}(document),document},deps:[]}],kX=YF(sQ,"browser",iV),OX=new le(""),sV=[{provide:fE,useClass:class _X{addToWindow(e){Ut.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new L(5103,!1);return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements(),Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(r=>{const i=Ut.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(u=>{u.whenStable(a)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?bu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:GF,useClass:kb,deps:[Tt,Ob,fE]},{provide:kb,useClass:kb,deps:[Tt,Ob,fE]}],oV=[{provide:g0,useValue:"root"},{provide:Ta,useFactory:function MX(){return new Ta},deps:[]},{provide:hD,useClass:AX,multi:!0,deps:[yr,Tt,Vs]},{provide:hD,useClass:PX,multi:!0,deps:[yr]},mD,YL,ZL,{provide:ug,useExisting:mD},{provide:qL,useClass:yX,deps:[]},[]];let aV=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Fv,useValue:t.appId}]}}static#e=this.\u0275fac=function(r){return new(r||n)(W(OX,12))};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({providers:[...oV,...sV],imports:[UY,oQ]})}return n})(),uV=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new r:function LX(){return new uV(W(yr))}(),i},providedIn:"root"})}return n})();typeof window<"u"&&window;let dV=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new(r||n):W(hV),i},providedIn:"root"})}return n})(),hV=(()=>{class n extends dV{constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case as.NONE:return r;case as.HTML:return xo(r,"HTML")?os(r):Wx(this._doc,String(r)).toString();case as.STYLE:return xo(r,"Style")?os(r):r;case as.SCRIPT:if(xo(r,"Script"))return os(r);throw new L(5200,!1);case as.URL:return xo(r,"URL")?os(r):Pv(String(r));case as.RESOURCE_URL:if(xo(r,"ResourceURL"))return os(r);throw new L(5201,!1);default:throw new L(5202,!1)}}bypassSecurityTrustHtml(t){return function f9(n){return new a9(n)}(t)}bypassSecurityTrustStyle(t){return function p9(n){return new u9(n)}(t)}bypassSecurityTrustScript(t){return function g9(n){return new l9(n)}(t)}bypassSecurityTrustUrl(t){return function m9(n){return new c9(n)}(t)}bypassSecurityTrustResourceUrl(t){return function _9(n){return new d9(n)}(t)}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr))};static#t=this.\u0275prov=ye({token:n,factory:function(r){let i=null;return i=r?new r:function jX(n){return new hV(n.get(yr))}(W(Jr)),i},providedIn:"root"})}return n})();const{isArray:$X}=Array,{getPrototypeOf:HX,prototype:qX,keys:zX}=Object;function pV(n){if(1===n.length){const e=n[0];if($X(e))return{args:e,keys:null};if(function GX(n){return n&&"object"==typeof n&&HX(n)===qX}(e)){const t=zX(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}const{isArray:WX}=Array;function gV(n){return de(e=>function KX(n,e){return WX(e)?n(...e):n(e)}(n,e))}function mV(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}let _V=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(r){return new(r||n)(J(wa),J(ls))};static#t=this.\u0275dir=Ve({type:n})}return n})(),Zl=(()=>{class n extends _V{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=Jn(n)))(i||n)}}();static#t=this.\u0275dir=Ve({type:n,features:[qt]})}return n})();const Vo=new le("NgValueAccessor"),YX={provide:Vo,useExisting:U(()=>Fg),multi:!0},JX=new le("CompositionEventMode");let Fg=(()=>{class n extends _V{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function XX(){const n=bu()?bu().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(r){return new(r||n)(J(wa),J(ls),J(JX,8))};static#t=this.\u0275dir=Ve({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&ar("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[An([YX]),qt]})}return n})();function Au(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function vV(n){return null!=n&&"number"==typeof n.length}const ni=new le("NgValidators"),Su=new le("NgAsyncValidators"),eJ=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ka{static min(e){return function EV(n){return e=>{if(Au(e.value)||Au(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function IV(n){return e=>{if(Au(e.value)||Au(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function wV(n){return Au(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function TV(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function CV(n){return Au(n.value)||eJ.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function bV(n){return e=>Au(e.value)||!vV(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function DV(n){return e=>vV(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function AV(n){if(!n)return OE;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Au(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return xV(e)}static composeAsync(e){return kV(e)}}function OE(n){return null}function SV(n){return null!=n}function RV(n){return Eg(n)?I(n):n}function PV(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function NV(n,e){return e.map(t=>t(n))}function MV(n){return n.map(e=>function tJ(n){return!n.validate}(e)?e:t=>e.validate(t))}function xV(n){if(!n)return null;const e=n.filter(SV);return 0==e.length?null:function(t){return PV(NV(t,e))}}function ED(n){return null!=n?xV(MV(n)):null}function kV(n){if(!n)return null;const e=n.filter(SV);return 0==e.length?null:function(t){return function ZX(...n){const e=Oi(n),{args:t,keys:r}=pV(n),i=new Ze(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let u=o,l=o;for(let d=0;d<o;d++){let f=!1;gt(t[d]).subscribe(ce(s,m=>{f||(f=!0,l--),a[d]=m},()=>u--,void 0,()=>{(!u||!f)&&(l||s.next(r?mV(r,a):a),s.complete())}))}});return e?i.pipe(gV(e)):i}(NV(t,e).map(RV)).pipe(de(PV))}}function ID(n){return null!=n?kV(MV(n)):null}function OV(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function FV(n){return n._rawValidators}function LV(n){return n._rawAsyncValidators}function wD(n){return n?Array.isArray(n)?n:[n]:[]}function FE(n,e){return Array.isArray(n)?n.includes(e):n===e}function VV(n,e){const t=wD(e);return wD(n).forEach(i=>{FE(t,i)||t.push(i)}),t}function UV(n,e){return wD(e).filter(t=>!FE(n,t))}class BV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=ED(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ID(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Di extends BV{get formDirective(){return null}get path(){return null}}class Ru extends BV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class jV{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let TD=(()=>{class n extends jV{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||n)(J(Ru,2))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&tE("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[qt]})}return n})(),CD=(()=>{class n extends jV{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||n)(J(Di,10))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&tE("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[qt]})}return n})();const Lg="VALID",VE="INVALID",yh="PENDING",Vg="DISABLED";function AD(n){return(UE(n)?n.validators:n)||null}function SD(n,e){return(UE(e)?e.asyncValidators:n)||null}function UE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function HV(n,e,t){const r=n.controls;if(!(e?Object.keys(r):r).length)throw new L(1e3,"");if(!r[t])throw new L(1001,"")}function qV(n,e,t){n._forEachChild((r,i)=>{if(void 0===t[i])throw new L(1002,"")})}class BE{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Lg}get invalid(){return this.status===VE}get pending(){return this.status==yh}get disabled(){return this.status===Vg}get enabled(){return this.status!==Vg}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(VV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(VV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(UV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(UV(e,this._rawAsyncValidators))}hasValidator(e){return FE(this._rawValidators,e)}hasAsyncValidator(e){return FE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=yh,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Vg,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Lg,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Lg||this.status===yh)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Vg:Lg}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=yh,this._hasOwnPendingAsyncValidator=!0;const t=RV(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new qn,this.statusChanges=new qn}_calculateStatus(){return this._allControlsDisabled()?Vg:this.errors?VE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yh)?yh:this._anyControlsHaveStatus(VE)?VE:Lg}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){UE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function sJ(n){return Array.isArray(n)?ED(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function oJ(n){return Array.isArray(n)?ID(n):n||null}(this._rawAsyncValidators)}}class Ug extends BE{constructor(e,t,r){super(AD(t),SD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){qV(this,0,e),Object.keys(e).forEach(r=>{HV(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class zV extends Ug{}const Ql=new le("CallSetDisabledState",{providedIn:"root",factory:()=>Bg}),Bg="always";function jg(n,e,t=Bg){RD(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function uJ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&GV(n,e)})}(n,e),function cJ(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function lJ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&GV(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function aJ(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function $E(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),qE(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function HE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function RD(n,e){const t=FV(n);null!==e.validator?n.setValidators(OV(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=LV(n);null!==e.asyncValidator?n.setAsyncValidators(OV(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();HE(e._rawValidators,i),HE(e._rawAsyncValidators,i)}function qE(n,e){let t=!1;if(null!==n){if(null!==e.validator){const i=FV(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const i=LV(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}const r=()=>{};return HE(e._rawValidators,r),HE(e._rawAsyncValidators,r),t}function GV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function ZV(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function QV(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Hg=class extends BE{constructor(e=null,t,r){super(AD(t),SD(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),UE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=QV(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){ZV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){ZV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){QV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};let kD=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275dir=Ve({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return n})(),n2=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({})}return n})();const OD=new le("NgModelWithFormControlWarning"),CJ={provide:Di,useExisting:U(()=>qg)};let qg=(()=>{class n extends Di{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new qn,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(qE(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return jg(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){$E(t.control||null,t,!1),function pJ(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,function KV(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,i=this.form.get(t.path);r!==i&&($E(r||null,t),(n=>n instanceof Hg)(i)&&(jg(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);(function WV(n,e){RD(n,e)})(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function dJ(n,e){return qE(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){RD(this.form,this),this._oldForm&&qE(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(r){return new(r||n)(J(ni,10),J(Su,10),J(Ql,8))};static#t=this.\u0275dir=Ve({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&ar("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[An([CJ]),qt,Vi]})}return n})();const AJ={provide:Ru,useExisting:U(()=>zE)};let zE=(()=>{class n extends Ru{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new qn,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function MD(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===Fg?t=s:function fJ(n){return Object.getPrototypeOf(n.constructor)===Zl}(s)?r=s:i=s}),i||r||t||null}(0,s)}ngOnChanges(t){this._added||this._setUpControl(),function ND(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function jE(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(r){return new(r||n)(J(Di,13),J(ni,10),J(Su,10),J(Vo,10),J(OD,8))};static#n=this.\u0275dir=Ve({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[An([AJ]),qt,Vi]})}return n})(),y2=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({imports:[n2]})}return n})();class v2 extends BE{constructor(e,t,r){super(AD(t),SD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){qV(this,0,e),e.forEach((r,i)=>{HV(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function E2(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let I2=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,r=null){const i=this._reduceControls(t);let s={};return E2(r)?s=r:null!==r&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Ug(i,s)}record(t,r=null){const i=this._reduceControls(t);return new zV(i,r)}control(t,r,i){let s={};return this.useNonNullable?(E2(r)?s=r:(s.validators=r,s.asyncValidators=i),new Hg(t,{...s,nonNullable:!0})):new Hg(t,r,i)}array(t,r,i){const s=t.map(o=>this._createControl(o));return new v2(s,r,i)}_reduceControls(t){const r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){return t instanceof Hg||t instanceof BE?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$J=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ql,useValue:t.callSetDisabledState??Bg}]}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({imports:[y2]})}return n})(),HJ=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:OD,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Ql,useValue:t.callSetDisabledState??Bg}]}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({imports:[y2]})}return n})();function jD(...n){const e=rs(n),t=Oi(n),{args:r,keys:i}=pV(n);if(0===r.length)return I([],e);const s=new Ze(function zJ(n,e,t=Tn){return r=>{w2(e,()=>{const{length:i}=n,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)w2(e,()=>{const l=I(n[u],e);let d=!1;l.subscribe(ce(r,f=>{s[u]=f,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>mV(i,o):Tn));return t?s.pipe(gV(t)):s}function w2(n,e,t){n?pi(t,n,e):e()}const GE=Z(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function $D(...n){return function GJ(){return Qr(1)}()(I(n,rs(n)))}function T2(n){return new Ze(e=>{gt(n()).subscribe(e)})}function zg(n,e){const t=A(n)?n:()=>n,r=i=>i.error(t());return new Ze(e?i=>e.schedule(r,0,i):r)}function HD(){return Y((n,e)=>{let t=null;n._refCount++;const r=ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class C2 extends Ze{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ee(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new yt;const t=this.getSubject();e.add(this.source.subscribe(ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=yt.EMPTY)}return e}refCount(){return HD()(this)}}function vh(n){return n<=0?()=>Cn:Y((e,t)=>{let r=0;e.subscribe(ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function WE(...n){const e=rs(n);return Y((t,r)=>{(e?$D(n,t,e):$D(n,t)).subscribe(r)})}function $s(n,e){return Y((t,r)=>{let i=0;t.subscribe(ce(r,s=>n.call(e,s,i++)&&r.next(s)))})}function KE(n){return Y((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function b2(n=WJ){return Y((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function WJ(){return new GE}function Pu(n,e){const t=arguments.length>=2;return r=>r.pipe(n?$s((i,s)=>n(i,s,r)):Tn,vh(1),t?KE(e):b2(()=>new GE))}function Eh(n,e){return A(e)?Ot(n,e,1):Ot(n,1)}function jr(n,e,t){const r=A(n)||e||t?{next:n,error:e,complete:t}:n;return r?Y((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(ce(s,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),s.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):Tn}function Xl(n){return Y((e,t)=>{let s,r=null,i=!1;r=e.subscribe(ce(t,void 0,void 0,o=>{s=gt(n(o,Xl(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Ih(n,e){return Y(function KJ(n,e,t,r,i){return(s,o)=>{let a=t,u=e,l=0;s.subscribe(ce(o,d=>{const f=l++;u=a?n(u,d,f):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(n,e,arguments.length>=2,!0))}function qD(n){return n<=0?()=>Cn:Y((e,t)=>{let r=[];e.subscribe(ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Gg(n){return Y((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const et="primary",Wg=Symbol("RouteTitle");class XJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function wh(n){return new XJ(n)}function JJ(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Uo(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!D2(n[i],e[i]))return!1;return!0}function D2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}return n===e}function A2(n){return n.length>0?n[n.length-1]:null}function Nu(n){return function qJ(n){return!!n&&(n instanceof Ze||A(n.lift)&&A(n.subscribe))}(n)?n:Eg(n)?I(Promise.resolve(n)):R(n)}const tee={exact:function P2(n,e,t){if(!Jl(n.segments,e.segments)||!ZE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!P2(n.children[r],e.children[r],t))return!1;return!0},subset:N2},S2={exact:function nee(n,e){return Uo(n,e)},subset:function ree(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>D2(n[t],e[t]))},ignored:()=>!0};function R2(n,e,t){return tee[t.paths](n.root,e.root,t.matrixParams)&&S2[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function N2(n,e,t){return M2(n,e,e.segments,t)}function M2(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!Jl(i,t)||e.hasChildren()||!ZE(i,t,r))}if(n.segments.length===t.length){if(!Jl(n.segments,t)||!ZE(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!N2(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Jl(n.segments,i)&&ZE(n.segments,i,r)&&n.children[et])&&M2(n.children[et],e,s,r)}}function ZE(n,e,t){return e.every((r,i)=>S2[t](n[i].parameters,r.parameters))}class Th{constructor(e=new zt([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=wh(this.queryParams)),this._queryParamMap}toString(){return oee.serialize(this)}}class zt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return QE(this)}}class Kg{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=wh(this.parameters)),this._parameterMap}toString(){return O2(this)}}function Jl(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let Zg=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return new zD},providedIn:"root"})}return n})();class zD{parse(e){const t=new _ee(e);return new Th(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Qg(e.root,!0)}`,r=function lee(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${YE(t)}=${YE(i)}`).join("&"):`${YE(t)}=${YE(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function aee(n){return encodeURI(n)}(e.fragment)}`:""}`}}const oee=new zD;function QE(n){return n.segments.map(e=>O2(e)).join("/")}function Qg(n,e){if(!n.hasChildren())return QE(n);if(e){const t=n.children[et]?Qg(n.children[et],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==et&&r.push(`${i}:${Qg(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function see(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===et&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==et&&(t=t.concat(e(i,r)))}),t}(n,(r,i)=>i===et?[Qg(n.children[et],!1)]:[`${i}:${Qg(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[et]?`${QE(n)}/${t[0]}`:`${QE(n)}/(${t.join("//")})`}}function x2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function YE(n){return x2(n).replace(/%3B/gi,";")}function GD(n){return x2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function XE(n){return decodeURIComponent(n)}function k2(n){return XE(n.replace(/\+/g,"%20"))}function O2(n){return`${GD(n.path)}${function uee(n){return Object.keys(n).map(e=>`;${GD(e)}=${GD(n[e])}`).join("")}(n.parameters)}`}const cee=/^[^\/()?;#]+/;function WD(n){const e=n.match(cee);return e?e[0]:""}const dee=/^[^\/()?;=#]+/,fee=/^[^=?&#]+/,gee=/^[^&#]+/;class _ee{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new zt([],{}):new zt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[et]=new zt(e,t)),r}parseSegment(){const e=WD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new L(4009,!1);return this.capture(e),new Kg(XE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function hee(n){const e=n.match(dee);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=WD(this.remaining);i&&(r=i,this.capture(r))}e[XE(t)]=XE(r)}parseQueryParam(e){const t=function pee(n){const e=n.match(fee);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const o=function mee(n){const e=n.match(gee);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=k2(t),s=k2(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=WD(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new L(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=et);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[et]:new zt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new L(4011,!1)}}function F2(n){return n.segments.length>0?new zt([],{[et]:n}):n}function L2(n){const e={};for(const r of Object.keys(n.children)){const s=L2(n.children[r]);if(r===et&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function yee(n){if(1===n.numberOfChildren&&n.children[et]){const e=n.children[et];return new zt(n.segments.concat(e.segments),e.children)}return n}(new zt(n.segments,e))}function ec(n){return n instanceof Th}function V2(n){let e;const i=F2(function t(s){const o={};for(const u of s.children){const l=t(u);o[u.outlet]=l}const a=new zt(s.url,o);return s===n&&(e=a),a}(n.root));return e??i}function U2(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(0===e.length)return KD(i,i,i,t,r);const s=function Eee(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new j2(!0,0,n);let e=0,t=!1;const r=n.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new j2(t,e,r)}(e);if(s.toRoot())return KD(i,i,new zt([],{}),t,r);const o=function Iee(n,e,t){if(n.isAbsolute)return new eI(e,!0,0);if(!t)return new eI(e,!1,NaN);if(null===t.parent)return new eI(t,!0,0);const r=JE(n.commands[0])?0:1;return function wee(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new L(4005,!1);i=r.segments.length}return new eI(r,!1,i-s)}(t,t.segments.length-1+r,n.numberOfDoubleDots)}(s,i,n),a=o.processChildren?Xg(o.segmentGroup,o.index,s.commands):$2(o.segmentGroup,o.index,s.commands);return KD(i,o.segmentGroup,a,t,r)}function JE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Yg(n){return"object"==typeof n&&null!=n&&n.outlets}function KD(n,e,t,r,i){let o,s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),o=n===e?t:B2(n,e,t);const a=F2(L2(o));return new Th(a,s,i)}function B2(n,e,t){const r={};return Object.entries(n.children).forEach(([i,s])=>{r[i]=s===e?t:B2(s,e,t)}),new zt(n.segments,r)}class j2{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&JE(r[0]))throw new L(4003,!1);const i=r.find(Yg);if(i&&i!==A2(r))throw new L(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class eI{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function $2(n,e,t){if(n||(n=new zt([],{})),0===n.segments.length&&n.hasChildren())return Xg(n,e,t);const r=function Cee(n,e,t){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;const o=n.segments[i],a=t[r];if(Yg(a))break;const u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!q2(u,l,o))return s;r+=2}else{if(!q2(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const s=new zt(n.segments.slice(0,r.pathIndex),{});return s.children[et]=new zt(n.segments.slice(r.pathIndex),n.children),Xg(s,0,i)}return r.match&&0===i.length?new zt(n.segments,{}):r.match&&!n.hasChildren()?ZD(n,e,t):r.match?Xg(n,0,i):ZD(n,e,t)}function Xg(n,e,t){if(0===t.length)return new zt(n.segments,{});{const r=function Tee(n){return Yg(n[0])?n[0].outlets:{[et]:n}}(t),i={};if(Object.keys(r).some(s=>s!==et)&&n.children[et]&&1===n.numberOfChildren&&0===n.children[et].segments.length){const s=Xg(n.children[et],e,t);return new zt(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=$2(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new zt(n.segments,i)}}function ZD(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(Yg(s)){const u=bee(s.outlets);return new zt(r,u)}if(0===i&&JE(t[0])){r.push(new Kg(n.segments[e].path,H2(t[0]))),i++;continue}const o=Yg(s)?s.outlets[et]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&JE(a)?(r.push(new Kg(o,H2(a))),i+=2):(r.push(new Kg(o,{})),i++)}return new zt(r,{})}function bee(n){const e={};return Object.entries(n).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[t]=ZD(new zt([],{}),0,r))}),e}function H2(n){const e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function q2(n,e,t){return n==t.path&&Uo(e,t.parameters)}const Jg="imperative";class Bo{constructor(e,t){this.id=e,this.url=t}}class tI extends Bo{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Mu extends Bo{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class em extends Bo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ch extends Bo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class nI extends Bo{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class z2 extends Bo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dee extends Bo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Aee extends Bo{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class See extends Bo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ree extends Bo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pee{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Nee{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Mee{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xee{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kee{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oee{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class G2{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class QD{}class YD{constructor(e){this.url=e}}class Fee{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new tm,this.attachRef=null}}let tm=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Fee,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class W2{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=XD(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=XD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=JD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return JD(e,this._root).map(t=>t.value)}}function XD(n,e){if(n===e.value)return e;for(const t of e.children){const r=XD(n,t);if(r)return r}return null}function JD(n,e){if(n===e.value)return[e];for(const t of e.children){const r=JD(n,t);if(r.length)return r.unshift(e),r}return[]}class Oa{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function bh(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class K2 extends W2{constructor(e,t){super(e),this.snapshot=t,eA(this,e)}toString(){return this.snapshot.toString()}}function Z2(n,e){const t=function Lee(n,e){const o=new rI([],{},{},"",{},et,e,null,{});return new Y2("",new Oa(o,[]))}(0,e),r=new E([new Kg("",{})]),i=new E({}),s=new E({}),o=new E({}),a=new E(""),u=new Dh(r,i,o,a,s,et,e,t.root);return u.snapshot=t.root,new K2(new Oa(u,[]),t)}class Dh{constructor(e,t,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(de(l=>l[Wg]))??R(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(de(e=>wh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(de(e=>wh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Q2(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],s=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function Vee(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class rI{get title(){return this.data?.[Wg]}constructor(e,t,r,i,s,o,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=wh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=wh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Y2 extends W2{constructor(e,t){super(t),this.url=e,eA(this,t)}toString(){return X2(this._root)}}function eA(n,e){e.value._routerState=n,e.children.forEach(t=>eA(n,t))}function X2(n){const e=n.children.length>0?` { ${n.children.map(X2).join(", ")} } `:"";return`${n.value}${e}`}function tA(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Uo(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Uo(e.params,t.params)||n.paramsSubject.next(t.params),function eee(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Uo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Uo(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function nA(n,e){const t=Uo(n.params,e.params)&&function iee(n,e){return Jl(n,e)&&n.every((t,r)=>Uo(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||nA(n.parent,e.parent))}let rA=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=et,this.activateEvents=new qn,this.deactivateEvents=new qn,this.attachEvents=new qn,this.detachEvents=new qn,this.parentContexts=pe(tm),this.location=pe(so),this.changeDetector=pe(gE),this.environmentInjector=pe(us),this.inputBinder=pe(iI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new L(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new L(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new L(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new L(4013,!1);this._activatedRoute=t;const i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Uee(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275dir=Ve({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Vi]})}return n})();class Uee{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Dh?this.route:e===tm?this.childContexts:this.parent.get(e,t)}}const iI=new le("");let J2=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,i=jD([r.queryParams,r.params,r.data]).pipe(ve(([s,o,a],u)=>(a={...s,...o,...a},0===u?R(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const o=function yQ(n){const e=dt(n);if(!e)return null;const t=new fg(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,i)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function nm(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function jee(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return nm(n,r,i);return nm(n,r)})}(n,e,t);return new Oa(r,i)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>nm(n,a)),o}}const r=function $ee(n){return new Dh(new E(n.url),new E(n.params),new E(n.queryParams),new E(n.fragment),new E(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(s=>nm(n,s));return new Oa(r,i)}}const iA="ngNavigationCancelingError";function eU(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=ec(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=tU(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function tU(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[iA]=!0,r.cancellationCode=e,t&&(r.url=t),r}function nU(n){return n&&n[iA]}let rU=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=Co({type:n,selectors:[["ng-component"]],standalone:!0,features:[aE],decls:1,vars:0,template:function(r,i){1&r&&Br(0,"router-outlet")},dependencies:[rA],encapsulation:2})}return n})();function sA(n){const e=n.children&&n.children.map(sA),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==et&&(t.component=rU),t}function uo(n){return n.outlet||et}function rm(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Qee{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),tA(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=bh(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=bh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=bh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){const i=bh(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Oee(s.value.snapshot))}),e.children.length&&this.forwardEvent(new xee(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(tA(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),tA(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=rm(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class iU{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class sI{constructor(e,t){this.component=e,this.route=t}}function Yee(n,e,t){const r=n._root;return im(r,e?e._root:null,t,[r.value])}function Ah(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||function py(n){return null!==Wc(n)}(n)?e.get(n):n:r}function im(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=bh(e);return n.children.forEach(o=>{(function Jee(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function ete(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Jl(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Jl(n.url,e.url)||!Uo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nA(n,e)||!Uo(n.queryParams,e.queryParams);default:return!nA(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new iU(r)):(s.data=o.data,s._resolvedData=o._resolvedData),im(n,e,s.component?a?a.children:null:t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new sI(a.outlet.component,o))}else o&&sm(e,a,i),i.canActivateChecks.push(new iU(r)),im(n,null,s.component?a?a.children:null:t,r,i)})(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>sm(a,t.getContext(o),i)),i}function sm(n,e,t){const r=bh(n),i=n.value;Object.entries(r).forEach(([s,o])=>{sm(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new sI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function om(n){return"function"==typeof n}function sU(n){return n instanceof GE||"EmptyError"===n?.name}const oI=Symbol("INITIAL_VALUE");function Sh(){return ve(n=>jD(n.map(e=>e.pipe(vh(1),WE(oI)))).pipe(de(e=>{for(const t of e)if(!0!==t){if(t===oI)return oI;if(!1===t||t instanceof Th)return t}return!0}),$s(e=>e!==oI),vh(1)))}function oU(n){return function Xi(...n){return Ji(n)}(jr(e=>{if(ec(e))throw eU(0,e)}),de(e=>!0===e))}class aI{constructor(e){this.segmentGroup=e||null}}class aU{constructor(e){this.urlTree=e}}function Rh(n){return zg(new aI(n))}function uU(n){return zg(new aU(n))}class Ete{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new L(4002,!1)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return R(r);if(i.numberOfChildren>1||!i.children[et])return zg(new L(4e3,!1));i=i.children[et]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const s=this.createSegmentGroup(e,t.root,r,i);return new Th(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){const s=this.createSegments(e,t.segments,r,i);let o={};return Object.entries(t.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new zt(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new L(4001,!1);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}const oA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ite(n,e,t,r,i){const s=aA(n,e,t);return s.matched?(r=function qee(n,e){return n.providers&&!n._injector&&(n._injector=mb(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,r),function _te(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?R(i.map(o=>{const a=Ah(o,n);return Nu(function ote(n){return n&&om(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Sh(),oU()):R(!0)}(r,e,t).pipe(de(o=>!0===o?s:{...oA}))):R(s)}function aA(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...oA}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||JJ)(t,n,e);if(!i)return{...oA};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function lU(n,e,t,r){return t.length>0&&function Cte(n,e,t){return t.some(r=>uI(n,e,r)&&uo(r)!==et)}(n,t,r)?{segmentGroup:new zt(e,Tte(r,new zt(t,n.children))),slicedSegments:[]}:0===t.length&&function bte(n,e,t){return t.some(r=>uI(n,e,r))}(n,t,r)?{segmentGroup:new zt(n.segments,wte(n,0,t,r,n.children)),slicedSegments:t}:{segmentGroup:new zt(n.segments,n.children),slicedSegments:t}}function wte(n,e,t,r,i){const s={};for(const o of r)if(uI(n,t,o)&&!i[uo(o)]){const a=new zt([],{});s[uo(o)]=a}return{...i,...s}}function Tte(n,e){const t={};t[et]=e;for(const r of n)if(""===r.path&&uo(r)!==et){const i=new zt([],{});t[uo(r)]=i}return t}function uI(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Rte{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new Ete(this.urlSerializer,this.urlTree)}noMatchError(e){return new L(4002,!1)}recognize(){const e=lU(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,et).pipe(Xl(t=>{if(t instanceof aU)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof aI?this.noMatchError(t):t}),de(t=>{const r=new rI([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},et,this.rootComponentType,null,{}),i=new Oa(r,t),s=new Y2("",i),o=function vee(n,e,t=null,r=null){return U2(V2(n),e,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,et).pipe(Xl(r=>{throw r instanceof aI?this.noMatchError(r):r}))}inheritParamsAndData(e){const t=e.value,r=Q2(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0)}processChildren(e,t,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return I(i).pipe(Eh(s=>{const o=r.children[s],a=function Kee(n,e){const t=n.filter(r=>uo(r)===e);return t.push(...n.filter(r=>uo(r)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),Ih((s,o)=>(s.push(...o),s)),KE(null),function ZJ(n,e){const t=arguments.length>=2;return r=>r.pipe(n?$s((i,s)=>n(i,s,r)):Tn,qD(1),t?KE(e):b2(()=>new GE))}(),Ot(s=>{if(null===s)return Rh(r);const o=cU(s);return function Pte(n){n.sort((e,t)=>e.value.outlet===et?-1:t.value.outlet===et?1:e.value.outlet.localeCompare(t.value.outlet))}(o),R(o)}))}processSegment(e,t,r,i,s,o){return I(t).pipe(Eh(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Xl(u=>{if(u instanceof aI)return R(null);throw u}))),Pu(a=>!!a),Xl(a=>{if(sU(a))return function Ate(n,e,t){return 0===e.length&&!n.children[t]}(r,i,s)?R([]):Rh(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return function Dte(n,e,t,r){return!!(uo(n)===r||r!==et&&uI(e,t,n))&&("**"===n.path||aA(e,n,t).matched)}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Rh(i):Rh(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const s=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?uU(s):this.applyRedirects.lineralizeSegments(r,s).pipe(Ot(o=>{const a=new zt(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){const{matched:a,consumedSegments:u,remainingSegments:l,positionalParamSegments:d}=aA(t,i,s);if(!a)return Rh(t);const f=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d);return i.redirectTo.startsWith("/")?uU(f):this.applyRedirects.lineralizeSegments(i,f).pipe(Ot(m=>this.processSegment(e,r,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a;if("**"===r.path){const u=i.length>0?A2(i).parameters:{};a=R({snapshot:new rI(i,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,dU(r),uo(r),r.component??r._loadedComponent??null,r,hU(r)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Ite(t,r,i,e).pipe(de(({matched:u,consumedSegments:l,remainingSegments:d,parameters:f})=>u?{snapshot:new rI(l,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,dU(r),uo(r),r.component??r._loadedComponent??null,r,hU(r)),consumedSegments:l,remainingSegments:d}:null));return a.pipe(ve(u=>null===u?Rh(t):this.getChildConfig(e=r._injector??e,r,i).pipe(ve(({routes:l})=>{const d=r._loadedInjector??e,{snapshot:f,consumedSegments:m,remainingSegments:_}=u,{segmentGroup:v,slicedSegments:T}=lU(t,m,_,l);if(0===T.length&&v.hasChildren())return this.processChildren(d,l,v).pipe(de(k=>null===k?null:[new Oa(f,k)]));if(0===l.length&&0===T.length)return R([new Oa(f,[])]);const D=uo(r)===s;return this.processSegment(d,l,v,T,D?et:s,!0).pipe(de(k=>[new Oa(f,k)]))}))))}getChildConfig(e,t,r){return t.children?R({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?R({routes:t._loadedRoutes,injector:t._loadedInjector}):function mte(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?R(!0):R(i.map(o=>{const a=Ah(o,n);return Nu(function nte(n){return n&&om(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Sh(),oU())}(e,t,r).pipe(Ot(i=>i?this.configLoader.loadChildren(e,t).pipe(jr(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function vte(n){return zg(tU(!1,3))}())):R({routes:[],injector:e})}}function Nte(n){const e=n.value.routeConfig;return e&&""===e.path}function cU(n){const e=[],t=new Set;for(const r of n){if(!Nte(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=cU(r.children);e.push(new Oa(r.value,i))}return e.filter(r=>!t.has(r))}function dU(n){return n.data||{}}function hU(n){return n.resolve||{}}function fU(n){return"string"==typeof n.title||null===n.title}function uA(n){return ve(e=>{const t=n(e);return t?I(t).pipe(de(()=>e)):R(e)})}const Ph=new le("ROUTES");let lA=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=pe($F)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return R(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Nu(t.loadComponent()).pipe(de(pU),jr(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Gg(()=>{this.componentLoaders.delete(t)})),i=new C2(r,()=>new z).pipe(HD());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return R({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function Vte(n,e,t,r){return Nu(n.loadChildren()).pipe(de(pU),Ot(i=>i instanceof Z1||Array.isArray(i)?R(i):I(e.compileModuleAsync(i))),de(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(t).injector,o=s.get(Ph,[],{optional:!0,self:!0}).flat()),{routes:o.map(sA),injector:s}}))}(r,this.compiler,t,this.onLoadEndListener).pipe(Gg(()=>{this.childrenLoaders.delete(r)})),o=new C2(s,()=>new z).pipe(HD());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pU(n){return function Ute(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let lI=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new z,this.transitionAbortSubject=new z,this.configLoader=pe(lA),this.environmentInjector=pe(us),this.urlSerializer=pe(Zg),this.rootContexts=pe(tm),this.inputBindingEnabled=null!==pe(iI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>R(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Nee(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new Pee(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t,r,i){return this.transitions=new E({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:t.urlHandlingStrategy.extract(r),urlAfterRedirects:t.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Jg,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe($s(s=>0!==s.id),de(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),ve(s=>{this.currentTransition=s;let o=!1,a=!1;return R(s).pipe(jr(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ve(u=>{const l=u.currentBrowserUrl.toString(),d=!t.navigated||u.extractedUrl.toString()!==l||l!==u.currentUrlTree.toString();if(!d&&"reload"!==(u.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const m="";return this.events.next(new Ch(u.id,this.urlSerializer.serialize(u.rawUrl),m,0)),u.resolve(null),Cn}if(t.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return R(u).pipe(ve(m=>{const _=this.transitions?.getValue();return this.events.next(new tI(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),_!==this.transitions?.getValue()?Cn:Promise.resolve(m)}),function Mte(n,e,t,r,i,s){return Ot(o=>function Ste(n,e,t,r,i,s,o="emptyOnly"){return new Rte(n,e,t,r,i,o,s).recognize()}(n,e,t,r,o.extractedUrl,i,s).pipe(de(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),jr(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects};const _=new z2(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(_)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:m,extractedUrl:_,source:v,restoredState:T,extras:D}=u,k=new tI(m,this.urlSerializer.serialize(_),v,T);this.events.next(k);const P=Z2(0,this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:P,urlAfterRedirects:_,extras:{...D,skipLocationChange:!1,replaceUrl:!1}},R(s)}{const m="";return this.events.next(new Ch(u.id,this.urlSerializer.serialize(u.extractedUrl),m,1)),u.resolve(null),Cn}}),jr(u=>{const l=new Dee(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),de(u=>(this.currentTransition=s={...u,guards:Yee(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function ute(n,e){return Ot(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?R({...t,guardsResult:!0}):function lte(n,e,t,r){return I(n).pipe(Ot(i=>function gte(n,e,t,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?R(s.map(a=>{const u=rm(e)??i,l=Ah(a,u);return Nu(function ste(n){return n&&om(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,r):u.runInContext(()=>l(n,e,t,r))).pipe(Pu())})).pipe(Sh()):R(!0)}(i.component,i.route,t,e,r)),Pu(i=>!0!==i,!0))}(o,r,i,n).pipe(Ot(a=>a&&function tte(n){return"boolean"==typeof n}(a)?function cte(n,e,t,r){return I(e).pipe(Eh(i=>$D(function hte(n,e){return null!==n&&e&&e(new Mee(n)),R(!0)}(i.route.parent,r),function dte(n,e){return null!==n&&e&&e(new kee(n)),R(!0)}(i.route,r),function pte(n,e,t){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function Xee(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>T2(()=>R(o.guards.map(u=>{const l=rm(o.node)??t,d=Ah(u,l);return Nu(function ite(n){return n&&om(n.canActivateChild)}(d)?d.canActivateChild(r,n):l.runInContext(()=>d(r,n))).pipe(Pu())})).pipe(Sh())));return R(s).pipe(Sh())}(n,i.path,t),function fte(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return R(!0);const i=r.map(s=>T2(()=>{const o=rm(e)??t,a=Ah(s,o);return Nu(function rte(n){return n&&om(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Pu())}));return R(i).pipe(Sh())}(n,i.route,t))),Pu(i=>!0!==i,!0))}(r,s,n,e):R(a)),de(a=>({...t,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),jr(u=>{if(s.guardsResult=u.guardsResult,ec(u.guardsResult))throw eU(0,u.guardsResult);const l=new Aee(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),$s(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),uA(u=>{if(u.guards.canActivateChecks.length)return R(u).pipe(jr(l=>{const d=new See(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ve(l=>{let d=!1;return R(l).pipe(function xte(n,e){return Ot(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return R(t);let s=0;return I(i).pipe(Eh(o=>function kte(n,e,t,r){const i=n.routeConfig,s=n._resolve;return void 0!==i?.title&&!fU(i)&&(s[Wg]=i.title),function Ote(n,e,t,r){const i=function Fte(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return R({});const s={};return I(i).pipe(Ot(o=>function Lte(n,e,t,r){const i=rm(e)??r,s=Ah(n,i);return Nu(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(n[o],e,t,r).pipe(Pu(),jr(a=>{s[o]=a}))),qD(1),function QJ(n){return de(()=>n)}(s),Xl(o=>sU(o)?Cn:zg(o)))}(s,n,e,r).pipe(de(o=>(n._resolvedData=o,n.data=Q2(n,t).resolve,i&&fU(i)&&(n.data[Wg]=i.title),null)))}(o.route,r,n,e)),jr(()=>s++),qD(1),Ot(o=>s===i.length?R(t):Cn))})}(t.paramsInheritanceStrategy,this.environmentInjector),jr({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",2)}}))}),jr(l=>{const d=new Ree(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),uA(u=>{const l=d=>{const f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(jr(m=>{d.component=m}),de(()=>{})));for(const m of d.children)f.push(...l(m));return f};return jD(l(u.targetSnapshot.root)).pipe(KE(),vh(1))}),uA(()=>this.afterPreactivation()),de(u=>{const l=function Bee(n,e,t){const r=nm(n,e._root,t?t._root:void 0);return new K2(r,e)}(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:l},s}),jr(()=>{this.events.next(new QD)}),((n,e,t,r)=>de(i=>(new Qee(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),vh(1),jr({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Mu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),t.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function YJ(n){return Y((e,t)=>{gt(n).subscribe(ce(t,()=>t.complete(),be)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(jr(u=>{throw u}))),Gg(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Xl(u=>{if(a=!0,nU(u))this.events.next(new em(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function Hee(n){return nU(n)&&ec(n.url)}(u)?this.events.next(new YD(u.url)):s.resolve(!1);else{this.events.next(new nI(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(u))}catch(l){s.reject(l)}}return Cn}))}))}cancelNavigationTransition(t,r,i){const s=new em(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gU(n){return n!==Jg}let mU=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===et);return r}getResolvedTitleForRoute(t){return t.data[Wg]}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(Bte)},providedIn:"root"})}return n})(),Bte=(()=>{class n extends mU{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||n)(W(uV))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jte=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(Hte)},providedIn:"root"})}return n})();class $te{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Hte=(()=>{class n extends $te{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=Jn(n)))(i||n)}}();static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const cI=new le("",{providedIn:"root",factory:()=>({})});let qte=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:function(){return pe(zte)},providedIn:"root"})}return n})(),zte=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var am=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(am||{});function _U(n,e){n.events.pipe($s(t=>t instanceof Mu||t instanceof em||t instanceof nI||t instanceof Ch),de(t=>t instanceof Mu||t instanceof Ch?am.COMPLETE:t instanceof em&&(0===t.code||1===t.code)?am.REDIRECTING:am.FAILED),$s(t=>t!==am.REDIRECTING),vh(1)).subscribe(()=>{e()})}function Gte(n){throw n}function Wte(n,e,t){return e.parse("/")}const Kte={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Zte={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=pe(jF),this.isNgZoneEnabled=!1,this._events=new z,this.options=pe(cI,{optional:!0})||{},this.pendingTasks=pe(dE),this.errorHandler=this.options.errorHandler||Gte,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Wte,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=pe(qte),this.routeReuseStrategy=pe(jte),this.titleStrategy=pe(mU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=pe(Ph,{optional:!0})?.flat()??[],this.navigationTransitions=pe(lI),this.urlSerializer=pe(Zg),this.location=pe(Kb),this.componentInputBindingEnabled=!!pe(iI,{optional:!0}),this.eventsSubscription=new yt,this.isNgZoneEnabled=pe(Tt)instanceof Tt&&Tt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Th,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Z2(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:i}=this.navigationTransitions;if(null===i)return void(yU(r)&&this._events.next(r));if(r instanceof tI)gU(i.source)&&(this.browserUrlTree=i.extractedUrl);else if(r instanceof Ch)this.rawUrlTree=i.rawUrl;else if(r instanceof z2){if("eager"===this.urlUpdateStrategy){if(!i.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl);this.setBrowserUrl(s,i)}this.browserUrlTree=i.urlAfterRedirects}}else if(r instanceof QD)this.currentUrlTree=i.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i),this.browserUrlTree=i.urlAfterRedirects);else if(r instanceof em)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(i);else if(r instanceof YD){const s=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),o={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||gU(i.source)};this.scheduleNavigation(s,Jg,null,o,{resolve:i.resolve,reject:i.reject,promise:i.promise})}r instanceof nI&&this.restoreHistory(i,!0),r instanceof Mu&&(this.navigated=!0),yU(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Jg,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(sA),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o;let f,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{f=V2(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),f=this.currentUrlTree.root}return U2(f,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=ec(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Jg,null,r)}navigate(t,r={skipLocationChange:!1}){return function Qte(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new L(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...Kte}:!1===r?{...Zte}:r,ec(t))return R2(this.currentUrlTree,t,i);const s=this.parseUrl(t);return R2(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const s=t[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((f,m)=>{a=f,u=m});const d=this.pendingTasks.add();return _U(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yU(n){return!(n instanceof QD||n instanceof YD)}class vU{}let Jte=(()=>{class n{constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe($s(t=>t instanceof Mu),Eh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=mb(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return I(i).pipe(Qr())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):R(null);const s=i.pipe(Ot(o=>null===o?R(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return r.loadComponent&&!r._loadedComponent?I([s,this.loader.loadComponent(r)]).pipe(Qr()):s})}static#e=this.\u0275fac=function(r){return new(r||n)(W(qi),W($F),W(us),W(vU),W(lA))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const dA=new le("");let EU=(()=>{class n{constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof tI?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Mu?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Ch&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof G2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new G2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function Lk(){throw new Error("invalid")}()};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function Fa(n,e){return{\u0275kind:n,\u0275providers:e}}function wU(){const n=pe(Jr);return e=>{const t=n.get(Pa);if(e!==t.components[0])return;const r=n.get(qi),i=n.get(TU);1===n.get(hA)&&r.initialNavigation(),n.get(CU,null,rt.Optional)?.setUpPreloading(),n.get(dA,null,rt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const TU=new le("",{factory:()=>new z}),hA=new le("",{providedIn:"root",factory:()=>1}),CU=new le("");function rne(n){return Fa(0,[{provide:CU,useExisting:Jte},{provide:vU,useExisting:n}])}const bU=new le("ROUTER_FORROOT_GUARD"),sne=[Kb,{provide:Zg,useClass:zD},qi,tm,{provide:Dh,useFactory:function IU(n){return n.routerState.root},deps:[qi]},lA,[]];function one(){return new ZF("Router",qi)}let DU=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[sne,[],{provide:Ph,multi:!0,useValue:t},{provide:bU,useFactory:cne,deps:[[qi,new Qp,new gv]]},{provide:cI,useValue:r||{}},r?.useHash?{provide:Kl,useClass:TQ}:{provide:Kl,useClass:DL},{provide:dA,useFactory:()=>{const n=pe(HY),e=pe(Tt),t=pe(cI),r=pe(lI),i=pe(Zg);return t.scrollOffset&&n.setOffset(t.scrollOffset),new EU(i,r,n,e,t)}},r?.preloadingStrategy?rne(r.preloadingStrategy).\u0275providers:[],{provide:ZF,multi:!0,useFactory:one},r?.initialNavigation?dne(r):[],r?.bindToComponentInputs?Fa(8,[J2,{provide:iI,useExisting:J2}]).\u0275providers:[],[{provide:AU,useFactory:wU},{provide:Vb,multi:!0,useExisting:AU}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Ph,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(r){return new(r||n)(W(bU,8))};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({})}return n})();function cne(n){return"guarded"}function dne(n){return["disabled"===n.initialNavigation?Fa(3,[{provide:Pb,multi:!0,useFactory:()=>{const e=pe(qi);return()=>{e.setUpLocationChangeListener()}}},{provide:hA,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Fa(2,[{provide:hA,useValue:0},{provide:Pb,multi:!0,deps:[Jr],useFactory:e=>{const t=e.get(IQ,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(qi),s=e.get(TU);_U(i,()=>{r(!0)}),e.get(lI).afterPreactivation=()=>(r(!0),s.closed?R(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const AU=new le("");var SU=ke(562),b=ke(58),zi=ke(534),fs=ke(879),lo=ke(537);ke(365),(0,zi.registerVersion)("firebase","10.6.0","app");class gne extends yt{constructor(e,t){super()}schedule(e,t=0){return this}}const dI={setInterval(n,e,...t){const{delegate:r}=dI;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=dI;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class RU extends gne{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return dI.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&dI.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ae(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const fA={now:()=>(fA.delegate||Date).now(),delegate:void 0};class um{constructor(e,t=um.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}um.now=fA.now;class PU extends um{constructor(e,t=um.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const yne=new class _ne extends PU{}(class mne extends RU{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}}),hI=new PU(RU),Nh=new Yd("ANGULARFIRE2_VERSION");class fI{constructor(){return((n,e)=>{const t=(0,zi.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(Ene)}}const Ene="app-check";function Mh(){}class NU{zone;delegate;constructor(e,t=yne){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,r)}}class Ine{zone;task=null;constructor(e){this.zone=e}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Mh,{},Mh,Mh)),t.pipe(jr({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let pI=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new NU(Zone.current)),this.insideAngular=t.run(()=>new NU(Zone.current,hI)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(W(Tt))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xh(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function MU(n){return n.pipe($n(xh().outsideAngular))}function tr(n){return function Tne(n){return function(t){return(t=t.lift(new Ine(n.ngZone))).pipe(Or(n.outsideAngular),$n(n.insideAngular))}}(xh())(n)}var ps=ke(106);ps.Z.registerVersion("firebase","10.6.0","app-compat");const Ane=["ngOnDestroy"];class xU{constructor(e){return e}}const kh=new le("angularfire2.app.options"),Oh=new le("angularfire2.app.name");function lm(n,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const o=ps.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>ps.Z.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){const a=!!module.hot;Pne("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new xU(o)}const Pne=(n,...e)=>{},Nne={provide:xU,useFactory:lm,deps:[kh,Tt,[new Qp,Oh]]};let Mne=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:kh,useValue:t},{provide:Oh,useValue:r}]}}constructor(t){ps.Z.registerVersion("angularfire",Nh.full,"core"),ps.Z.registerVersion("angularfire",Nh.full,"app-compat"),ps.Z.registerVersion("angular",hk.full,t.toString())}static \u0275fac=function(r){return new(r||n)(W(Vs))};static \u0275mod=rn({type:n});static \u0275inj=Dn({providers:[Nne]})}return n})();function gI(n,e,t,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return function xne(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(i,o)||(kU("error",`${e} was already initialized on the ${t} Firebase App with different settings.${kne?" You may need to reload as Firebase is not HMR aware.":""}`),kU("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}const kne=typeof module<"u"&&!!module.hot,kU=(n,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[];class One extends z{constructor(e=1/0,t=1/0,r=fA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=t.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function OU(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,K({connector:()=>new One(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function FU(n,e){return A(e)?ve(()=>n,e):ve(()=>n)}const pA=new le("angularfire2.auth.use-emulator"),gA=new le("angularfire2.auth.settings"),mA=new le("angularfire2.auth.tenant-id"),_A=new le("angularfire2.auth.langugage-code"),yA=new le("angularfire2.auth.use-device-language"),vA=new le("angularfire.auth.persistence"),EA=(n,e,t,r,i,s,o,a)=>gI(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,s,o,a]);let nc=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,u,l,d,f,m,_){const v=new z,T=R(void 0).pipe($n(o.outsideAngular),ve(()=>s.runOutsideAngular(()=>Promise.resolve().then(ke.bind(ke,365)))),de(()=>lm(t,s,r)),de(D=>EA(D,s,a,l,d,f,u,m)),OU({bufferSize:1,refCount:!1}));if(NE(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=R(null);else{T.pipe(Pu()).subscribe();const D=T.pipe(ve(O=>O.getRedirectResult().then(q=>q,()=>null)),tr,OU({bufferSize:1,refCount:!1})),k=T.pipe(ve(O=>new Ze(q=>({unsubscribe:s.runOutsideAngular(()=>O.onAuthStateChanged(ue=>q.next(ue),ue=>q.error(ue),()=>q.complete()))})))),P=T.pipe(ve(O=>new Ze(q=>({unsubscribe:s.runOutsideAngular(()=>O.onIdTokenChanged(ue=>q.next(ue),ue=>q.error(ue),()=>q.complete()))}))));this.authState=D.pipe(FU(k),Or(o.outsideAngular),$n(o.insideAngular)),this.user=D.pipe(FU(P),Or(o.outsideAngular),$n(o.insideAngular)),this.idToken=this.user.pipe(ve(O=>O?I(O.getIdToken()):R(null))),this.idTokenResult=this.user.pipe(ve(O=>O?I(O.getIdTokenResult()):R(null))),this.credential=C(D,v,this.authState.pipe($s(O=>!O))).pipe(de(O=>O?.user?O:null),Or(o.outsideAngular),$n(o.insideAngular))}return((n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(Ane.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{const f=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,f),f})})})}))(this,T,s,{spy:{apply:(D,k,P)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&P.then(O=>v.next(O))}}})}static \u0275fac=function(r){return new(r||n)(W(kh),W(Oh,8),W(Vs),W(Tt),W(pI),W(pA,8),W(gA,8),W(mA,8),W(_A,8),W(yA,8),W(vA,8),W(fI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Lne=(()=>{class n{constructor(){ps.Z.registerVersion("angularfire",Nh.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({providers:[nc]})}return n})();var rc=function(n){return n.UserNotFound="auth/user-not-found",n.WrongPassword="auth/wrong-password",n.EmailInUse="auth/email-already-in-use",n.WeakPassword="auth/weak-password",n.BadEmail="auth/invalid-email",n.InvalidLogin="auth/invalid-login-credentials",n}(rc||{});let Vne=(()=>{class n{constructor(){}firebaseError(t){switch(t){case rc.UserNotFound:return"User does not exist";case rc.WrongPassword:return"Wrong password";case rc.EmailInUse:return"Email already in use";case rc.WeakPassword:return"Weak password, use 6 characters at least";case rc.BadEmail:return"Invalid Email";case rc.InvalidLogin:return"Credentials not accepted";default:return"Unknown error"}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class LU{}class Une{}const La="*";function Bne(n,e){return{type:7,name:n,definitions:e,options:{}}}function VU(n,e=null){return{type:4,styles:e,timings:n}}function UU(n,e=null){return{type:2,steps:n,options:e}}function cm(n){return{type:6,styles:n,offset:null}}function IA(n,e,t){return{type:0,name:n,styles:e,options:t}}function BU(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}class dm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class jU{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,r=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(i)})}getPosition(){const e=this.players.reduce((t,r)=>null===t||r.totalTime>t.totalTime?r:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}const $U=["toast-component",""];function jne(n,e){if(1&n){const t=tb();mt(0,"button",5),ar("click",function(){return Fp(t),Ml(ds().remove())}),mt(1,"span",6),Bt(2,"\xd7"),At()()}}function $ne(n,e){if(1&n&&(yg(0),Bt(1),vg()),2&n){const t=ds(2);an(1),Aa("[",t.duplicatesCount+1,"]")}}function Hne(n,e){if(1&n&&(mt(0,"div"),Bt(1),ti(2,$ne,2,1,"ng-container",4),At()),2&n){const t=ds();Da(t.options.titleClass),ji("aria-label",t.title),an(1),Aa(" ",t.title," "),an(1),Fn("ngIf",t.duplicatesCount)}}function qne(n,e){if(1&n&&Br(0,"div",7),2&n){const t=ds();Da(t.options.messageClass),Fn("innerHTML",t.message,d0)}}function zne(n,e){if(1&n&&(mt(0,"div",8),Bt(1),At()),2&n){const t=ds();Da(t.options.messageClass),ji("aria-label",t.message),an(1),Aa(" ",t.message," ")}}function Gne(n,e){if(1&n&&(mt(0,"div"),Br(1,"div",9),At()),2&n){const t=ds();an(1),dh("width",t.width+"%")}}class Jne{_attachedHost;component;viewContainerRef;injector;constructor(e,t){this.component=e,this.injector=t}attach(e,t){return this._attachedHost=e,e.attach(this,t)}detach(){const e=this._attachedHost;if(e)return this._attachedHost=void 0,e.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class ere{_attachedPortal;_disposeFn;attach(e,t){return this._attachedPortal=e,this.attachComponentPortal(e,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(e){this._disposeFn=e}}class tre{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new z;_activate=new z;_manualClose=new z;_resetTimeout=new z;_countDuplicate=new z;constructor(e){this._overlayRef=e}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(e,t){e&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}}class mI{toastId;config;message;title;toastType;toastRef;_onTap=new z;_onAction=new z;constructor(e,t,r,i,s,o){this.toastId=e,this.config=t,this.message=r,this.title=i,this.toastType=s,this.toastRef=o,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(e){this._onAction.next(e)}onAction(){return this._onAction.asObservable()}}const qU=new le("ToastConfig");class nre extends ere{_hostDomElement;_componentFactoryResolver;_appRef;constructor(e,t,r){super(),this._hostDomElement=e,this._componentFactoryResolver=t,this._appRef=r}attachComponentPortal(e,t){const r=this._componentFactoryResolver.resolveComponentFactory(e.component);let i;return i=r.create(e.injector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(i),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(i)),i}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let rre=(()=>{class n{_document=pe(yr);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class ire{_portalHost;constructor(e){this._portalHost=e}attach(e,t=!0){return this._portalHost.attach(e,t)}detach(){return this._portalHost.detach()}}let sre=(()=>{class n{_overlayContainer=pe(rre);_componentFactoryResolver=pe(ag);_appRef=pe(Pa);_document=pe(yr);_paneElements=new Map;create(t,r){return this._createOverlayRef(this.getPaneElement(t,r))}getPaneElement(t="",r){return this._paneElements.get(r)||this._paneElements.set(r,{}),this._paneElements.get(r)[t]||(this._paneElements.get(r)[t]=this._createPaneElement(t,r)),this._paneElements.get(r)[t]}_createPaneElement(t,r){const i=this._document.createElement("div");return i.id="toast-container",i.classList.add(t),i.classList.add("toast-container"),r?r.getContainerElement().appendChild(i):this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalHost(t){return new nre(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new ire(this._createPortalHost(t))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_I=(()=>{class n{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,r,i,s,o){this.overlay=r,this._injector=i,this.sanitizer=s,this.ngZone=o,this.toastrConfig={...t.default,...t.config},t.config.iconClasses&&(this.toastrConfig.iconClasses={...t.default.iconClasses,...t.config.iconClasses})}show(t,r,i={},s=""){return this._preBuildNotification(s,t,r,this.applyConfig(i))}success(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",t,r,this.applyConfig(i))}error(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",t,r,this.applyConfig(i))}info(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",t,r,this.applyConfig(i))}warning(t,r,i={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",t,r,this.applyConfig(i))}clear(t){for(const r of this.toasts)if(void 0!==t){if(r.toastId===t)return void r.toastRef.manualClose()}else r.toastRef.manualClose()}remove(t){const r=this._findToast(t);if(!r||(r.activeToast.toastRef.close(),this.toasts.splice(r.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const i=this.toasts[this.currentlyActive].toastRef;i.isInactive()||(this.currentlyActive=this.currentlyActive+1,i.activate())}return!0}findDuplicate(t="",r="",i,s){const{includeTitleDuplicates:o}=this.toastrConfig;for(const a of this.toasts)if((!o||o&&a.title===t)&&a.message===r)return a.toastRef.onDuplicate(i,s),a;return null}applyConfig(t={}){return{...this.toastrConfig,...t}}_findToast(t){for(let r=0;r<this.toasts.length;r++)if(this.toasts[r].toastId===t)return{index:r,activeToast:this.toasts[r]};return null}_preBuildNotification(t,r,i,s){return s.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,r,i,s)):this._buildNotification(t,r,i,s)}_buildNotification(t,r,i,s){if(!s.toastComponent)throw new Error("toastComponent required");const o=this.findDuplicate(i,r,this.toastrConfig.resetTimeoutOnDuplicate&&s.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&i||r)&&this.toastrConfig.preventDuplicates&&null!==o)return o;this.previousToastMessage=r;let a=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(a=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const u=this.overlay.create(s.positionClass,this.overlayContainer);this.index=this.index+1;let l=r;r&&s.enableHtml&&(l=this.sanitizer.sanitize(as.HTML,r));const d=new tre(u),f=new mI(this.index,s,l,i,t,d),_=Jr.create({providers:[{provide:mI,useValue:f}],parent:this._injector}),v=new Jne(s.toastComponent,_),T=u.attach(v,s.newestOnTop);d.componentInstance=T.instance;const D={toastId:this.index,title:i||"",message:r||"",toastRef:d,onShown:d.afterActivate(),onHidden:d.afterClosed(),onTap:f.onTap(),onAction:f.onAction(),portal:T};return a||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{D.toastRef.activate()})),this.toasts.push(D),D}static \u0275fac=function(r){return new(r||n)(W(qU),W(sre),W(Jr),W(dV),W(Tt))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ore={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",toastComponent:(()=>{class n{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=-1;toastClasses="";state;get displayStyle(){if("inactive"===this.state.value)return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,r,i){this.toastrService=t,this.toastPackage=r,this.ngZone=i,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(s=>{this.duplicatesCount=s}),this.state={value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}}}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state={...this.state,value:"active"},!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const t=(new Date).getTime();this.width=(this.hideTime-t)/this.options.timeOut*100,"increasing"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state={...this.state,value:"active"},this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state.value&&(clearTimeout(this.timeout),this.state={...this.state,value:"removed"},this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state.value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state.value&&"extendedTimeOut"!==this.options.disableTimeOut&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state.value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),r)):this.timeout=setTimeout(()=>t(),r)}outsideInterval(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),r)):this.intervalId=setInterval(()=>t(),r)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(r){return new(r||n)(J(_I),J(mI),J(Tt))};static \u0275cmp=Co({type:n,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(r,i){1&r&&ar("click",function(){return i.tapToast()})("mouseenter",function(){return i.stickAround()})("mouseleave",function(){return i.delayedHideToast()}),2&r&&(ab("@flyInOut",i.state),Da(i.toastClasses),dh("display",i.displayStyle))},standalone:!0,features:[aE],attrs:$U,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,i){1&r&&(ti(0,jne,3,0,"button",0),ti(1,Hne,3,5,"div",1),ti(2,qne,1,3,"div",2),ti(3,zne,2,4,"div",3),ti(4,Gne,2,2,"div",4)),2&r&&(Fn("ngIf",i.options.closeButton),an(1),Fn("ngIf",i.title),an(1),Fn("ngIf",i.message&&i.options.enableHtml),an(1),Fn("ngIf",i.message&&!i.options.enableHtml),an(1),Fn("ngIf",i.options.progressBar))},dependencies:[PE],encapsulation:2,data:{animation:[Bne("flyInOut",[IA("inactive",cm({opacity:0})),IA("active",cm({opacity:1})),IA("removed",cm({opacity:0})),BU("inactive => active",VU("{{ easeTime }}ms {{ easing }}")),BU("active => removed",VU("{{ easeTime }}ms {{ easing }}"))])]}})}return n})()},are=(n={})=>Mv([{provide:qU,useValue:{default:ore,config:n}}]);let ure=(()=>{class n{static forRoot(t={}){return{ngModule:n,providers:[are(t)]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({})}return n})(),TA=(()=>{class n{constructor(){this.loggedIn=new E(!1)}get isLoggedIn(){return this.loggedIn.asObservable()}isLoggedNext(t){return this.loggedIn.next(t)}SessionAddStorage(t,r){sessionStorage.setItem(t,JSON.stringify(r))}SessionGetStorage(t){const r=sessionStorage.getItem(t);return JSON.parse(r)}SessionRemove(t){sessionStorage.removeItem(t),sessionStorage.clear()}SessionClear(){sessionStorage.clear()}LocalAddStorage(t,r){localStorage.setItem(t,JSON.stringify(r))}LocalGetStorage(t){const r=localStorage.getItem(t);return JSON.parse(r)}LocalRemove(t){localStorage.removeItem(t)}LocalClear(){localStorage.clear()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class yI{}class vI{}class Hs{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Hs?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Hs;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Hs?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class lre{encodeKey(e){return zU(e)}encodeValue(e){return zU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const dre=/%(\d[a-f0-9])/gi,hre={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function zU(n){return encodeURIComponent(n).replace(dre,(e,t)=>hre[t]??e)}function EI(n){return`${n}`}class xu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new lre,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function cre(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],u=t.get(o)||[];u.push(a),t.set(o,u)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],i=Array.isArray(r)?r.map(EI):[EI(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new xu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(EI(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(EI(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class fre{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function GU(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function WU(n){return typeof Blob<"u"&&n instanceof Blob}function KU(n){return typeof FormData<"u"&&n instanceof FormData}class hm{constructor(e,t,r,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function pre(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Hs),this.context||(this.context=new fre),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new xu,this.urlWithParams=t}serializeBody(){return null===this.body?null:GU(this.body)||WU(this.body)||KU(this.body)||function gre(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof xu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||KU(this.body)?null:WU(this.body)?this.body.type||null:GU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let u=e.headers||this.headers,l=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((f,m)=>f.set(m,e.setHeaders[m]),u)),e.setParams&&(l=Object.keys(e.setParams).reduce((f,m)=>f.set(m,e.setParams[m]),l)),new hm(t,r,s,{params:l,headers:u,context:d,reportProgress:a,responseType:i,withCredentials:o})}}var Fh=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Fh||{});class CA{constructor(e,t=200,r="OK"){this.headers=e.headers||new Hs,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class bA extends CA{constructor(e={}){super(e),this.type=Fh.ResponseHeader}clone(e={}){return new bA({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Lh extends CA{constructor(e={}){super(e),this.type=Fh.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Lh({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ZU extends CA{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function DA(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let QU=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof hm)s=t;else{let u,l;u=i.headers instanceof Hs?i.headers:new Hs(i.headers),i.params&&(l=i.params instanceof xu?i.params:new xu({fromObject:i.params})),s=new hm(t,r,void 0!==i.body?i.body:null,{headers:u,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=R(s).pipe(Eh(u=>this.handler.handle(u)));if(t instanceof hm||"events"===i.observe)return o;const a=o.pipe($s(u=>u instanceof Lh));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(de(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return a.pipe(de(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return a.pipe(de(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return a.pipe(de(u=>u.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new xu).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,DA(i,r))}post(t,r,i={}){return this.request("POST",t,DA(i,r))}put(t,r,i={}){return this.request("PUT",t,DA(i,r))}static#e=this.\u0275fac=function(r){return new(r||n)(W(yI))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function JU(n,e){return e(n)}function _re(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}const vre=new le(""),fm=new le(""),eB=new le("");function Ere(){let n=null;return(e,t)=>{null===n&&(n=(pe(vre,{optional:!0})??[]).reduceRight(_re,JU));const r=pe(dE),i=r.add();return n(e,t).pipe(Gg(()=>r.remove(i)))}}let tB=(()=>{class n extends yI{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=pe(dE)}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(fm),...this.injector.get(eB,[])]));this.chain=i.reduceRight((s,o)=>function yre(n,e,t){return(r,i)=>t.runInContext(()=>e(r,s=>n(s,i)))}(s,o,this.injector),JU)}const r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Gg(()=>this.pendingTasks.remove(r)))}static#e=this.\u0275fac=function(r){return new(r||n)(W(vI),W(us))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const Cre=/^\)\]\}',?\n/;let rB=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new L(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?I(r.\u0275loadImpl()):R(null)).pipe(ve(()=>new Ze(s=>{const o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((T,D)=>o.setRequestHeader(T,D.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const T=t.detectContentTypeHeader();null!==T&&o.setRequestHeader("Content-Type",T)}if(t.responseType){const T=t.responseType.toLowerCase();o.responseType="json"!==T?T:"text"}const a=t.serializeBody();let u=null;const l=()=>{if(null!==u)return u;const T=o.statusText||"OK",D=new Hs(o.getAllResponseHeaders()),k=function bre(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return u=new bA({headers:D,status:o.status,statusText:T,url:k}),u},d=()=>{let{headers:T,status:D,statusText:k,url:P}=l(),O=null;204!==D&&(O=typeof o.response>"u"?o.responseText:o.response),0===D&&(D=O?200:0);let q=D>=200&&D<300;if("json"===t.responseType&&"string"==typeof O){const ue=O;O=O.replace(Cre,"");try{O=""!==O?JSON.parse(O):null}catch(Te){O=ue,q&&(q=!1,O={error:Te,text:O})}}q?(s.next(new Lh({body:O,headers:T,status:D,statusText:k,url:P||void 0})),s.complete()):s.error(new ZU({error:O,headers:T,status:D,statusText:k,url:P||void 0}))},f=T=>{const{url:D}=l(),k=new ZU({error:T,status:o.status||0,statusText:o.statusText||"Unknown Error",url:D||void 0});s.error(k)};let m=!1;const _=T=>{m||(s.next(l()),m=!0);let D={type:Fh.DownloadProgress,loaded:T.loaded};T.lengthComputable&&(D.total=T.total),"text"===t.responseType&&o.responseText&&(D.partialText=o.responseText),s.next(D)},v=T=>{let D={type:Fh.UploadProgress,loaded:T.loaded};T.lengthComputable&&(D.total=T.total),s.next(D)};return o.addEventListener("load",d),o.addEventListener("error",f),o.addEventListener("timeout",f),o.addEventListener("abort",f),t.reportProgress&&(o.addEventListener("progress",_),null!==a&&o.upload&&o.upload.addEventListener("progress",v)),o.send(a),s.next({type:Fh.Sent}),()=>{o.removeEventListener("error",f),o.removeEventListener("abort",f),o.removeEventListener("load",d),o.removeEventListener("timeout",f),t.reportProgress&&(o.removeEventListener("progress",_),null!==a&&o.upload&&o.upload.removeEventListener("progress",v)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(r){return new(r||n)(W(qL))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const AA=new le("XSRF_ENABLED"),iB=new le("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),sB=new le("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class oB{}let Sre=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=FL(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(Vs),W(iB))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();function Rre(n,e){const t=n.url.toLowerCase();if(!pe(AA)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const r=pe(oB).getToken(),i=pe(sB);return null!=r&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var ku=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(ku||{});function Pre(...n){const e=[QU,rB,tB,{provide:yI,useExisting:tB},{provide:vI,useExisting:rB},{provide:fm,useValue:Rre,multi:!0},{provide:AA,useValue:!0},{provide:oB,useClass:Sre}];for(const t of n)e.push(...t.\u0275providers);return Mv(e)}const aB=new le("LEGACY_INTERCEPTOR_FN");function Nre(){return function ic(n,e){return{\u0275kind:n,\u0275providers:e}}(ku.LegacyInterceptors,[{provide:aB,useFactory:Ere},{provide:fm,useExisting:aB,multi:!0}])}let Mre=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({providers:[Pre(Nre())]})}return n})(),uB=(()=>{class n{constructor(t,r,i,s){this.http=t,this.storageService=r,this.afAuth=i,this.toastr=s,this.apiUrl="https://weed-406221.uc.r.appspot.com/"}GoogleAuth(){return this.AuthLogin(new SU.X)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{console.log("You have been successfully logged in!")}).catch(r=>{console.log(r)})}getUser(t){const r=(new Hs).set("Authorization","Bearer 1234");return new Promise((i,s)=>{this.http.get(this.apiUrl+"user/"+t,{headers:r}).subscribe(o=>{i(o)},o=>{s(o)})})}sendUser(t){const r=(new Hs).set("Authorization","Bearer 1234");return new Promise((i,s)=>{this.http.patch(this.apiUrl+"user/"+t.id,t,{headers:r}).subscribe(o=>{i(o)},o=>{s(o)})})}static#e=this.\u0275fac=function(r){return new(r||n)(W(QU),W(TA),W(nc),W(_I))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Vre(n,e){1&n&&(mt(0,"span",12)(1,"strong"),Bt(2,"Mail"),At(),Bt(3," is required "),At())}function Ure(n,e){1&n&&(mt(0,"span",12),Bt(1," Mail must be "),mt(2,"strong"),Bt(3,"valid"),At()())}function Bre(n,e){1&n&&(mt(0,"span",12)(1,"strong"),Bt(2,"Password"),At(),Bt(3," is required "),At())}const jre=[{path:"",component:(()=>{class n{constructor(t,r,i,s,o,a,u){this.fb=t,this.afAuth=r,this.router=i,this.fireBaseErrorService=s,this.toastr=o,this.storageService=a,this.apiService=u,this.loginUser=this.fb.group({email:["",[ka.required,ka.email]],password:["",ka.required]}),this.subscription=this.storageService.isLoggedIn.subscribe(l=>{1==l&&this.router.navigate(["dashboard"])}),this.checkSession()}checkSession(){const t=localStorage.getItem("usrMail")||"",r=localStorage.getItem("usrPswd")||"";this.login(t,r,!0)}login(t,r,i){var s=this.loginUser.value.email,o=this.loginUser.value.password;if(i){if(""==t||""==r)return;s=t,o=r}this.afAuth.signInWithEmailAndPassword(s,o).then(a=>{this.storageService.isLoggedNext(!0),this.storageService.SessionAddStorage("uid",a.user?.uid),this.router.navigate(["home"])}).catch(a=>{this.toastr.error(this.fireBaseErrorService.firebaseError(a.code),"Error")})}GoogleAuth(){return this.AuthLogin(new SU.X)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{this.storageService.isLoggedNext(!0),this.storageService.SessionAddStorage("uid",r.user?.uid),console.log(r.user?.uid),this.router.navigate(["home"])}).catch(r=>{console.log(r)})}static#e=this.\u0275fac=function(r){return new(r||n)(J(I2),J(nc),J(qi),J(Vne),J(_I),J(TA),J(uB))};static#t=this.\u0275cmp=Co({type:n,selectors:[["app-login"]],decls:23,vars:5,consts:[[1,"wrapper"],[1,"body"],[3,"formGroup","ngSubmit"],[1,"form-floating","mb-3"],["type","email","formControlName","email","placeholder","name@example.com",1,"form-control"],["class","text-danger errorLabel",4,"ngIf"],["type","password","formControlName","password","placeholder","Password",1,"form-control"],[1,"d-grid","gap-2"],["type","submit",1,"basicButton","btn-google",3,"disabled"],[1,"form-group","mt-3"],[1,"btn","btn-lg","btn-google",3,"click"],["src","/assets/img/googleicon.png","alt",""],[1,"text-danger","errorLabel"]],template:function(r,i){if(1&r&&(mt(0,"div",0)(1,"div",1)(2,"h1"),Bt(3,"Wellcome to Weed CoBot"),At(),mt(4,"form",2),ar("ngSubmit",function(){return i.login("","",!1)}),mt(5,"div",3),Br(6,"input",4),mt(7,"label"),Bt(8,"Email"),At(),ti(9,Vre,4,0,"span",5),ti(10,Ure,4,0,"span",5),At(),mt(11,"div",3),Br(12,"input",6),mt(13,"label"),Bt(14,"Password"),At(),ti(15,Bre,4,0,"span",5),At(),mt(16,"div",7)(17,"button",8),Bt(18,"Login"),At()()(),mt(19,"div",9)(20,"button",10),ar("click",function(){return i.GoogleAuth()}),Br(21,"img",11),Bt(22," Login with google"),At()()()()),2&r){let s,o,a;an(4),Fn("formGroup",i.loginUser),an(5),Fn("ngIf",(null==(s=i.loginUser.get("email"))?null:s.hasError("required"))&&(null==(s=i.loginUser.get("email"))?null:s.touched)),an(1),Fn("ngIf",(null==(o=i.loginUser.get("email"))?null:o.hasError("email"))&&(null==(o=i.loginUser.get("email"))?null:o.touched)),an(5),Fn("ngIf",(null==(a=i.loginUser.get("password"))?null:a.hasError("required"))&&(null==(a=i.loginUser.get("password"))?null:a.touched)),an(2),Fn("disabled",i.loginUser.invalid)}},dependencies:[PE,kD,Fg,TD,CD,qg,zE],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-image:url(/assets/img/background.jpg);background-size:cover;padding:100px;height:100vh}.logo[_ngcontent-%COMP%]{height:130px;margin-bottom:10px}.body[_ngcontent-%COMP%]{margin-top:2%;width:100%;max-width:330px;text-align:center;padding:3%;border-radius:20px;background-color:#00000089}.btn-google[_ngcontent-%COMP%]{background-color:#61a1fe;color:#fff;width:100%;font-weight:500}.btn-reg[_ngcontent-%COMP%]{background-color:#9d9d9d;color:#fff;width:100%;font-weight:500}.btn-google[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;margin-bottom:4px;margin-right:14px}.btn-reg[_ngcontent-%COMP%]{background-color:#9d9d9d;color:#fff;width:100%}h1[_ngcontent-%COMP%]{color:#fff;font-weight:500;border-color:#fff}.basicButton[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:8px;border-radius:8px;border-color:none;font-size:20px}"]})}return n})()},{path:"register",component:(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=Co({type:n,selectors:[["app-register"]],decls:2,vars:0,template:function(r,i){1&r&&(mt(0,"p"),Bt(1,"register works!"),At())}})}return n})()},{path:"home",component:(()=>{class n{constructor(t,r,i,s,o){this.fb=t,this.afAuth=r,this.router=i,this.storageService=s,this.apiService=o,this.changesForm=this.fb.group({maximum_temperature:["",[ka.required]],minimum_temperature:["",ka.required],maximum_air_humidity:["",[ka.required]],minimum_air_humidity:["",ka.required],maximum_soil_humidity:["",[ka.required]],minimum_soil_humidity:["",ka.required]}),o.getUser(this.storageService.SessionGetStorage("uid")).then(a=>{this.changesForm.controls.maximum_temperature.setValue(a.max_temperature),this.changesForm.controls.minimum_temperature.setValue(a.min_temperature),this.changesForm.controls.maximum_air_humidity.setValue(a.max_air_humidity),this.changesForm.controls.minimum_air_humidity.setValue(a.min_air_humidity),this.changesForm.controls.maximum_soil_humidity.setValue(a.max_soil_humidity),this.changesForm.controls.minimum_soil_humidity.setValue(a.min_soil_humidity),s.SessionAddStorage("user",a)})}sendChanges(){let t=this.storageService.SessionGetStorage("user");t.max_air_humidity=Number(this.changesForm.value.maximum_air_humidity),t.min_air_humidity=Number(this.changesForm.value.minimum_air_humidity),t.max_temperature=Number(this.changesForm.value.maximum_temperature),t.min_temperature=Number(this.changesForm.value.minimum_temperature),t.max_soil_humidity=Number(this.changesForm.value.maximum_soil_humidity),t.min_soil_humidity=Number(this.changesForm.value.minimum_soil_humidity),this.apiService.sendUser(t)}logout(){this.afAuth.signOut().then(()=>{this.storageService.isLoggedNext(!1),localStorage.clear(),this.storageService.SessionClear(),this.router.navigate(["/"])})}static#e=this.\u0275fac=function(r){return new(r||n)(J(I2),J(nc),J(qi),J(TA),J(uB))};static#t=this.\u0275cmp=Co({type:n,selectors:[["app-home"]],decls:27,vars:2,consts:[[1,"wrapper"],[1,"body"],[3,"formGroup","ngSubmit"],[1,"text-light"],["type","text","formControlName","maximum_temperature","placeholder","maximum_temperature",1,"form-control"],["type","text","formControlName","minimum_temperature","placeholder","minimum_temperature",1,"form-control"],["type","text","formControlName","maximum_air_humidity","placeholder","maximum_air_humidity",1,"form-control"],["type","text","formControlName","minimum_air_humidity","placeholder","minimum_air_humidity",1,"form-control"],["type","text","formControlName","maximum_soil_humidity","placeholder","maximum_soil_humidity",1,"form-control"],["type","text","formControlName","minimum_soil_humidity","placeholder","minimum_soil_humidity",1,"form-control"],["type","submit",1,"btn","btn-success","mt-2",3,"disabled"],[1,"btn","btn-danger","mt-2",3,"click"]],template:function(r,i){1&r&&(mt(0,"div",0)(1,"div",1)(2,"h1"),Bt(3,"Wellcome to Weed CoBot"),At(),mt(4,"form",2),ar("ngSubmit",function(){return i.sendChanges()}),mt(5,"label",3),Bt(6,"maximum_temperature"),At(),Br(7,"input",4),mt(8,"label",3),Bt(9,"minimum_temperature"),At(),Br(10,"input",5),mt(11,"label",3),Bt(12,"maximum_air_humidity"),At(),Br(13,"input",6),mt(14,"label",3),Bt(15,"minimum_air_humidity"),At(),Br(16,"input",7),mt(17,"label",3),Bt(18,"maximum_soil_humidity"),At(),Br(19,"input",8),mt(20,"label",3),Bt(21,"minimum_soil_humidity"),At(),Br(22,"input",9),mt(23,"button",10),Bt(24,"Save Changes"),At()(),mt(25,"button",11),ar("click",function(){return i.logout()}),Bt(26,"Logout"),At()()()),2&r&&(an(4),Fn("formGroup",i.changesForm),an(19),Fn("disabled",i.changesForm.invalid))},dependencies:[kD,Fg,TD,CD,qg,zE],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-image:url(/assets/img/homeBack.jpg);background-size:cover;padding:100px;height:100vh}.editContent[_ngcontent-%COMP%]{text-align:left;padding:5%;background-color:#00000094;color:#fff;border-radius:20px}.editContent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:30px;width:100%;border-radius:8px}.body[_ngcontent-%COMP%]{margin-top:2%;width:100%;max-width:330px;text-align:center;padding:3%;border-radius:20px;background-color:#00000089}h1[_ngcontent-%COMP%]{color:#fff;font-weight:500;border-color:#fff}"]})}return n})()}];let $re=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({imports:[DU.forRoot(jre),DU]})}return n})(),Hre=(()=>{class n{constructor(){this.title="weedcobot-angular"}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=Co({type:n,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"content"]],template:function(r,i){1&r&&(mt(0,"div",0),Br(1,"router-outlet"),At())},dependencies:[rA]})}return n})();const qre_firebase={apiKey:"AIzaSyACr8sywQsvgP9JEoDjruJpLlfeOdT9M5g",authDomain:"weedcobot.firebaseapp.com",projectId:"weedcobot",storageBucket:"weedcobot.appspot.com",messagingSenderId:"626040150744",appId:"1:626040150744:web:9cd284bb5098a73e1895ad"};var Q=ke(861);const lB="@firebase/database";let SA="";function RA(n){SA=n}class Wre{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,b.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,b.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Kre{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,b.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const dB=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Wre(e)}}catch{}return new Kre},sc=dB("localStorage"),PA=dB("sessionStorage"),Vh=new fs.Yd("@firebase/database"),hB=function(){let n=1;return function(){return n++}}(),fB=function(n){const e=(0,b.dS)(n),t=new b.gQ;t.update(e);const r=t.digest();return b.US.encodeByteArray(r)},pm=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=pm.apply(null,r):e+="object"==typeof r?(0,b.Wl)(r):r,e+=" "}return e};let oc=null,pB=!0;const gB=function(n,e){(0,b.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Vh.logLevel=fs.in.VERBOSE,oc=Vh.log.bind(Vh),e&&PA.set("logging_enabled",!0)):"function"==typeof n?oc=n:(oc=null,PA.remove("logging_enabled"))},Ar=function(...n){if(!0===pB&&(pB=!1,null===oc&&!0===PA.get("logging_enabled")&&gB(!0)),oc){const e=pm.apply(null,n);oc(e)}},gm=function(n){return function(...e){Ar(n,...e)}},NA=function(...n){const e="FIREBASE INTERNAL ERROR: "+pm(...n);Vh.error(e)},jo=function(...n){const e=`FIREBASE FATAL ERROR: ${pm(...n)}`;throw Vh.error(e),new Error(e)},ri=function(...n){const e="FIREBASE WARNING: "+pm(...n);Vh.warn(e)},wI=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Ou="[MIN_NAME]",Va="[MAX_NAME]",ac=function(n,e){if(n===e)return 0;if(n===Ou||e===Va)return-1;if(e===Ou||n===Va)return 1;{const t=yB(n),r=yB(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},Yre=function(n,e){return n===e?0:n<e?-1:1},mm=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,b.Wl)(e))},MA=function(n){if("object"!=typeof n||null===n)return(0,b.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,b.Wl)(e[r]),t+=":",t+=MA(n[e[r]]);return t+="}",t},mB=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Sr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const _B=function(n){(0,b.hu)(!wI(n),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===n?(s=0,o=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const l=[];for(u=52;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();const d=l.join("");let f="";for(u=0;u<64;u+=8){let m=parseInt(d.substr(u,8),2).toString(16);1===m.length&&(m="0"+m),f+=m}return f.toLowerCase()},tie=new RegExp("^-?(0*)\\d{1,10}$"),yB=function(n){if(tie.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},Uh=function(n){try{n()}catch(e){setTimeout(()=>{throw ri("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},_m=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class sie{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ri(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class oie{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ar("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ri(e)}}let ym=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const TB=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,DB="websocket",AB="long_polling";class kA{constructor(e,t,r,i,s=!1,o="",a=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=sc.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&sc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function SB(n,e,t){let r;if((0,b.hu)("string"==typeof e,"typeof type must == string"),(0,b.hu)("object"==typeof t,"typeof params must == object"),e===DB)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==AB)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function aie(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Sr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class uie{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,b.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,b.p$)(this.counters_)}}const OA={},FA={};function LA(n){const e=n.toString();return OA[e]||(OA[e]=new uie),OA[e]}class cie{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Uh(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Fu{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=gm(e),this.stats_=LA(t),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),SB(t,AB,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new cie(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,b.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new VA((...s)=>{const[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&TB.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fu.forceAllow_=!0}static forceDisallow(){Fu.forceDisallow_=!0}static isAvailable(){return!((0,b.Yr)()||!Fu.forceAllow_&&(Fu.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,b.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,b.h$)(t),i=mB(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,b.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,b.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class VA{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,b.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=hB(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=VA.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ar("frame writing exception"),a.stack&&Ar(a.stack),Ar(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ar("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,b.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ar("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let CI=null;typeof MozWebSocket<"u"?CI=MozWebSocket:typeof WebSocket<"u"&&(CI=WebSocket);let Bh=(()=>{class n{constructor(t,r,i,s,o,a,u){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=gm(this.connId),this.stats_=LA(r),this.connURL=n.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){const a={v:"5"};return!(0,b.Yr)()&&typeof location<"u"&&location.hostname&&TB.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),SB(t,DB,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,sc.set("previous_websocket_failure",!0);try{let i;if((0,b.Yr)()){i={headers:{"User-Agent":`Firebase/5/${SA}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new CI(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==CI&&!n.forceDisallow_}static previouslyFailed(){return sc.isInMemoryStorage||!0===sc.get("previous_websocket_failure")}markConnectionHealthy(){sc.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,b.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,b.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,b.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=mB(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),OB=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Fu,Bh]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Bh&&Bh.isAvailable();let i=r&&!Bh.previouslyFailed();if(t.webSocketOnly&&(r||ri("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Bh];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class $B{constructor(e,t,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=gm("c:"+this.id+":"),this.transportManager_=new OB(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=_m(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=mm("t",e),r=mm("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=mm("t",e),r=mm("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=mm("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?NA("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):NA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&ri("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),_m(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):_m(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(sc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class HB{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class qB{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,b.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,b.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class bI extends qB{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,b.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new bI}getInitialEvent(e){return(0,b.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class jt{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function xt(){return new jt("")}function ut(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Lu(n){return n.pieces_.length-n.pieceNum_}function Xt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new jt(n.pieces_,e)}function BA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function vm(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function WB(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new jt(e,0)}function Sn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof jt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new jt(t,0)}function lt(n){return n.pieceNum_>=n.pieces_.length}function Ai(n,e){const t=ut(n),r=ut(e);if(null===t)return e;if(t===r)return Ai(Xt(n),Xt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Mie(n,e){const t=vm(n,0),r=vm(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=ac(t[i],r[i]);if(0!==s)return s}return t.length===r.length?0:t.length<r.length?-1:1}function jA(n,e){if(Lu(n)!==Lu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function qs(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Lu(n)>Lu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class xie{constructor(e,t){this.errorPrefix_=t,this.parts_=vm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,b.ug)(this.parts_[r]);KB(this)}}function KB(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+uc(n))}function uc(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class $A extends qB{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new $A}getInitialEvent(e){return(0,b.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Em=1e3;let AI,lc=(()=>{class n extends HB{constructor(t,r,i,s,o,a,u,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=gm("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Em,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,b.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$A.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&bI.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_((0,b.Wl)(o)),(0,b.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const r=new b.BH,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,b.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,b.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,u=>{const l=u.d,d=u.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",u),"ok"!==d&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,b.r3)(t,"w")){const i=(0,b.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();ri(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,b.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,b.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,b.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);const o={p:t};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,b.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):NA("Unrecognized action received from server: "+(0,b.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,b.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Em,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Em,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Em),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Q.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let u=!1,l=null;const d=function(){l?l.close():(u=!0,s())};t.realtime_={close:d,sendRequest:function(_){(0,b.hu)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)}};const m=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[_,v]=yield Promise.all([t.authTokenProvider_.getToken(m),t.appCheckTokenProvider_.getToken(m)]);u?Ar("getToken() completed but was canceled"):(Ar("getToken() completed. Creating connection."),t.authToken_=_&&_.accessToken,t.appCheckToken_=v&&v.token,l=new $B(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,s,T=>{ri(T+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(_){t.log_("Failed to get token: "+_),u||(t.repoInfo_.nodeAdmin&&ri(_),d())}}})()}interrupt(t){Ar("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ar("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,b.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Em,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(o=>MA(o)).join("$"):"default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){const i=new jt(t).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Ar("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ar("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,b.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+SA.replace(/\./g,"-")]=1,(0,b.uI)()?t["framework.cordova"]=1:(0,b.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=bI.getInstance().currentlyOnline();return(0,b.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class ft{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ft(e,t)}}class DI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ft(Ou,e),i=new ft(Ou,t);return 0!==this.compare(r,i)}minPost(){return ft.MIN}}class YB extends DI{static get __EMPTY_NODE(){return AI}static set __EMPTY_NODE(e){AI=e}compare(e,t){return ac(e.name,t.name)}isDefinedOn(e){throw(0,b.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ft.MIN}maxPost(){return new ft(Va,AI)}makePost(e,t){return(0,b.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new ft(e,AI)}toString(){return".key"}}const $o=new YB;class SI{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let qA,co=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Gi.EMPTY_NODE,this.right=o??Gi.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Gi.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return Gi.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Gi{constructor(e,t=Gi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Gi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,co.BLACK,null,null))}remove(e){return new Gi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,co.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new SI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new SI(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new SI(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new SI(this.root_,null,this.comparator_,!0,e)}}function jie(n,e){return ac(n.name,e.name)}function HA(n,e){return ac(n,e)}Gi.EMPTY_NODE=new class Bie{copy(e,t,r,i,s){return this}insert(e,t,r){return new co(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const XB=function(n){return"number"==typeof n?"number:"+_B(n):"string:"+n},JB=function(n){if(n.isLeafNode()){const e=n.val();(0,b.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,b.r3)(e,".sv"),"Priority must be a string or number.")}else(0,b.hu)(n===qA||n.isEmpty(),"priority of unexpected type.");(0,b.hu)(n===qA||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ej,tj,nj,jh=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,b.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),JB(this.priorityNode_)}static set __childrenNodeConstructor(t){ej=t}static get __childrenNodeConstructor(){return ej}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return lt(t)?this:".priority"===ut(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=ut(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,b.hu)(".priority"!==i||1===Lu(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xt(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+XB(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?_B(this.value_):this.value_,this.lazyHash_=fB(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,b.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return(0,b.hu)(s>=0,"Unknown leaf type: "+r),(0,b.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const cn=new class zie extends DI{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return 0===s?ac(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ft.MIN}maxPost(){return new ft(Va,new jh("[PRIORITY-POST]",nj))}makePost(e,t){const r=tj(e);return new ft(t,new jh("[PRIORITY-POST]",r))}toString(){return".priority"}},Gie=Math.log(2);class Wie{constructor(e){this.count=parseInt(Math.log(e+1)/Gie,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const RI=function(n,e,t,r){n.sort(e);const i=function(u,l){const d=l-u;let f,m;if(0===d)return null;if(1===d)return f=n[u],m=t?t(f):f,new co(m,f.node,co.BLACK,null,null);{const _=parseInt(d/2,10)+u,v=i(u,_),T=i(_+1,l);return f=n[_],m=t?t(f):f,new co(m,f.node,co.BLACK,v,T)}},a=function(u){let l=null,d=null,f=n.length;const m=function(v,T){const D=f-v,k=f;f-=v;const P=i(D+1,k),O=n[D],q=t?t(O):O;_(new co(q,O.node,T,null,P))},_=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<u.count;++v){const T=u.nextBitIsOne(),D=Math.pow(2,u.count-(v+1));T?m(D,co.BLACK):(m(D,co.BLACK),m(D,co.RED))}return d}(new Wie(n.length));return new Gi(r||e,a)};let zA;const $h={};class Ua{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,b.hu)($h&&cn,"ChildrenNode.ts has not been loaded"),zA=zA||new Ua({".priority":$h},{".priority":cn}),zA}get(e){const t=(0,b.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Gi?t:null}hasIndex(e){return(0,b.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,b.hu)(e!==$o,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(ft.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?RI(r,e.getCompare()):$h;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const d=Object.assign({},this.indexes_);return d[u]=a,new Ua(d,l)}addToIndexes(e,t){const r=(0,b.UI)(this.indexes_,(i,s)=>{const o=(0,b.DV)(this.indexSet_,s);if((0,b.hu)(o,"Missing index implementation for "+s),i===$h){if(o.isDefinedOn(e.node)){const a=[],u=t.getIterator(ft.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),RI(a,o.getCompare())}return $h}{const a=t.get(e.name);let u=i;return a&&(u=u.remove(new ft(e.name,a))),u.insert(e,e.node)}});return new Ua(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,b.UI)(this.indexes_,i=>{if(i===$h)return i;{const s=t.get(e.name);return s?i.remove(new ft(e.name,s)):i}});return new Ua(r,this.indexSet_)}}let Im,Ye=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&JB(this.priorityNode_),this.children_.isEmpty()&&(0,b.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Im||(Im=new n(new Gi(HA),null,Ua.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Im}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Im:r}}getChild(t){const r=ut(t);return null===r?this:this.getImmediateChild(r).getChild(Xt(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,b.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new ft(t,r);let s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?Im:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){const i=ut(t);if(null===i)return r;{(0,b.hu)(".priority"!==ut(t)||1===Lu(t),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Xt(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(cn,(a,u)=>{r[a]=u.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+XB(this.getPriority().val())+":"),this.forEachChild(cn,(r,i)=>{const s=i.hash();""!==s&&(t+=":"+r+":"+s)}),this.lazyHash_=""===t?"":fB(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ft(t,r));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new ft(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new ft(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,ft.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,ft.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===wm?-1:0}withIndex(t){if(t===$o||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===$o||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(cn),s=r.getIterator(cn);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===$o?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const wm=new class Kie extends Ye{constructor(){super(new Gi(HA),Ye.EMPTY_NODE,Ua.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ye.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(ft,{MIN:{value:new ft(Ou,Ye.EMPTY_NODE)},MAX:{value:new ft(Va,wm)}}),YB.__EMPTY_NODE=Ye.EMPTY_NODE,jh.__childrenNodeConstructor=Ye,function $ie(n){qA=n}(wm),function qie(n){nj=n}(wm);const Zie=!0;function Ln(n,e=null){if(null===n)return Ye.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,b.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new jh(n,Ln(e));if(n instanceof Array||!Zie){let t=Ye.EMPTY_NODE;return Sr(n,(r,i)=>{if((0,b.r3)(n,r)&&"."!==r.substring(0,1)){const s=Ln(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Ln(e))}{const t=[];let r=!1;if(Sr(n,(o,a)=>{if("."!==o.substring(0,1)){const u=Ln(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new ft(o,u)))}}),0===t.length)return Ye.EMPTY_NODE;const s=RI(t,jie,o=>o.name,HA);if(r){const o=RI(t,cn.getCompare());return new Ye(s,Ln(e),new Ua({".priority":o},{".priority":cn}))}return new Ye(s,Ln(e),Ua.Default)}}!function Hie(n){tj=n}(Ln);class GA extends DI{constructor(e){super(),this.indexPath_=e,(0,b.hu)(!lt(e)&&".priority"!==ut(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return 0===s?ac(e.name,t.name):s}makePost(e,t){const r=Ln(e),i=Ye.EMPTY_NODE.updateChild(this.indexPath_,r);return new ft(t,i)}maxPost(){const e=Ye.EMPTY_NODE.updateChild(this.indexPath_,wm);return new ft(Va,e)}toString(){return vm(this.indexPath_,0).join("/")}}const WA=new class Qie extends DI{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?ac(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ft.MIN}maxPost(){return ft.MAX}makePost(e,t){const r=Ln(e);return new ft(t,r)}toString(){return".value"}};function rj(n){return{type:"value",snapshotNode:n}}function Hh(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Tm(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Cm(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class KA{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){(0,b.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Tm(t,a)):(0,b.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Hh(t,r)):o.trackChildChange(Cm(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(cn,(i,s)=>{t.hasChild(i)||r.trackChildChange(Tm(i,s))}),t.isLeafNode()||t.forEachChild(cn,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Cm(i,s,o))}else r.trackChildChange(Hh(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ye.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class bm{constructor(e){this.indexedFilter_=new KA(e.getIndex()),this.index_=e.getIndex(),this.startPost_=bm.getStartPost_(e),this.endPost_=bm.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ft(t,r))||(r=Ye.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Ye.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Ye.EMPTY_NODE);const s=this;return t.forEachChild(cn,(o,a)=>{s.matches(new ft(o,a))||(i=i.updateImmediateChild(o,Ye.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Xie{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new bm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ft(t,r))||(r=Ye.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Ye.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;i=Ye.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=t.withIndex(this.index_),i=i.updatePriority(Ye.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Ye.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,_)=>f(_,m)}else o=this.index_.getCompare();const a=e;(0,b.hu)(a.numChildren()===this.limit_,"");const u=new ft(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(t)){const f=a.getImmediateChild(t);let m=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=m&&(m.name===t||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const _=null==m?1:o(m,u);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(Cm(t,r,f)),a.updateImmediateChild(t,r);{s?.trackChildChange(Tm(t,f));const T=a.updateImmediateChild(t,Ye.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange(Hh(m.name,m.node)),T.updateImmediateChild(m.name,m.node)):T}}return r.isEmpty()?e:d&&o(l,u)>=0?(null!=s&&(s.trackChildChange(Tm(l.name,l.node)),s.trackChildChange(Hh(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,Ye.EMPTY_NODE)):e}}class PI{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=cn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,b.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,b.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ou}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,b.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,b.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Va}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,b.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===cn}copy(){const e=new PI;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ZA(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function QA(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function NI(n,e){const t=n.copy();return t.index_=e,t}function ij(n){const e={};if(n.isDefault())return e;let t;if(n.index_===cn?t="$priority":n.index_===WA?t="$value":n.index_===$o?t="$key":((0,b.hu)(n.index_ instanceof GA,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,b.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,b.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,b.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,b.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,b.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function sj(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==cn&&(e.i=n.index_.toString()),e}class MI extends HB{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=gm("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,b.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=MI.getListenId_(e,r),a={};this.listens_[o]=a;const u=ij(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let f=d;if(404===l&&(f=null,l=null),null===l&&this.onDataUpdate_(s,f,!1,r),(0,b.DV)(this.listens_,o)===a){let m;m=l?401===l?"permission_denied":"rest_error:"+l:"ok",i(m,null)}})}unlisten(e,t){const r=MI.getListenId_(e,t);delete this.listens_[r]}get(e){const t=ij(e._queryParams),r=e._path.toString(),i=new b.BH;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,b.xO)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,b.cI)(a.responseText)}catch{ri("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&ri("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class ise{constructor(){this.rootNode_=Ye.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function xI(){return{value:null,children:new Map}}function qh(n,e,t){if(lt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=ut(e);n.children.has(r)||n.children.set(r,xI()),qh(n.children.get(r),e=Xt(e),t)}}function YA(n,e){if(lt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(cn,(r,i)=>{qh(n,new jt(r),i)}),YA(n,e)}}if(n.children.size>0){const t=ut(e);return e=Xt(e),n.children.has(t)&&YA(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function XA(n,e,t){null!==n.value?t(e,n.value):function sse(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{XA(i,new jt(e.toString()+"/"+r),t)})}class ose{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Sr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class lse{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ose(e);const r=1e4+2e4*Math.random();_m(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Sr(e,(i,s)=>{s>0&&(0,b.r3)(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),_m(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ho=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ho||{});function tS(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class kI{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ho.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(lt(this.path)){if(null!=this.affectedTree.value)return(0,b.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new jt(e));return new kI(xt(),t,this.revert)}}return(0,b.hu)(ut(this.path)===e,"operationForChild called for unrelated child."),new kI(Xt(this.path),this.affectedTree,this.revert)}}class Dm{constructor(e,t){this.source=e,this.path=t,this.type=Ho.LISTEN_COMPLETE}operationForChild(e){return lt(this.path)?new Dm(this.source,xt()):new Dm(this.source,Xt(this.path))}}class cc{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ho.OVERWRITE}operationForChild(e){return lt(this.path)?new cc(this.source,xt(),this.snap.getImmediateChild(e)):new cc(this.source,Xt(this.path),this.snap)}}class zh{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ho.MERGE}operationForChild(e){if(lt(this.path)){const t=this.children.subtree(new jt(e));return t.isEmpty()?null:t.value?new cc(this.source,xt(),t.value):new zh(this.source,xt(),t)}return(0,b.hu)(ut(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new zh(this.source,Xt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Vu{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(lt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ut(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class cse{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Am(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,u)=>function fse(n,e,t){if(null==e.childName||null==t.childName)throw(0,b.g5)("Should only compare child_ events.");const r=new ft(e.childName,e.snapshotNode),i=new ft(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,a,u)),o.forEach(a=>{const u=function hse(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,n.query_))})})}function OI(n,e){return{eventCache:n,serverCache:e}}function Sm(n,e,t,r){return OI(new Vu(e,t,r),n.serverCache)}function aj(n,e,t,r){return OI(n.eventCache,new Vu(e,t,r))}function FI(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function dc(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let nS;class dn{constructor(e,t=(()=>(nS||(nS=new Gi(Yre)),nS))()){this.value=e,this.children=t}static fromObject(e){let t=new dn(null);return Sr(e,(r,i)=>{t=t.set(new jt(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:xt(),value:this.value};if(lt(e))return null;{const r=ut(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Xt(e),t);return null!=s?{path:Sn(new jt(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(lt(e))return this;{const t=ut(e),r=this.children.get(t);return null!==r?r.subtree(Xt(e)):new dn(null)}}set(e,t){if(lt(e))return new dn(t,this.children);{const r=ut(e),s=(this.children.get(r)||new dn(null)).set(Xt(e),t),o=this.children.insert(r,s);return new dn(this.value,o)}}remove(e){if(lt(e))return this.children.isEmpty()?new dn(null):new dn(null,this.children);{const t=ut(e),r=this.children.get(t);if(r){const i=r.remove(Xt(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new dn(null):new dn(this.value,s)}return this}}get(e){if(lt(e))return this.value;{const t=ut(e),r=this.children.get(t);return r?r.get(Xt(e)):null}}setTree(e,t){if(lt(e))return t;{const r=ut(e),s=(this.children.get(r)||new dn(null)).setTree(Xt(e),t);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new dn(this.value,o)}}fold(e){return this.fold_(xt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Sn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,xt(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(lt(e))return null;{const s=ut(e),o=this.children.get(s);return o?o.findOnPath_(Xt(e),Sn(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,xt(),t)}foreachOnPath_(e,t,r){if(lt(e))return this;{this.value&&r(t,this.value);const i=ut(e),s=this.children.get(i);return s?s.foreachOnPath_(Xt(e),Sn(t,i),r):new dn(null)}}foreach(e){this.foreach_(xt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Sn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class ho{constructor(e){this.writeTree_=e}static empty(){return new ho(new dn(null))}}function Rm(n,e,t){if(lt(e))return new ho(new dn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Ai(i,e);return s=s.updateChild(o,t),new ho(n.writeTree_.set(i,s))}{const i=new dn(t),s=n.writeTree_.setTree(e,i);return new ho(s)}}}function rS(n,e,t){let r=n;return Sr(t,(i,s)=>{r=Rm(r,Sn(e,i),s)}),r}function uj(n,e){if(lt(e))return ho.empty();{const t=n.writeTree_.setTree(e,new dn(null));return new ho(t)}}function iS(n,e){return null!=hc(n,e)}function hc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Ai(t.path,e)):null}function lj(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(cn,(r,i)=>{e.push(new ft(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new ft(r,i.value))}),e}function Uu(n,e){if(lt(e))return n;{const t=hc(n,e);return new ho(null!=t?new dn(t):n.writeTree_.subtree(e))}}function sS(n){return n.writeTree_.isEmpty()}function Gh(n,e){return cj(xt(),n.writeTree_,e)}function cj(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,b.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):t=cj(Sn(n,i),s,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Sn(n,".priority"),r)),t}}function LI(n,e){return gj(e,n)}function vse(n,e){if(n.snap)return qs(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&qs(Sn(n.path,t),e))return!0;return!1}function Ise(n){return n.visible}function dj(n,e,t){let r=ho.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)qs(t,o)?(a=Ai(t,o),r=Rm(r,a,s.snap)):qs(o,t)&&(a=Ai(o,t),r=Rm(r,xt(),s.snap.getChild(a)));else{if(!s.children)throw(0,b.g5)("WriteRecord should have .snap or .children");if(qs(t,o))a=Ai(t,o),r=rS(r,a,s.children);else if(qs(o,t))if(a=Ai(o,t),lt(a))r=rS(r,xt(),s.children);else{const u=(0,b.DV)(s.children,ut(a));if(u){const l=u.getChild(Xt(a));r=Rm(r,xt(),l)}}}}}return r}function hj(n,e,t,r,i){if(r||i){const s=Uu(n.visibleWrites,e);return!i&&sS(s)?t:i||null!=t||iS(s,xt())?Gh(dj(n.allWrites,function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(qs(l.path,e)||qs(e,l.path))},e),t||Ye.EMPTY_NODE):null}{const s=hc(n.visibleWrites,e);if(null!=s)return s;{const o=Uu(n.visibleWrites,e);return sS(o)?t:null!=t||iS(o,xt())?Gh(o,t||Ye.EMPTY_NODE):null}}}function VI(n,e,t,r){return hj(n.writeTree,n.treePath,e,t,r)}function oS(n,e){return function wse(n,e,t){let r=Ye.EMPTY_NODE;const i=hc(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(cn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Uu(n.visibleWrites,e);return t.forEachChild(cn,(o,a)=>{const u=Gh(Uu(s,new jt(o)),a);r=r.updateImmediateChild(o,u)}),lj(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return lj(Uu(n.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(n.writeTree,n.treePath,e)}function fj(n,e,t,r){return function Tse(n,e,t,r,i){(0,b.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Sn(e,t);if(iS(n.visibleWrites,s))return null;{const o=Uu(n.visibleWrites,s);return sS(o)?i.getChild(t):Gh(o,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function UI(n,e){return function bse(n,e){return hc(n.visibleWrites,e)}(n.writeTree,Sn(n.treePath,e))}function aS(n,e,t){return function Cse(n,e,t,r){const i=Sn(e,t),s=hc(n.visibleWrites,i);return null!=s?s:r.isCompleteForChild(t)?Gh(Uu(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function pj(n,e){return gj(Sn(n.treePath,e),n.writeTree)}function gj(n,e){return{treePath:n,writeTree:e}}class Rse{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,b.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,b.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(r,Cm(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(r,Tm(r,i.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(r,Hh(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,b.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,Cm(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const mj=new class Pse{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class uS{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Vu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return aS(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:dc(this.viewCache_),s=function Sse(n,e,t,r,i,s){return function Dse(n,e,t,r,i,s,o){let a;const u=Uu(n.visibleWrites,e),l=hc(u,xt());if(null!=l)a=l;else{if(null==t)return[];a=Gh(u,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const d=[],f=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=m.getNext();for(;_&&d.length<i;)0!==f(_,r)&&d.push(_),_=m.getNext();return d}}(n.writeTree,n.treePath,e,t,r,i,s)}(this.writes_,i,t,1,r,e);return 0===s.length?null:s[0]}}function _j(n,e,t,r,i,s){const o=e.eventCache;if(null!=UI(r,t))return e;{let a,u;if(lt(t))if((0,b.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=dc(e),f=oS(r,l instanceof Ye?l:Ye.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const l=VI(r,dc(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{const l=ut(t);if(".priority"===l){(0,b.hu)(1===Lu(t),"Can't have a priority with additional path components");const d=o.getNode();u=e.serverCache.getNode();const f=fj(r,t,d,u);a=null!=f?n.filter.updatePriority(d,f):o.getNode()}else{const d=Xt(t);let f;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const m=fj(r,t,o.getNode(),u);f=null!=m?o.getNode().getImmediateChild(l).updateChild(d,m):o.getNode().getImmediateChild(l)}else f=aS(r,l,e.serverCache);a=null!=f?n.filter.updateChild(o.getNode(),l,f,d,i,s):o.getNode()}}return Sm(e,a,o.isFullyInitialized()||lt(t),n.filter.filtersNodes())}}function BI(n,e,t,r,i,s,o,a){const u=e.serverCache;let l;const d=o?n.filter:n.filter.getIndexedFilter();if(lt(t))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){const _=u.getNode().updateChild(t,r);l=d.updateFullNode(u.getNode(),_,null)}else{const _=ut(t);if(!u.isCompleteForPath(t)&&Lu(t)>1)return e;const v=Xt(t),D=u.getNode().getImmediateChild(_).updateChild(v,r);l=".priority"===_?d.updatePriority(u.getNode(),D):d.updateChild(u.getNode(),_,D,v,mj,null)}const f=aj(e,l,u.isFullyInitialized()||lt(t),d.filtersNodes());return _j(n,f,t,i,new uS(i,f,s),a)}function lS(n,e,t,r,i,s,o){const a=e.eventCache;let u,l;const d=new uS(i,e,s);if(lt(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Sm(e,l,!0,n.filter.filtersNodes());else{const f=ut(t);if(".priority"===f)l=n.filter.updatePriority(e.eventCache.getNode(),r),u=Sm(e,l,a.isFullyInitialized(),a.isFiltered());else{const m=Xt(t),_=a.getNode().getImmediateChild(f);let v;if(lt(m))v=r;else{const T=d.getCompleteChild(f);v=null!=T?".priority"===BA(m)&&T.getChild(WB(m)).isEmpty()?T:T.updateChild(m,r):Ye.EMPTY_NODE}u=_.equals(v)?e:Sm(e,n.filter.updateChild(a.getNode(),f,v,m,d,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return u}function yj(n,e){return n.eventCache.isCompleteForChild(e)}function vj(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function cS(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,u=e;l=lt(t)?r:new dn(null).setTree(t,r);const d=e.serverCache.getNode();return l.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){const v=vj(0,e.serverCache.getNode().getImmediateChild(f),m);u=BI(n,u,new jt(f),v,i,s,o,a)}}),l.children.inorderTraversal((f,m)=>{const _=!e.serverCache.isCompleteForChild(f)&&null===m.value;if(!d.hasChild(f)&&!_){const T=vj(0,e.serverCache.getNode().getImmediateChild(f),m);u=BI(n,u,new jt(f),T,i,s,o,a)}}),u}class Use{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new KA(r.getIndex()),s=function Jie(n){return n.loadsAllData()?new KA(n.getIndex()):n.hasLimit()?new Xie(n):new bm(n)}(r);this.processor_=function Nse(n){return{filter:n}}(s);const o=t.serverCache,a=t.eventCache,u=i.updateFullNode(Ye.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(Ye.EMPTY_NODE,a.getNode(),null),d=new Vu(u,o.isFullyInitialized(),i.filtersNodes()),f=new Vu(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=OI(f,d),this.eventGenerator_=new cse(this.query_)}get query(){return this.query_}}function $se(n,e){const t=dc(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!lt(e)&&!t.getImmediateChild(ut(e)).isEmpty())?t.getChild(e):null}function Ej(n){return 0===n.eventRegistrations_.length}function Ij(n,e,t){const r=[];if(t){(0,b.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}else i.push(o)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function wj(n,e,t,r){e.type===Ho.MERGE&&null!==e.source.queryId&&((0,b.hu)(dc(n.viewCache_),"We should always have a full cache before handling merges"),(0,b.hu)(FI(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=function xse(n,e,t,r,i){const s=new Rse;let o,a;if(t.type===Ho.OVERWRITE){const l=t;l.source.fromUser?o=lS(n,e,l.path,l.snap,r,i,s):((0,b.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!lt(l.path),o=BI(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Ho.MERGE){const l=t;l.source.fromUser?o=function Ose(n,e,t,r,i,s,o){let a=e;return r.foreach((u,l)=>{const d=Sn(t,u);yj(e,ut(d))&&(a=lS(n,a,d,l,i,s,o))}),r.foreach((u,l)=>{const d=Sn(t,u);yj(e,ut(d))||(a=lS(n,a,d,l,i,s,o))}),a}(n,e,l.path,l.children,r,i,s):((0,b.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=cS(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Ho.ACK_USER_WRITE){const l=t;o=l.revert?function Vse(n,e,t,r,i,s){let o;if(null!=UI(r,t))return e;{const a=new uS(r,e,i),u=e.eventCache.getNode();let l;if(lt(t)||".priority"===ut(t)){let d;if(e.serverCache.isFullyInitialized())d=VI(r,dc(e));else{const f=e.serverCache.getNode();(0,b.hu)(f instanceof Ye,"serverChildren would be complete if leaf node"),d=oS(r,f)}l=n.filter.updateFullNode(u,d,s)}else{const d=ut(t);let f=aS(r,d,e.serverCache);null==f&&e.serverCache.isCompleteForChild(d)&&(f=u.getImmediateChild(d)),l=null!=f?n.filter.updateChild(u,d,f,Xt(t),a,s):e.eventCache.getNode().hasChild(d)?n.filter.updateChild(u,d,Ye.EMPTY_NODE,Xt(t),a,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=VI(r,dc(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=UI(r,xt()),Sm(e,l,o,n.filter.filtersNodes())}}(n,e,l.path,r,i,s):function Fse(n,e,t,r,i,s,o){if(null!=UI(i,t))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(lt(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return BI(n,e,t,u.getNode().getChild(t),i,s,a,o);if(lt(t)){let l=new dn(null);return u.getNode().forEachChild($o,(d,f)=>{l=l.set(new jt(d),f)}),cS(n,e,t,l,i,s,a,o)}return e}{let l=new dn(null);return r.foreach((d,f)=>{const m=Sn(t,d);u.isCompleteForPath(m)&&(l=l.set(d,u.getNode().getChild(m)))}),cS(n,e,t,l,i,s,a,o)}}(n,e,l.path,l.affectedTree,r,i,s)}else{if(t.type!==Ho.LISTEN_COMPLETE)throw(0,b.g5)("Unknown operation type: "+t.type);o=function Lse(n,e,t,r,i){const s=e.serverCache;return _j(n,aj(e,s.getNode(),s.isFullyInitialized()||lt(t),s.isFiltered()),t,r,mj,i)}(n,e,t.path,r,s)}const u=s.getChanges();return function kse(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=FI(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(rj(FI(e)))}}(e,o,u),{viewCache:o,changes:u}}(n.processor_,i,e,t,r);return function Mse(n,e){(0,b.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,b.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,b.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Tj(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Tj(n,e,t,r){return function dse(n,e,t,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Yie(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),Am(n,i,"child_removed",e,r,t),Am(n,i,"child_added",e,r,t),Am(n,i,"child_moved",s,r,t),Am(n,i,"child_changed",e,r,t),Am(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let jI,HI;class Cj{constructor(){this.views=new Map}}function dS(n,e,t,r){const i=e.source.queryId;if(null!==i){const s=n.views.get(i);return(0,b.hu)(null!=s,"SyncTree gave us an op for an invalid query."),wj(s,e,t,r)}{let s=[];for(const o of n.views.values())s=s.concat(wj(o,e,t,r));return s}}function bj(n,e,t,r,i){const o=n.views.get(e._queryIdentifier);if(!o){let a=VI(t,i?r:null),u=!1;a?u=!0:r instanceof Ye?(a=oS(t,r),u=!1):(a=Ye.EMPTY_NODE,u=!1);const l=OI(new Vu(a,u,!1),new Vu(r,i,!1));return new Use(e,l)}return o}function Dj(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Bu(n,e){let t=null;for(const r of n.views.values())t=t||$se(r,e);return t}function Aj(n,e){return e._queryParams.loadsAllData()?$I(n):n.views.get(e._queryIdentifier)}function Sj(n,e){return null!=Aj(n,e)}function ju(n){return null!=$I(n)}function $I(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Xse=1;class Rj{constructor(e){this.listenProvider_=e,this.syncPointTree_=new dn(null),this.pendingWriteTree_=function Ase(){return{visibleWrites:ho.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function hS(n,e,t,r,i){return function gse(n,e,t,r,i){(0,b.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Rm(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Wh(n,new cc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function $u(n,e,t=!1){const r=function _se(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function yse(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);(0,b.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&vse(a,r.path)?i=!1:qs(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Ese(n){n.visibleWrites=dj(n.allWrites,Ise,xt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=uj(n.visibleWrites,r.path):Sr(r.children,u=>{n.visibleWrites=uj(n.visibleWrites,Sn(r.path,u))}),!0))}(n.pendingWriteTree_,e)){let s=new dn(null);return null!=r.snap?s=s.set(xt(),!0):Sr(r.children,o=>{s=s.set(new jt(o),!0)}),Wh(n,new kI(r.path,s,t))}return[]}function Pm(n,e,t){return Wh(n,new cc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function qI(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||Sj(o,e))){const u=function Zse(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const a=ju(n);if("default"===i)for(const[u,l]of n.views.entries())o=o.concat(Ij(l,t,r)),Ej(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{const u=n.views.get(i);u&&(o=o.concat(Ij(u,t,r)),Ej(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!ju(n)&&s.push(new(function Gse(){return(0,b.hu)(jI,"Reference.ts has not been loaded"),jI}())(e._repo,e._path)),{removed:s,events:o}}(o,e,t,r);(function Wse(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const l=u.removed;if(a=u.events,!i){const d=-1!==l.findIndex(m=>m._queryParams.loadsAllData()),f=n.syncPointTree_.findOnPath(s,(m,_)=>ju(_));if(d&&!f){const m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){const _=function soe(n){return n.fold((e,t,r)=>{if(t&&ju(t))return[$I(t)];{let i=[];return t&&(i=Dj(t)),Sr(r,(s,o)=>{i=i.concat(o)}),i}})}(m);for(let v=0;v<_.length;++v){const T=_[v],D=T.query,k=xj(n,T);n.listenProvider_.startListening(Mm(D),Nm(n,D),k.hashFn,k.onComplete)}}}!f&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Mm(e),null):l.forEach(m=>{const _=n.queryToTagMap.get(GI(m));n.listenProvider_.stopListening(Mm(m),_)}))}!function ooe(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=GI(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}(n,l)}return a}function Pj(n,e,t,r){const i=pS(n,r);if(null!=i){const s=gS(i),o=s.path,a=s.queryId,u=Ai(o,e);return mS(n,o,new cc(tS(a),u,t))}return[]}function fS(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(m,_)=>{const v=Ai(m,i);s=s||Bu(_,v),o=o||ju(_)});let u,a=n.syncPointTree_.get(i);a?(o=o||ju(a),s=s||Bu(a,xt())):(a=new Cj,n.syncPointTree_=n.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=Ye.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,v)=>{const T=Bu(v,xt());T&&(s=s.updateImmediateChild(_,T))}));const l=Sj(a,e);if(!l&&!e._queryParams.loadsAllData()){const m=GI(e);(0,b.hu)(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");const _=function aoe(){return Xse++}();n.queryToTagMap.set(m,_),n.tagToQueryMap.set(_,m)}let f=function Kse(n,e,t,r,i,s){const o=bj(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),function Hse(n,e){n.eventRegistrations_.push(e)}(o,t),function qse(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(cn,(s,o)=>{r.push(Hh(s,o))}),t.isFullyInitialized()&&r.push(rj(t.getNode())),Tj(n,r,t.getNode(),e)}(o,t)}(a,e,t,LI(n.pendingWriteTree_,i),s,u);if(!l&&!o&&!r){const m=Aj(a,e);f=f.concat(function uoe(n,e,t){const r=e._path,i=Nm(n,e),s=xj(n,t),o=n.listenProvider_.startListening(Mm(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)(0,b.hu)(!ju(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((l,d,f)=>{if(!lt(l)&&d&&ju(d))return[$I(d).query];{let m=[];return d&&(m=m.concat(Dj(d).map(_=>_.query))),Sr(f,(_,v)=>{m=m.concat(v)}),m}});for(let l=0;l<u.length;++l){const d=u[l];n.listenProvider_.stopListening(Mm(d),Nm(n,d))}}return o}(n,e,m))}return f}function zI(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=Bu(a,Ai(o,e));if(l)return l});return hj(i,e,s,t,!0)}function Wh(n,e){return Nj(e,n.syncPointTree_,null,LI(n.pendingWriteTree_,xt()))}function Nj(n,e,t,r){if(lt(n.path))return Mj(n,e,t,r);{const i=e.get(xt());null==t&&null!=i&&(t=Bu(i,xt()));let s=[];const o=ut(n.path),a=n.operationForChild(o),u=e.children.get(o);if(u&&a){const l=t?t.getImmediateChild(o):null,d=pj(r,o);s=s.concat(Nj(a,u,l,d))}return i&&(s=s.concat(dS(i,n,r,t))),s}}function Mj(n,e,t,r){const i=e.get(xt());null==t&&null!=i&&(t=Bu(i,xt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=t?t.getImmediateChild(o):null,l=pj(r,o),d=n.operationForChild(o);d&&(s=s.concat(Mj(d,a,u,l)))}),i&&(s=s.concat(dS(i,n,r,t))),s}function xj(n,e){const t=e.query,r=Nm(n,t);return{hashFn:()=>(function Bse(n){return n.viewCache_.serverCache.getNode()}(e)||Ye.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function noe(n,e,t){const r=pS(n,t);if(r){const i=gS(r),s=i.path,o=i.queryId,a=Ai(s,e);return mS(n,s,new Dm(tS(o),a))}return[]}(n,t._path,r):function toe(n,e){return Wh(n,new Dm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function eie(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return qI(n,t,null,s)}}}}function Nm(n,e){const t=GI(e);return n.queryToTagMap.get(t)}function GI(n){return n._path.toString()+"$"+n._queryIdentifier}function pS(n,e){return n.tagToQueryMap.get(e)}function gS(n){const e=n.indexOf("$");return(0,b.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new jt(n.substr(0,e))}}function mS(n,e,t){const r=n.syncPointTree_.get(e);return(0,b.hu)(r,"Missing sync point for query tag that we're tracking"),dS(r,t,LI(n.pendingWriteTree_,e),null)}function Mm(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Yse(){return(0,b.hu)(HI,"Reference.ts has not been loaded"),HI}())(n._repo,n._path):n}class _S{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new _S(t)}node(){return this.node_}}class yS{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Sn(this.path_,e);return new yS(this.syncTree_,t)}node(){return zI(this.syncTree_,this.path_)}}const loe=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},kj=function(n,e,t){return n&&"object"==typeof n?((0,b.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?coe(n[".sv"],e,t):"object"==typeof n[".sv"]?doe(n[".sv"],e):void(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},coe=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,b.hu)(!1,"Unexpected server value: "+n)},doe=function(n,e,t){n.hasOwnProperty("increment")||(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,b.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,b.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},Oj=function(n,e,t,r){return ES(e,new yS(t,n),r)},vS=function(n,e,t){return ES(n,new _S(e),t)};function ES(n,e,t){const r=n.getPriority().val(),i=kj(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=kj(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new jh(a,Ln(i)):n}{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new jh(i))),o.forEachChild(cn,(a,u)=>{const l=ES(u,e.getImmediateChild(a),t);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}class IS{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function WI(n,e){let t=e instanceof jt?e:new jt(e),r=n,i=ut(t);for(;null!==i;){const s=(0,b.DV)(r.node.children,i)||{children:{},childCount:0};r=new IS(i,r,s),t=Xt(t),i=ut(t)}return r}function fc(n){return n.node.value}function wS(n,e){n.node.value=e,TS(n)}function Fj(n){return n.node.childCount>0}function KI(n,e){Sr(n.node.children,(t,r)=>{e(new IS(t,n,r))})}function Lj(n,e,t,r){t&&!r&&e(n),KI(n,i=>{Lj(i,e,!0,r)}),t&&r&&e(n)}function xm(n){return new jt(null===n.parent?n.name:xm(n.parent)+"/"+n.name)}function TS(n){null!==n.parent&&function poe(n,e,t){const r=function hoe(n){return void 0===fc(n)&&!Fj(n)}(t),i=(0,b.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,TS(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,TS(n))}(n.parent,n.name,n)}const goe=/[\[\].#$\/\u0000-\u001F\u007F]/,moe=/[\[\].#$\u0000-\u001F\u007F]/,CS=10485760,ZI=function(n){return"string"==typeof n&&0!==n.length&&!goe.test(n)},Vj=function(n){return"string"==typeof n&&0!==n.length&&!moe.test(n)},km=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!wI(n)||n&&"object"==typeof n&&(0,b.r3)(n,".sv")},qo=function(n,e,t,r){r&&void 0===e||Om((0,b.gK)(n,"value"),e,t)},Om=function(n,e,t){const r=t instanceof jt?new xie(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+uc(r));if("function"==typeof e)throw new Error(n+"contains a function "+uc(r)+" with contents = "+e.toString());if(wI(e))throw new Error(n+"contains "+e.toString()+" "+uc(r));if("string"==typeof e&&e.length>CS/3&&(0,b.ug)(e)>CS)throw new Error(n+"contains a string greater than "+CS+" utf8 bytes "+uc(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Sr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!ZI(o)))throw new Error(n+" contains an invalid key ("+o+") "+uc(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function kie(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,b.ug)(e),KB(n)})(r,o),Om(n,a,r),function Oie(n){const e=n.parts_.pop();n.byteLength_-=(0,b.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&s)throw new Error(n+' contains ".value" child '+uc(r)+" in addition to actual children.")}},Uj=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,b.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Sr(e,(o,a)=>{const u=new jt(o);if(Om(i,a,Sn(t,u)),".priority"===BA(u)&&!km(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=vm(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!ZI(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Mie);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&qs(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},bS=function(n,e,t){if(!t||void 0!==e){if(wI(e))throw new Error((0,b.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!km(e))throw new Error((0,b.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Fm=function(n,e,t,r){if(!(r&&void 0===t||ZI(t)))throw new Error((0,b.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Lm=function(n,e,t,r){if(!(r&&void 0===t||Vj(t)))throw new Error((0,b.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},voe=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Lm(n,e,t,r)},zs=function(n,e){if(".info"===ut(e))throw new Error(n+" failed = Can't modify data under /.info/")},Bj=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!ZI(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Vj(n)}(t))throw new Error((0,b.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Eoe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function QI(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==t&&!jA(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function jj(n,e,t){QI(n,t),$j(n,r=>jA(r,e))}function gs(n,e,t){QI(n,t),$j(n,r=>qs(r,e)||qs(e,r))}function $j(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(Ioe(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function Ioe(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();oc&&Ar("event: "+t.toString()),Uh(r)}}}const Hj="repo_interrupt",woe=25;class Toe{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Eoe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xI(),this.transactionQueueTree_=new IS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function qj(n){const t=n.infoData_.getNode(new jt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Vm(n){return loe({timestamp:qj(n)})}function zj(n,e,t,r,i){n.dataUpdateCount++;const s=new jt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const u=(0,b.UI)(t,l=>Ln(l));o=function roe(n,e,t,r){const i=pS(n,r);if(i){const s=gS(i),o=s.path,a=s.queryId,u=Ai(o,e),l=dn.fromObject(t);return mS(n,o,new zh(tS(a),u,l))}return[]}(n.serverSyncTree_,s,u,i)}else{const u=Ln(t);o=Pj(n.serverSyncTree_,s,u,i)}else if(r){const u=(0,b.UI)(t,l=>Ln(l));o=function eoe(n,e,t){const r=dn.fromObject(t);return Wh(n,new zh({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,s,u)}else{const u=Ln(t);o=Pm(n.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Zh(n,s)),gs(n.eventQueue_,a,o)}function Gj(n,e){DS(n,"connected",e),!1===e&&function Soe(n){Kh(n,"onDisconnectEvents");const e=Vm(n),t=xI();XA(n.onDisconnect_,xt(),(i,s)=>{const o=Oj(i,s,n.serverSyncTree_,e);qh(t,i,o)});let r=[];XA(t,xt(),(i,s)=>{r=r.concat(Pm(n.serverSyncTree_,i,s));const o=PS(n,i);Zh(n,o)}),n.onDisconnect_=xI(),gs(n.eventQueue_,xt(),r)}(n)}function DS(n,e,t){const r=new jt("/.info/"+e),i=Ln(t);n.infoData_.updateSnapshot(r,i);const s=Pm(n.infoSyncTree_,r,i);gs(n.eventQueue_,r,s)}function YI(n){return n.nextWriteId_++}function AS(n,e,t,r,i){Kh(n,"set",{path:e.toString(),value:t,priority:r});const s=Vm(n),o=Ln(t,r),a=zI(n.serverSyncTree_,e),u=vS(o,a,s),l=YI(n),d=hS(n.serverSyncTree_,e,u,l,!0);QI(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(m,_)=>{const v="ok"===m;v||ri("set at "+e+" failed: "+m);const T=$u(n.serverSyncTree_,l,!v);gs(n.eventQueue_,e,T),Hu(0,i,m,_)});const f=PS(n,e);Zh(n,f),gs(n.eventQueue_,f,[])}function Roe(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&YA(n.onDisconnect_,e),Hu(0,t,r,i)})}function Wj(n,e,t,r){const i=Ln(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&qh(n.onDisconnect_,e,i),Hu(0,r,s,o)})}function SS(n,e,t){let r;r=".info"===ut(e._path)?qI(n.infoSyncTree_,e,t):qI(n.serverSyncTree_,e,t),jj(n.eventQueue_,e._path,r)}function Kj(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Hj)}function Kh(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ar(t,...e)}function Hu(n,e,t,r){e&&Uh(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function RS(n,e,t){return zI(n.serverSyncTree_,e,t)||Ye.EMPTY_NODE}function XI(n,e=n.transactionQueueTree_){if(e||JI(n,e),fc(e)){const t=Qj(n,e);(0,b.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function Ooe(n,e,t){const r=t.map(l=>l.currentWriteId),i=RS(n,e,r);let s=i;const o=i.hash();for(let l=0;l<t.length;l++){const d=t[l];(0,b.hu)(0===d.status,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Ai(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;n.server_.put(u.toString(),a,l=>{Kh(n,"transaction put response",{path:u.toString(),status:l});let d=[];if("ok"===l){const f=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat($u(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&f.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();JI(n,WI(n.transactionQueueTree_,e)),XI(n,n.transactionQueueTree_),gs(n.eventQueue_,e,d);for(let m=0;m<f.length;m++)Uh(f[m])}else{if("datastale"===l)for(let f=0;f<t.length;f++)t[f].status=3===t[f].status?4:0;else{ri("transaction at "+u.toString()+" failed: "+l);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=l}Zh(n,e)}},o)}(n,xm(e),t)}else Fj(e)&&KI(e,t=>{XI(n,t)})}function Zh(n,e){const t=Zj(n,e),r=xm(t);return function Foe(n,e,t){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=Ai(t,u.path);let f,d=!1;if((0,b.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,f=u.abortReason,i=i.concat($u(n.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=woe)d=!0,f="maxretry",i=i.concat($u(n.serverSyncTree_,u.currentWriteId,!0));else{const m=RS(n,u.path,o);u.currentInputSnapshot=m;const _=e[a].update(m.val());if(void 0!==_){Om("transaction failed: Data returned ",_,u.path);let v=Ln(_);"object"==typeof _&&null!=_&&(0,b.r3)(_,".priority")||(v=v.updatePriority(m.getPriority()));const D=u.currentWriteId,k=Vm(n),P=vS(v,m,k);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=P,u.currentWriteId=YI(n),o.splice(o.indexOf(D),1),i=i.concat(hS(n.serverSyncTree_,u.path,P,u.currentWriteId,u.applyLocally)),i=i.concat($u(n.serverSyncTree_,D,!0))}else d=!0,f="nodata",i=i.concat($u(n.serverSyncTree_,u.currentWriteId,!0))}gs(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===f?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(f),!1,null)))}JI(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Uh(r[a]);XI(n,n.transactionQueueTree_)}(n,Qj(n,t),r),r}function Zj(n,e){let t,r=n.transactionQueueTree_;for(t=ut(e);null!==t&&void 0===fc(r);)r=WI(r,t),t=ut(e=Xt(e));return r}function Qj(n,e){const t=[];return Yj(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Yj(n,e,t){const r=fc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);KI(e,i=>{Yj(n,i,t)})}function JI(n,e){const t=fc(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,wS(e,t.length>0?t:void 0)}KI(e,r=>{JI(n,r)})}function PS(n,e){const t=xm(Zj(n,e)),r=WI(n.transactionQueueTree_,e);return function foe(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{NS(n,i)}),NS(n,r),Lj(r,i=>{NS(n,i)}),t}function NS(n,e){const t=fc(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?((0,b.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):((0,b.hu)(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat($u(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?wS(e,void 0):t.length=s+1,gs(n.eventQueue_,xm(e),i);for(let o=0;o<r.length;o++)Uh(r[o])}}const MS=function(n,e){const t=Uoe(n),r=t.namespace;return"firebase.com"===t.domain&&jo(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&jo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ri("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new kA(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new jt(t.pathString)}},Uoe=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof n){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");-1===d&&(d=n.length);let f=n.indexOf("?");-1===f&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=function Loe(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(d,f)));const m=function Voe(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ri(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,f)));l=e.indexOf(":"),l>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(l+1),10)):l=e.length;const _=e.slice(0,l);if("localhost"===_.toLowerCase())t="localhost";else if(_.split(".").length<=2)t=_;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},Xj="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Boe=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const s=new Array(8);for(i=7;i>=0;i--)s[i]=Xj.charAt(t%64),t=Math.floor(t/64);(0,b.hu)(0===t,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=Xj.charAt(e[i]);return(0,b.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class Jj{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,b.Wl)(this.snapshot.exportVal())}}class e${constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xS{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,b.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class t${constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new b.BH;return Roe(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){zs("OnDisconnect.remove",this._path);const e=new b.BH;return Wj(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){zs("OnDisconnect.set",this._path),qo("OnDisconnect.set",e,this._path,!1);const t=new b.BH;return Wj(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){zs("OnDisconnect.setWithPriority",this._path),qo("OnDisconnect.setWithPriority",e,this._path,!1),bS("OnDisconnect.setWithPriority",t,!1);const r=new b.BH;return function Poe(n,e,t,r,i){const s=Ln(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&qh(n.onDisconnect_,e,s),Hu(0,i,o,a)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){zs("OnDisconnect.update",this._path),Uj("OnDisconnect.update",e,this._path,!1);const t=new b.BH;return function Noe(n,e,t,r){if((0,b.xb)(t))return Ar("onDisconnect().update() called with empty data.  Don't do anything."),void Hu(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{"ok"===i&&Sr(t,(o,a)=>{const u=Ln(a);qh(n.onDisconnect_,Sn(e,o),u)}),Hu(0,r,i,s)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Wi{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return lt(this._path)?null:BA(this._path)}get ref(){return new Gs(this._repo,this._path)}get _queryIdentifier(){const e=sj(this._queryParams),t=MA(e);return"{}"===t?"default":t}get _queryObject(){return sj(this._queryParams)}isEqual(e){if(!((e=(0,b.m9)(e))instanceof Wi))return!1;const t=this._repo===e._repo,r=jA(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Nie(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function ew(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function qu(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===$o){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ou)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Va)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===cn){if(null!=e&&!km(e)||null!=t&&!km(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,b.hu)(n.getIndex()instanceof GA||n.getIndex()===WA,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function tw(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Gs extends Wi{constructor(e,t){super(e,t,new PI,!1)}get parent(){const e=WB(this._path);return null===e?null:new Gs(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class pc{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new jt(e),r=gc(this.ref,e);return new pc(this._node.getChild(t),r,cn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new pc(i,gc(this.ref,r),cn)))}hasChild(e){const t=new jt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function n$(n,e){return(n=(0,b.m9)(n))._checkNotDeleted("ref"),void 0!==e?gc(n._root,e):n._root}function r$(n,e){(n=(0,b.m9)(n))._checkNotDeleted("refFromURL");const t=MS(e,n._repo.repoInfo_.nodeAdmin);Bj("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&jo("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),n$(n,t.path.toString())}function gc(n,e){return null===ut((n=(0,b.m9)(n))._path)?voe("child","path",e,!1):Lm("child","path",e,!1),new Gs(n._repo,Sn(n._path,e))}function kS(n,e){n=(0,b.m9)(n),zs("set",n._path),qo("set",e,n._path,!1);const t=new b.BH;return AS(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function zoe(n,e){Uj("update",e,n._path,!1);const t=new b.BH;return function Aoe(n,e,t,r){Kh(n,"update",{path:e.toString(),value:t});let i=!0;const s=Vm(n),o={};if(Sr(t,(a,u)=>{i=!1,o[a]=Oj(Sn(e,a),Ln(u),n.serverSyncTree_,s)}),i)Ar("update() called with empty data.  Don't do anything."),Hu(0,r,"ok",void 0);else{const a=YI(n),u=function Jse(n,e,t,r){!function mse(n,e,t,r){(0,b.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=rS(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=dn.fromObject(t);return Wh(n,new zh({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,o,a);QI(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,d)=>{const f="ok"===l;f||ri("update at "+e+" failed: "+l);const m=$u(n.serverSyncTree_,a,!f),_=m.length>0?Zh(n,e):e;gs(n.eventQueue_,_,m),Hu(0,r,l,d)}),Sr(t,l=>{const d=PS(n,Sn(e,l));Zh(n,d)}),gs(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Goe(n){n=(0,b.m9)(n);const e=new xS(()=>{}),t=new Um(e);return function Doe(n,e,t){const r=function ioe(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{const f=Ai(l,t);r=r||Bu(d,f)});let i=n.syncPointTree_.get(t);i?r=r||Bu(i,xt()):(i=new Cj,n.syncPointTree_=n.syncPointTree_.set(t,i));const s=null!=r,o=s?new Vu(r,!0,!1):null;return function jse(n){return FI(n.viewCache_)}(bj(i,e,LI(n.pendingWriteTree_,e._path),s?o.getNode():Ye.EMPTY_NODE,s))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const s=Ln(i).withIndex(e._queryParams.getIndex());let o;if(fS(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())o=Pm(n.serverSyncTree_,e._path,s);else{const a=Nm(n.serverSyncTree_,e);o=Pj(n.serverSyncTree_,e._path,s,a)}return gs(n.eventQueue_,e._path,o),qI(n.serverSyncTree_,e,t,null,!0),s},i=>(Kh(n,"get for query "+(0,b.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new pc(r,new Gs(n._repo,n._path),n._queryParams.getIndex()))}class Um{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new Jj("value",this,new pc(e.snapshotNode,new Gs(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new e$(this,e,t):null}matches(e){return e instanceof Um&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class nw{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new e$(this,e,t):null}createEvent(e,t){(0,b.hu)(null!=e.childName,"Child events should have a childName.");const r=gc(new Gs(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Jj(e.type,this,new pc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof nw&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Bm(n,e,t,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=t,l=(d,f)=>{SS(n._repo,n,a),u(d,f)};l.userCallback=t.userCallback,l.context=t.context,t=l}const o=new xS(t,s||void 0),a="value"===e?new Um(o):new nw(e,o);return function Moe(n,e,t){let r;r=".info"===ut(e._path)?fS(n.infoSyncTree_,e,t):fS(n.serverSyncTree_,e,t),jj(n.eventQueue_,e._path,r)}(n._repo,n,a),()=>SS(n._repo,n,a)}function OS(n,e,t,r){return Bm(n,"value",e,t,r)}function i$(n,e,t,r){return Bm(n,"child_added",e,t,r)}function s$(n,e,t,r){return Bm(n,"child_changed",e,t,r)}function o$(n,e,t,r){return Bm(n,"child_moved",e,t,r)}function a$(n,e,t,r){return Bm(n,"child_removed",e,t,r)}function u$(n,e,t){let r=null;const i=t?new xS(t):null;"value"===e?r=new Um(i):e&&(r=new nw(e,i)),SS(n._repo,n,r)}class fo{}class l$ extends fo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("endAt",this._value,e._path,!0);const t=QA(e._queryParams,this._value,this._key);if(tw(t),qu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wi(e._repo,e._path,t,e._orderByCalled)}}class Koe extends fo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("endBefore",this._value,e._path,!1);const t=function rse(n,e,t){let r;return r=QA(n,e,n.index_===$o||t?t:Ou),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(tw(t),qu(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wi(e._repo,e._path,t,e._orderByCalled)}}class c$ extends fo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("startAt",this._value,e._path,!0);const t=ZA(e._queryParams,this._value,this._key);if(tw(t),qu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Wi(e._repo,e._path,t,e._orderByCalled)}}class Yoe extends fo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){qo("startAfter",this._value,e._path,!1);const t=function nse(n,e,t){let r;return r=ZA(n,e,n.index_===$o||t?t:Va),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(tw(t),qu(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Wi(e._repo,e._path,t,e._orderByCalled)}}class Joe extends fo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wi(e._repo,e._path,function ese(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class tae extends fo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wi(e._repo,e._path,function tse(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class rae extends fo{constructor(e){super(),this._path=e}_apply(e){ew(e,"orderByChild");const t=new jt(this._path);if(lt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new GA(t),i=NI(e._queryParams,r);return qu(i),new Wi(e._repo,e._path,i,!0)}}class sae extends fo{_apply(e){ew(e,"orderByKey");const t=NI(e._queryParams,$o);return qu(t),new Wi(e._repo,e._path,t,!0)}}class aae extends fo{_apply(e){ew(e,"orderByPriority");const t=NI(e._queryParams,cn);return qu(t),new Wi(e._repo,e._path,t,!0)}}class lae extends fo{_apply(e){ew(e,"orderByValue");const t=NI(e._queryParams,WA);return qu(t),new Wi(e._repo,e._path,t,!0)}}class dae extends fo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(qo("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new l$(this._value,this._key)._apply(new c$(this._value,this._key)._apply(e))}}function po(n,...e){let t=(0,b.m9)(n);for(const r of e)t=r._apply(t);return t}(function zse(n){(0,b.hu)(!jI,"__referenceConstructor has already been defined"),jI=n})(Gs),function Qse(n){(0,b.hu)(!HI,"__referenceConstructor has already been defined"),HI=n}(Gs);const FS={};function LS(n,e,t,r,i){let s=r||n.options.databaseURL;void 0===s&&(n.options.projectId||jo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ar("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let u,l,o=MS(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=MS(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const d=i&&u?new ym(ym.OWNER):new oie(n.name,n.options,e);Bj("Invalid Firebase Database URL",o),lt(o.path)||jo("Database URL must point to the root of a Firebase Database (not including a child path).");const f=function mae(n,e,t,r){let i=FS[e.name];i||(i={},FS[e.name]=i);let s=i[n.toURLString()];return s&&jo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Toe(n,false,t,r),i[n.toURLString()]=s,s}(a,n,d,new sie(n.name,t));return new yae(f,n)}class yae{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Coe(n,e,t){if(n.stats_=LA(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new MI(n.repoInfo_,(r,i,s,o)=>{zj(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Gj(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,b.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new lc(n.repoInfo_,e,(r,i,s,o)=>{zj(n,r,i,s,o)},r=>{Gj(n,r)},r=>{!function boe(n,e){Sr(e,(t,r)=>{DS(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function lie(n,e){const t=n.toString();return FA[t]||(FA[t]=e()),FA[t]}(n.repoInfo_,()=>new lse(n.stats_,n.server_)),n.infoData_=new ise,n.infoSyncTree_=new Rj({startListening:(r,i,s,o)=>{let a=[];const u=n.infoData_.getNode(r._path);return u.isEmpty()||(a=Pm(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),DS(n,"connected",!1),n.serverSyncTree_=new Rj({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,u)=>{const l=o(a,u);gs(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Gs(this._repo,xt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function gae(n,e){const t=FS[e];(!t||t[n.key]!==n)&&jo(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Kj(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&jo("Cannot call "+e+" on a deleted database.")}}function h$(){OB.IS_TRANSPORT_INITIALIZED&&ri("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vae(){h$(),Fu.forceDisallow()}function Eae(){h$(),Bh.forceDisallow(),Fu.forceAllow()}function Tae(n,e){gB(n,e)}const bae={".sv":"timestamp"};class Sae{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}lc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},lc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Cae(n){RA(zi.SDK_VERSION),(0,zi._registerComponent)(new lo.wA("database",(e,{instanceIdentifier:t})=>LS(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,zi.registerVersion)(lB,"1.0.1",n),(0,zi.registerVersion)(lB,"1.0.1","esm2017")}();const Mae=new fs.Yd("@firebase/database-compat"),p$=function(n){Mae.warn("FIREBASE WARNING: "+n)};class Oae{constructor(e){this._delegate=e}cancel(e){(0,b.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,b.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,b.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,b.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,b.Dv)("OnDisconnect.set",1,2,arguments.length),(0,b.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,b.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,b.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if((0,b.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,p$("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,b.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class Fae{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,b.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class zu{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,b.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,b.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,b.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,b.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,b.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Lm("DataSnapshot.child","path",e,!1),new zu(this._database,this._delegate.child(e))}hasChild(e){return(0,b.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Lm("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,b.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,b.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,b.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new zu(this._database,t)))}hasChildren(){return(0,b.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,b.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,b.Dv)("DataSnapshot.ref",0,0,arguments.length),new ms(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class $r{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;(0,b.Dv)("Query.on",2,4,arguments.length),(0,b.Wj)("Query.on","callback",t,!1);const o=$r.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new zu(this.database,l),d)};a.userCallback=t,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return OS(this._delegate,a,u),t;case"child_added":return i$(this._delegate,a,u),t;case"child_removed":return a$(this._delegate,a,u),t;case"child_changed":return s$(this._delegate,a,u),t;case"child_moved":return o$(this._delegate,a,u),t;default:throw new Error((0,b.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,b.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,b.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,b.Wj)("Query.off","callback",t,!0),(0,b.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,u$(this._delegate,e,i)}else u$(this._delegate,e)}get(){return Goe(this._delegate).then(e=>new zu(this.database,e))}once(e,t,r,i){(0,b.Dv)("Query.once",1,4,arguments.length),(0,b.Wj)("Query.once","callback",t,!0);const s=$r.getCancelAndContextArgs_("Query.once",r,i),o=new b.BH,a=(l,d)=>{const f=new zu(this.database,l);t&&t.call(s.context,f,d),o.resolve(f)};a.userCallback=t,a.context=s.context;const u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":OS(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":i$(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":a$(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":s$(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":o$(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,b.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,b.Dv)("Query.limitToFirst",1,1,arguments.length),new $r(this.database,po(this._delegate,function eae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Joe(n)}(e)))}limitToLast(e){return(0,b.Dv)("Query.limitToLast",1,1,arguments.length),new $r(this.database,po(this._delegate,function nae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new tae(n)}(e)))}orderByChild(e){return(0,b.Dv)("Query.orderByChild",1,1,arguments.length),new $r(this.database,po(this._delegate,function iae(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Lm("orderByChild","path",n,!1),new rae(n)}(e)))}orderByKey(){return(0,b.Dv)("Query.orderByKey",0,0,arguments.length),new $r(this.database,po(this._delegate,function oae(){return new sae}()))}orderByPriority(){return(0,b.Dv)("Query.orderByPriority",0,0,arguments.length),new $r(this.database,po(this._delegate,function uae(){return new aae}()))}orderByValue(){return(0,b.Dv)("Query.orderByValue",0,0,arguments.length),new $r(this.database,po(this._delegate,function cae(){return new lae}()))}startAt(e=null,t){return(0,b.Dv)("Query.startAt",0,2,arguments.length),new $r(this.database,po(this._delegate,function Qoe(n=null,e){return Fm("startAt","key",e,!0),new c$(n,e)}(e,t)))}startAfter(e=null,t){return(0,b.Dv)("Query.startAfter",0,2,arguments.length),new $r(this.database,po(this._delegate,function Xoe(n,e){return Fm("startAfter","key",e,!0),new Yoe(n,e)}(e,t)))}endAt(e=null,t){return(0,b.Dv)("Query.endAt",0,2,arguments.length),new $r(this.database,po(this._delegate,function Woe(n,e){return Fm("endAt","key",e,!0),new l$(n,e)}(e,t)))}endBefore(e=null,t){return(0,b.Dv)("Query.endBefore",0,2,arguments.length),new $r(this.database,po(this._delegate,function Zoe(n,e){return Fm("endBefore","key",e,!0),new Koe(n,e)}(e,t)))}equalTo(e,t){return(0,b.Dv)("Query.equalTo",1,2,arguments.length),new $r(this.database,po(this._delegate,function hae(n,e){return Fm("equalTo","key",e,!0),new dae(n,e)}(e,t)))}toString(){return(0,b.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,b.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,b.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof $r))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,b.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,b.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,b.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new ms(this.database,new Gs(this._delegate._repo,this._delegate._path))}}class ms extends $r{constructor(e,t){super(e,new Wi(t._repo,t._path,new PI,!1)),this.database=e,this._delegate=t}getKey(){return(0,b.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,b.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ms(this.database,gc(this._delegate,e))}getParent(){(0,b.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ms(this.database,e):null}getRoot(){return(0,b.Dv)("Reference.root",0,0,arguments.length),new ms(this.database,this._delegate.root)}set(e,t){(0,b.Dv)("Reference.set",1,2,arguments.length),(0,b.Wj)("Reference.set","onComplete",t,!0);const r=kS(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,b.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,p$("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}zs("Reference.update",this._delegate._path),(0,b.Wj)("Reference.update","onComplete",t,!0);const r=zoe(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,b.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,b.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function qoe(n,e,t){if(zs("setWithPriority",n._path),qo("setWithPriority",e,n._path,!1),bS("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new b.BH;return AS(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,b.Dv)("Reference.remove",0,1,arguments.length),(0,b.Wj)("Reference.remove","onComplete",e,!0);const t=function $oe(n){return zs("remove",n._path),kS(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,b.Dv)("Reference.transaction",1,3,arguments.length),(0,b.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,b.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,b.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function Rae(n,e,t){var r;if(n=(0,b.m9)(n),zs("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,s=new b.BH,a=OS(n,()=>{});return function koe(n,e,t,r,i,s){Kh(n,"transaction on "+e);const o={path:e,update:t,onComplete:r,status:null,order:hB(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=RS(n,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Om("transaction failed: Data returned ",u,o.path),o.status=0;const l=WI(n.transactionQueueTree_,e),d=fc(l)||[];let f;d.push(o),wS(l,d),"object"==typeof u&&null!==u&&(0,b.r3)(u,".priority")?(f=(0,b.DV)(u,".priority"),(0,b.hu)(km(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(zI(n.serverSyncTree_,e)||Ye.EMPTY_NODE).getPriority().val();const m=Vm(n),_=Ln(u,f),v=vS(_,a,m);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=v,o.currentWriteId=YI(n);const T=hS(n.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);gs(n.eventQueue_,e,T),XI(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(u,l,d)=>{let f=null;u?s.reject(u):(f=new pc(d,new Gs(n._repo,n._path),cn),s.resolve(new Sae(l,f)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new Fae(s.committed,new zu(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){(0,b.Dv)("Reference.setPriority",1,2,arguments.length),(0,b.Wj)("Reference.setPriority","onComplete",t,!0);const r=function Hoe(n,e){n=(0,b.m9)(n),zs("setPriority",n._path),bS("setPriority",e,!1);const t=new b.BH;return AS(n._repo,Sn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,b.Dv)("Reference.push",0,2,arguments.length),(0,b.Wj)("Reference.push","onComplete",t,!0);const r=function joe(n,e){n=(0,b.m9)(n),zs("push",n._path),qo("push",e,n._path,!0);const t=qj(n._repo),r=Boe(t),i=gc(n,r),s=gc(n,r);let o;return o=null!=e?kS(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new ms(this.database,o));t&&i.then(()=>t(null),o=>t(o));const s=new ms(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return zs("Reference.onDisconnect",this._delegate._path),new Oae(new t$(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class jm{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:vae,forceLongPolling:Eae}}useEmulator(e,t,r={}){!function f$(n,e,t,r={}){(n=(0,b.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&jo("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&jo('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ym(ym.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,b.Sg)(r.mockUserToken,n.app.options.projectId);s=new ym(o)}!function pae(n,e,t,r){n.repoInfo_=new kA(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,s)}(this._delegate,e,t,r)}ref(e){if((0,b.Dv)("database.ref",0,1,arguments.length),e instanceof ms){const t=r$(this._delegate,e.toString());return new ms(this,t)}{const t=n$(this._delegate,e);return new ms(this,t)}}refFromURL(e){(0,b.Dv)("database.refFromURL",1,1,arguments.length);const r=r$(this._delegate,e);return new ms(this,r)}goOffline(){return(0,b.Dv)("database.goOffline",0,0,arguments.length),function Iae(n){(n=(0,b.m9)(n))._checkNotDeleted("goOffline"),Kj(n._repo)}(this._delegate)}goOnline(){return(0,b.Dv)("database.goOnline",0,0,arguments.length),function wae(n){(n=(0,b.m9)(n))._checkNotDeleted("goOnline"),function xoe(n){n.persistentConnection_&&n.persistentConnection_.resume(Hj)}(n._repo)}(this._delegate)}}jm.ServerValue={TIMESTAMP:function Dae(){return bae}(),increment:n=>function Aae(n){return{".sv":{increment:n}}}(n)};var Vae=Object.freeze({__proto__:null,initStandalone:function Lae({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){RA(t);const a=new lo.H0("database-standalone"),u=new lo.zt("auth-internal",a);let l;return u.setComponent(new lo.wA("auth-internal",()=>r,"PRIVATE")),i&&(l=new lo.zt("app-check-internal",a),l.setComponent(new lo.wA("app-check-internal",()=>i,"PRIVATE"))),{instance:new jm(LS(n,u,l,e,o),n),namespace:s}}});const Uae=jm.ServerValue;function $m(n,e,t="on",r=hI){return new Ze(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===t&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===t?{unsubscribe(){null!=s&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(de(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),K())}function g$(n){return null==n}function m$(n){return"function"==typeof n.set}function _$(n,e){return m$(e)?e:n.ref(e)}function y$(n,e){if(function jae(n){return"string"==typeof n}(n))return e.stringCase();if(m$(n))return e.firebaseCase();if(function $ae(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function v$(n){return(g$(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function E$(n,e,t){return C(...(e=v$(e)).map(i=>$m(n,i,"on",t)))}function I$(n,e){return function(r,i){return y$(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Gae(n){return function(t){return t?y$(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function w$(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function Zae(n,e){const{payload:t,prevKey:r,key:i}=e,s=w$(n,i),o=function Kae(n,e){if(g$(e))return 0;{const t=w$(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(u=>u.payload.key!==t.key)).splice(o,0,e);else{if(null==r)return[e,...n];(n=n.slice()).splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=n.splice(s,1)[0];return(n=n.slice()).splice(o,0,a),n}return n;default:return n}}function T$(n,e,t){return function Wae(n,e,t){return $m(n,"value","once",t).pipe(ve(r=>{const i=[R(r)];return e.forEach(s=>i.push($m(n,s,"on",t))),C(...i).pipe(Ih(Zae,[]))}),Fe())}(n,e=v$(e),t)}function C$(n,e){return function(){return $m(n,"value","on",e)}}!function Bae(n){n.INTERNAL.registerComponent(new lo.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new jm(i,r)},"PUBLIC").setServiceProps({Reference:ms,Query:$r,Database:jm,DataSnapshot:zu,enableLogging:Tae,INTERNAL:Vae,ServerValue:Uae}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","1.0.1")}(ps.Z);const Xae=new le("angularfire2.realtimeDatabaseURL"),Jae=new le("angularfire2.database.use-emulator");let eue=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,u,l,d,f,m,_,v,T,D){this.schedulers=a;const k=u,P=lm(t,o,r);l&&EA(P,o,d,m,_,v,f,T),this.database=gI(`${P.name}.database.${i}`,"AngularFireDatabase",P.name,()=>{const O=o.runOutsideAngular(()=>P.database(i||void 0));return k&&O.useEmulator(...k),O},[k])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>_$(this.database,t));let s=i;return r&&(s=r(i)),function Qae(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:I$(r,"update"),set:I$(r,"set"),push:i=>r.push(i),remove:Gae(r),snapshotChanges:i=>T$(n,i,t).pipe(tr),stateChanges:i=>E$(n,i,t).pipe(tr),auditTrail:i=>function Hae(n,e,t){return function zae(n,e,t){return function qae(n,e){return $m(n,"value","on",e).pipe(de(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function zre(...n){const e=Oi(n);return Y((t,r)=>{const i=n.length,s=new Array(i);let o=n.map(()=>!1),a=!1;for(let u=0;u<i;u++)gt(n[u]).subscribe(ce(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(Tn))&&(o=null))},be));t.subscribe(ce(r,u=>{if(a){const l=[u,...s];r.next(e?e(...l):l)}}))})}(e),de(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function Gre(n){return Y((e,t)=>{let r=!1,i=0;e.subscribe(ce(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),de(i=>i.actions))}(n,E$(n,e).pipe(Ih((i,s)=>[...i,s],[])),t)}(n,i,t).pipe(tr),valueChanges:(i,s)=>T$(n,i,t).pipe(de(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),tr)}}(s,this)}object(t){return function Yae(n,e){return{query:n,snapshotChanges:()=>C$(n,e.schedulers.outsideAngular)().pipe(tr),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>C$(n,e.schedulers.outsideAngular)().pipe(tr,de(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>_$(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(W(kh),W(Oh,8),W(Xae,8),W(Vs),W(Tt),W(pI),W(Jae,8),W(nc,8),W(pA,8),W(gA,8),W(mA,8),W(_A,8),W(yA,8),W(vA,8),W(fI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),tue=(()=>{class n{constructor(){ps.Z.registerVersion("angularfire",Nh.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({providers:[eue]})}return n})();function VS(){return Y((n,e)=>{let t,r=!1;n.subscribe(ce(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var _e,nue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},go={},US=US||{},Ke=nue||self;function rw(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Hm(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var BS="closure_uid_"+(1e9*Math.random()>>>0),iue=0;function sue(n,e,t){return n.call.apply(n.bind,arguments)}function oue(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function ii(n,e,t){return(ii=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sue:oue).apply(null,arguments)}function iw(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Rr(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Gu(){this.s=this.s,this.o=this.o}Gu.prototype.s=!1,Gu.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function rue(n){Object.prototype.hasOwnProperty.call(n,BS)&&n[BS]||(n[BS]=++iue)}(this)},Gu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const b$=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function jS(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function D$(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(rw(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function si(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}si.prototype.h=function(){this.defaultPrevented=!0};var uue=function(){if(!Ke.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ke.addEventListener("test",()=>{},e),Ke.removeEventListener("test",()=>{},e)}catch{}return n}();function qm(n){return/^[\s\xa0]*$/.test(n)}function sw(){var n=Ke.navigator;return n&&(n=n.userAgent)?n:""}function zo(n){return-1!=sw().indexOf(n)}function $S(n){return $S[" "](n),n}$S[" "]=function(){};var qS,n,cue=zo("Opera"),Qh=zo("Trident")||zo("MSIE"),A$=zo("Edge"),HS=A$||Qh,S$=zo("Gecko")&&!(-1!=sw().toLowerCase().indexOf("webkit")&&!zo("Edge"))&&!(zo("Trident")||zo("MSIE"))&&!zo("Edge"),due=-1!=sw().toLowerCase().indexOf("webkit")&&!zo("Edge");function R$(){var n=Ke.document;return n?n.documentMode:void 0}e:{var zS="",GS=(n=sw(),S$?/rv:([^\);]+)(\)|;)/.exec(n):A$?/Edge\/([\d\.]+)/.exec(n):Qh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):due?/WebKit\/(\S+)/.exec(n):cue?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(GS&&(zS=GS?GS[1]:""),Qh){var WS=R$();if(null!=WS&&WS>parseFloat(zS)){qS=String(WS);break e}}qS=zS}var hue=Ke.document&&Qh&&(R$()||parseInt(qS,10))||void 0;function zm(n,e){if(si.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(S$){e:{try{$S(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:fue[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&zm.$.h.call(this)}}Rr(zm,si);var fue={2:"touch",3:"pen",4:"mouse"};zm.prototype.h=function(){zm.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Gm="closure_listenable_"+(1e6*Math.random()|0),pue=0;function gue(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++pue,this.fa=this.ia=!1}function ow(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function ZS(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function N$(n){const e={};for(const t in n)e[t]=n[t];return e}const M$="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x$(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<M$.length;s++)t=M$[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function aw(n){this.src=n,this.g={},this.h=0}function QS(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=b$(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(ow(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function YS(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}aw.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=YS(n,e,r,i);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new gue(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var XS="closure_lm_"+(1e6*Math.random()|0),JS={};function k$(n,e,t,r,i){if(r&&r.once)return F$(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)k$(n,e[s],t,r,i);return null}return t=rR(t),n&&n[Gm]?n.O(e,t,Hm(r)?!!r.capture:!!r,i):O$(n,e,t,!1,r,i)}function O$(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=Hm(i)?!!i.capture:!!i,a=tR(n);if(a||(n[XS]=a=new aw(n)),(t=a.add(e,t,r,o,s)).proxy)return t;if(r=function _ue(){const e=yue;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)uue||(i=o),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(V$(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function F$(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)F$(n,e[s],t,r,i);return null}return t=rR(t),n&&n[Gm]?n.P(e,t,Hm(r)?!!r.capture:!!r,i):O$(n,e,t,!0,r,i)}function L$(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)L$(n,e[s],t,r,i);else r=Hm(r)?!!r.capture:!!r,t=rR(t),n&&n[Gm]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=YS(s=n.g[e],t,r,i))&&(ow(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=tR(n))&&(e=n.g[e.toString()],n=-1,e&&(n=YS(e,t,r,i)),(t=-1<n?e[n]:null)&&eR(t))}function eR(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Gm])QS(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(V$(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=tR(e))?(QS(t,n),0==t.h&&(t.src=null,e[XS]=null)):ow(n)}}}function V$(n){return n in JS?JS[n]:JS[n]="on"+n}function yue(n,e){if(n.fa)n=!0;else{e=new zm(e,this);var t=n.listener,r=n.la||n.src;n.ia&&eR(n),n=t.call(r,e)}return n}function tR(n){return(n=n[XS])instanceof aw?n:null}var nR="__closure_events_fn_"+(1e9*Math.random()>>>0);function rR(n){return"function"==typeof n?n:(n[nR]||(n[nR]=function(e){return n.handleEvent(e)}),n[nR])}function Pr(){Gu.call(this),this.i=new aw(this),this.S=this,this.J=null}function Hr(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new si(e,n);else if(e instanceof si)e.target=e.target||n;else{var i=e;x$(e=new si(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=uw(o,r,!0,e)&&i}if(i=uw(o=e.g=n,r,!0,e)&&i,i=uw(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=uw(o=e.g=t[s],r,!1,e)&&i}function uw(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,u=o.la||o.src;o.ia&&QS(n.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Rr(Pr,Gu),Pr.prototype[Gm]=!0,Pr.prototype.removeEventListener=function(n,e,t,r){L$(this,n,e,t,r)},Pr.prototype.N=function(){if(Pr.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)ow(t[r]);delete n.g[e],n.h--}}this.J=null},Pr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Pr.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var iR=Ke.JSON.stringify;function Eue(){var n=sR;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var U$=new class vue{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new wue,n=>n.reset());class wue{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Tue(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Cue(n){Ke.setTimeout(()=>{throw n},0)}let Wm,Km=!1,sR=new class Iue{constructor(){this.h=this.g=null}add(e,t){const r=U$.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},B$=()=>{const n=Ke.Promise.resolve(void 0);Wm=()=>{n.then(bue)}};var bue=()=>{for(var n;n=Eue();){try{n.h.call(n.g)}catch(t){Cue(t)}var e=U$;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Km=!1};function lw(n,e){Pr.call(this),this.h=n||1,this.g=e||Ke,this.j=ii(this.qb,this),this.l=Date.now()}function oR(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function aR(n,e,t){if("function"==typeof n)t&&(n=ii(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ii(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ke.setTimeout(n,e||0)}function j$(n){n.g=aR(()=>{n.g=null,n.i&&(n.i=!1,j$(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Rr(lw,Pr),(_e=lw.prototype).ga=!1,_e.T=null,_e.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Hr(this,"tick"),this.ga&&(oR(this),this.start()))}},_e.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},_e.N=function(){lw.$.N.call(this),oR(this),delete this.g};class Due extends Gu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:j$(this)}N(){super.N(),this.g&&(Ke.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zm(n){Gu.call(this),this.h=n,this.g={}}Rr(Zm,Gu);var $$=[];function H$(n,e,t,r){Array.isArray(t)||(t&&($$[0]=t.toString()),t=$$);for(var i=0;i<t.length;i++){var s=k$(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function q$(n){ZS(n.g,function(e,t){this.g.hasOwnProperty(t)&&eR(e)},n),n.g={}}function cw(){this.g=!0}function Yh(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Pue(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return iR(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Zm.prototype.N=function(){Zm.$.N.call(this),q$(this)},Zm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},cw.prototype.Ea=function(){this.g=!1},cw.prototype.info=function(){};var mc={},z$=null;function dw(){return z$=z$||new Pr}function G$(n){si.call(this,mc.Ta,n)}function Qm(n){const e=dw();Hr(e,new G$(e))}function W$(n,e){si.call(this,mc.STAT_EVENT,n),this.stat=e}function Si(n){const e=dw();Hr(e,new W$(e,n))}function K$(n,e){si.call(this,mc.Ua,n),this.size=e}function Ym(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ke.setTimeout(function(){n()},e)}mc.Ta="serverreachability",Rr(G$,si),mc.STAT_EVENT="statevent",Rr(W$,si),mc.Ua="timingevent",Rr(K$,si);var hw={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Z$={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function uR(){}function Y$(){}uR.prototype.h=null;var dR,Xm={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function lR(){si.call(this,"d")}function cR(){si.call(this,"c")}function fw(){}function Jm(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Zm(this),this.P=Nue,this.V=new lw(n=HS?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new X$}function X$(){this.i=null,this.g="",this.h=!1}Rr(lR,si),Rr(cR,si),Rr(fw,uR),fw.prototype.g=function(){return new XMLHttpRequest},fw.prototype.i=function(){return{}},dR=new fw;var Nue=45e3,hR={},pw={};function fR(n,e,t){n.L=1,n.v=yw(Ba(e)),n.s=t,n.S=!0,J$(n,null)}function J$(n,e){n.G=Date.now(),e_(n),n.A=Ba(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),lH(t.i,"t",r),n.C=0,t=n.l.J,n.h=new X$,n.g=xH(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Due(ii(n.Pa,n,n.g),n.O)),H$(n.U,n.g,"readystatechange",n.nb),e=n.I?N$(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Qm(),function Aue(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var d=l[0];l=l[1];var f=d.split("_");o=2<=f.length&&"type"==f[1]?o+(d+"=")+l+"&":o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.W,n.s)}function eH(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function tH(n,e,t){let i,r=!0;for(;!n.J&&n.C<t.length;){if(i=Mue(n,t),i==pw){4==e&&(n.o=4,Si(14),r=!1),Yh(n.j,n.m,null,"[Incomplete Response]");break}if(i==hR){n.o=4,Si(15),Yh(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Yh(n.j,n.m,i,null),pR(n,i)}eH(n)&&i!=pw&&i!=hR&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Si(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),IR(e),e.M=!0,Si(11))):(Yh(n.j,n.m,t,"[Invalid Chunked Response]"),_c(n),t_(n))}function Mue(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?pw:(t=Number(e.substring(t,r)),isNaN(t)?hR:(r+=1)+t>e.length?pw:(e=e.slice(r,r+t),n.C=r+t,e))}function e_(n){n.Y=Date.now()+n.P,nH(n,n.P)}function nH(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Ym(ii(n.lb,n),e)}function gw(n){n.B&&(Ke.clearTimeout(n.B),n.B=null)}function t_(n){0==n.l.H||n.J||RH(n.l,n)}function _c(n){gw(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,oR(n.V),q$(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function pR(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||gR(t.i,n)))if(!n.K&&gR(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Cw(t),ww(t)}ER(t),Si(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Ym(ii(t.ib,t),6e3));if(1>=hH(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else vc(t,11)}else if((n.K||t.g==n)&&Cw(t),!qm(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const d=l[3];null!=d&&(t.ra=d,t.l.info("VER="+t.ra));const f=l[4];null!=f&&(t.Ga=f,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=r=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const _=n.g;if(_){const v=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||-1==v.indexOf("spdy")&&-1==v.indexOf("quic")&&-1==v.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(mR(s,s.h),s.h=null))}if(r.F){const T=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,_n(r.I,r.F,T))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((r=t).wa=MH(r,r.J?r.pa:null,r.Y),o.K){fH(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.B&&(gw(a),e_(a)),r.g=o}else AH(r);0<t.j.length&&Tw(t)}else"stop"!=l[0]&&"close"!=l[0]||vc(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?vc(t,7):vR(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Qm()}catch{}}function rH(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(rw(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function kue(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(rw(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function xue(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(rw(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(_e=Jm.prototype).setTimeout=function(n){this.P=n},_e.nb=function(n){n=n.target;const e=this.M;e&&3==Go(n)?e.l():this.Pa(n)},_e.Pa=function(n){try{if(n==this.g)e:{const d=Go(this.g);var e=this.g.Ia();if(this.g.da(),!(3>d)&&(3!=d||HS||this.g&&(this.h.h||this.g.ja()||IH(this.g)))){this.J||4!=d||7==e||Qm(),gw(this);var t=this.g.da();this.ca=t;t:if(eH(this)){var r=IH(this.g);n="";var i=r.length,s=4==Go(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){_c(this),t_(this);var o="";break t}this.h.i=new Ke.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function Sue(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,d,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qm(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,Si(12),_c(this),t_(this);break e}Yh(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pR(this,t)}this.S?(tH(this,d,o),HS&&this.i&&3==d&&(H$(this.U,this.V,"tick",this.mb),this.V.start())):(Yh(this.j,this.m,o,null),pR(this,o)),4==d&&_c(this),this.i&&!this.J&&(4==d?RH(this.l,this):(this.i=!1,e_(this)))}else(function Xue(n){const e={};n=(n.g&&2<=Go(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(qm(n[r]))continue;var t=Tue(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function mue(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Si(12)):(this.o=0,Si(13)),_c(this),t_(this)}}}catch{}},_e.mb=function(){if(this.g){var n=Go(this.g),e=this.g.ja();this.C<e.length&&(gw(this),tH(this,n,e),this.i&&4!=n&&e_(this))}},_e.cancel=function(){this.J=!0,_c(this)},_e.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Rue(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Qm(),Si(17)),_c(this),this.o=2,t_(this)):nH(this,this.Y-n)};var iH=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yc(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof yc){this.h=n.h,mw(this,n.j),this.s=n.s,this.g=n.g,_w(this,n.m),this.l=n.l;var e=n.i,t=new i_;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),sH(this,t),this.o=n.o}else n&&(e=String(n).match(iH))?(this.h=!1,mw(this,e[1]||"",!0),this.s=n_(e[2]||""),this.g=n_(e[3]||"",!0),_w(this,e[4]),this.l=n_(e[5]||"",!0),sH(this,e[6]||"",!0),this.o=n_(e[7]||"")):(this.h=!1,this.i=new i_(null,this.h))}function Ba(n){return new yc(n)}function mw(n,e,t){n.j=t?n_(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function _w(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function sH(n,e,t){e instanceof i_?(n.i=e,function jue(n,e){e&&!n.j&&(Wu(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(aH(this,r),lH(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=r_(e,Uue)),n.i=new i_(e,n.h))}function _n(n,e,t){n.i.set(e,t)}function yw(n){return _n(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function n_(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function r_(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Fue),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Fue(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}yc.prototype.toString=function(){var n=[],e=this.j;e&&n.push(r_(e,oH,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(r_(e,oH,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(r_(t,"/"==t.charAt(0)?Vue:Lue,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",r_(t,Bue)),n.join("")};var oH=/[#\/\?@]/g,Lue=/[#\?:]/g,Vue=/[#\?]/g,Uue=/[#\?@]/g,Bue=/#/g;function i_(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Wu(n){n.g||(n.g=new Map,n.h=0,n.i&&function Oue(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function aH(n,e){Wu(n),e=Xh(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function uH(n,e){return Wu(n),e=Xh(n,e),n.g.has(e)}function lH(n,e,t){aH(n,e),0<t.length&&(n.i=null,n.g.set(Xh(n,e),jS(t)),n.h+=t.length)}function Xh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function cH(n){this.l=n||Hue,n=Ke.PerformanceNavigationTiming?0<(n=Ke.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ke.g&&Ke.g.Ka&&Ke.g.Ka()&&Ke.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(_e=i_.prototype).add=function(n,e){Wu(this),this.i=null,n=Xh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},_e.forEach=function(n,e){Wu(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},_e.ta=function(){Wu(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},_e.Z=function(n){Wu(this);let e=[];if("string"==typeof n)uH(this,n)&&(e=e.concat(this.g.get(Xh(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},_e.set=function(n,e){return Wu(this),this.i=null,uH(this,n=Xh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},_e.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},_e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};var Hue=10;function dH(n){return!!n.h||!!n.g&&n.g.size>=n.j}function hH(n){return n.h?1:n.g?n.g.size:0}function gR(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function mR(n,e){n.g?n.g.add(e):n.h=e}function fH(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function pH(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return jS(n.i)}cH.prototype.cancel=function(){if(this.i=pH(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var que=class{stringify(n){return Ke.JSON.stringify(n,void 0)}parse(n){return Ke.JSON.parse(n,void 0)}};function zue(){this.g=new que}function Gue(n,e,t){const r=t||"";try{rH(n,function(i,s){let o=i;Hm(i)&&(o=iR(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function vw(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function s_(n){this.l=n.ec||null,this.j=n.ob||!1}function Ew(n,e){Pr.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=_R,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Rr(s_,uR),s_.prototype.g=function(){return new Ew(this.l,this.j)},s_.prototype.i=function(n){return function(){return n}}({}),Rr(Ew,Pr);var _R=0;function gH(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function o_(n){n.readyState=4,n.l=null,n.j=null,n.A=null,a_(n)}function a_(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(_e=Ew.prototype).open=function(n,e){if(this.readyState!=_R)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,a_(this)},_e.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Ke).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},_e.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,o_(this)),this.readyState=_R},_e.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,a_(this)),this.g&&(this.readyState=3,a_(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Ke.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;gH(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},_e.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?o_(this):a_(this),3==this.readyState&&gH(this)}},_e.Za=function(n){this.g&&(this.response=this.responseText=n,o_(this))},_e.Ya=function(n){this.g&&(this.response=n,o_(this))},_e.ka=function(){this.g&&o_(this)},_e.setRequestHeader=function(n,e){this.v.append(n,e)},_e.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},_e.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Ew.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Kue=Ke.JSON.parse;function Gn(n){Pr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=mH,this.L=this.M=!1}Rr(Gn,Pr);var mH="",Zue=/^https?$/i,Que=["POST","PUT"];function _H(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,yH(n),Iw(n)}function yH(n){n.F||(n.F=!0,Hr(n,"complete"),Hr(n,"error"))}function vH(n){if(n.h&&typeof US<"u"&&(!n.C[1]||4!=Go(n)||2!=n.da()))if(n.v&&4==Go(n))aR(n.La,0,n);else if(Hr(n,"readystatechange"),4==Go(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===o){var i=String(n.I).match(iH)[1]||null;!i&&Ke.self&&Ke.self.location&&(i=Ke.self.location.protocol.slice(0,-1)),r=!Zue.test(i?i.toLowerCase():"")}t=r}if(t)Hr(n,"complete"),Hr(n,"success");else{n.m=6;try{var s=2<Go(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",yH(n)}}finally{Iw(n)}}}function Iw(n,e){if(n.g){EH(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Hr(n,"ready");try{t.onreadystatechange=r}catch{}}}function EH(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Ke.clearTimeout(n.A),n.A=null)}function Go(n){return n.g?n.g.readyState:0}function IH(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case mH:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function wH(n){let e="";return ZS(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function yR(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=wH(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):_n(n,e,t))}function u_(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function TH(n){this.Ga=0,this.j=[],this.l=new cw,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=u_("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=u_("baseRetryDelayMs",5e3,n),this.hb=u_("retryDelaySeedMs",1e4,n),this.eb=u_("forwardChannelMaxRetries",2,n),this.xa=u_("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new cH(n&&n.concurrentRequestLimit),this.Ja=new zue,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function vR(n){if(CH(n),3==n.H){var e=n.W++,t=Ba(n.I);if(_n(t,"SID",n.K),_n(t,"RID",e),_n(t,"TYPE","terminate"),l_(n,t),(e=new Jm(n,n.l,e)).L=2,e.v=yw(Ba(t)),t=!1,Ke.navigator&&Ke.navigator.sendBeacon)try{t=Ke.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Ke.Image&&((new Image).src=e.v,t=!0),t||(e.g=xH(e.l,null),e.g.ha(e.v)),e.G=Date.now(),e_(e)}NH(n)}function ww(n){n.g&&(IR(n),n.g.cancel(),n.g=null)}function CH(n){ww(n),n.u&&(Ke.clearTimeout(n.u),n.u=null),Cw(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Ke.clearTimeout(n.m),n.m=null)}function Tw(n){if(!dH(n.i)&&!n.m){n.m=!0;var e=n.Na;Wm||B$(),Km||(Wm(),Km=!0),sR.add(e,n),n.C=0}}function bH(n,e){var t;t=e?e.m:n.W++;const r=Ba(n.I);_n(r,"SID",n.K),_n(r,"RID",t),_n(r,"AID",n.V),l_(n,r),n.o&&n.s&&yR(r,n.o,n.s),t=new Jm(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=DH(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),mR(n.i,t),fR(t,r,e)}function l_(n,e){n.na&&ZS(n.na,function(t,r){_n(e,r,t)}),n.h&&rH({},function(t,r){_n(e,r,t)})}function DH(n,e,t){t=Math.min(n.j.length,t);var r=n.h?ii(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<t;u++){let l=i[u].g;const d=i[u].map;if(l-=s,0>l)s=Math.max(0,i[u].g-100),a=!1;else try{Gue(d,o,"req"+l+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function AH(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Wm||B$(),Km||(Wm(),Km=!0),sR.add(e,n),n.A=0}}function ER(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Ym(ii(n.Ma,n),PH(n,n.A)),n.A++,0))}function IR(n){null!=n.B&&(Ke.clearTimeout(n.B),n.B=null)}function SH(n){n.g=new Jm(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=Ba(n.wa);_n(e,"RID","rpc"),_n(e,"SID",n.K),_n(e,"AID",n.V),_n(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&_n(e,"TO",n.qa),_n(e,"TYPE","xmlhttp"),l_(n,e),n.o&&n.s&&yR(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=yw(Ba(e)),t.s=null,t.S=!0,J$(t,n)}function Cw(n){null!=n.v&&(Ke.clearTimeout(n.v),n.v=null)}function RH(n,e){var t=null;if(n.g==e){Cw(n),IR(n),n.g=null;var r=2}else{if(!gR(n.i,e))return;t=e.F,fH(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;Hr(r=dw(),new K$(r,t)),Tw(n)}else AH(n);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==r&&function Jue(n,e){return!(hH(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Ym(ii(n.Na,n,e),PH(n,n.C)),n.C++,0)))}(n,e)||2==r&&ER(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:vc(n,5);break;case 4:vc(n,10);break;case 3:vc(n,6);break;default:vc(n,2)}}function PH(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function vc(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=ii(n.pb,n);t||(t=new yc("//www.google.com/images/cleardot.gif"),Ke.location&&"http"==Ke.location.protocol||mw(t,"https"),yw(t)),function Wue(n,e){const t=new cw;if(Ke.Image){const r=new Image;r.onload=iw(vw,t,r,"TestLoadImage: loaded",!0,e),r.onerror=iw(vw,t,r,"TestLoadImage: error",!1,e),r.onabort=iw(vw,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=iw(vw,t,r,"TestLoadImage: timeout",!1,e),Ke.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Si(2);n.H=0,n.h&&n.h.za(e),NH(n),CH(n)}function NH(n){if(n.H=0,n.ma=[],n.h){const e=pH(n.i);(0!=e.length||0!=n.j.length)&&(D$(n.ma,e),D$(n.ma,n.j),n.i.i.length=0,jS(n.j),n.j.length=0),n.h.ya()}}function MH(n,e,t){var r=t instanceof yc?Ba(t):new yc(t);if(""!=r.g)e&&(r.g=e+"."+r.g),_w(r,r.m);else{var i=Ke.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new yc(null);r&&mw(s,r),e&&(s.g=e),i&&_w(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&_n(r,t,e),_n(r,"VER",n.ra),l_(n,r),r}function xH(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Gn(t&&n.Ha&&!n.va?new s_({ob:!0}):n.va)).Oa(n.J),e}function kH(){}function bw(){if(Qh&&!(10<=Number(hue)))throw Error("Environmental error: no available transport.")}function _s(n,e){Pr.call(this),this.g=new TH(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!qm(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!qm(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Jh(this)}function OH(n){lR.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function FH(){cR.call(this),this.status=1}function Jh(n){this.g=n}function mo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function wR(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function Gt(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(_e=Gn.prototype).Oa=function(n){this.M=n},_e.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():dR.g(),this.C=function Q$(n){return n.h||(n.h=n.i())}(this.u?this.u:dR),this.g.onreadystatechange=ii(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void _H(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Ke.FormData&&n instanceof Ke.FormData,!(0<=b$(Que,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{EH(this),0<this.B&&((this.L=function Yue(n){return Qh&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ii(this.ua,this)):this.A=aR(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){_H(this,s)}},_e.ua=function(){typeof US<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Hr(this,"timeout"),this.abort(8))},_e.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Hr(this,"complete"),Hr(this,"abort"),Iw(this))},_e.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Iw(this,!0)),Gn.$.N.call(this)},_e.La=function(){this.s||(this.G||this.v||this.l?vH(this):this.kb())},_e.kb=function(){vH(this)},_e.isActive=function(){return!!this.g},_e.da=function(){try{return 2<Go(this)?this.g.status:-1}catch{return-1}},_e.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},_e.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Kue(e)}},_e.Ia=function(){return this.m},_e.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(_e=TH.prototype).ra=8,_e.H=1,_e.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Jm(this,this.l,n);let s=this.s;if(this.U&&(s?(s=N$(s),x$(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=DH(this,i,e),_n(t=Ba(this.I),"RID",n),_n(t,"CVER",22),this.F&&_n(t,"X-HTTP-Session-Id",this.F),l_(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(wH(s)))+"&"+e:this.o&&yR(t,this.o,s)),mR(this.i,i),this.bb&&_n(t,"TYPE","init"),this.P?(_n(t,"$req",e),_n(t,"SID","null"),i.aa=!0,fR(i,t,null)):fR(i,t,e),this.H=2}}else 3==this.H&&(n?bH(this,n):0==this.j.length||dH(this.i)||bH(this))},_e.Ma=function(){if(this.u=null,SH(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Ym(ii(this.jb,this),n)}},_e.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Si(10),ww(this),SH(this))},_e.ib=function(){null!=this.v&&(this.v=null,ww(this),ER(this),Si(19))},_e.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Si(2)):(this.l.info("Failed to ping google.com"),Si(1))},_e.isActive=function(){return!!this.h&&this.h.isActive(this)},(_e=kH.prototype).Ba=function(){},_e.Aa=function(){},_e.za=function(){},_e.ya=function(){},_e.isActive=function(){return!0},_e.Va=function(){},bw.prototype.g=function(n,e){return new _s(n,e)},Rr(_s,Pr),_s.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Si(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=MH(n,null,n.Y),Tw(n)},_s.prototype.close=function(){vR(this.g)},_s.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=iR(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&Tw(e)},_s.prototype.N=function(){this.g.h=null,delete this.j,vR(this.g),delete this.g,_s.$.N.call(this)},Rr(OH,lR),Rr(FH,cR),Rr(Jh,kH),Jh.prototype.Ba=function(){Hr(this.g,"a")},Jh.prototype.Aa=function(n){Hr(this.g,new OH(n))},Jh.prototype.za=function(n){Hr(this.g,new FH)},Jh.prototype.ya=function(){Hr(this.g,"b")},Rr(mo,function ele(){this.blockSize=-1}),mo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},mo.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)wR(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){wR(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){wR(this,r),i=0;break}}this.h=i,this.i+=e},mo.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var tle={};function TR(n){return-128<=n&&128>n?function lue(n,e){var t=tle;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new Gt([0|e],0>e?-1:0)}):new Gt([0|n],0>n?-1:0)}function Wo(n){if(isNaN(n)||!isFinite(n))return ef;if(0>n)return qr(Wo(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=CR;return new Gt(e,0)}var CR=4294967296,ef=TR(0),bR=TR(1),VH=TR(16777216);function ja(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Ws(n){return-1==n.h}function qr(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Gt(t,~n.h).add(bR)}function Dw(n,e){return n.add(qr(e))}function Aw(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function c_(n,e){this.g=n,this.h=e}function Sw(n,e){if(ja(e))throw Error("division by zero");if(ja(n))return new c_(ef,ef);if(Ws(n))return e=Sw(qr(n),e),new c_(qr(e.g),qr(e.h));if(Ws(e))return e=Sw(n,qr(e)),new c_(qr(e.g),e.h);if(30<n.g.length){if(Ws(n)||Ws(e))throw Error("slowDivide_ only works with positive integers.");for(var t=bR,r=e;0>=r.X(n);)t=UH(t),r=UH(r);var i=tf(t,1),s=tf(r,1);for(r=tf(r,2),t=tf(t,2);!ja(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(t),s=o),r=tf(r,1),t=tf(t,1)}return e=Dw(n,i.R(e)),new c_(i,e)}for(i=ef;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Wo(t)).R(e);Ws(o)||0<o.X(n);)o=(s=Wo(t-=r)).R(e);ja(s)&&(s=bR),i=i.add(s),n=Dw(n,o)}return new c_(i,n)}function UH(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Gt(t,n.h)}function tf(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Gt(i,n.h)}(_e=Gt.prototype).ea=function(){if(Ws(this))return-qr(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:CR+r)*e,e*=CR}return n},_e.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(ja(this))return"0";if(Ws(this))return"-"+qr(this).toString(n);for(var e=Wo(Math.pow(n,6)),t=this,r="";;){var i=Sw(t,e).g,s=((0<(t=Dw(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(ja(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},_e.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},_e.X=function(n){return Ws(n=Dw(this,n))?-1:ja(n)?0:1},_e.abs=function(){return Ws(this)?qr(this):this},_e.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new Gt(t,-2147483648&t[t.length-1]?-1:0)},_e.R=function(n){if(ja(this)||ja(n))return ef;if(Ws(this))return Ws(n)?qr(this).R(qr(n)):qr(qr(this).R(n));if(Ws(n))return qr(this.R(qr(n)));if(0>this.X(VH)&&0>n.X(VH))return Wo(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=n.D(i)>>>16,u=65535&n.D(i);t[2*r+2*i]+=o*u,Aw(t,2*r+2*i),t[2*r+2*i+1]+=s*u,Aw(t,2*r+2*i+1),t[2*r+2*i+1]+=o*a,Aw(t,2*r+2*i+1),t[2*r+2*i+2]+=s*a,Aw(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Gt(t,0)},_e.gb=function(n){return Sw(this,n).h},_e.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Gt(t,this.h&n.h)},_e.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Gt(t,this.h|n.h)},_e.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Gt(t,this.h^n.h)},bw.prototype.createWebChannel=bw.prototype.g,_s.prototype.send=_s.prototype.u,_s.prototype.open=_s.prototype.m,_s.prototype.close=_s.prototype.close,hw.NO_ERROR=0,hw.TIMEOUT=8,hw.HTTP_ERROR=6,Z$.COMPLETE="complete",Y$.EventType=Xm,Xm.OPEN="a",Xm.CLOSE="b",Xm.ERROR="c",Xm.MESSAGE="d",Pr.prototype.listen=Pr.prototype.O,Gn.prototype.listenOnce=Gn.prototype.P,Gn.prototype.getLastError=Gn.prototype.Sa,Gn.prototype.getLastErrorCode=Gn.prototype.Ia,Gn.prototype.getStatus=Gn.prototype.da,Gn.prototype.getResponseJson=Gn.prototype.Wa,Gn.prototype.getResponseText=Gn.prototype.ja,Gn.prototype.send=Gn.prototype.ha,Gn.prototype.setWithCredentials=Gn.prototype.Oa,mo.prototype.digest=mo.prototype.l,mo.prototype.reset=mo.prototype.reset,mo.prototype.update=mo.prototype.j,Gt.prototype.add=Gt.prototype.add,Gt.prototype.multiply=Gt.prototype.R,Gt.prototype.modulo=Gt.prototype.gb,Gt.prototype.compare=Gt.prototype.X,Gt.prototype.toNumber=Gt.prototype.ea,Gt.prototype.toString=Gt.prototype.toString,Gt.prototype.getBits=Gt.prototype.D,Gt.fromNumber=Wo,Gt.fromString=function LH(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return qr(LH(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Wo(Math.pow(e,8)),r=ef,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),e);8>s?(s=Wo(Math.pow(e,s)),r=r.R(s).add(Wo(o))):r=(r=r.R(t)).add(Wo(o))}return r};var nle=go.createWebChannelTransport=function(){return new bw},rle=go.getStatEventTarget=function(){return dw()},DR=go.ErrorCode=hw,ile=go.EventType=Z$,sle=go.Event=mc,BH=go.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ole=go.FetchXmlHttpFactory=s_,Rw=go.WebChannel=Y$,ale=go.XhrIo=Gn,ule=go.Md5=mo,nf=go.Integer=Gt;const jH="@firebase/firestore";class Nr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nr.UNAUTHENTICATED=new Nr(null),Nr.GOOGLE_CREDENTIALS=new Nr("google-credentials-uid"),Nr.FIRST_PARTY=new Nr("first-party-uid"),Nr.MOCK_USER=new Nr("mock-user");let rf="10.5.2";const Ku=new fs.Yd("@firebase/firestore");function sf(){return Ku.logLevel}function oe(n,...e){if(Ku.logLevel<=fs.in.DEBUG){const t=e.map(AR);Ku.debug(`Firestore (${rf}): ${n}`,...t)}}function nr(n,...e){if(Ku.logLevel<=fs.in.ERROR){const t=e.map(AR);Ku.error(`Firestore (${rf}): ${n}`,...t)}}function Ki(n,...e){if(Ku.logLevel<=fs.in.WARN){const t=e.map(AR);Ku.warn(`Firestore (${rf}): ${n}`,...t)}}function AR(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function we(n="Unexpected state"){const e=`FIRESTORE (${rf}) INTERNAL ASSERTION FAILED: `+n;throw nr(e),new Error(e)}function Pe(n,e){n||we()}function he(n,e){return n}const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends b.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class $H{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dle{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Nr.UNAUTHENTICATED))}shutdown(){}}class hle{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class fle{constructor(e){this.t=e,this.currentUser=Nr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable((0,Q.Z)(function*(){yield l.promise,yield s(r.currentUser)}))},u=l=>{oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vr)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe("string"==typeof r.accessToken),new $H(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Pe(null===e||"string"==typeof e),new Nr(e)}}class ple{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Nr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class gle{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ple(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Nr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class HH{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mle{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{null!=s.error&&oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Pe("string"==typeof t.token),this.R=t.token,new HH(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function _le(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class qH{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=_le(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function Ge(n,e){return n<e?-1:n>e?1:0}function af(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function zH(n){return n+"\0"}class Rn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ne(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Rn.fromMillis(Date.now())}static fromDate(e){return Rn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Rn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Rn(0,0))}static max(){return new Me(new Rn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class d_{constructor(e,t,r){void 0===t?t=0:t>e.length&&we(),void 0===r?r=e.length-t:r>e.length-t&&we(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===d_.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof d_?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class St extends d_{construct(e,t,r){return new St(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new St(t)}static emptyPath(){return new St([])}}const yle=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends d_{construct(e,t,r){return new yn(e,t,r)}static isValidIdentifier(e){return yle.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new yn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new ne(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new ne(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ne(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(t)}static emptyPath(){return new yn([])}}class fe{constructor(e){this.path=e}static fromPath(e){return new fe(St.fromString(e))}static fromName(e){return new fe(St.fromString(e).popFirst(5))}static empty(){return new fe(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===St.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return St.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fe(new St(e.slice()))}}class uf{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function SR(n){return n.fields.find(e=>2===e.kind)}function Ec(n){return n.fields.filter(e=>2!==e.kind)}uf.UNKNOWN_ID=-1;class Ic{constructor(e,t){this.fieldPath=e,this.kind=t}}class lf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new lf(0,ys.min())}}function GH(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Me.fromTimestamp(1e9===r?new Rn(t+1,0):new Rn(t,r));return new ys(i,fe.empty(),e)}function WH(n){return new ys(n.readTime,n.key,-1)}class ys{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ys(Me.min(),fe.empty(),-1)}static max(){return new ys(Me.max(),fe.empty(),-1)}}function RR(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=fe.comparator(n.documentKey,e.documentKey),0!==t?t:Ge(n.largestBatchId,e.largestBatchId))}const KH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Zu(n){return PR.apply(this,arguments)}function PR(){return PR=(0,Q.Z)(function*(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==KH)throw n;oe("LocalStore","Unexpectedly lost primary lease")}),PR.apply(this,arguments)}class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(i=>i?V.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new V((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const l=u;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new V((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Pw{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new h_(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=NR(r.target.error);this.V.reject(new h_(e,i))}}static open(e,t,r,i){try{return new Pw(t,e.transaction(i,r))}catch(s){throw new h_(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(oe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new wle(t)}}class _o{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===_o.S((0,b.z$)())&&nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return oe("SimpleDb","Removing database:",e),wc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,b.hl)())return!1;if(_o.C())return!0;const e=(0,b.z$)(),t=_o.S(e),r=0<t&&t<10,i=_o.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,Q.Z)(function*(){return t.db||(oe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new h_(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new ne(H.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new ne(H.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new h_(e,a))},s.onupgradeneeded=o=>{oe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.N(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{oe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,Q.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=Pw.open(s.db,e,o?"readonly":"readwrite",r),l=i(u).next(d=>(u.g(),d)).catch(d=>(u.abort(d),V.reject(d))).toPromise();return l.catch(()=>{}),yield u.m,l}catch(u){const l=u,d="FirebaseError"!==l.name&&a<3;if(oe("SimpleDb","Transaction failed with error:",l.message,"Retrying:",d),s.close(),!d)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ile{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return wc(this.k.delete())}}class h_ extends ne{constructor(e,t){super(H.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Qu(n){return"IndexedDbTransactionError"===n.name}class wle{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(oe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(oe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),wc(r)}add(e){return oe("SimpleDb","ADD",this.store.name,e,e),wc(this.store.add(e))}get(e){return wc(this.store.get(e)).next(t=>(void 0===t&&(t=null),oe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return oe("SimpleDb","DELETE",this.store.name,e),wc(this.store.delete(e))}count(){return oe("SimpleDb","COUNT",this.store.name),wc(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new V((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new V((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,t){oe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new V((r,i)=>{t.onerror=s=>{const o=NR(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,t){const r=[];return new V((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new Ile(a),l=t(a.primaryKey,a.value,u);if(l instanceof V){const d=l.catch(f=>(u.done(),V.reject(f)));r.push(d)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>V.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function wc(n){return new V((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=NR(r.target.error);t(i)}})}let QH=!1;function NR(n){const e=_o.S((0,b.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return QH||(QH=!0,setTimeout(()=>{throw r},0)),r}}return n}class Tle{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;oe("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Q.Z)(function*(){t.task=null;try{oe("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(r){Qu(r)?oe("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Zu(r)}yield t.ee(6e4)}))}}class Cle{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,Q.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.ne(r,e))})()}ne(e,t){const r=new Set;let i=t,s=!0;return V.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return oe("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(oe("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=WH(s);RR(o,r)>0&&(r=o)}),new ys(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let vs=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function f_(n){return null==n}function p_(n){return 0===n&&1/n==-1/0}function YH(n){return"number"==typeof n&&Number.isInteger(n)&&!p_(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function oi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=XH(e)),e=ble(n.get(t),e);return XH(e)}function ble(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function XH(n){return n+"\x01\x01"}function Ko(n){const e=n.length;if(Pe(e>=2),2===e)return Pe("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),St.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&we(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=n.substring(s,o),i+="\0";break;case"\x11":i+=n.substring(s,o+1);break;default:we()}s=o+2}return new St(r)}const JH=["userId","batchId"];function Nw(n,e){return[n,oi(e)]}function eq(n,e,t){return[n,oi(e),t]}const Dle={},Ale=["prefixPath","collectionGroup","readTime","documentId"],Sle=["prefixPath","collectionGroup","documentId"],Rle=["collectionGroup","readTime","prefixPath","documentId"],Ple=["canonicalId","targetId"],Nle=["targetId","path"],Mle=["path","targetId"],xle=["collectionId","parent"],kle=["indexId","uid"],Ole=["uid","sequenceNumber"],Fle=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Lle=["indexId","uid","orderedDocumentKey"],Vle=["userId","collectionPath","documentId"],Ule=["userId","collectionPath","largestBatchId"],Ble=["userId","collectionGroup","largestBatchId"],tq=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],jle=[...tq,"documentOverlays"],nq=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],rq=nq,$le=[...rq,"indexConfiguration","indexState","indexEntries"];class MR extends ZH{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function Mr(n,e){const t=he(n);return _o.M(t.ae,e)}function iq(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function sq(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class hn{constructor(e,t){this.comparator=e,this.root=t||zr.EMPTY}insert(e,t){return new hn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zr.BLACK,null,null))}remove(e){return new hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mw(this.root,e,this.comparator,!0)}}class Mw{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??zr.RED,this.left=i??zr.EMPTY,this.right=s??zr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new zr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return zr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}}zr.EMPTY=null,zr.RED=!0,zr.BLACK=!1,zr.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,r,i,s){return this}insert(e,t,r){return new zr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zt{constructor(e){this.comparator=e,this.data=new hn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new oq(this.data.getIterator())}getIteratorFrom(e){return new oq(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Zt(this.comparator);return t.data=e,t}}class oq{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function cf(n){return n.hasNext()?n.getNext():void 0}class Zi{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new Zi([])}unionWith(e){let t=new Zt(yn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Zi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return af(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class aq extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Er{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new aq("Invalid base64 string: "+s):s}}(e);return new Er(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Er(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Er.EMPTY_BYTE_STRING=new Er("");const qle=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xu(n){if(Pe(!!n),"string"==typeof n){let e=0;const t=qle.exec(n);if(Pe(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Wn(n.seconds),nanos:Wn(n.nanos)}}function Wn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function $a(n){return"string"==typeof n?Er.fromBase64String(n):Er.fromUint8Array(n)}function xw(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function kw(n){const e=n.mapValue.fields.__previous_value__;return xw(e)?kw(e):e}function g_(n){const e=Xu(n.mapValue.fields.__local_write_time__.timestampValue);return new Rn(e.seconds,e.nanos)}class zle{constructor(e,t,r,i,s,o,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class Ju{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ju("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ju&&e.projectId===this.projectId&&e.database===this.database}}const el={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ow={nullValue:"NULL_VALUE"};function tl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xw(n)?4:dq(n)?9007199254740991:10:we()}function Zo(n,e){if(n===e)return!0;const t=tl(n);if(t!==tl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return g_(n).isEqual(g_(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Xu(i.timestampValue),a=Xu(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,$a(n.bytesValue).isEqual($a(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Wn(i.geoPointValue.latitude)===Wn(s.geoPointValue.latitude)&&Wn(i.geoPointValue.longitude)===Wn(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Wn(i.integerValue)===Wn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Wn(i.doubleValue),a=Wn(s.doubleValue);return o===a?p_(o)===p_(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return af(n.arrayValue.values||[],e.arrayValue.values||[],Zo);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(iq(o)!==iq(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!Zo(o[u],a[u])))return!1;return!0}(n,e);default:return we()}var s}function m_(n,e){return void 0!==(n.values||[]).find(t=>Zo(t,e))}function nl(n,e){if(n===e)return 0;const t=tl(n),r=tl(e);if(t!==r)return Ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Wn(s.integerValue||s.doubleValue),u=Wn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return uq(n.timestampValue,e.timestampValue);case 4:return uq(g_(n),g_(e));case 5:return Ge(n.stringValue,e.stringValue);case 6:return function(s,o){const a=$a(s),u=$a(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const d=Ge(a[l],u[l]);if(0!==d)return d}return Ge(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ge(Wn(s.latitude),Wn(o.latitude));return 0!==a?a:Ge(Wn(s.longitude),Wn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){const d=nl(a[l],u[l]);if(d)return d}return Ge(a.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===el.mapValue&&o===el.mapValue)return 0;if(s===el.mapValue)return 1;if(o===el.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=Ge(u[f],d[f]);if(0!==m)return m;const _=nl(a[u[f]],l[d[f]]);if(0!==_)return _}return Ge(u.length,d.length)}(n.mapValue,e.mapValue);default:throw we()}}function uq(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ge(n,e);const t=Xu(n),r=Xu(e),i=Ge(t.seconds,r.seconds);return 0!==i?i:Ge(t.nanos,r.nanos)}function df(n){return xR(n)}function xR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Xu(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?$a(n.bytesValue).toBase64():"referenceValue"in n?fe.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=xR(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${xR(t.fields[o])}`;return i+"}"}(n.mapValue):we()}function Tc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function kR(n){return!!n&&"integerValue"in n}function __(n){return!!n&&"arrayValue"in n}function lq(n){return!!n&&"nullValue"in n}function cq(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Lw(n){return!!n&&"mapValue"in n}function y_(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Yu(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=y_(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=y_(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dq(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Gle(n){return"nullValue"in n?Ow:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Tc(Ju.empty(),fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:we()}function Wle(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Tc(Ju.empty(),fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?el:we()}function hq(n,e){const t=nl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function fq(n,e){const t=nl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Gr{constructor(e){this.value=e}static empty(){return new Gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Lw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=y_(t)}setAll(e){let t=yn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=y_(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Lw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Lw(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Yu(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Gr(y_(this.value))}}function pq(n){const e=[];return Yu(n.fields,(t,r)=>{const i=new yn([t]);if(Lw(r)){const s=pq(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Zi(e)}class vn{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vn(e,0,Me.min(),Me.min(),Me.min(),Gr.empty(),0)}static newFoundDocument(e,t,r,i){return new vn(e,1,t,Me.min(),r,i,0)}static newNoDocument(e,t){return new vn(e,2,t,Me.min(),Me.min(),Gr.empty(),0)}static newUnknownDocument(e,t){return new vn(e,3,t,Me.min(),Me.min(),Gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class rl{constructor(e,t){this.position=e,this.inclusive=t}}function gq(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(r=s.field.isKeyField()?fe.comparator(fe.fromName(o.referenceValue),t.key):nl(o,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function mq(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Zo(n.position[t],e.position[t]))return!1;return!0}class v_{constructor(e,t="asc"){this.field=e,this.dir=t}}function Kle(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class _q{}class Ct extends _q{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Zle(e,t,r):"array-contains"===t?new Xle(e,r):"in"===t?new Tq(e,r):"not-in"===t?new Jle(e,r):"array-contains-any"===t?new ece(e,r):new Ct(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Qle(e,r):new Yle(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(nl(t,this.value)):null!==t&&tl(this.value)===tl(t)&&this.matchesComparison(nl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wt extends _q{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Wt(e,t)}matches(e){return hf(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function hf(n){return"and"===n.op}function OR(n){return"or"===n.op}function FR(n){return yq(n)&&hf(n)}function yq(n){for(const e of n.filters)if(e instanceof Wt)return!1;return!0}function LR(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+df(n.value);if(FR(n))return n.filters.map(e=>LR(e)).join(",");{const e=n.filters.map(t=>LR(t)).join(",");return`${n.op}(${e})`}}function vq(n,e){return n instanceof Ct?(r=n,(i=e)instanceof Ct&&r.op===i.op&&r.field.isEqual(i.field)&&Zo(r.value,i.value)):n instanceof Wt?function(r,i){return i instanceof Wt&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&vq(o,i.filters[a]),!0)}(n,e):void we();var r,i}function Eq(n,e){const t=n.filters.concat(e);return Wt.create(t,n.op)}function Iq(n){return n instanceof Ct?`${(t=n).field.canonicalString()} ${t.op} ${df(t.value)}`:n instanceof Wt?function(t){return t.op.toString()+" {"+t.getFilters().map(Iq).join(" ,")+"}"}(n):"Filter";var t}class Zle extends Ct{constructor(e,t,r){super(e,t,r),this.key=fe.fromName(r.referenceValue)}matches(e){const t=fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Qle extends Ct{constructor(e,t){super(e,"in",t),this.keys=wq(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Yle extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=wq(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function wq(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>fe.fromName(r.referenceValue))}class Xle extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return __(t)&&m_(t.arrayValue,this.value)}}class Tq extends Ct{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&m_(this.value.arrayValue,t)}}class Jle extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(m_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!m_(this.value.arrayValue,t)}}class ece extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!__(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>m_(this.value.arrayValue,r))}}class tce{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function VR(n,e=null,t=[],r=[],i=null,s=null,o=null){return new tce(n,e,t,r,i,s,o)}function Cc(n){const e=he(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>LR(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),f_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>df(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>df(r)).join(",")),e.ce=t}return e.ce}function E_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Kle(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vq(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mq(n.startAt,e.startAt)&&mq(n.endAt,e.endAt)}function Vw(n){return fe.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Uw(n,e){return n.filters.filter(t=>t instanceof Ct&&t.field.isEqual(e))}function Cq(n,e,t){let r=Ow,i=!0;for(const s of Uw(n,e)){let o=Ow,a=!0;switch(s.op){case"<":case"<=":o=Gle(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ow}hq({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];hq({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}function bq(n,e,t){let r=el,i=!0;for(const s of Uw(n,e)){let o=el,a=!0;switch(s.op){case">=":case">":o=Wle(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=el}fq({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];fq({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}class Ha{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function Dq(n,e,t,r,i,s,o,a){return new Ha(n,e,t,r,i,s,o,a)}function ff(n){return new Ha(n)}function Aq(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function UR(n){return null!==n.collectionGroup}function pf(n){const e=he(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Zt(yn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new v_(s,r))}),t.has(yn.keyField().canonicalString())||e.le.push(new v_(yn.keyField(),r))}return e.le}function Ri(n){const e=he(n);return e.he||(e.he=function Sq(n,e){if("F"===n.limitType)return VR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new v_(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new rl(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new rl(n.startAt.position,n.startAt.inclusive):null;return VR(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,pf(n))),e.he}function BR(n,e){const t=n.filters.concat([e]);return new Ha(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Bw(n,e,t){return new Ha(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function I_(n,e){return E_(Ri(n),Ri(e))&&n.limitType===e.limitType}function Rq(n){return`${Cc(Ri(n))}|lt:${n.limitType}`}function gf(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Iq(i)).join(", ")}]`),f_(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>df(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>df(i)).join(",")),`Target(${r})`}(Ri(n))}; limitType=${n.limitType})`}function w_(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):fe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of pf(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(o,a,u){const l=gq(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,pf(r),i)||r.endAt&&!function(o,a,u){const l=gq(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,pf(r),i)));var r,i}function Pq(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Nq(n){return(e,t)=>{let r=!1;for(const i of pf(n)){const s=nce(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function nce(n,e,t){const r=n.field.isKeyField()?fe.comparator(e.key,t.key):function(s,o,a){const u=o.data.field(s),l=a.data.field(s);return null!==u&&null!==l?nl(u,l):we()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return we()}}class qa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yu(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return sq(this.inner)}size(){return this.innerSize}}const rce=new hn(fe.comparator);function Qi(){return rce}const Mq=new hn(fe.comparator);function T_(...n){let e=Mq;for(const t of n)e=e.insert(t.key,t);return e}function xq(n){let e=Mq;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qo(){return C_()}function kq(){return C_()}function C_(){return new qa(n=>n.toString(),(n,e)=>n.isEqual(e))}const ice=new hn(fe.comparator),sce=new Zt(fe.comparator);function tt(...n){let e=sce;for(const t of n)e=e.add(t);return e}const oce=new Zt(Ge);function jR(){return oce}function Oq(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:p_(e)?"-0":e}}function Fq(n){return{integerValue:""+n}}function Lq(n,e){return YH(e)?Fq(e):Oq(n,e)}class jw{constructor(){this._=void 0}}function ace(n,e,t){return n instanceof mf?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&xw(s)&&(s=kw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof bc?Uq(n,e):n instanceof Dc?Bq(n,e):function(i,s){const o=Vq(i,s),a=jq(o)+jq(i.Ie);return kR(o)&&kR(i.Ie)?Fq(a):Oq(i.serializer,a)}(n,e)}function uce(n,e,t){return n instanceof bc?Uq(n,e):n instanceof Dc?Bq(n,e):t}function Vq(n,e){return n instanceof _f?kR(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class mf extends jw{}class bc extends jw{constructor(e){super(),this.elements=e}}function Uq(n,e){const t=$q(e);for(const r of n.elements)t.some(i=>Zo(i,r))||t.push(r);return{arrayValue:{values:t}}}class Dc extends jw{constructor(e){super(),this.elements=e}}function Bq(n,e){let t=$q(e);for(const r of n.elements)t=t.filter(i=>!Zo(i,r));return{arrayValue:{values:t}}}class _f extends jw{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function jq(n){return Wn(n.integerValue||n.doubleValue)}function $q(n){return __(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class b_{constructor(e,t){this.field=e,this.transform=t}}class cce{constructor(e,t){this.version=e,this.transformResults=t}}class Pn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function $w(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Hw{}function Hq(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new vf(n.key,Pn.none()):new yf(n.key,n.data,Pn.none());{const t=n.data,r=Gr.empty();let i=new Zt(yn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new za(n.key,r,new Zi(i.toArray()),Pn.none())}}function dce(n,e,t){n instanceof yf?function(i,s,o){const a=i.value.clone(),u=Gq(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof za?function(i,s,o){if(!$w(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Gq(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(zq(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function D_(n,e,t,r){return n instanceof yf?function(s,o,a,u){if(!$w(s.precondition,o))return a;const l=s.value.clone(),d=Wq(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof za?function(s,o,a,u){if(!$w(s.precondition,o))return a;const l=Wq(s.fieldTransforms,u,o),d=o.data;return d.setAll(zq(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):(a=t,$w(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function hce(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Vq(r.transform,i||null);null!=s&&(null===t&&(t=Gr.empty()),t.set(r.field,s))}return t||null}function qq(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&af(r,i,(s,o)=>function lce(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof bc&&i instanceof bc||r instanceof Dc&&i instanceof Dc?af(r.elements,i.elements,Zo):r instanceof _f&&i instanceof _f?Zo(r.Ie,i.Ie):r instanceof mf&&i instanceof mf);var r,i}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class yf extends Hw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class za extends Hw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function zq(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Gq(n,e,t){const r=new Map;Pe(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,uce(o,a,t[i]))}return r}function Wq(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,ace(s,o,e))}return r}class vf extends Hw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $R extends Hw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class HR{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&dce(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=D_(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=D_(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=kq();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const u=Hq(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tt())}isEqual(e){return this.batchId===e.batchId&&af(this.mutations,e.mutations,(t,r)=>qq(t,r))&&af(this.baseMutations,e.baseMutations,(t,r)=>qq(t,r))}}class qR{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Pe(e.mutations.length===r.length);let i=ice;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new qR(e,t,r,i)}}class zR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pce{constructor(e,t){this.count=e,this.unchangedNames=t}}var lr,Rt;function Kq(n){switch(n){default:return we();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function Zq(n){if(void 0===n)return nr("GRPC error has no .code"),H.UNKNOWN;switch(n){case lr.OK:return H.OK;case lr.CANCELLED:return H.CANCELLED;case lr.UNKNOWN:return H.UNKNOWN;case lr.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case lr.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case lr.INTERNAL:return H.INTERNAL;case lr.UNAVAILABLE:return H.UNAVAILABLE;case lr.UNAUTHENTICATED:return H.UNAUTHENTICATED;case lr.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case lr.NOT_FOUND:return H.NOT_FOUND;case lr.ALREADY_EXISTS:return H.ALREADY_EXISTS;case lr.PERMISSION_DENIED:return H.PERMISSION_DENIED;case lr.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case lr.ABORTED:return H.ABORTED;case lr.OUT_OF_RANGE:return H.OUT_OF_RANGE;case lr.UNIMPLEMENTED:return H.UNIMPLEMENTED;case lr.DATA_LOSS:return H.DATA_LOSS;default:return we()}}(Rt=lr||(lr={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";function Qq(){return new TextEncoder}const gce=new nf([4294967295,4294967295],0);function Yq(n){const e=Qq().encode(n),t=new ule;return t.update(e),new Uint8Array(t.digest())}function Xq(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new nf([t,r],0),new nf([i,s],0)]}class GR{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new A_(`Invalid padding: ${t}`);if(r<0)throw new A_(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new A_(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new A_(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=nf.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(nf.fromNumber(r)));return 1===i.compare(gce)&&(i=new nf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Yq(e),[r,i]=Xq(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new GR(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const t=Yq(e),[r,i]=Xq(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class A_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class S_{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,R_.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new S_(Me.min(),i,new hn(Ge),Qi(),tt())}}class R_{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new R_(r,t,tt(),tt(),tt())}}class zw{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class Jq{constructor(e,t){this.targetId=e,this.fe=t}}class ez{constructor(e,t,r=Er.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class tz{constructor(){this.ge=0,this.pe=rz(),this.ye=Er.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=tt(),t=tt(),r=tt();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:we()}}),new R_(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=rz()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class mce{constructor(e){this.Le=e,this.ke=new Map,this.qe=Qi(),this.Qe=nz(),this.Ke=new hn(Ge)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:we()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(Vw(s))if(0===r){const o=new fe(s.path);this.We(t,o,vn.newNoDocument(o,Me.min()))}else Pe(1===r);else{const o=this.Ze(t);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(t),this.Ke=this.Ke.insert(t,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=$a(r).toUint8Array()}catch(u){if(u instanceof aq)return Ki("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new GR(o,i,s)}catch(u){return Ki(u instanceof A_?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Vw(a.target)){const u=new fe(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,vn.newNoDocument(u,e))}s.De&&(t.set(o,s.ve()),s.Fe())}});let r=tt();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Ye(u);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new S_(e,t,this.Ke,this.qe,r);return this.qe=Qi(),this.Qe=nz(),this.Ke=new hn(Ge),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new tz,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Zt(Ge),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||oe("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new tz),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function nz(){return new hn(fe.comparator)}function rz(){return new hn(fe.comparator)}const _ce={asc:"ASCENDING",desc:"DESCENDING"},yce={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vce={and:"AND",or:"OR"};class Ece{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function WR(n,e){return n.useProto3Json||f_(e)?e:{value:e}}function Ef(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iz(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ice(n,e){return Ef(n,e.toTimestamp())}function rr(n){return Pe(!!n),Me.fromTimestamp(function(t){const r=Xu(t);return new Rn(r.seconds,r.nanos)}(n))}function KR(n,e){return(r=n,new St(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function sz(n){const e=St.fromString(n);return Pe(pz(e)),e}function P_(n,e){return KR(n.databaseId,e.path)}function Yo(n,e){const t=sz(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new fe(az(t))}function ZR(n,e){return KR(n.databaseId,e)}function oz(n){const e=sz(n);return 4===e.length?St.emptyPath():az(e)}function N_(n){return new St(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function az(n){return Pe(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function uz(n,e,t){return{name:P_(n,e),fields:t.value.mapValue.fields}}function lz(n,e,t){const r=Yo(n,e.name),i=rr(e.updateTime),s=e.createTime?rr(e.createTime):Me.min(),o=new Gr({mapValue:{fields:e.fields}}),a=vn.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function M_(n,e){let t;if(e instanceof yf)t={update:uz(n,e.key,e.value)};else if(e instanceof vf)t={delete:P_(n,e.key)};else if(e instanceof za)t={update:uz(n,e.key,e.data),updateMask:Rce(e.fieldMask)};else{if(!(e instanceof $R))return we();t={verify:P_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof mf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof bc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Dc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _f)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw we()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Ice(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:we()),t;var s}function QR(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Pn.updateTime(rr(s.updateTime)):void 0!==s.exists?Pn.exists(s.exists):Pn.none():Pn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(Pe("REQUEST_TIME"===a.setToServerValue),u=new mf):"appendMissingElements"in a?u=new bc(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new Dc(a.removeAllFromArray.values||[]):"increment"in a?u=new _f(o,a.increment):we();const l=yn.fromServerFormat(a.fieldPath);return new b_(l,u)}(n,i)):[];var s;if(e.update){const i=Yo(n,e.update.name),s=new Gr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Zi((e.updateMask.fieldPaths||[]).map(d=>yn.fromServerFormat(d)));return new za(i,s,o,t,r)}return new yf(i,s,t,r)}if(e.delete){const i=Yo(n,e.delete);return new vf(i,t)}if(e.verify){const i=Yo(n,e.verify);return new $R(i,t)}return we()}function cz(n,e){return{documents:[ZR(n,e.path)]}}function YR(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=ZR(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=ZR(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return fz(Wt.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(l=>{return{field:il((f=l).field),direction:Dce(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=WR(n,e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),t;var u}function dz(n){let e=oz(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Pe(1===r);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){const m=hz(f);return m instanceof Wt&&FR(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(m=>{return new v_(If((v=m).field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let a=null;t.limit&&(a=function(f){let m;return m="object"==typeof f?f.value:f,f_(m)?null:m}(t.limit));let u=null;var f;t.startAt&&(u=new rl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new rl(f.values||[],!f.before)}(t.endAt)),Dq(e,i,o,s,a,"F",u,l)}function hz(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=If(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=If(t.unaryFilter.field);return Ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=If(t.unaryFilter.field);return Ct.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=If(t.unaryFilter.field);return Ct.create(o,"!=",{nullValue:"NULL_VALUE"});default:return we()}}(n):void 0!==n.fieldFilter?Ct.create(If((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return Wt.create(t.compositeFilter.filters.map(r=>hz(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we()}}(t.compositeFilter.op))}(n):we();var t}function Dce(n){return _ce[n]}function Ace(n){return yce[n]}function Sce(n){return vce[n]}function il(n){return{fieldPath:n.canonicalString()}}function If(n){return yn.fromServerFormat(n.fieldPath)}function fz(n){return n instanceof Ct?function(t){if("=="===t.op){if(cq(t.value))return{unaryFilter:{field:il(t.field),op:"IS_NAN"}};if(lq(t.value))return{unaryFilter:{field:il(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(cq(t.value))return{unaryFilter:{field:il(t.field),op:"IS_NOT_NAN"}};if(lq(t.value))return{unaryFilter:{field:il(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:il(t.field),op:Ace(t.op),value:t.value}}}(n):n instanceof Wt?function(t){const r=t.getFilters().map(i=>fz(i));return 1===r.length?r[0]:{compositeFilter:{op:Sce(t.op),filters:r}}}(n):we()}function Rce(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function pz(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Ga{constructor(e,t,r,i,s=Me.min(),o=Me.min(),a=Er.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Ga(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class gz{constructor(e){this.ut=e}}function mz(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Gw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:P_(s=n.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:Ef(s,o.version.toTimestamp()),createTime:Ef(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ac(e.version)};else{if(!e.isUnknownDocument())return we();r.unknownDocument={path:t.path.toArray(),version:Ac(e.version)}}var s,o;return r}function Gw(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ac(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sc(n){const e=new Rn(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function Rc(n,e){const t=(e.baseMutations||[]).map(s=>QR(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>QR(n.ut,s)),i=Rn.fromMillis(e.localWriteTimeMs);return new HR(e.batchId,i,t,r)}function x_(n){const e=Sc(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Sc(n.lastLimboFreeSnapshotVersion):Me.min();let r;return r=void 0!==n.query.documents?(Pe(1===(s=n.query).documents.length),Ri(ff(oz(s.documents[0])))):function(s){return Ri(dz(s))}(n.query),new Ga(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Er.fromBase64String(n.resumeToken));var s}function _z(n,e){const t=Ac(e.snapshotVersion),r=Ac(e.lastLimboFreeSnapshotVersion);let i;i=Vw(e.target)?cz(n.ut,e.target):YR(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function XR(n){const e=dz({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Bw(e,e.limit,"L"):e}function JR(n,e){return new zR(e.largestBatchId,QR(n.ut,e.overlayMutation))}function yz(n,e){const t=e.path.lastSegment();return[n,oi(e.path.popLast()),t]}function vz(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ac(r.readTime),documentKey:oi(r.documentKey.path),largestBatchId:r.largestBatchId}}class Nce{getBundleMetadata(e,t){return Ez(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Sc(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return Ez(e).put({bundleId:(i=t).id,createTime:Ac(rr(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return Iz(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:XR(s.bundledQuery),readTime:Sc(s.readTime)};var s})}saveNamedQuery(e,t){return Iz(e).put({name:(i=t).name,readTime:Ac(rr(i.readTime)),bundledQuery:i.bundledQuery});var i}}function Ez(n){return Mr(n,"bundles")}function Iz(n){return Mr(n,"namedQueries")}class Ww{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new Ww(e,t.uid||"")}getOverlay(e,t){return k_(e).get(yz(this.userId,t)).next(r=>r?JR(this.serializer,r):null)}getOverlays(e,t){const r=Qo();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new zR(t,o);i.push(this.lt(e,a))}),V.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(oi(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(k_(e).H("collectionPathOverlayIndex",a))}),V.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Qo(),s=oi(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return k_(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const l=JR(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Qo();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return k_(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{const f=JR(this.serializer,l);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}lt(e,t){return k_(e).put(function(i,s,o){const[a,u,l]=yz(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:M_(i.ut,o.mutation)}}(this.serializer,this.userId,t))}}function k_(n){return Mr(n,"documentOverlays")}class Pc{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Wn(e.integerValue));else if("doubleValue"in e){const r=Wn(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),p_(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt($a(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?dq(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):we()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),fe.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function Mce(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function wz(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Mce(255&r[s]);if(i+=o,8!==o)break}return i}(n);return Math.ceil(e/8)}Pc.St=new Pc;class xce{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=wz(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=wz(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class kce{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Oce{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class O_{constructor(){this.Wt=new xce,this.Gt=new kce(this.Wt),this.zt=new Oce(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Nc{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Nc(this.indexId,this.documentKey,this.arrayValue,r)}}function sl(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Tz(n.arrayValue,e.arrayValue),0!==t?t:(t=Tz(n.directionalValue,e.directionalValue),0!==t?t:fe.comparator(n.documentKey,e.documentKey)))}function Tz(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Cz{constructor(e){this.Jt=new Zt((t,r)=>yn.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Pe(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=SR(e);if(void 0!==t&&!this.tn(t))return!1;const r=Ec(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Zt(yn.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Ic(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ic(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ic(r.field,"asc"===r.dir?0:1)));return new uf(uf.UNKNOWN_ID,this.collectionId,t,lf.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function bz(n){var e,t;if(Pe(n instanceof Ct||n instanceof Wt),n instanceof Ct){if(n instanceof Tq){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Ct.create(n.field,"==",s)))||[];return Wt.create(i,"or")}return n}const r=n.filters.map(i=>bz(i));return Wt.create(r,n.op)}function Fce(n){if(0===n.getFilters().length)return[];const e=nP(bz(n));return Pe(Dz(e)),eP(e)||tP(e)?[e]:e.getFilters()}function eP(n){return n instanceof Ct}function tP(n){return n instanceof Wt&&FR(n)}function Dz(n){return eP(n)||tP(n)||function(t){if(t instanceof Wt&&OR(t)){for(const r of t.getFilters())if(!eP(r)&&!tP(r))return!1;return!0}return!1}(n)}function nP(n){if(Pe(n instanceof Ct||n instanceof Wt),n instanceof Ct)return n;if(1===n.filters.length)return nP(n.filters[0]);const e=n.filters.map(r=>nP(r));let t=Wt.create(e,n.op);return t=Kw(t),Dz(t)?t:(Pe(t instanceof Wt),Pe(hf(t)),Pe(t.filters.length>1),t.filters.reduce((r,i)=>rP(r,i)))}function rP(n,e){let t;return Pe(n instanceof Ct||n instanceof Wt),Pe(e instanceof Ct||e instanceof Wt),t=n instanceof Ct?e instanceof Ct?Wt.create([n,e],"and"):Az(n,e):e instanceof Ct?Az(e,n):function(i,s){if(Pe(i.filters.length>0&&s.filters.length>0),hf(i)&&hf(s))return Eq(i,s.getFilters());const o=OR(i)?i:s,a=OR(i)?s:i,u=o.filters.map(l=>rP(l,a));return Wt.create(u,"or")}(n,e),Kw(t)}function Az(n,e){if(hf(e))return Eq(e,n.getFilters());{const t=e.filters.map(r=>rP(n,r));return Wt.create(t,"or")}}function Kw(n){if(Pe(n instanceof Ct||n instanceof Wt),n instanceof Ct)return n;const e=n.getFilters();if(1===e.length)return Kw(e[0]);if(yq(n))return n;const t=e.map(i=>Kw(i)),r=[];return t.forEach(i=>{i instanceof Ct?r.push(i):i instanceof Wt&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Wt.create(r,n.op)}class Lce{constructor(){this.on=new iP}addToCollectionParentIndex(e,t){return this.on.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(ys.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(ys.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class iP{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Zt(St.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Zt(St.comparator)).toArray()}}const Zw=new Uint8Array(0);class Vce{constructor(e,t){this.user=e,this.databaseId=t,this._n=new iP,this.an=new qa(r=>Cc(r),(r,i)=>E_(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:oi(i)};return Sz(e).put(s)}return V.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[zH(t),""],!1,!0);return Sz(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(Ko(o.parent))}return r})}addFieldIndex(e,t){const r=F_(e),i={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(t.indexState){const o=Tf(e);return s.next(a=>{o.put(vz(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=F_(e),i=Tf(e),s=wf(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=F_(e),r=wf(e),i=Tf(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return V.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new Cz(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=wf(e);let i=!0;const s=new Map;return V.forEach(this.un(t),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=tt();const a=[];return V.forEach(s,(u,l)=>{var O;oe("IndexedDbIndexManager",`Using index ${O=u,`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`} to execute ${Cc(t)}`);const d=function(O,q){const ue=SR(q);if(void 0===ue)return null;for(const Te of Uw(O,ue.fieldPath))switch(Te.op){case"array-contains-any":return Te.value.arrayValue.values||[];case"array-contains":return[Te.value]}return null}(l,u),f=function(O,q){const ue=new Map;for(const Te of Ec(q))for(const Ue of Uw(O,Te.fieldPath))switch(Ue.op){case"==":case"in":ue.set(Te.fieldPath.canonicalString(),Ue.value);break;case"not-in":case"!=":return ue.set(Te.fieldPath.canonicalString(),Ue.value),Array.from(ue.values())}return null}(l,u),m=function(O,q){const ue=[];let Te=!0;for(const Ue of Ec(q)){const Pt=0===Ue.kind?Cq(O,Ue.fieldPath,O.startAt):bq(O,Ue.fieldPath,O.startAt);ue.push(Pt.value),Te&&(Te=Pt.inclusive)}return new rl(ue,Te)}(l,u),_=function(O,q){const ue=[];let Te=!0;for(const Ue of Ec(q)){const Pt=0===Ue.kind?bq(O,Ue.fieldPath,O.endAt):Cq(O,Ue.fieldPath,O.endAt);ue.push(Pt.value),Te&&(Te=Pt.inclusive)}return new rl(ue,Te)}(l,u),v=this.ln(u,l,m),T=this.ln(u,l,_),D=this.hn(u,l,f),k=this.Pn(u.indexId,d,v,m.inclusive,T,_.inclusive,D);return V.forEach(k,P=>r.j(P,t.limit).next(O=>{O.forEach(q=>{const ue=fe.fromSegments(q.documentKey);o.has(ue)||(o=o.add(ue),a.push(ue))})}))}).next(()=>a)}return V.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:Fce(Wt.create(e.filters,"and")).map(r=>VR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,o,a){const u=(null!=t?t.length:1)*Math.max(r.length,s.length),l=u/(null!=t?t.length:1),d=[];for(let f=0;f<u;++f){const m=t?this.In(t[f/l]):Zw,_=this.Tn(e,m,r[f%l],i),v=this.En(e,m,s[f%l],o),T=a.map(D=>this.Tn(e,m,D,!0));d.push(...this.createRange(_,v,T))}return d}Tn(e,t,r,i){const s=new Nc(e,fe.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Nc(e,fe.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new Cz(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.un(t);return V.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let l=new Zt(yn.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?d=!0:l=l.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}dn(e,t){const r=new O_;for(const i of Ec(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);Pc.St.ht(s,o)}return r.Ut()}In(e){const t=new O_;return Pc.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new O_;return Pc.St.ht(Tc(this.databaseId,t),r.jt(function(s){const o=Ec(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(null===r)return[];let i=[];i.push(new O_);let s=0;for(const o of Ec(e)){const a=r[s++];for(const u of i)if(this.Rn(t,o.fieldPath)&&__(a))i=this.Vn(i,o,a);else{const l=u.jt(o.kind);Pc.St.ht(a,l)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new O_;u.seed(a.Ut()),Pc.St.ht(o,u.jt(t.kind)),s.push(u)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof Ct&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=F_(e),i=Tf(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const o=[];return V.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new lf(f.sequenceNumber,new ys(Sc(f.readTime),new fe(Ko(f.documentKey)),f.largestBatchId)):lf.empty(),_=d.fields.map(([v,T])=>new Ic(yn.fromServerFormat(v),T));return new uf(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ge(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=F_(e),s=Tf(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,u=>s.put(vz(u.indexId,this.user,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),V.forEach(a,u=>this.gn(e,i,u).next(l=>{const d=this.pn(s,u);return l.isEqual(d)?V.resolve():this.yn(e,s,u,l,d)}))))})}wn(e,t,r,i){return wf(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return wf(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=wf(e);let s=new Zt(sl);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(o,a)=>{s=s.add(new Nc(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,t){let r=new Zt(sl);const i=this.dn(t,e);if(null==i)return r;const s=SR(t);if(null!=s){const o=e.data.field(s.fieldPath);if(__(o))for(const a of o.arrayValue.values||[])r=r.add(new Nc(t.indexId,e.key,this.In(a),i))}else r=r.add(new Nc(t.indexId,e.key,Zw,i));return r}yn(e,t,r,i,s){oe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,l,d,f,m){const _=u.getIterator(),v=l.getIterator();let T=cf(_),D=cf(v);for(;T||D;){let k=!1,P=!1;if(T&&D){const O=d(T,D);O<0?P=!0:O>0&&(k=!0)}else null!=T?P=!0:k=!0;k?(f(D),D=cf(v)):P?(m(T),T=cf(_)):(T=cf(_),D=cf(v))}}(i,s,sl,a=>{o.push(this.wn(e,t,r,a))},a=>{o.push(this.Sn(e,t,r,a))}),V.waitFor(o)}fn(e){let t=1;return Tf(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>sl(o,a)).filter((o,a,u)=>!a||0!==sl(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=sl(o,e),u=sl(o,t);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Zw,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Zw,[]]))}return s}bn(e,t){return sl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Rz)}getMinOffset(e,t){return V.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||we())).next(Rz)}}function Sz(n){return Mr(n,"collectionParents")}function wf(n){return Mr(n,"indexEntries")}function F_(n){return Mr(n,"indexConfiguration")}function Tf(n){return Mr(n,"indexState")}function Rz(n){Pe(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;RR(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ys(e.readTime,e.documentKey,t)}const Pz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ai{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ai(e,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Nz(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.Y({range:o},(d,f,m)=>(a++,m.delete()));s.push(u.next(()=>{Pe(1===a)}));const l=[];for(const d of t.mutations){const f=eq(e,d.key.path,t.batchId);s.push(i.delete(f)),l.push(d.key)}return V.waitFor(s).next(()=>l)}function Qw(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we();e=n.noDocument}return JSON.stringify(e).length}ai.DEFAULT_COLLECTION_PERCENTILE=10,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ai.DEFAULT=new ai(41943040,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ai.DISABLED=new ai(-1,0,0);class Yw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){Pe(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Yw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ol(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Cf(e),o=ol(e);return o.add({}).next(a=>{Pe("number"==typeof a);const u=new HR(a,t,r,i),l=function(_,v,T){const D=T.baseMutations.map(P=>M_(_.ut,P)),k=T.mutations.map(P=>M_(_.ut,P));return{userId:v,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:D,mutations:k}}(this.serializer,this.userId,u),d=[];let f=new Zt((m,_)=>Ge(m.canonicalString(),_.canonicalString()));for(const m of i){const _=eq(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,Dle))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),V.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return ol(e).get(t).next(r=>r?(Pe(r.userId===this.userId),Rc(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?V.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ol(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(Pe(a.batchId>=r),s=Rc(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ol(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ol(e).W("userMutationsIndex",t).next(r=>r.map(i=>Rc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Nw(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Cf(e).Y({range:i},(o,a,u)=>{const[l,d,f]=o,m=Ko(d);if(l===this.userId&&t.path.isEqual(m))return ol(e).get(f).next(_=>{if(!_)throw we();Pe(_.userId===this.userId),s.push(Rc(this.serializer,_))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zt(Ge);const i=[];return t.forEach(s=>{const o=Nw(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Cf(e).Y({range:a},(l,d,f)=>{const[m,_,v]=l,T=Ko(_);m===this.userId&&s.path.isEqual(T)?r=r.add(v):f.done()});i.push(u)}),V.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Nw(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Zt(Ge);return Cf(e).Y({range:o},(u,l,d)=>{const[f,m,_]=u,v=Ko(m);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(_)):d.done()}).next(()=>this.vn(e,a))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(ol(e).get(s).next(o=>{if(null===o)throw we();Pe(o.userId===this.userId),r.push(Rc(this.serializer,o))}))}),V.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Nz(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),V.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Cf(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Ko(s[1]);i.push(u)}else a.done()}).next(()=>{Pe(0===i.length)})})}containsKey(e,t){return Mz(e,this.userId,t)}Mn(e){return xz(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Mz(n,e,t){const r=Nw(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Cf(n).Y({range:s,J:!0},(a,u,l)=>{const[d,f,m]=a;d===e&&f===i&&(o=!0),l.done()}).next(()=>o)}function ol(n){return Mr(n,"mutations")}function Cf(n){return Mr(n,"documentMutations")}function xz(n){return Mr(n,"mutationQueues")}class Mc{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Mc(0)}static Nn(){return new Mc(-1)}}class Uce{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Mc(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>Me.fromTimestamp(new Rn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>bf(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(Pe(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return bf(e).Y((o,a)=>{const u=x_(a);u.sequenceNumber<=t&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>V.waitFor(s)).next(()=>i)}forEachTarget(e,t){return bf(e).Y((r,i)=>{const s=x_(i);t(s)})}Bn(e){return kz(e).get("targetGlobalKey").next(t=>(Pe(null!==t),t))}Ln(e,t){return kz(e).put("targetGlobalKey",t)}kn(e,t){return bf(e).put(_z(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Cc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return bf(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const l=x_(a);E_(t,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=al(e);return t.forEach(o=>{const a=oi(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(i)}removeMatchingKeys(e,t,r){const i=al(e);return V.forEach(t,s=>{const o=oi(s.path);return V.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=al(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=al(e);let s=tt();return i.Y({range:r,J:!0},(o,a,u)=>{const l=Ko(o[1]),d=new fe(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){const r=oi(t.path),i=IDBKeyRange.bound([r],[zH(r)],!1,!0);let s=0;return al(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,l)=>{0!==o&&(s++,l.done())}).next(()=>s>0)}_t(e,t){return bf(e).get(t).next(r=>r?x_(r):null)}}function bf(n){return Mr(n,"targets")}function kz(n){return Mr(n,"targetGlobal")}function al(n){return Mr(n,"targetDocuments")}function Oz([n,e],[t,r]){const i=Ge(n,t);return 0===i?Ge(e,r):i}class Bce{constructor(e){this.Qn=e,this.buffer=new Zt(Oz),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Oz(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Fz{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;oe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Q.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Qu(r)?oe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Zu(r)}yield t.Gn(3e5)}))}}class jce{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return V.resolve(vs._e);const r=new Bce(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Pz)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pz):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,o,a,u,l;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),sf()<=fs.in.DEBUG&&oe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-d}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${f} documents in `+(l-u)+`ms\nTotal Duration: ${l-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}class $ce{constructor(e,t){this.db=e,this.garbageCollector=function Lz(n,e){return new jce(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Xw(e,r)}removeReference(e,t,r){return Xw(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Xw(e,t)}Xn(e,t){return function(i,s){let o=!1;return xz(i).Z(a=>Mz(i,a,s).next(u=>(u&&(o=!0),V.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=t){const u=this.Xn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Me.min()),al(e).delete([0,oi(o.path)])))});i.push(u)}}).next(()=>V.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Xw(e,t)}Zn(e,t){const r=al(e);let i,s=vs._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{0===o?(s!==vs._e&&t(new fe(Ko(i)),s),s=l,i=u):s=vs._e}).next(()=>{s!==vs._e&&t(new fe(Ko(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xw(n,e){return al(n).put((i=n.currentSequenceNumber,{targetId:0,path:oi(e.path),sequenceNumber:i}));var i}class Vz{constructor(){this.changes=new qa(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,vn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Hce{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return xc(e).put(r)}removeEntry(e,t,r){return xc(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gw(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=vn.newInvalidDocument(t);return xc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(L_(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:vn.newInvalidDocument(t)};return xc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(L_(t))},(i,s)=>{r={document:this.tr(t,s),size:Qw(s)}}).next(()=>r)}getEntries(e,t){let r=Qi();return this.rr(e,t,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,t){let r=Qi(),i=new hn(fe.comparator);return this.rr(e,t,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Qw(o))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return V.resolve();let i=new Zt($z);t.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(L_(i.first()),L_(i.last())),o=i.getIterator();let a=o.getNext();return xc(e).Y({index:"documentKeyIndex",range:s},(u,l,d)=>{const f=fe.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&$z(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.U(L_(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Gw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xc(e).W(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Qi();for(const f of l){const m=this.tr(fe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(w_(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Qi();const o=jz(t,r),a=jz(t,ys.max());return xc(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{const f=this.tr(fe.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new qce(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Bz(e).get("remoteDocumentGlobalKey").next(t=>(Pe(!!t),t))}er(e,t){return Bz(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=function Pce(n,e){let t;if(e.document)t=lz(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=fe.fromSegments(e.noDocument.path),i=Sc(e.noDocument.readTime);t=vn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we();{const r=fe.fromSegments(e.unknownDocument.path),i=Sc(e.unknownDocument.version);t=vn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Rn(i[0],i[1]);return Me.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(Me.min()))return r}return vn.newInvalidDocument(e)}}function Uz(n){return new Hce(n)}class qce extends Vz{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new qa(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Zt((s,o)=>Ge(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=mz(this._r.serializer,o);i=i.add(s.path.popLast());const l=Qw(u);r+=l-a.size,t.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=mz(this._r.serializer,o.convertToNoDocument(Me.min()));t.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Bz(n){return Mr(n,"remoteDocumentGlobal")}function xc(n){return Mr(n,"remoteDocumentsV14")}function L_(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function jz(n,e){const t=e.documentKey.path.toArray();return[n,Gw(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function $z(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Ge(t[s],r[s]),i)return i;return i=Ge(t.length,r.length),i||(i=Ge(t[t.length-2],r[r.length-2]),i||Ge(t[t.length-1],r[r.length-1]))}class zce{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Hz{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&D_(r.mutation,i,Zi.empty(),Rn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,tt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=tt()){const i=Qo();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=T_();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Qo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,tt()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Qi();const o=C_(),a=C_();return t.forEach((u,l)=>{const d=r.get(l.key);i.has(l.key)&&(void 0===d||d.mutation instanceof za)?s=s.insert(l.key,l):void 0!==d?(o.set(l.key,d.mutation.getFieldMask()),D_(d.mutation,l,d.mutation.getFieldMask(),Rn.now())):o.set(l.key,Zi.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var f;return a.set(l,new zce(d,null!==(f=o.get(l))&&void 0!==f?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=C_();let i=new hn((o,a)=>o-a),s=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=t.get(u);if(null===l)return;let d=r.get(u)||Zi.empty();d=a.applyToLocalView(l,d),r.set(u,d);const f=(i.get(a.batchId)||tt()).add(u);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,d=u.value,f=kq();d.forEach(m=>{if(!s.has(m)){const _=Hq(t.get(m),r.get(m));null!==_&&f.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return fe.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):UR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var o}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(Qo());let a=-1,u=s;return o.next(l=>V.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,tt())).next(d=>({batchId:a,changes:xq(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new fe(t)).next(r=>{let i=T_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=T_();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,u=>{const l=(f=t,m=u.child(s),new Ha(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,m;return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{const d=l.getKey();null===o.get(d)&&(o=o.insert(d,vn.newInvalidDocument(d)))});let a=T_();return o.forEach((u,l)=>{const d=s.get(u);void 0!==d&&D_(d.mutation,l,Zi.empty(),Rn.now()),w_(t,l)&&(a=a.insert(u,l))}),a})}}class Gce{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return V.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:rr(i.createTime)}),V.resolve();var i}getNamedQuery(e,t){return V.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:XR(i.bundledQuery),readTime:rr(i.readTime)}),V.resolve();var i}}class Wce{constructor(){this.overlays=new hn(fe.comparator),this.lr=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qo();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const i=Qo(),s=t.length+1,o=new fe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new hn((l,d)=>l-d);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);null===d&&(d=Qo(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}const a=Qo(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return V.resolve(a)}lt(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zR(t,r));let s=this.lr.get(t);void 0===s&&(s=tt(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class sP{constructor(){this.hr=new Zt(xr.Pr),this.Ir=new Zt(xr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new xr(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new xr(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new fe(new St([])),r=new xr(t,e),i=new xr(t,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new fe(new St([])),r=new xr(t,e),i=new xr(t,e+1);let s=tt();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new xr(e,0),r=this.hr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class xr{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return fe.comparator(e.key,t.key)||Ge(e.gr,t.gr)}static Tr(e,t){return Ge(e.gr,t.gr)||fe.comparator(e.key,t.key)}}class Kce{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Zt(xr.Pr)}checkEmpty(e){return V.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++;const o=new HR(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new xr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new xr(t,0),i=new xr(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zt(Ge);return t.forEach(i=>{const s=new xr(i,0),o=new xr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),V.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;fe.isDocumentKey(s)||(s=s.child(""));const o=new xr(new fe(s),0);let a=new Zt(Ge);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.gr)),!0)},o),V.resolve(this.br(a))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Pe(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return V.forEach(t.mutations,i=>{const s=new xr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new xr(t,0),i=this.yr.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return V.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Zce{constructor(e){this.Cr=e,this.docs=new hn(fe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():vn.newInvalidDocument(t))}getEntries(e,t){let r=Qi();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vn.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Qi();const o=t.path,a=new fe(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||RR(WH(d),r)<=0||(i.has(d.key)||w_(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){we()}vr(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Qce(this)}getSize(e){return V.resolve(this.size)}}class Qce extends Vz{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class Yce{constructor(e){this.persistence=e,this.Fr=new qa(t=>Cc(t),E_),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Mr=0,this.Or=new sP,this.targetCount=0,this.Nr=Mc.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),V.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Mc(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.kn(t),V.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Or.containsKey(t))}}class oP{constructor(e,t){this.Br={},this.overlays={},this.Lr=new vs(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Yce(this),this.indexManager=new Lce,this.remoteDocumentCache=new Zce(r=>this.referenceDelegate.Qr(r)),this.serializer=new gz(t),this.Kr=new Gce(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Wce,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Kce(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){oe("MemoryPersistence","Starting transaction:",e);const i=new Xce(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return V.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class Xce extends ZH{constructor(e){super(),this.currentSequenceNumber=e}}class Jw{constructor(e){this.persistence=e,this.Gr=new sP,this.zr=null}static jr(e){return new Jw(e)}get Hr(){if(this.zr)return this.zr;throw we()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Hr,r=>{const i=fe.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,Me.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return V.or([()=>V.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class Jce{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Pw("createOrUpgrade",t);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JH,{unique:!0}),u.createObjectStore("documentMutations"),qz(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),qz(e)),o=o.next(()=>function(u){const l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,l){return l.store("mutations").W().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JH,{unique:!0});const f=l.store("mutations"),m=d.map(_=>f.put(_));return V.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const l=u.createObjectStore("documentOverlays",{keyPath:Vle});l.createIndex("collectionPathOverlayIndex",Ule,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",Ble,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const l=u.createObjectStore("remoteDocumentsV14",{keyPath:Ale});l.createIndex("documentKeyIndex",Sle),l.createIndex("collectionGroupIndex",Rle)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:kle}).createIndex("sequenceNumberIndex",Ole,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Fle}).createIndex("documentKeyIndex",Lle,{unique:!1})}(e))),o}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=Qw(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>V.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>V.forEach(a,u=>{Pe(u.userId===s.userId);const l=Rc(this.serializer,u);return Nz(e,s.userId,l).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new St(o),l=[0,oi(u)];s.push(t.get(l).next(d=>d?V.resolve():t.put({targetId:0,path:oi(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>V.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:xle});const r=t.store("collectionParents"),i=new iP,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:oi(u)})}};return t.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new St(o);return s(u.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([o,a,u],l)=>{const d=Ko(a);return s(d.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=x_(i),o=_z(this.serializer,s);return t.put(o)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=t.store("remoteDocumentsV14"),u=(f=o,f.document?new fe(St.fromString(f.document.name).popFirst(5)):f.noDocument?fe.fromSegments(f.noDocument.path):f.unknownDocument?fe.fromSegments(f.unknownDocument.path):we()).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var f;i.push(a.put(l))}).next(()=>V.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=Uz(this.serializer),s=new oP(Jw.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var l;let d=null!==(l=a.get(u.userId))&&void 0!==l?l:tt();Rc(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),V.forEach(a,(u,l)=>{const d=new Nr(l),f=Ww.ct(this.serializer,d),m=s.getIndexManager(d),_=Yw.ct(d,this.serializer,m,s.referenceDelegate);return new Hz(i,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new MR(t,vs._e),u).next()})})}}function qz(n){n.createObjectStore("targetDocuments",{keyPath:Nle}).createIndex("documentTargetsIndex",Mle,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ple,{unique:!0}),n.createObjectStore("targetGlobal")}const aP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class uP{constructor(e,t,r,i,s,o,a,u,l,d,f=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=l,this._i=d,this.ai=f,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!uP.D())throw new ne(H.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $ce(this,i),this.Ii=t+"main",this.serializer=new gz(u),this.Ti=new _o(this.Ii,this.ai,new Jce(this.serializer)),this.qr=new Uce(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Uz(this.serializer),this.Kr=new Nce,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===d&&nr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(H.FAILED_PRECONDITION,aP);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new vs(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var r=(0,Q.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,Q.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,Q.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>tT(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(Qu(e))return oe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return oe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return V_(e).get("owner").next(t=>V.resolve(this.wi(t)))}Si(e){return tT(e).delete(this.clientId)}bi(){var e=this;return(0,Q.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Mr(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return V.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of t)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?V.resolve(!0):V_(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new ne(H.FAILED_PRECONDITION,aP);return!1}}return!(!this.networkEnabled||!this.inForeground)||tT(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&oe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Q.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new MR(t,vs._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>tT(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return Yw.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vce(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Ww.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){oe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(u=this.ai)?$le:14===u?rq:13===u?nq:12===u?jle:11===u?tq:void we();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new MR(a,this.Lr?this.Lr.next():vs._e),"readwrite-primary"===t?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw nr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new ne(H.FAILED_PRECONDITION,KH);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return V_(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ne(H.FAILED_PRECONDITION,aP)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return V_(e).put("owner",t)}static D(){return _o.D()}pi(e){const t=V_(e);return t.get("owner").next(r=>this.wi(r)?(oe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Di(e,t){const r=Date.now();return!(e<r-t||e>r&&(nr(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,b.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return oe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){nr("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function V_(n){return Mr(n,"owner")}function tT(n){return Mr(n,"clientMetadata")}function lP(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class cP{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=tt(),i=tt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new cP(e,t.fromCache,r,i)}}class ede{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class zz{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new ede;return this.Hi(e,t,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(sf()<=fs.in.DEBUG&&oe("QueryEngine","SDK will not create cache indexes for query:",gf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),V.resolve()):(sf()<=fs.in.DEBUG&&oe("QueryEngine","Query:",gf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(sf()<=fs.in.DEBUG&&oe("QueryEngine","The SDK decides to create cache indexes for query:",gf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ri(t))):V.resolve())}zi(e,t){if(Aq(t))return V.resolve(null);let r=Ri(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Bw(t,null,"F"),r=Ri(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=tt(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(t,a);return this.Zi(t,l,o,u.readTime)?this.zi(e,Bw(t,null,"F")):this.Xi(e,l,t,u)}))})))}ji(e,t,r,i){return Aq(t)||i.isEqual(Me.min())?V.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(t,s);return this.Zi(t,o,r,i)?V.resolve(null):(sf()<=fs.in.DEBUG&&oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gf(t)),this.Xi(e,o,t,GH(i,-1)).next(a=>a))})}Yi(e,t){let r=new Zt(Nq(e));return t.forEach((i,s)=>{w_(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return sf()<=fs.in.DEBUG&&oe("QueryEngine","Using full collection scan to execute query:",gf(t)),this.Gi.getDocumentsMatchingQuery(e,t,ys.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class tde{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new hn(Ge),this.ns=new qa(s=>Cc(s),E_),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hz(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function Gz(n,e,t,r){return new tde(n,e,t,r)}function Wz(n,e){return dP.apply(this,arguments)}function dP(){return dP=(0,Q.Z)(function*(n,e){const t=he(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=tt();for(const l of i){o.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}for(const l of s){a.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}),dP.apply(this,arguments)}function Kz(n){const e=he(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function Zz(n,e,t){let r=tt(),i=tt();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Qi();return t.forEach((a,u)=>{const l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Me.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||0===u.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{us:o,cs:i}})}function ide(n,e){const t=he(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Df(n,e){const t=he(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):t.qr.allocateTargetId(r).next(o=>(i=new Ga(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}function Af(n,e,t){return hP.apply(this,arguments)}function hP(){return hP=(0,Q.Z)(function*(n,e,t){const r=he(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Qu(o))throw o;oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),hP.apply(this,arguments)}function nT(n,e,t){const r=he(n);let i=Me.min(),s=tt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){const f=he(u),m=f.ns.get(d);return void 0!==m?V.resolve(f.ts.get(m)):f.qr.getTargetData(l,d)}(r,o,Ri(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,t?i:Me.min(),t?s:tt())).next(a=>(Xz(r,Pq(e),a),{documents:a,ls:s})))}function Qz(n,e){const t=he(n),r=he(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function Yz(n,e){const t=he(n),r=t.rs.get(e)||Me.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,GH(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Xz(t,e,i),i))}function Xz(n,e,t){let r=n.rs.get(e)||Me.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}function fP(){return fP=(0,Q.Z)(function*(n,e,t,r){const i=he(n);let s=tt(),o=Qi();for(const l of t){const d=e.hs(l.metadata.name);l.document&&(s=s.add(d));const f=e.Ps(l);f.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(d,f)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield Df(i,(d=r,Ri(ff(St.fromString(`__bundle__/docs/${d}`)))));var d;return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>Zz(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.us,d.cs)).next(()=>d.us)))}),fP.apply(this,arguments)}function ode(n,e){return pP.apply(this,arguments)}function pP(){return pP=(0,Q.Z)(function*(n,e,t=tt()){const r=yield Df(n,Ri(XR(e.bundledQuery))),i=he(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=rr(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(Er.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),pP.apply(this,arguments)}function Jz(n,e){return`firestore_clients_${n}_${e}`}function eG(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function gP(n,e){return`firestore_targets_${n}_${e}`}class rT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new ne(i.error.code,i.error.message))),o?new rT(e,t,i.state,s):(nr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class U_{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ne(r.error.code,r.error.message))),s?new U_(e,r.state,i):(nr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class iT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=jR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=YH(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new iT(e,s):(nr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class mP{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new mP(t.clientId,t.onlineState):(nr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class _P{constructor(){this.activeTargetIds=jR()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yP{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new hn(Ge),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Jz(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new _P),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Q.Z)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Rs)continue;const s=e.getItem(Jz(e.persistenceKey,i));if(s){const o=iT.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(gP(this.persistenceKey,e));if(r){const i=U_.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(gP(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return oe("SharedClientState","READ",e,t),t}setItem(e,t){oe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){oe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(oe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,Q.Z)(function*(){if(t.started){if(null!==r.key)if(t.Ss.test(r.key)){if(null==r.newValue){const i=t.Ks(r.key);return t.$s(i,null)}{const i=t.Us(r.key,r.newValue);if(i)return t.$s(i.clientId,i)}}else if(t.bs.test(r.key)){if(null!==r.newValue){const i=t.Ws(r.key,r.newValue);if(i)return t.Gs(i)}}else if(t.Ds.test(r.key)){if(null!==r.newValue){const i=t.zs(r.key,r.newValue);if(i)return t.js(i)}}else if(r.key===t.Cs){if(null!==r.newValue){const i=t.Ms(r.newValue);if(i)return t.xs(i)}}else if(r.key===t.ws){const i=function(o){let a=vs._e;if(null!=o)try{const u=JSON.parse(o);Pe("number"==typeof u),a=u}catch(u){nr("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==vs._e&&t.sequenceNumberHandler(i)}else if(r.key===t.vs){const i=t.Hs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new rT(this.currentUser,e,t,r),s=eG(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=eG(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,r){const i=gP(this.persistenceKey,e),s=new U_(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return iT.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]);return rT.Ts(new Nr(void 0!==r[2]?r[2]:null),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return U_.Ts(i,t)}Ms(e){return mP.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,Q.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);oe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=jR();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class tG{constructor(){this.eo=new _P,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new _P,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ade{ro(e){}shutdown(){}}class nG{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let sT=null;function vP(){return null===sT?sT=268435456+Math.round(2147483648*Math.random()):sT++,"0x"+sT.toString(16)}const ude={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lde{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const ui="WebChannelConnection";class cde extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,o){const a=vP(),u=this.So(t,r);oe("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,o),this.Do(t,u,l,i).then(d=>(oe("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Ki("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Co(t,r,i,s,o,a){return this.wo(t,r,i,s,o)}bo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+rf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}So(t,r){return`${this.mo}/v1/${r}:${ude[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=vP();return new Promise((o,a)=>{const u=new ale;u.setWithCredentials(!0),u.listenOnce(ile.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case DR.NO_ERROR:const d=u.getResponseJson();oe(ui,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case DR.TIMEOUT:oe(ui,`RPC '${e}' ${s} timed out`),a(new ne(H.DEADLINE_EXCEEDED,"Request time out"));break;case DR.HTTP_ERROR:const f=u.getStatus();if(oe(ui,`RPC '${e}' ${s} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m?.error;if(_&&_.status&&_.message){const v=function(D){const k=D.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(k)>=0?k:H.UNKNOWN}(_.status);a(new ne(v,_.message))}else a(new ne(H.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new ne(H.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{oe(ui,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);oe(ui,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",l,r,15)})}vo(e,t,r){const i=vP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nle(),a=rle(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new ole({})),this.bo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=s.join("");oe(ui,`Creating RPC '${e}' stream ${i}: ${d}`,u);const f=o.createWebChannel(d,u);let m=!1,_=!1;const v=new lde({co:D=>{_?oe(ui,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(oe(ui,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),oe(ui,`RPC '${e}' stream ${i} sending:`,D),f.send(D))},lo:()=>f.close()}),T=(D,k,P)=>{D.listen(k,O=>{try{P(O)}catch(q){setTimeout(()=>{throw q},0)}})};return T(f,Rw.EventType.OPEN,()=>{_||oe(ui,`RPC '${e}' stream ${i} transport opened.`)}),T(f,Rw.EventType.CLOSE,()=>{_||(_=!0,oe(ui,`RPC '${e}' stream ${i} transport closed`),v.Ro())}),T(f,Rw.EventType.ERROR,D=>{_||(_=!0,Ki(ui,`RPC '${e}' stream ${i} transport errored:`,D),v.Ro(new ne(H.UNAVAILABLE,"The operation could not be completed")))}),T(f,Rw.EventType.MESSAGE,D=>{var k;if(!_){const P=D.data[0];Pe(!!P);const q=P.error||(null===(k=P[0])||void 0===k?void 0:k.error);if(q){oe(ui,`RPC '${e}' stream ${i} received error:`,q);const ue=q.status;let Te=function(Ir){const Yi=lr[Ir];if(void 0!==Yi)return Zq(Yi)}(ue),Ue=q.message;void 0===Te&&(Te=H.INTERNAL,Ue="Unknown error status: "+ue+" with message "+q.message),_=!0,v.Ro(new ne(Te,Ue)),f.close()}else oe(ui,`RPC '${e}' stream ${i} received:`,P),v.Vo(P)}}),T(a,sle.STAT_EVENT,D=>{D.stat===BH.PROXY?oe(ui,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===BH.NOPROXY&&oe(ui,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.Ao()},0),v}}function rG(){return typeof window<"u"?window:null}function oT(){return typeof document<"u"?document:null}function B_(n){return new Ece(n,!0)}class EP{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class iG{constructor(e,t,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new EP(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,Q.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,Q.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var r=this;return(0,Q.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(nr(t.toString()),nr("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):t&&t.code===H.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new ne(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,Q.Z)(function*(){e.state=0,e.start()}))}o_(e){return oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dde extends iG{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function Tce(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:we(),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Pe(void 0===d||"string"==typeof d),Er.fromBase64String(d||"")):(Pe(void 0===d||d instanceof Uint8Array),Er.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const d=void 0===l.code?H.UNKNOWN:Zq(l.code);return new ne(d,l.message||"")}(o);t=new ez(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=Yo(n,r.document.name),s=rr(r.document.updateTime),o=r.document.createTime?rr(r.document.createTime):Me.min(),a=new Gr({mapValue:{fields:r.document.fields}}),u=vn.newFoundDocument(i,s,o,a);t=new zw(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=Yo(n,r.document),s=r.readTime?rr(r.readTime):Me.min(),o=vn.newNoDocument(i,s);t=new zw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=Yo(n,r.document);t=new zw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return we();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new pce(i,s);t=new Jq(r.targetId,o)}}var l;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return Me.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?rr(o.readTime):Me.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=N_(this.serializer),t.addTarget=function(s,o){let a;const u=o.target;if(a=Vw(u)?{documents:cz(s,u)}:{query:YR(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=iz(s,o.resumeToken);const l=WR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Me.min())>0){a.readTime=Ef(s,o.snapshotVersion.toTimestamp());const l=WR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const r=function bce(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=N_(this.serializer),t.removeTarget=e,this.e_(t)}}class hde extends iG{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(Pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function Cce(n,e){return n&&n.length>0?(Pe(void 0!==e),n.map(t=>function(i,s){let o=rr(i.updateTime?i.updateTime:s);return o.isEqual(Me.min())&&(o=rr(s)),new cce(o,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=rr(e.commitTime);return this.listener.I_(r,t)}return Pe(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=N_(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>M_(this.serializer,r))};this.e_(t)}}class fde extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new ne(H.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ne(H.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,t,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(H.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class gde{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(nr(t),this.f_=!1):oe("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class mde{constructor(e,t,r,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,Q.Z)(function*(){var u;ul(o)&&(oe("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,Q.Z)(function*(d){const f=he(d);f.C_.add(4),yield Sf(f),f.M_.set("Unknown"),f.C_.delete(4),yield j_(f)}),function l(d){return u.apply(this,arguments)})(o))}))}),this.M_=new gde(r,i)}}function j_(n){return wP.apply(this,arguments)}function wP(){return wP=(0,Q.Z)(function*(n){if(ul(n))for(const e of n.v_)yield e(!0)}),wP.apply(this,arguments)}function Sf(n){return TP.apply(this,arguments)}function TP(){return TP=(0,Q.Z)(function*(n){for(const e of n.v_)yield e(!1)}),TP.apply(this,arguments)}function aT(n,e){const t=he(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),DP(t)?bP(t):Pf(t).Ho()&&CP(t,e))}function $_(n,e){const t=he(n),r=Pf(t);t.D_.delete(e),r.Ho()&&sG(t,e),0===t.D_.size&&(r.Ho()?r.Zo():ul(t)&&t.M_.set("Unknown"))}function CP(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pf(n).u_(e)}function sG(n,e){n.x_.Oe(e),Pf(n).c_(e)}function bP(n){n.x_=new mce({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Pf(n).start(),n.M_.g_()}function DP(n){return ul(n)&&!Pf(n).jo()&&n.D_.size>0}function ul(n){return 0===he(n).C_.size}function oG(n){n.x_=void 0}function _de(n){return AP.apply(this,arguments)}function AP(){return AP=(0,Q.Z)(function*(n){n.D_.forEach((e,t)=>{CP(n,e)})}),AP.apply(this,arguments)}function yde(n,e){return SP.apply(this,arguments)}function SP(){return SP=(0,Q.Z)(function*(n,e){oG(n),DP(n)?(n.M_.w_(e),bP(n)):n.M_.set("Unknown")}),SP.apply(this,arguments)}function vde(n,e,t){return RP.apply(this,arguments)}function RP(){return RP=(0,Q.Z)(function*(n,e,t){if(n.M_.set("Online"),e instanceof ez&&2===e.state&&e.cause)try{yield(r=(0,Q.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(n,e)}catch(r){oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield uT(n,r)}else if(e instanceof zw?n.x_.$e(e):e instanceof Jq?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(Me.min()))try{const r=yield Kz(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.D_.get(l);d&&s.D_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const d=s.D_.get(u);if(!d)return;s.D_.set(u,d.withResumeToken(Er.EMPTY_BYTE_STRING,d.snapshotVersion)),sG(s,u);const f=new Ga(d.target,u,l,d.sequenceNumber);CP(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){oe("RemoteStore","Failed to raise snapshot:",r),yield uT(n,r)}var r}),RP.apply(this,arguments)}function uT(n,e,t){return PP.apply(this,arguments)}function PP(){return PP=(0,Q.Z)(function*(n,e,t){if(!Qu(e))throw e;n.C_.add(1),yield Sf(n),n.M_.set("Offline"),t||(t=()=>Kz(n.localStore)),n.asyncQueue.enqueueRetryable((0,Q.Z)(function*(){oe("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield j_(n)}))}),PP.apply(this,arguments)}function aG(n,e){return e().catch(t=>uT(n,t,e))}function Rf(n){return NP.apply(this,arguments)}function NP(){return NP=(0,Q.Z)(function*(n){const e=he(n),t=ll(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Ede(e);)try{const i=yield ide(e.localStore,r);if(null===i){0===e.b_.length&&t.Zo();break}r=i.batchId,Ide(e,i)}catch(i){yield uT(e,i)}uG(e)&&lG(e)}),NP.apply(this,arguments)}function Ede(n){return ul(n)&&n.b_.length<10}function Ide(n,e){n.b_.push(e);const t=ll(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function uG(n){return ul(n)&&!ll(n).jo()&&n.b_.length>0}function lG(n){ll(n).start()}function wde(n){return MP.apply(this,arguments)}function MP(){return MP=(0,Q.Z)(function*(n){ll(n).E_()}),MP.apply(this,arguments)}function Tde(n){return xP.apply(this,arguments)}function xP(){return xP=(0,Q.Z)(function*(n){const e=ll(n);for(const t of n.b_)e.P_(t.mutations)}),xP.apply(this,arguments)}function Cde(n,e,t){return kP.apply(this,arguments)}function kP(){return kP=(0,Q.Z)(function*(n,e,t){const r=n.b_.shift(),i=qR.from(r,e,t);yield aG(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Rf(n)}),kP.apply(this,arguments)}function bde(n,e){return OP.apply(this,arguments)}function OP(){return OP=(0,Q.Z)(function*(n,e){var t;e&&ll(n).h_&&(yield(t=(0,Q.Z)(function*(i,s){if(Kq(a=s.code)&&a!==H.ABORTED){const o=i.b_.shift();ll(i).Yo(),yield aG(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Rf(i)}var a}),function r(i,s){return t.apply(this,arguments)})(n,e)),uG(n)&&lG(n)}),OP.apply(this,arguments)}function cG(n,e){return FP.apply(this,arguments)}function FP(){return FP=(0,Q.Z)(function*(n,e){const t=he(n);t.asyncQueue.verifyOperationInProgress(),oe("RemoteStore","RemoteStore received new credentials");const r=ul(t);t.C_.add(3),yield Sf(t),r&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield j_(t)}),FP.apply(this,arguments)}function LP(n,e){return VP.apply(this,arguments)}function VP(){return VP=(0,Q.Z)(function*(n,e){const t=he(n);e?(t.C_.delete(2),yield j_(t)):e||(t.C_.add(2),yield Sf(t),t.M_.set("Unknown"))}),VP.apply(this,arguments)}function Pf(n){return n.O_||(n.O_=function(t,r,i){const s=he(t);return s.A_(),new dde(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:_de.bind(null,n),Io:yde.bind(null,n),a_:vde.bind(null,n)}),n.v_.push(function(){var e=(0,Q.Z)(function*(t){t?(n.O_.Yo(),DP(n)?bP(n):n.M_.set("Unknown")):(yield n.O_.stop(),oG(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function ll(n){return n.N_||(n.N_=function(t,r,i){const s=he(t);return s.A_(),new hde(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:wde.bind(null,n),Io:bde.bind(null,n),T_:Tde.bind(null,n),I_:Cde.bind(null,n)}),n.v_.push(function(){var e=(0,Q.Z)(function*(t){t?(n.N_.Yo(),yield Rf(n)):(yield n.N_.stop(),n.b_.length>0&&(oe("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class UP{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new UP(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ne(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nf(n,e){if(nr("AsyncQueue",`${e}: ${n}`),Qu(n))return new ne(H.UNAVAILABLE,`${e}: ${n}`);throw n}class Mf{constructor(e){this.comparator=e?(t,r)=>e(t,r)||fe.comparator(t.key,r.key):(t,r)=>fe.comparator(t.key,r.key),this.keyedMap=T_(),this.sortedSet=new hn(this.comparator)}static emptySet(e){return new Mf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Mf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class dG{constructor(){this.B_=new hn(fe.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):we():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class xf{constructor(e,t,r,i,s,o,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new xf(e,t,Mf.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&I_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Dde{constructor(){this.k_=void 0,this.listeners=[]}}class Ade{constructor(){this.queries=new qa(e=>Rq(e),I_),this.onlineState="Unknown",this.q_=new Set}}function BP(n,e){return jP.apply(this,arguments)}function jP(){return jP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Dde),i)try{s.k_=yield t.onListen(r)}catch(o){const a=Nf(o,`Initialization of query '${gf(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&qP(t)}),jP.apply(this,arguments)}function $P(n,e){return HP.apply(this,arguments)}function HP(){return HP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),HP.apply(this,arguments)}function Sde(n,e){const t=he(n);let r=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&qP(t)}function Rde(n,e,t){const r=he(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function qP(n){n.q_.forEach(e=>{e.next()})}class zP{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new xf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=xf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Pde{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class hG{constructor(e){this.serializer=e}hs(e){return Yo(this.serializer,e)}Ps(e){return e.metadata.exists?lz(this.serializer,e.document,!1):vn.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return rr(e)}}class Nde{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=fG(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=St.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new hG(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||tt()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,Q.Z)(function*(){const t=yield function sde(n,e,t,r){return fP.apply(this,arguments)}(e.localStore,new hG(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield ode(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function fG(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class pG{constructor(e){this.key=e}}class gG{constructor(e){this.key=e}}class mG{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=tt(),this.mutatedKeys=tt(),this._a=Nq(e),this.aa=new Mf(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new dG,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const m=i.get(d),_=w_(this.query,f)?f:null,v=!!m&&this.mutatedKeys.has(m.key),T=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let D=!1;m&&_?m.data.isEqual(_.data)?v!==T&&(r.track({type:3,doc:_}),D=!0):this.ha(m,_)||(r.track({type:2,doc:_}),D=!0,(u&&this._a(_,u)>0||l&&this._a(_,l)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),D=!0):m&&!_&&(r.track({type:1,doc:m}),D=!0,(u||l)&&(a=!0)),D&&(_?(o=o.add(_),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const d="F"===this.query.limitType?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort((l,d)=>function(m,_){const v=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return v(m)-v(_)}(l.type,d.type)||this._a(l.doc,d.doc)),this.Pa(r);const o=t?this.Ia():[],a=0===this.oa.size&&this.current?1:0,u=a!==this.sa;return this.sa=a,0!==s.length||u?{snapshot:new xf(this.query,e.aa,i,s,e.mutatedKeys,0===a,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new dG,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=tt(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new gG(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new pG(r))}),t}da(e){this.ia=e.ls,this.oa=tt();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return xf.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Mde{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class xde{constructor(e){this.key=e,this.Ra=!1}}class kde{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new qa(a=>Rq(a),I_),this.fa=new Map,this.ga=new Set,this.pa=new hn(fe.comparator),this.ya=new Map,this.wa=new sP,this.Sa={},this.ba=new Map,this.Da=Mc.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Ode(n,e){return GP.apply(this,arguments)}function GP(){return GP=(0,Q.Z)(function*(n,e){const t=gN(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield Df(t.localStore,Ri(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield WP(t,e,r,"current"===a,o.resumeToken),t.isPrimaryClient&&aT(t.remoteStore,o)}return i}),GP.apply(this,arguments)}function WP(n,e,t,r,i){return KP.apply(this,arguments)}function KP(){return KP=(0,Q.Z)(function*(n,e,t,r,i){n.va=(f,m,_)=>{return(v=(0,Q.Z)(function*(D,k,P,O){let q=k.view.ca(P);q.Zi&&(q=yield nT(D.localStore,k.query,!1).then(({documents:Ue})=>k.view.ca(Ue,q)));const ue=O&&O.targetChanges.get(k.targetId),Te=k.view.applyChanges(q,D.isPrimaryClient,ue);return iN(D,k.targetId,Te.Ta),Te.snapshot}),function T(D,k,P,O){return v.apply(this,arguments)})(n,f,m,_);var v};const s=yield nT(n.localStore,e,!0),o=new mG(e,s.ls),a=o.ca(s.documents),u=R_.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),l=o.applyChanges(a,n.isPrimaryClient,u);iN(n,t,l.Ta);const d=new Mde(e,t,o);return n.ma.set(e,d),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),l.snapshot}),KP.apply(this,arguments)}function Fde(n,e){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,Q.Z)(function*(n,e){const t=he(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!I_(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Af(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),$_(t.remoteStore,r.targetId),kf(t,r.targetId)}).catch(Zu))):(kf(t,r.targetId),yield Af(t.localStore,r.targetId,!0))}),ZP.apply(this,arguments)}function QP(){return QP=(0,Q.Z)(function*(n,e,t){const r=mN(n);try{const i=yield function(o,a){const u=he(o),l=Rn.now(),d=a.reduce((_,v)=>_.add(v.key),tt());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=Qi(),T=tt();return u.ss.getEntries(_,d).next(D=>{v=D,v.forEach((k,P)=>{P.isValidDocument()||(T=T.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,v)).next(D=>{f=D;const k=[];for(const P of a){const O=hce(P,f.get(P.key).overlayedDocument);null!=O&&k.push(new za(P.key,O,pq(O.value.mapValue),Pn.exists(!0)))}return u.mutationQueue.addMutationBatch(_,l,k,a)}).next(D=>{m=D;const k=D.applyToLocalDocumentSet(f,T);return u.documentOverlayCache.saveOverlays(_,D.batchId,k)})}).then(()=>({batchId:m.batchId,changes:xq(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Sa[o.currentUser.toKey()];l||(l=new hn(Ge)),l=l.insert(a,u),o.Sa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Wa(r,i.changes),yield Rf(r.remoteStore)}catch(i){const s=Nf(i,"Failed to persist write");t.reject(s)}}),QP.apply(this,arguments)}function _G(n,e){return YP.apply(this,arguments)}function YP(){return YP=(0,Q.Z)(function*(n,e){const t=he(n);try{const r=yield function rde(n,e){const t=he(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const a=[];e.targetChanges.forEach((d,f)=>{const m=i.get(f);if(!m)return;a.push(t.qr.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.qr.addMatchingKeys(s,d.addedDocuments,f)));let _=m.withSequenceNumber(s.currentSequenceNumber);var T,D,k;null!==e.targetMismatches.get(f)?_=_.withResumeToken(Er.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(f,_),D=_,k=d,(0===(T=m).resumeToken.approximateByteSize()||D.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8||k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(s,_))});let u=Qi(),l=tt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(Zz(s,o,e.documentUpdates).next(d=>{u=d.us,l=d.cs})),!r.isEqual(Me.min())){const d=t.qr.getLastRemoteSnapshotVersion(s).next(f=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.ts=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.ya.get(s);o&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?Pe(o.Ra):i.removedDocuments.size>0&&(Pe(o.Ra),o.Ra=!1))}),yield Wa(t,r,e)}catch(r){yield Zu(r)}}),YP.apply(this,arguments)}function yG(n,e,t){const r=he(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=he(o);u.onlineState=a;let l=!1;u.queries.forEach((d,f)=>{for(const m of f.listeners)m.Q_(a)&&(l=!0)}),l&&qP(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Vde(n,e,t){return XP.apply(this,arguments)}function XP(){return XP=(0,Q.Z)(function*(n,e,t){const r=he(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new hn(fe.comparator);o=o.insert(s,vn.newNoDocument(s,Me.min()));const a=tt().add(s),u=new S_(Me.min(),new Map,new hn(Ge),o,a);yield _G(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),sN(r)}else yield Af(r.localStore,e,!1).then(()=>kf(r,e,t)).catch(Zu)}),XP.apply(this,arguments)}function Ude(n,e){return JP.apply(this,arguments)}function JP(){return JP=(0,Q.Z)(function*(n,e){const t=he(n),r=e.batch.batchId;try{const i=yield function nde(n,e){const t=he(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){const f=l.batch,m=f.keys();let _=V.resolve();return m.forEach(v=>{_=_.next(()=>d.getEntry(u,v)).next(T=>{const D=l.docVersions.get(v);Pe(null!==D),T.version.compareTo(D)<0&&(f.applyToRemoteDocument(T,l),T.isValidDocument()&&(T.setReadTime(l.commitVersion),d.addEntry(T)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=tt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);rN(t,r,null),nN(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Wa(t,i)}catch(i){yield Zu(i)}}),JP.apply(this,arguments)}function Bde(n,e,t){return eN.apply(this,arguments)}function eN(){return eN=(0,Q.Z)(function*(n,e,t){const r=he(n);try{const i=yield function(o,a){const u=he(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(f=>(Pe(null!==f),d=f.keys(),u.mutationQueue.removeMutationBatch(l,f))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);rN(r,e,t),nN(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Wa(r,i)}catch(i){yield Zu(i)}}),eN.apply(this,arguments)}function tN(){return tN=(0,Q.Z)(function*(n,e){const t=he(n);ul(t.remoteStore)||oe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=he(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=Nf(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),tN.apply(this,arguments)}function nN(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function rN(n,e,t){const r=he(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function kf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||vG(n,r)})}function vG(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&($_(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),sN(n))}function iN(n,e,t){for(const r of t)r instanceof pG?(n.wa.addReference(r.key,e),$de(n,r)):r instanceof gG?(oe("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||vG(n,r.key)):we()}function $de(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(oe("SyncEngine","New document in limbo: "+t),n.ga.add(r),sN(n))}function sN(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new fe(St.fromString(e)),r=n.Da.next();n.ya.set(r,new xde(t)),n.pa=n.pa.insert(t,r),aT(n.remoteStore,new Ga(Ri(ff(t.path)),r,"TargetPurposeLimboResolution",vs._e))}}function Wa(n,e,t){return oN.apply(this,arguments)}function oN(){return oN=(0,Q.Z)(function*(n,e,t){const r=he(n),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,t).then(l=>{if((l||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const d=cP.Qi(u.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,Q.Z)(function*(l,d){const f=he(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>V.forEach(d,_=>V.forEach(_.ki,v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>V.forEach(_.qi,v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!Qu(m))throw m;oe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const _=m.targetId;if(!m.fromCache){const v=f.ts.get(_),D=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);f.ts=f.ts.insert(_,D)}}}),function u(l,d){return a.apply(this,arguments)})(r.localStore,s))}),oN.apply(this,arguments)}function Hde(n,e){return aN.apply(this,arguments)}function aN(){return aN=(0,Q.Z)(function*(n,e){const t=he(n);if(!t.currentUser.isEqual(e)){oe("SyncEngine","User change. New user:",e.toKey());const r=yield Wz(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(a=>{a.forEach(u=>{u.reject(new ne(H.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Wa(t,r._s)}var s}),aN.apply(this,arguments)}function qde(n,e){const t=he(n),r=t.ya.get(e);if(r&&r.Ra)return tt().add(r.key);{let i=tt();const s=t.fa.get(e);if(!s)return i;for(const o of s){const a=t.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function zde(n,e){return uN.apply(this,arguments)}function uN(){return uN=(0,Q.Z)(function*(n,e){const t=he(n),r=yield nT(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&iN(t,e.targetId,i.Ta),i}),uN.apply(this,arguments)}function Gde(n,e){return lN.apply(this,arguments)}function lN(){return lN=(0,Q.Z)(function*(n,e){const t=he(n);return Yz(t.localStore,e).then(r=>Wa(t,r))}),lN.apply(this,arguments)}function Wde(n,e,t,r){return cN.apply(this,arguments)}function cN(){return cN=(0,Q.Z)(function*(n,e,t,r){const i=he(n),s=yield function(a,u){const l=he(a),d=he(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Cn(f,u).next(m=>m?l.localDocuments.getDocuments(f,m):V.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===t?yield Rf(i.remoteStore):"acknowledged"===t||"rejected"===t?(rN(i,e,r||null),nN(i,e),u=e,he(he(i.localStore).mutationQueue).Fn(u)):we(),yield Wa(i,s)):oe("SyncEngine","Cannot apply mutation batch with id: "+e)}),cN.apply(this,arguments)}function dN(){return dN=(0,Q.Z)(function*(n,e){const t=he(n);if(gN(t),mN(t),!0===e&&!0!==t.Ca){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield EG(t,r.toArray());t.Ca=!0,yield LP(t.remoteStore,!0);for(const s of i)aT(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const r=[];let i=Promise.resolve();t.fa.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(kf(t,o),Af(t.localStore,o,!0))),$_(t.remoteStore,o)}),yield i,yield EG(t,r),function(o){const a=he(o);a.ya.forEach((u,l)=>{$_(a.remoteStore,l)}),a.wa.Vr(),a.ya=new Map,a.pa=new hn(fe.comparator)}(t),t.Ca=!1,yield LP(t.remoteStore,!1)}}),dN.apply(this,arguments)}function EG(n,e,t){return hN.apply(this,arguments)}function hN(){return hN=(0,Q.Z)(function*(n,e,t){const r=he(n),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield Df(r.localStore,Ri(u[0]));for(const l of u){const d=r.ma.get(l),f=yield zde(r,d);f.snapshot&&s.push(f.snapshot)}}else{const l=yield Qz(r.localStore,o);a=yield Df(r.localStore,l),yield WP(r,IG(l),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),hN.apply(this,arguments)}function IG(n){return Dq(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Zde(n){return t=he(n).localStore,he(he(t).persistence).Bi();var t}function Qde(n,e,t,r){return fN.apply(this,arguments)}function fN(){return fN=(0,Q.Z)(function*(n,e,t,r){const i=he(n);if(i.Ca)return void oe("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield Yz(i.localStore,Pq(s[0])),a=S_.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Er.EMPTY_BYTE_STRING);yield Wa(i,o,a);break}case"rejected":yield Af(i.localStore,e,!0),kf(i,e,r);break;default:we()}}),fN.apply(this,arguments)}function Yde(n,e,t){return pN.apply(this,arguments)}function pN(){return pN=(0,Q.Z)(function*(n,e,t){const r=gN(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){oe("SyncEngine","Adding an already active target "+i);continue}const s=yield Qz(r.localStore,i),o=yield Df(r.localStore,s);yield WP(r,IG(s),o.targetId,!1,o.resumeToken),aT(r.remoteStore,o)}for(const i of t)r.fa.has(i)&&(yield Af(r.localStore,i,!1).then(()=>{$_(r.remoteStore,i),kf(r,i)}).catch(Zu))}}),pN.apply(this,arguments)}function gN(n){const e=he(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=_G.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qde.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vde.bind(null,e),e.Va.a_=Sde.bind(null,e.eventManager),e.Va.Fa=Rde.bind(null,e.eventManager),e}function mN(n){const e=he(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ude.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bde.bind(null,e),e}class H_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Q.Z)(function*(){t.serializer=B_(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Gz(this.persistence,new zz,e.initialUser,this.serializer)}createPersistence(e){return new oP(Jw.jr,this.serializer)}createSharedClientState(e){return new tG}terminate(){var e=this;return(0,Q.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class _N extends H_{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Q.Z)(function*(){yield t().call(r,e),yield r.xa.initialize(r,e),yield mN(r.xa.syncEngine),yield Rf(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return Gz(this.persistence,new zz,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new Fz(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new Cle(t,this.persistence);return new Tle(e.asyncQueue,r)}createPersistence(e){const t=lP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ai.withCacheSize(this.cacheSizeBytes):ai.DEFAULT;return new uP(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,rG(),oT(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new tG}}class wG extends _N{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Q.Z)(function*(){yield t().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof yP&&(r.sharedClientState.syncEngine={Ys:Wde.bind(null,i),Zs:Qde.bind(null,i),Xs:Yde.bind(null,i),Bi:Zde.bind(null,i),Js:Gde.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,Q.Z)(function*(o){yield function Kde(n,e){return dN.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=rG();if(!yP.D(t))throw new ne(H.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=lP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new yP(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Of{initialize(e,t){var r=this;return(0,Q.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>yG(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Hde.bind(null,r.syncEngine),yield LP(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Ade}createDatastore(e){const t=B_(e.databaseInfo.databaseId),r=new cde(e.databaseInfo);return new fde(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=t=>yG(this.syncEngine,t,0),a=nG.D()?new nG:new ade,new mde(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,t){return function(i,s,o,a,u,l,d){const f=new kde(i,s,o,a,u,l);return d&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Q.Z)(function*(r){const i=he(r);oe("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Sf(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function TG(n,e=10240){let t=0;return{read:()=>(0,Q.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Q.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class lT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):nr("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class ehe{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new vr,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,Q.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,Q.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,Q.Z)(function*(){const t=yield e.qa();if(null===t)return null;const r=e.La.decode(t),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Pde(JSON.parse(s),t.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,Q.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Ka(e){var t=this;return(0,Q.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const r=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,Q.Z)(function*(){const t=yield e.Ba.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class the{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Q.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new ne(H.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Q.Z)(function*(o,a){const u=he(o),l=N_(u.serializer)+"/documents",d={documents:a.map(v=>P_(u.serializer,v))},f=yield u.Co("BatchGetDocuments",l,d,a.length),m=new Map;f.forEach(v=>{const T=function wce(n,e){return"found"in e?function(r,i){Pe(!!i.found);const s=Yo(r,i.found.name),o=rr(i.found.updateTime),a=i.found.createTime?rr(i.found.createTime):Me.min(),u=new Gr({mapValue:{fields:i.found.fields}});return vn.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){Pe(!!i.missing),Pe(!!i.readTime);const s=Yo(r,i.missing),o=rr(i.readTime);return vn.newNoDocument(s,o)}(n,e):we()}(u.serializer,v);m.set(T.key.toString(),T)});const _=[];return a.forEach(v=>{const T=m.get(v.toString());Pe(!!T),_.push(T)}),_}),function s(o,a){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Q.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=fe.fromPath(i);e.mutations.push(new $R(s,e.precondition(s)))}),yield(r=(0,Q.Z)(function*(s,o){const a=he(s),u=N_(a.serializer)+"/documents",l={writes:o.map(d=>M_(a.serializer,d))};yield a.wo("Commit",u,l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we();t=Me.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ne(H.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Me.min())?Pn.exists(!1):Pn.updateTime(t):Pn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Me.min()))throw new ne(H.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Pn.updateTime(t)}return Pn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class nhe{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new EP(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,Q.Z)(function*(){const t=new the(e.datastore),r=e.za(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const t=this.updateFunction(e);return!f_(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Kq(t)}return!1}}class rhe{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Nr.UNAUTHENTICATED,this.clientId=qH.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,Q.Z)(function*(a){oe("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(oe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,Q.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ne(H.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Q.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Nf(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function cT(n,e){return yN.apply(this,arguments)}function yN(){return yN=(0,Q.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Q.Z)(function*(s){r.isEqual(s)||(yield Wz(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),yN.apply(this,arguments)}function vN(n,e){return EN.apply(this,arguments)}function EN(){return EN=(0,Q.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield IN(n);oe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>cG(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>cG(e.remoteStore,s)),n._onlineComponents=e}),EN.apply(this,arguments)}function CG(n){return"FirebaseError"===n.name?n.code===H.FAILED_PRECONDITION||n.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function IN(n){return wN.apply(this,arguments)}function wN(){return wN=(0,Q.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield cT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!CG(t))throw t;Ki("Error using user provided cache. Falling back to memory cache: "+t),yield cT(n,new H_)}}else oe("FirestoreClient","Using default OfflineComponentProvider"),yield cT(n,new H_);return n._offlineComponents}),wN.apply(this,arguments)}function dT(n){return TN.apply(this,arguments)}function TN(){return TN=(0,Q.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield vN(n,n._uninitializedComponentsProvider._online)):(oe("FirestoreClient","Using default OnlineComponentProvider"),yield vN(n,new Of))),n._onlineComponents}),TN.apply(this,arguments)}function bG(n){return IN(n).then(e=>e.persistence)}function Ff(n){return IN(n).then(e=>e.localStore)}function DG(n){return dT(n).then(e=>e.remoteStore)}function CN(n){return dT(n).then(e=>e.syncEngine)}function Lf(n){return bN.apply(this,arguments)}function bN(){return bN=(0,Q.Z)(function*(n){const e=yield dT(n),t=e.eventManager;return t.onListen=Ode.bind(null,e.syncEngine),t.onUnlisten=Fde.bind(null,e.syncEngine),t}),bN.apply(this,arguments)}function SG(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function(s,o,a,u,l){const d=new lT({next:m=>{o.enqueueAndForget(()=>$P(s,f));const _=m.docs.has(a);!_&&m.fromCache?l.reject(new ne(H.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&"server"===u.source?l.reject(new ne(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new zP(ff(a.path),d,{includeMetadataChanges:!0,J_:!0});return BP(s,f)}(yield Lf(n),n.asyncQueue,e,t,r)})),r.promise}function RG(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function(s,o,a,u,l){const d=new lT({next:m=>{o.enqueueAndForget(()=>$P(s,f)),m.fromCache&&"server"===u.source?l.reject(new ne(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new zP(a,d,{includeMetadataChanges:!0,J_:!0});return BP(s,f)}(yield Lf(n),n.asyncQueue,e,t,r)})),r.promise}function PG(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const NG=new Map;function DN(n,e,t){if(!t)throw new ne(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function MG(n,e,t,r){if(!0===e&&!0===r)throw new ne(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function xG(n){if(!fe.isDocumentKey(n))throw new ne(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function kG(n){if(fe.isDocumentKey(n))throw new ne(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function hT(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":we()}function _t(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=hT(n);throw new ne(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function OG(n,e){if(e<=0)throw new ne(H.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class FG{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new ne(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ne(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=PG(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class q_{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FG({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ne(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ne(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FG(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new dle;switch(r.type){case"firstParty":return new gle(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=NG.get(t);r&&(oe("ComponentProvider","Removing Datastore"),NG.delete(t),r.terminate())}(this),Promise.resolve()}}class Wr{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Wr(this.firestore,e,this._query)}}class En{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new En(this.firestore,e,this._key)}}class Xo extends Wr{constructor(e,t,r){super(e,t,ff(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new En(this.firestore,null,new fe(e))}withConverter(e){return new Xo(this.firestore,e,this._path)}}function VG(n,e,...t){if(n=(0,b.m9)(n),DN("collection","path",e),n instanceof q_){const r=St.fromString(e,...t);return kG(r),new Xo(n,null,r)}{if(!(n instanceof En||n instanceof Xo))throw new ne(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(St.fromString(e,...t));return kG(r),new Xo(n.firestore,null,r)}}function fT(n,e,...t){if(n=(0,b.m9)(n),1===arguments.length&&(e=qH.newId()),DN("doc","path",e),n instanceof q_){const r=St.fromString(e,...t);return xG(r),new En(n,null,new fe(r))}{if(!(n instanceof En||n instanceof Xo))throw new ne(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(St.fromString(e,...t));return xG(r),new En(n.firestore,n instanceof Xo?n.converter:null,new fe(r))}}function UG(n,e){return n=(0,b.m9)(n),e=(0,b.m9)(e),(n instanceof En||n instanceof Xo)&&(e instanceof En||e instanceof Xo)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function AN(n,e){return n=(0,b.m9)(n),e=(0,b.m9)(e),n instanceof Wr&&e instanceof Wr&&n.firestore===e.firestore&&I_(n._query,e._query)&&n.converter===e.converter}class ghe{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new EP(this,"async_queue_retry"),this.iu=()=>{const t=oT();t&&oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=oT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=oT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new vr;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,Q.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!Qu(t))throw t;oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,nr("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=UP.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&we()}verifyOperationInProgress(){}uu(){var e=this;return(0,Q.Z)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function SN(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class mhe{constructor(){this._progressObserver={},this._taskCompletionResolver=new vr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class fn extends q_{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ghe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||BG(this),this._firestoreClient.terminate()}}function Kn(n){return n._firestoreClient||BG(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function BG(n){var e,t,r;const i=n._freezeSettings(),s=(u=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new zle(n._databaseId,u,n._persistenceKey,(d=i).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,PG(d.experimentalLongPollingOptions),d.useFetchStreams));var u,d;n._firestoreClient=new rhe(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function jG(n,e,t){const r=new vr;return n.asyncQueue.enqueue((0,Q.Z)(function*(){try{yield cT(n,t),yield vN(n,e),r.resolve()}catch(i){const s=i;if(!CG(s))throw s;Ki("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function $G(n){if(n._initialized||n._terminated)throw new ne(H.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Jo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jo(Er.fromBase64String(e))}catch(t){throw new ne(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jo(Er.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ka{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new ne(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class kc{constructor(e){this._methodName=e}}class pT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}}const Ahe=/^__.*__$/;class She{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new za(e,this.data,this.fieldMask,t,this.fieldTransforms):new yf(e,this.data,t,this.fieldTransforms)}}class HG{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new za(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function qG(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class gT{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new gT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return yT(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(qG(this.Iu)&&Ahe.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Rhe{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||B_(e)}pu(e,t,r,i=!1){return new gT({Iu:e,methodName:t,gu:r,path:yn.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Oc(n){const e=n._freezeSettings(),t=B_(n._databaseId);return new Rhe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function mT(n,e,t,r,i,s={}){const o=n.pu(s.merge||s.mergeFields?2:0,e,t,i);MN("Data must be an object, but it was:",o,r);const a=WG(r,o);let u,l;if(s.merge)u=new Zi(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const m=W_(e,f,t);if(!o.contains(m))throw new ne(H.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);ZG(d,m)||d.push(m)}u=new Zi(d),l=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,l=o.fieldTransforms;return new She(new Gr(a),u,l)}class G_ extends kc{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof G_}}function zG(n,e,t){return new gT({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class RN extends kc{_toFieldTransform(e){return new b_(e.path,new mf)}isEqual(e){return e instanceof RN}}class Phe extends kc{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=zG(this,e,!0),r=this.yu.map(s=>Fc(s,t)),i=new bc(r);return new b_(e.path,i)}isEqual(e){return this===e}}class Nhe extends kc{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=zG(this,e,!0),r=this.yu.map(s=>Fc(s,t)),i=new Dc(r);return new b_(e.path,i)}isEqual(e){return this===e}}class Mhe extends kc{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new _f(e.serializer,Lq(e.serializer,this.wu));return new b_(e.path,t)}isEqual(e){return this===e}}function PN(n,e,t,r){const i=n.pu(1,e,t);MN("Data must be an object, but it was:",i,r);const s=[],o=Gr.empty();Yu(r,(u,l)=>{const d=_T(e,u,t);l=(0,b.m9)(l);const f=i.Ru(d);if(l instanceof G_)s.push(d);else{const m=Fc(l,f);null!=m&&(s.push(d),o.set(d,m))}});const a=new Zi(s);return new HG(o,a,i.fieldTransforms)}function NN(n,e,t,r,i,s){const o=n.pu(1,e,t),a=[W_(e,r,t)],u=[i];if(s.length%2!=0)throw new ne(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(W_(e,s[m])),u.push(s[m+1]);const l=[],d=Gr.empty();for(let m=a.length-1;m>=0;--m)if(!ZG(l,a[m])){const _=a[m];let v=u[m];v=(0,b.m9)(v);const T=o.Ru(_);if(v instanceof G_)l.push(_);else{const D=Fc(v,T);null!=D&&(l.push(_),d.set(_,D))}}const f=new Zi(l);return new HG(d,f,o.fieldTransforms)}function GG(n,e,t,r=!1){return Fc(t,n.pu(r?4:3,e))}function Fc(n,e){if(KG(n=(0,b.m9)(n)))return MN("Unsupported field value:",e,n),WG(n,e);if(n instanceof kc)return function(r,i){if(!qG(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=Fc(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,b.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return Lq(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Rn.fromDate(r);return{timestampValue:Ef(i.serializer,s)}}if(r instanceof Rn){const s=new Rn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ef(i.serializer,s)}}if(r instanceof pT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jo)return{bytesValue:iz(i.serializer,r._byteString)};if(r instanceof En){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:KR(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${hT(r)}`)}(n,e)}function WG(n,e){const t={};return sq(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yu(n,(r,i)=>{const s=Fc(i,e.Eu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function KG(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Rn||n instanceof pT||n instanceof Jo||n instanceof En||n instanceof kc)}function MN(n,e,t){if(!KG(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=hT(t);throw e.mu("an object"===r?n+" a custom object":n+" "+r)}var i}function W_(n,e,t){if((e=(0,b.m9)(e))instanceof Ka)return e._internalPath;if("string"==typeof e)return _T(n,e);throw yT("Field path arguments must be of type string or ",n,!1,void 0,t)}const xhe=new RegExp("[~\\*/\\[\\]]");function _T(n,e,t){if(e.search(xhe)>=0)throw yT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ka(...e.split("."))._internalPath}catch{throw yT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yT(n,e,t,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new ne(H.INVALID_ARGUMENT,a+n+u)}function ZG(n,e){return n.some(t=>t.isEqual(e))}class K_{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new En(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new khe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class khe extends K_{data(){return super.data()}}function vT(n,e){return"string"==typeof e?_T(n,e):e instanceof Ka?e._internalPath:e._delegate._internalPath}function QG(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new ne(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xN{}class Z_ extends xN{}function cl(n,e,...t){let r=[];e instanceof xN&&r.push(e),r=r.concat(t),function(s){const o=s.filter(u=>u instanceof Vf).length,a=s.filter(u=>u instanceof Q_).length;if(o>1||o>0&&a>0)throw new ne(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Q_ extends Z_{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Q_(e,t,r)}_apply(e){const t=this._parse(e);return e4(e._query,t),new Wr(e.firestore,e.converter,BR(e._query,t))}_parse(e){const t=Oc(e.firestore);return function(s,o,a,u,l,d,f){let m;if(l.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new ne(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if("in"===d||"not-in"===d){JG(f,d);const _=[];for(const v of f)_.push(XG(u,s,v));m={arrayValue:{values:_}}}else m=XG(u,s,f)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||JG(f,d),m=GG(a,"where",f,"in"===d||"not-in"===d);return Ct.create(l,d,m)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Vf extends xN{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vf(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:Wt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)e4(o,u),o=BR(o,u)}(e._query,t),new Wr(e.firestore,e.converter,BR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class kN extends Z_{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new kN(e,t)}_apply(e){const t=function(i,s,o){if(null!==i.startAt)throw new ne(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new ne(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new v_(s,o)}(e._query,this._field,this._direction);return new Wr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ha(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class ET extends Z_{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ET(e,t,r)}_apply(e){return new Wr(e.firestore,e.converter,Bw(e._query,this._limit,this._limitType))}}class IT extends Z_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new IT(e,t,r)}_apply(e){const t=YG(e,this.type,this._docOrFields,this._inclusive);return new Wr(e.firestore,e.converter,(s=t,new Ha((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class wT extends Z_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new wT(e,t,r)}_apply(e){const t=YG(e,this.type,this._docOrFields,this._inclusive);return new Wr(e.firestore,e.converter,(s=t,new Ha((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function YG(n,e,t,r){if(t[0]=(0,b.m9)(t[0]),t[0]instanceof K_)return function(s,o,a,u,l){if(!u)throw new ne(H.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of pf(s))if(f.field.isKeyField())d.push(Tc(o,u.key));else{const m=u.data.field(f.field);if(xw(m))throw new ne(H.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const _=f.field.canonicalString();throw new ne(H.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new rl(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Oc(n.firestore);return function(o,a,u,l,d,f){const m=o.explicitOrderBy;if(d.length>m.length)throw new ne(H.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let v=0;v<d.length;v++){const T=d[v];if(m[v].field.isKeyField()){if("string"!=typeof T)throw new ne(H.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof T}`);if(!UR(o)&&-1!==T.indexOf("/"))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${T}' contains a slash.`);const D=o.path.child(St.fromString(T));if(!fe.isDocumentKey(D))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const k=new fe(D);_.push(Tc(a,k))}else{const D=GG(u,l,T);_.push(D)}}return new rl(_,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function XG(n,e,t){if("string"==typeof(t=(0,b.m9)(t))){if(""===t)throw new ne(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!UR(e)&&-1!==t.indexOf("/"))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(St.fromString(t));if(!fe.isDocumentKey(r))throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tc(n,new fe(r))}if(t instanceof En)return Tc(n,t._key);throw new ne(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hT(t)}.`)}function JG(n,e){if(!Array.isArray(n)||0===n.length)throw new ne(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function e4(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new ne(H.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class ON{convertValue(e,t="none"){switch(tl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($a(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Yu(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new pT(Wn(e.latitude),Wn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=kw(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(g_(e));default:return null}}convertTimestamp(e){const t=Xu(e);return new Rn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=St.fromString(e);Pe(pz(r));const i=new Ju(r.get(1),r.get(3)),s=new fe(r.popFirst(5));return i.isEqual(t)||nr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function TT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Hhe extends ON{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,t)}}class Lc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Za extends K_{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Y_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(vT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Y_ extends Za{data(e={}){return super.data(e)}}class dl{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Lc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Y_(this._firestore,this._userDataWriter,r.key,r,new Lc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new Y_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new Y_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,d=-1;return 0!==a.type&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:zhe(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function zhe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}function n4(n,e){return n instanceof Za&&e instanceof Za?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof dl&&e instanceof dl&&n._firestore===e._firestore&&AN(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class hl extends ON{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,t)}}function r4(n,e,t){n=_t(n,En);const r=_t(n.firestore,fn),i=TT(n.converter,e,t);return Uf(r,[mT(Oc(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Pn.none())])}function i4(n,e,t,...r){n=_t(n,En);const i=_t(n.firestore,fn),s=Oc(i);let o;return o="string"==typeof(e=(0,b.m9)(e))||e instanceof Ka?NN(s,"updateDoc",n._key,e,t,r):PN(s,"updateDoc",n._key,e),Uf(i,[o.toMutation(n._key,Pn.exists(!0))])}function s4(n,...e){var t,r,i;n=(0,b.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||SN(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(SN(e[o])){const f=e[o];e[o]=null===(t=f.next)||void 0===t?void 0:t.bind(f),e[o+1]=null===(r=f.error)||void 0===r?void 0:r.bind(f),e[o+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}let u,l,d;if(n instanceof En)l=_t(n.firestore,fn),d=ff(n._key.path),u={next:f=>{e[o]&&e[o](FN(l,n,f))},error:e[o+1],complete:e[o+2]};else{const f=_t(n,Wr);l=_t(f.firestore,fn),d=f._query;const m=new hl(l);u={next:_=>{e[o]&&e[o](new dl(l,m,f,_))},error:e[o+1],complete:e[o+2]},QG(n._query)}return function(m,_,v,T){const D=new lT(T),k=new zP(_,D,v);return m.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return BP(yield Lf(m),k)})),()=>{D.Na(),m.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return $P(yield Lf(m),k)}))}}(Kn(l),d,a,u)}function Uf(n,e){return function(r,i){const s=new vr;return r.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function Lde(n,e,t){return QP.apply(this,arguments)}(yield CN(r),i,s)})),s.promise}(Kn(n),e)}function FN(n,e,t){const r=t.docs.get(e._key),i=new hl(n);return new Za(n,i,e._key,r,new Lc(t.hasPendingWrites,t.fromCache),e.converter)}const lfe={maxAttempts:5};class o4{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Oc(e)}set(e,t,r){this._verifyNotCommitted();const i=fl(e,this._firestore),s=TT(i.converter,t,r),o=mT(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Pn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=fl(e,this._firestore);let o;return o="string"==typeof(t=(0,b.m9)(t))||t instanceof Ka?NN(this._dataReader,"WriteBatch.update",s._key,t,r,i):PN(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Pn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=fl(e,this._firestore);return this._mutations=this._mutations.concat(new vf(t._key,Pn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ne(H.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fl(n,e){if((n=(0,b.m9)(n)).firestore!==e)throw new ne(H.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class cfe extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Oc(t)}get(t){const r=fl(t,this._firestore),i=new Hhe(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return we();const o=s[0];if(o.isFoundDocument())return new K_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new K_(this._firestore,i,r._key,null,r.converter);throw we()})}set(t,r,i){const s=fl(t,this._firestore),o=TT(s.converter,r,i),a=mT(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=fl(t,this._firestore);let a;return a="string"==typeof(r=(0,b.m9)(r))||r instanceof Ka?NN(this._dataReader,"Transaction.update",o._key,r,i,s):PN(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=fl(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=fl(e,this._firestore),r=new hl(this._firestore);return super.get(e).then(i=>new Za(this._firestore,r,t._key,i._document,new Lc(!1,!1),t.converter))}}function VN(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ne("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function c4(){if(typeof Uint8Array>"u")throw new ne("unimplemented","Uint8Arrays are not available in this environment.")}function d4(){if(!function Hle(){return typeof atob<"u"}())throw new ne("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){rf=zi.SDK_VERSION,(0,zi._registerComponent)(new lo.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new fn(new fle(r.getProvider("auth-internal")),new mle(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new ne(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ju(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,zi.registerVersion)(jH,"4.3.2",e),(0,zi.registerVersion)(jH,"4.3.2","esm2017")}();class X_{constructor(e){this._delegate=e}static fromBase64String(e){return d4(),new X_(Jo.fromBase64String(e))}static fromUint8Array(e){return c4(),new X_(Jo.fromUint8Array(e))}toBase64(){return d4(),this._delegate.toBase64()}toUint8Array(){return c4(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function UN(n){return function Efe(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class Ife{enableIndexedDbPersistence(e,t){return function yhe(n,e){$G(n=_t(n,fn));const t=Kn(n);if(t._uninitializedComponentsProvider)throw new ne(H.FAILED_PRECONDITION,"SDK cache is already specified.");Ki("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Of;return jG(t,i,new _N(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function vhe(n){$G(n=_t(n,fn));const e=Kn(n);if(e._uninitializedComponentsProvider)throw new ne(H.FAILED_PRECONDITION,"SDK cache is already specified.");Ki("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Of;return jG(e,r,new wG(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Ehe(n){if(n._initialized&&!n._terminated)throw new ne(H.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new vr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Q.Z)(function*(){try{yield(t=(0,Q.Z)(function*(i){if(!_o.D())return Promise.resolve();const s=i+"main";yield _o.delete(s)}),function r(i){return t.apply(this,arguments)})(lP(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class h4{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ju||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ki("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function LG(n,e,t,r={}){var i;const s=(n=_t(n,q_))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ki("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=Nr.MOCK_USER;else{a=(0,b.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new ne(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Nr(l)}n._authCredentials=new hle(new $H(a,u))}}(this._delegate,e,t,r)}enableNetwork(){return function whe(n){return function ihe(n){return n.asyncQueue.enqueue((0,Q.Z)(function*(){const e=yield bG(n),t=yield DG(n);return e.setNetworkEnabled(!0),function(i){const s=he(i);return s.C_.delete(0),j_(s)}(t)}))}(Kn(n=_t(n,fn)))}(this._delegate)}disableNetwork(){return function The(n){return function she(n){return n.asyncQueue.enqueue((0,Q.Z)(function*(){const e=yield bG(n),t=yield DG(n);return e.setNetworkEnabled(!1),(r=(0,Q.Z)(function*(s){const o=he(s);o.C_.add(0),yield Sf(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(Kn(n=_t(n,fn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,MG("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Ihe(n){return function(t){const r=new vr;return t.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return function jde(n,e){return tN.apply(this,arguments)}(yield CN(t),r)})),r.promise}(Kn(n=_t(n,fn)))}(this._delegate)}onSnapshotsInSync(e){return function efe(n,e){return function uhe(n,e){const t=new lT(e);return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return i=yield Lf(n),s=t,he(i).q_.add(s),void s.next();var i,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return i=yield Lf(n),s=t,void he(i).q_.delete(s);var i,s}))}}(Kn(n=_t(n,fn)),SN(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new ne("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Bf(this,VG(this._delegate,e))}catch(t){throw Pi(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ks(this,fT(this._delegate,e))}catch(t){throw Pi(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ni(this,function phe(n,e){if(n=_t(n,q_),DN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ne(H.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Wr(n,null,(r=e,new Ha(St.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw Pi(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function dfe(n,e,t){n=_t(n,fn);const r=Object.assign(Object.assign({},lfe),t);return function(s){if(s.maxAttempts<1)throw new ne(H.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new vr;return s.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){const l=yield function AG(n){return dT(n).then(e=>e.datastore)}(s);new nhe(s.asyncQueue,l,a,o,u).run()})),u.promise}(Kn(n),i=>e(new cfe(n,i)),r)}(this._delegate,t=>e(new f4(this,t)))}batch(){return Kn(this._delegate),new p4(new o4(this._delegate,e=>Uf(this._delegate,e)))}loadBundle(e){return function Che(n,e){const t=Kn(n=_t(n,fn)),r=new mhe;return function lhe(n,e,t,r){const i=function(o,a){let u;return u="string"==typeof o?Qq().encode(o):o,d=function(d,f){if(d instanceof Uint8Array)return TG(d,f);if(d instanceof ArrayBuffer)return TG(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new ehe(d,a);var d}(t,B_(e));n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){!function Xde(n,e,t){const r=he(n);var i;(i=(0,Q.Z)(function*(o,a,u){try{const l=yield a.getMetadata();if(yield function(v,T){const D=he(v),k=rr(T.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",P=>D.Kr.getBundleMetadata(P,T.id)).then(P=>!!P&&P.createTime.compareTo(k)>=0)}(o.localStore,l))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(v=l).totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}),Promise.resolve(new Set);u._updateProgress(fG(l));const d=new Nde(l,o.localStore,a.serializer);let f=yield a.Ma();for(;f;){const _=yield d.ea(f);_&&u._updateProgress(_),f=yield a.Ma()}const m=yield d.complete();return yield Wa(o,m.ra,void 0),yield function(v,T){const D=he(v);return D.persistence.runTransaction("Save bundle","readwrite",k=>D.Kr.saveBundleMetadata(k,T))}(o.localStore,l),u._completeWith(m.progress),Promise.resolve(m.na)}catch(l){return Ki("SyncEngine",`Loading bundle failed with ${l}`),u._failWith(l),Promise.resolve(new Set)}var v}),function s(o,a,u){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield CN(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function bhe(n,e){return function che(n,e){return n.asyncQueue.enqueue((0,Q.Z)(function*(){return function(r,i){const s=he(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Ff(n),e)}))}(Kn(n=_t(n,fn)),e).then(t=>t?new Wr(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ni(this,t):null)}}class bT extends ON{constructor(e){super(),this.firestore=e}convertBytes(e){return new X_(new Jo(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ks.forKey(t,this.firestore,null)}}class f4{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new bT(e)}get(e){const t=Uc(e);return this._delegate.get(t).then(r=>new J_(this._firestore,new Za(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Uc(e);return r?(VN("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Uc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Uc(e);return this._delegate.delete(t),this}}class p4{constructor(e){this._delegate=e}set(e,t,r){const i=Uc(e);return r?(VN("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Uc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Uc(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Vc{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Y_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ey(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Vc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Vc(e,new bT(e),t),i.set(t,s)),s}}Vc.INSTANCES=new WeakMap;class Ks{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new bT(e)}static forPath(e,t,r){if(e.length%2!=0)throw new ne("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ks(t,new En(t._delegate,r,new fe(e)))}static forKey(e,t,r){return new Ks(t,new En(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Bf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Bf(this.firestore,VG(this._delegate,e))}catch(t){throw Pi(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,b.m9)(e))instanceof En&&UG(this._delegate,e)}set(e,t){t=VN("DocumentReference.set",t);try{return t?r4(this._delegate,e,t):r4(this._delegate,e)}catch(r){throw Pi(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?i4(this._delegate,e):i4(this._delegate,e,t,...r)}catch(i){throw Pi(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Xhe(n){return Uf(_t(n.firestore,fn),[new vf(n._key,Pn.none())])}(this._delegate)}onSnapshot(...e){const t=g4(e),r=m4(e,i=>new J_(this.firestore,new Za(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return s4(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function Whe(n){n=_t(n,En);const e=_t(n.firestore,fn),t=Kn(e),r=new hl(e);return function ohe(n,e){const t=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return(r=(0,Q.Z)(function*(s,o,a){try{const u=yield function(d,f){const m=he(d);return m.persistence.runTransaction("read document","readonly",_=>m.localDocuments.getDocument(_,f))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new ne(H.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const l=Nf(u,`Failed to get document '${o} from cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Ff(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Za(e,r,n._key,i,new Lc(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Khe(n){n=_t(n,En);const e=_t(n.firestore,fn);return SG(Kn(e),n._key,{source:"server"}).then(t=>FN(e,n,t))}(this._delegate):function Ghe(n){n=_t(n,En);const e=_t(n.firestore,fn);return SG(Kn(e),n._key).then(t=>FN(e,n,t))}(this._delegate),t.then(r=>new J_(this.firestore,new Za(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Ks(this.firestore,this._delegate.withConverter(e?Vc.getInstance(this.firestore,e):null))}}function Pi(n,e,t){return n.message=n.message.replace(e,t),n}function g4(n){for(const e of n)if("object"==typeof e&&!UN(e))return e;return{}}function m4(n,e){var t,r;let i;return i=UN(n[0])?n[0]:UN(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class J_{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ks(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return n4(this._delegate,e._delegate)}}class ey extends J_{data(e){const t=this._delegate.data(e);return this._delegate._converter||function cle(n,e){n||we()}(void 0!==t),t}}class Ni{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new bT(e)}where(e,t,r){try{return new Ni(this.firestore,cl(this._delegate,function Ohe(n,e,t){const r=e,i=vT("where",n);return Q_._create(i,r,t)}(e,t,r)))}catch(i){throw Pi(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ni(this.firestore,cl(this._delegate,function Fhe(n,e="asc"){const t=e,r=vT("orderBy",n);return kN._create(r,t)}(e,t)))}catch(r){throw Pi(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ni(this.firestore,cl(this._delegate,function Lhe(n){return OG("limit",n),ET._create("limit",n,"F")}(e)))}catch(t){throw Pi(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ni(this.firestore,cl(this._delegate,function Vhe(n){return OG("limitToLast",n),ET._create("limitToLast",n,"L")}(e)))}catch(t){throw Pi(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ni(this.firestore,cl(this._delegate,function Uhe(...n){return IT._create("startAt",n,!0)}(...e)))}catch(t){throw Pi(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ni(this.firestore,cl(this._delegate,function Bhe(...n){return IT._create("startAfter",n,!1)}(...e)))}catch(t){throw Pi(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ni(this.firestore,cl(this._delegate,function jhe(...n){return wT._create("endBefore",n,!1)}(...e)))}catch(t){throw Pi(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ni(this.firestore,cl(this._delegate,function $he(...n){return wT._create("endAt",n,!0)}(...e)))}catch(t){throw Pi(t,"endAt()","Query.endAt()")}}isEqual(e){return AN(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Qhe(n){n=_t(n,Wr);const e=_t(n.firestore,fn),t=Kn(e),r=new hl(e);return function ahe(n,e){const t=new vr;return n.asyncQueue.enqueueAndForget((0,Q.Z)(function*(){return(r=(0,Q.Z)(function*(s,o,a){try{const u=yield nT(s,o,!0),l=new mG(o,u.ls),d=l.ca(u.documents),f=l.applyChanges(d,!1);a.resolve(f.snapshot)}catch(u){const l=Nf(u,`Failed to execute query '${o} against cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Ff(n),e,t);var r})),t.promise}(t,n._query).then(i=>new dl(e,r,n,i))}(this._delegate):"server"===e?.source?function Yhe(n){n=_t(n,Wr);const e=_t(n.firestore,fn),t=Kn(e),r=new hl(e);return RG(t,n._query,{source:"server"}).then(i=>new dl(e,r,n,i))}(this._delegate):function Zhe(n){n=_t(n,Wr);const e=_t(n.firestore,fn),t=Kn(e),r=new hl(e);return QG(n._query),RG(t,n._query).then(i=>new dl(e,r,n,i))}(this._delegate),t.then(r=>new BN(this.firestore,new dl(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=g4(e),r=m4(e,i=>new BN(this.firestore,new dl(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return s4(this._delegate,t,r)}withConverter(e){return new Ni(this.firestore,this._delegate.withConverter(e?Vc.getInstance(this.firestore,e):null))}}class Tfe{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ey(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class BN{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ni(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ey(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Tfe(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ey(this._firestore,r))})}isEqual(e){return n4(this._delegate,e._delegate)}}class Bf extends Ni{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ks(this.firestore,e):null}doc(e){try{return new Ks(this.firestore,void 0===e?fT(this._delegate):fT(this._delegate,e))}catch(t){throw Pi(t,"doc()","CollectionReference.doc()")}}add(e){return function Jhe(n,e){const t=_t(n.firestore,fn),r=fT(n),i=TT(n.converter,e);return Uf(t,[mT(Oc(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Pn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Ks(this.firestore,t))}isEqual(e){return UG(this._delegate,e._delegate)}withConverter(e){return new Bf(this.firestore,this._delegate.withConverter(e?Vc.getInstance(this.firestore,e):null))}}function Uc(n){return _t(n,En)}class jN{constructor(...e){this._delegate=new Ka(...e)}static documentId(){return new jN(yn.keyField().canonicalString())}isEqual(e){return(e=(0,b.m9)(e))instanceof Ka&&this._delegate._internalPath.isEqual(e._internalPath)}}class Bc{constructor(e){this._delegate=e}static serverTimestamp(){const e=function ffe(){return new RN("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Bc(e)}static delete(){const e=function hfe(){return new G_("deleteField")}();return e._methodName="FieldValue.delete",new Bc(e)}static arrayUnion(...e){const t=function pfe(...n){return new Phe("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Bc(t)}static arrayRemove(...e){const t=function gfe(...n){return new Nhe("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Bc(t)}static increment(e){const t=function mfe(n){return new Mhe("increment",n)}(e);return t._methodName="FieldValue.increment",new Bc(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Cfe={Firestore:h4,GeoPoint:pT,Timestamp:Rn,Blob:X_,Transaction:f4,WriteBatch:p4,DocumentReference:Ks,DocumentSnapshot:J_,Query:Ni,QueryDocumentSnapshot:ey,QuerySnapshot:BN,CollectionReference:Bf,FieldPath:jN,FieldValue:Bc,setLogLevel:function wfe(n){!function lle(n){Ku.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function _4(n,e){return function Afe(n,e=hI){return new Ze(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function $N(n,e){return _4(n,e).pipe(de(t=>({payload:t,type:"query"})))}!function Dfe(n){(function bfe(n,e){n.INTERNAL.registerComponent(new lo.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Cfe)))})(n,(e,t)=>new h4(e,t,new Ife)),n.registerVersion("@firebase/firestore-compat","0.3.22")}(ps.Z);class y4{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=C4(r,t);return new I4(i,s,this.afs)}snapshotChanges(){return function Sfe(n,e){return _4(n,e).pipe(WE(void 0),VS(),de(t=>{const[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return this.snapshotChanges().pipe(de(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return I(this.ref.get(e)).pipe(tr)}}function DT(n,e){return $N(n,e).pipe(WE(void 0),VS(),de(t=>{const[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const l=s.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function v4(n,e,t){return DT(n,t).pipe(Ih((r,i)=>function Rfe(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function Pfe(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return HN(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return HN(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return HN(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),Fe(),de(r=>r.map(i=>({type:i.type,payload:i}))))}function HN(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function E4(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class I4{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=DT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(de(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(WE(void 0),VS(),$s(([r,i])=>i.length>0||!r),de(([,r])=>r),tr)}auditTrail(e){return this.stateChanges(e).pipe(Ih((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=E4(e);return v4(this.query,t,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return $N(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),tr)}get(e){return I(this.query.get(e)).pipe(tr)}add(e){return this.ref.add(e)}doc(e){return new y4(this.ref.doc(e),this.afs)}}class Nfe{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?DT(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.filter(r=>e.indexOf(r.type)>-1)),$s(t=>t.length>0),tr):DT(this.query,this.afs.schedulers.outsideAngular).pipe(tr)}auditTrail(e){return this.stateChanges(e).pipe(Ih((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=E4(e);return v4(this.query,t,this.afs.schedulers.outsideAngular).pipe(tr)}valueChanges(e={}){return $N(this.query,this.afs.schedulers.outsideAngular).pipe(de(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),tr)}get(e){return I(this.query.get(e)).pipe(tr)}}const w4=new le("angularfire2.enableFirestorePersistence"),T4=new le("angularfire2.firestore.persistenceSettings"),Mfe=new le("angularfire2.firestore.settings"),xfe=new le("angularfire2.firestore.use-emulator");function C4(n,e=(t=>t)){return{query:e(n),ref:n}}let kfe=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,u,l,d,f,m,_,v,T,D,k,P){this.schedulers=u;const O=lm(t,a,r),q=d;f&&EA(O,a,m,v,T,D,_,k),[this.firestore,this.persistenceEnabled$]=gI(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{const ue=a.runOutsideAngular(()=>O.firestore());if(s&&ue.settings(s),q&&ue.useEmulator(...q),i&&!NE(o)){const Te=()=>{try{return I(ue.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Ue){return typeof console<"u"&&console.warn(Ue),R(!1)}};return[ue,a.runOutsideAngular(Te)]}return[ue,R(!1)]},[s,q,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=C4(i,r),a=this.schedulers.ngZone.run(()=>s);return new I4(a,o,this)}collectionGroup(t,r){const i=r||(o=>o),s=this.firestore.collectionGroup(t);return new Nfe(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new y4(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(W(kh),W(Oh,8),W(w4,8),W(Mfe,8),W(Vs),W(Tt),W(pI),W(T4,8),W(xfe,8),W(nc,8),W(pA,8),W(gA,8),W(mA,8),W(_A,8),W(yA,8),W(vA,8),W(fI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Ofe=(()=>{class n{constructor(){ps.Z.registerVersion("angularfire",Nh.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:w4,useValue:!0},{provide:T4,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({providers:[kfe]})}return n})();const b4="firebasestorage.googleapis.com",D4="storageBucket";class Vn extends b.ZR{constructor(e,t,r=0){super(qN(e),`Firebase Storage: ${t} (${qN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Vn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Nn=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Nn||{});function qN(n){return"storage/"+n}function zN(){return new Vn(Nn.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function A4(){return new Vn(Nn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function S4(){return new Vn(Nn.CANCELED,"User canceled the upload/download.")}function R4(){return new Vn(Nn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jf(n){return new Vn(Nn.INVALID_ARGUMENT,n)}function P4(){return new Vn(Nn.APP_DELETED,"The Firebase app was deleted.")}function N4(n){return new Vn(Nn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ty(n,e){return new Vn(Nn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ny(n){throw new Vn(Nn.INTERNAL_ERROR,"Internal error: "+n)}class li{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=li.makeFromUrl(e,t)}catch{return new li(e,"")}if(""===r.path)return r;throw function Gfe(n){return new Vn(Nn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function l(q){q.path_=decodeURIComponent(q.path)}const f=t.replace(/[.]/g,"\\."),O=[{regex:a,indices:{bucket:1,path:3},postModify:function s(q){"/"===q.path.charAt(q.path.length-1)&&(q.path_=q.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${f}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp(`^https?://${t===b4?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:l}];for(let q=0;q<O.length;q++){const ue=O[q],Te=ue.regex.exec(e);if(Te){let Pt=Te[ue.indices.path];Pt||(Pt=""),r=new li(Te[ue.indices.bucket],Pt),ue.postModify(r);break}}if(null==r)throw function zfe(n){return new Vn(Nn.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return r}}class Yfe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function AT(n){return"string"==typeof n||n instanceof String}function M4(n){return GN()&&n instanceof Blob}function GN(){return typeof Blob<"u"&&!(0,b.UG)()}function WN(n,e,t,r){if(r<e)throw jf(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw jf(`Invalid value for '${n}'. Expected ${t} or less.`)}function Qa(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function x4(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var $f=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}($f||{});function k4(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),s=-1!==e.indexOf(n);return t||i||s}class rpe{constructor(e,t,r,i,s,o,a,u,l,d,f,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,v)=>{this.resolve_=_,this.reject_=v,this.start_()})}start_(){const t=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function epe(n){return void 0!==n}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=zN();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?P4():S4():A4())};this.canceled_?t(0,new ST(!1,null,!0)):this.backoffId_=function Xfe(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function d(...D){l||(l=!0,e.apply(null,D))}function f(D){i=setTimeout(()=>{i=null,n(_,u())},D)}function m(){s&&clearTimeout(s)}function _(D,...k){if(l)return void m();if(D)return m(),void d.call(null,D,...k);if(u()||o)return m(),void d.call(null,D,...k);let O;r<64&&(r*=2),1===a?(a=2,O=0):O=1e3*(r+Math.random()),f(O)}let v=!1;function T(D){v||(v=!0,m(),!l&&(null!==i?(D||(a=2),clearTimeout(i),f(0)):D||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}((r,i)=>{if(i)return void r(!1,new ST(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===$f.NO_ERROR,u=s.getStatus();if(!a||k4(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===$f.ABORT;return void r(!1,new ST(!1,null,d))}const l=-1!==this.successCodes_.indexOf(u);r(!0,new ST(l,s))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function Jfe(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ST{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function cpe(...n){const e=function lpe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(GN())return new Blob(n);throw new Vn(Nn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Es={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class KN{constructor(e,t){this.data=e,this.contentType=t||null}}function ZN(n,e){switch(n){case Es.RAW:return new KN(O4(e));case Es.BASE64:case Es.BASE64URL:return new KN(F4(n,e));case Es.DATA_URL:return new KN(function ppe(n){const e=new L4(n);return e.base64?F4(Es.BASE64,e.rest):function fpe(n){let e;try{e=decodeURIComponent(n)}catch{throw ty(Es.DATA_URL,"Malformed data URL.")}return O4(e)}(e.rest)}(e),function gpe(n){return new L4(n).contentType}(e))}throw zN()}function O4(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function F4(n,e){switch(n){case Es.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw ty(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Es.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw ty(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function hpe(n){if(typeof atob>"u")throw function Qfe(n){return new Vn(Nn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:ty(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class L4{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw ty(Es.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function mpe(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class ea{constructor(e,t){let r=0,i="";M4(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(M4(this.data_)){const i=function dpe(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new ea(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new ea(r,!0)}}static getBlob(...e){if(GN()){const t=e.map(r=>r instanceof ea?r.data_:r);return new ea(cpe.apply(null,t))}{const t=e.map(o=>AT(o)?ZN(Es.RAW,o).data:o.data_);let r=0;t.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new ea(i,!0)}}uploadData(){return this.data_}}function QN(n){let e;try{e=JSON.parse(n)}catch{return null}return function npe(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function V4(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function vpe(n,e){return e}class Mi{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||vpe}}let RT=null;function ry(){if(RT)return RT;const n=[];n.push(new Mi("bucket")),n.push(new Mi("generation")),n.push(new Mi("metageneration")),n.push(new Mi("name","fullPath",!0));const t=new Mi("name");t.xform=function e(s,o){return function Epe(n){return!AT(n)||n.length<2?n:V4(n)}(o)},n.push(t);const i=new Mi("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},n.push(i),n.push(new Mi("timeCreated")),n.push(new Mi("updated")),n.push(new Mi("md5Hash",null,!0)),n.push(new Mi("cacheControl",null,!0)),n.push(new Mi("contentDisposition",null,!0)),n.push(new Mi("contentEncoding",null,!0)),n.push(new Mi("contentLanguage",null,!0)),n.push(new Mi("contentType",null,!0)),n.push(new Mi("metadata","customMetadata",!0)),RT=n,RT}function U4(n,e,t){const r=QN(e);return null===r?null:function wpe(n,e,t){const r={type:"file"},i=t.length;for(let s=0;s<i;s++){const o=t[s];r[o.local]=o.xform(r,e[o.server])}return function Ipe(n,e){Object.defineProperty(n,"ref",{get:function t(){const s=new li(n.bucket,n.fullPath);return e._makeStorageReference(s)}})}(r,n),r}(n,r,t)}function YN(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}const B4="prefixes",j4="items";class ta{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function na(n){if(!n)throw zN()}function PT(n,e){return function t(r,i){const s=U4(n,i,e);return na(null!==s),s}}function Hf(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function Hfe(){return new Vn(Nn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function $fe(){return new Vn(Nn.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function jfe(n){return new Vn(Nn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function qfe(n){return new Vn(Nn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function iy(n){const e=Hf(n);return function t(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function Bfe(n){return new Vn(Nn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),s.serverResponse=i.serverResponse,s}}function $4(n,e,t){const i=Qa(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new ta(i,"GET",PT(n,t),o);return a.errorHandler=iy(e),a}function Spe(n,e,t,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=Qa(e.bucketOnlyServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new ta(a,"GET",function Dpe(n,e){return function t(r,i){const s=function bpe(n,e,t){const r=QN(t);return null===r?null:function Cpe(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[B4])for(const i of t[B4]){const s=i.replace(/\/$/,""),o=n._makeStorageReference(new li(e,s));r.prefixes.push(o)}if(t[j4])for(const i of t[j4]){const s=n._makeStorageReference(new li(e,i.name));r.items.push(s)}return r}(n,e,r)}(n,e,i);return na(null!==s),s}}(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Hf(e),d}function q4(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function Mpe(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class NT{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function XN(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{na(!1)}return na(!!t&&-1!==(e||["active"]).indexOf(t)),t}const Fpe={STATE_CHANGED:"state_changed"},xi={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function JN(n){switch(n){case"running":case"pausing":case"canceling":return xi.RUNNING;case"paused":return xi.PAUSED;case"success":return xi.SUCCESS;case"canceled":return xi.CANCELED;default:return xi.ERROR}}class Lpe{constructor(e,t,r){if(function tpe(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function qf(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let W4=null;class Vpe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$f.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$f.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$f.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw ny("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ny("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ny("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ny("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ny("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Upe extends Vpe{initXhr(){this.xhr_.responseType="text"}}function yo(){return W4?W4():new Upe}class K4{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=ry(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Nn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(k4(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=A4()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Nn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function xpe(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),o=q4(e,r,i),a={name:o.fullPath},u=Qa(s,n.host,n._protocol),d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=YN(o,t),v=new ta(u,"POST",function _(T){let D;XN(T);try{D=T.getResponseHeader("X-Goog-Upload-URL")}catch{na(!1)}return na(AT(D)),D},n.maxUploadRetryTime);return v.urlParams=a,v.headers=d,v.body=f,v.errorHandler=Hf(e),v}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,yo,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function kpe(n,e,t,r){const u=new ta(t,"POST",function s(l){const d=XN(l,["active","final"]);let f=null;try{f=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{na(!1)}f||na(!1);const m=Number(f);return na(!isNaN(m)),new NT(m,r.size(),"final"===d)},n.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=Hf(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,yo,t,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new NT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function Ope(n,e,t,r,i,s,o,a){const u=new NT(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function Kfe(){return new Vn(Nn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const l=u.total-u.current;let d=l;i>0&&(d=Math.min(d,i));const f=u.current;let _="";_=0===d?"finalize":l===d?"upload, finalize":"upload";const v={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${u.current}`},T=r.slice(f,f+d);if(null===T)throw R4();const O=new ta(t,"POST",function D(q,ue){const Te=XN(q,["active","final"]),Ue=u.current+d,Pt=r.size();let Ir;return Ir="final"===Te?PT(e,s)(q,ue):null,new NT(Ue,Pt,"final"===Te,Ir)},e.maxUploadRetryTime);return O.headers=v,O.body=T.uploadData(),O.progressCallback=a||null,O.errorHandler=Hf(n),O}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,yo,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=$4(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,yo,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function z4(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let O="";for(let q=0;q<2;q++)O+=Math.random().toString().slice(2);return O}();o["Content-Type"]="multipart/related; boundary="+u;const l=q4(e,r,i),d=YN(l,t),_=ea.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+d+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===_)throw R4();const v={name:l.fullPath},T=Qa(s,n.host,n._protocol),k=n.maxUploadRetryTime,P=new ta(T,"POST",PT(n,t),k);return P.urlParams=v,P.headers=o,P.body=_.uploadData(),P.errorHandler=Hf(e),P}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,yo,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=S4(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=JN(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const s=new Lpe(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(JN(this._state)){case xi.SUCCESS:qf(this._resolve.bind(null,this.snapshot))();break;case xi.CANCELED:case xi.ERROR:qf(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(JN(this._state)){case xi.RUNNING:case xi.PAUSED:e.next&&qf(e.next.bind(e,this.snapshot))();break;case xi.SUCCESS:e.complete&&qf(e.complete.bind(e))();break;default:e.error&&qf(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class jc{constructor(e,t){this._service=e,this._location=t instanceof li?t:li.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new jc(e,t)}get root(){const e=new li(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return V4(this._location.path)}get storage(){return this._service}get parent(){const e=function _pe(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new li(this._location.bucket,e);return new jc(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw N4(e)}}function Q4(n,e,t){return eM.apply(this,arguments)}function eM(){return eM=(0,Q.Z)(function*(n,e,t){const i=yield Y4(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield Q4(n,e,i.nextPageToken))}),eM.apply(this,arguments)}function Y4(n,e){null!=e&&"number"==typeof e.maxResults&&WN("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=Spe(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,yo)}function Ype(n){n._throwIfRoot("getDownloadURL");const e=function Rpe(n,e,t){const i=Qa(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new ta(i,"GET",function Ape(n,e){return function t(r,i){const s=U4(n,i,e);return na(null!==s),function Tpe(n,e,t,r){const i=QN(e);if(null===i||!AT(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(l=>{const f=n.fullPath;return Qa("/b/"+o(n.bucket)+"/o/"+o(f),t,r)+x4({alt:"media",token:l})})[0]}(s,i,n.host,n._protocol)}}(n,t),o);return a.errorHandler=iy(e),a}(n.storage,n._location,ry());return n.storage.makeRequestWithTokens(e,yo).then(t=>{if(null===t)throw function Zfe(){return new Vn(Nn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return t})}function X4(n,e){const t=function ype(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new li(n._location.bucket,t);return new jc(n.storage,r)}function J4(n,e){if(n instanceof tM){const t=n;if(null==t._bucket)throw function Wfe(){return new Vn(Nn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+D4+"' property when initializing the app?")}();const r=new jc(t,t._bucket);return null!=e?J4(r,e):r}return void 0!==e?X4(n,e):n}function tge(n,e){if(e&&function Jpe(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof tM)return function ege(n,e){return new jc(n,e)}(n,e);throw jf("To use ref(service, url), the first argument must be a Storage instance.")}return J4(n,e)}function eW(n,e){const t=e?.[D4];return null==t?null:li.makeFromBucketSpec(t,n)}class tM{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=b4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?li.makeFromBucketSpec(i,this._host):eW(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?li.makeFromBucketSpec(this._url,e):eW(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Q.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Q.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new jc(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Yfe(P4());{const o=function upe(n,e,t,r,i,s,o=!0){const a=x4(n.urlParams),u=n.url+a,l=Object.assign({},n.headers);return function ope(n,e){e&&(n["X-Firebase-GMPID"]=e)}(l,e),function ipe(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(l,t),function spe(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,s),function ape(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(l,r),new rpe(u,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){var r=this;return(0,Q.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,s).getPromise()})()}}const tW="@firebase/storage";function iW(n,e){return tge(n=(0,b.m9)(n),e)}function dge(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new tM(t,r,i,e,zi.SDK_VERSION)}!function hge(){(0,zi._registerComponent)(new lo.wA("storage",dge,"PUBLIC").setMultipleInstances(!0)),(0,zi.registerVersion)(tW,"0.11.2",""),(0,zi.registerVersion)(tW,"0.11.2","esm2017")}();class MT{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class oW{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new MT(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new MT(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(s="function"==typeof t?o=>t(new MT(o,this,this._ref)):{next:t.next?o=>t.next(new MT(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class aW{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Ya(e,this._service))}get items(){return this._delegate.items.map(e=>new Ya(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Ya{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function cge(n,e){return X4(n,e)}(this._delegate,e);return new Ya(t,this.storage)}get root(){return new Ya(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Ya(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new oW(function rge(n,e,t){return function Gpe(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new K4(n,new ea(e),t)}(n=(0,b.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Es.RAW,r){this._throwIfRoot("putString");const i=ZN(t,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new oW(new K4(this._delegate,new ea(i.data,!0),s),this)}listAll(){return function age(n){return function Kpe(n){const e={prefixes:[],items:[]};return Q4(n,e).then(()=>e)}(n=(0,b.m9)(n))}(this._delegate).then(e=>new aW(e,this.storage))}list(e){return function oge(n,e){return Y4(n=(0,b.m9)(n),e)}(this._delegate,e||void 0).then(t=>new aW(t,this.storage))}getMetadata(){return function ige(n){return function Zpe(n){n._throwIfRoot("getMetadata");const e=$4(n.storage,n._location,ry());return n.storage.makeRequestWithTokens(e,yo)}(n=(0,b.m9)(n))}(this._delegate)}updateMetadata(e){return function sge(n,e){return function Qpe(n,e){n._throwIfRoot("updateMetadata");const t=function Ppe(n,e,t,r){const s=Qa(e.fullServerUrl(),n.host,n._protocol),a=YN(t,r),l=n.maxOperationRetryTime,d=new ta(s,"PATCH",PT(n,r),l);return d.headers={"Content-Type":"application/json; charset=utf-8"},d.body=a,d.errorHandler=iy(e),d}(n.storage,n._location,e,ry());return n.storage.makeRequestWithTokens(t,yo)}(n=(0,b.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function uge(n){return Ype(n=(0,b.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function lge(n){return function Xpe(n){n._throwIfRoot("deleteObject");const e=function Npe(n,e){const r=Qa(e.fullServerUrl(),n.host,n._protocol),a=new ta(r,"DELETE",function o(u,l){},n.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=iy(e),a}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,yo)}(n=(0,b.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw N4(e)}}class uW{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(lW(e))throw jf("ref() expected a child path but got a URL, use refFromURL instead.");return new Ya(iW(this._delegate,e),this)}refFromURL(e){if(!lW(e))throw jf("refFromURL() expected a full URL but got a child path, use ref() instead.");try{li.makeFromUrl(e,this._delegate.host)}catch{throw jf("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ya(iW(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function sW(n,e,t,r={}){!function nge(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,b.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function lW(n){return/^[A-Za-z]+:\/\//.test(n)}function mge(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new uW(t,r)}function cW(n){const e=function yge(n){return new Ze(e=>{const t=o=>e.next(o);t(n.snapshot);const s=n.on("state_changed",t);return n.then(o=>{t(o),e.complete()},o=>{t(n.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function Ffe(n,e=hI){return Y((t,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const l=s;s=null,r.next(l)}};function u(){const l=o+n,d=e.now();if(d<l)return i=this.schedule(void 0,l-d),void r.add(i);a()}t.subscribe(ce(r,l=>{s=l,o=e.now(),i||(i=e.schedule(u,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(de(t=>t.bytesTransferred/t.totalBytes*100))}}function xT(n){return{getDownloadURL:()=>R(void 0).pipe(MU,ve(()=>n.getDownloadURL()),tr),getMetadata:()=>R(void 0).pipe(MU,ve(()=>n.getMetadata()),tr),delete:()=>I(n.delete()),child:e=>xT(n.child(e)),updateMetadata:e=>I(n.updateMetadata(e)),put:(e,t)=>cW(n.put(e,t)),putString:(e,t,r)=>cW(n.putString(e,t,r)),list:e=>I(n.list(e)),listAll:()=>I(n.listAll())}}!function _ge(n){const e={TaskState:xi,TaskEvent:Fpe,StringFormat:Es,Storage:uW,Reference:Ya};n.INTERNAL.registerComponent(new lo.wA("storage-compat",mge,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(ps.Z);const vge=new le("angularfire2.storageBucket"),Ege=new le("angularfire2.storage.maxUploadRetryTime"),Ige=new le("angularfire2.storage.maxOperationRetryTime"),wge=new le("angularfire2.storage.use-emulator");let Tge=(()=>{class n{storage;constructor(t,r,i,s,o,a,u,l,d,f){const m=lm(t,o,r);this.storage=gI(`${m.name}.storage.${i}`,"AngularFireStorage",m.name,()=>{const _=o.runOutsideAngular(()=>m.storage(i||void 0)),v=d;return v&&_.useEmulator(...v),u&&_.setMaxUploadRetryTime(u),l&&_.setMaxOperationRetryTime(l),_},[u,l])}ref(t){return xT(this.storage.ref(t))}refFromURL(t){return xT(this.storage.refFromURL(t))}upload(t,r,i){return xT(this.storage.ref(t)).put(r,i)}static \u0275fac=function(r){return new(r||n)(W(kh),W(Oh,8),W(vge,8),W(Vs),W(Tt),W(pI),W(Ege,8),W(Ige,8),W(wge,8),W(fI,8))};static \u0275prov=ye({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Cge=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({})}return n})(),bge=(()=>{class n{constructor(){ps.Z.registerVersion("angularfire",Nh.full,"gcs-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rn({type:n});static \u0275inj=Dn({providers:[Tge],imports:[Cge]})}return n})();function dW(n){return new L(3e3,!1)}function pl(n){switch(n.length){case 0:return new dm;case 1:return n[0];default:return new jU(n)}}function hW(n,e,t=new Map,r=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(u=>{const l=u.get("offset"),d=l==o,f=d&&a||new Map;u.forEach((m,_)=>{let v=_,T=m;if("offset"!==_)switch(v=n.normalizePropertyName(v,i),T){case"!":T=t.get(_);break;case La:T=r.get(_);break;default:T=n.normalizeStyleValue(_,v,T,i)}f.set(v,T)}),d||s.push(f),a=f,o=l}),i.length)throw function Kge(n){return new L(3502,!1)}();return s}function nM(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&rM(t,"start",n)));break;case"done":n.onDone(()=>r(t&&rM(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&rM(t,"destroy",n)))}}function rM(n,e,t){const s=iM(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function iM(n,e,t,r,i="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function Is(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function fW(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const ome=(()=>typeof document>"u"?null:document.documentElement)();function sM(n){const e=n.parentNode||n.host||null;return e===ome?null:e}let $c=null,pW=!1;function gW(n,e){for(;e;){if(e===n)return!0;e=sM(e)}return!1}function mW(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const r=n.querySelector(e);return r?[r]:[]}let _W=(()=>{class n{validateStyleProperty(t){return function ume(n){$c||($c=function lme(){return typeof document<"u"?document.body:null}()||{},pW=!!$c.style&&"WebkitAppearance"in $c.style);let e=!0;return $c.style&&!function ame(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in $c.style,!e&&pW&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in $c.style)),e}(t)}matchesElement(t,r){return!1}containsElement(t,r){return gW(t,r)}getParentElement(t){return sM(t)}query(t,r,i){return mW(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,s,o,a=[],u){return new dm(i,s)}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})(),oM=(()=>{class n{static#e=this.NOOP=new _W}return n})();const cme=1e3,aM="ng-enter",kT="ng-leave",OT="ng-trigger",FT=".ng-trigger",vW="ng-animating",uM=".ng-animating";function Xa(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:lM(parseFloat(e[1]),e[2])}function lM(n,e){return"s"===e?n*cme:n}function LT(n,e,t){return n.hasOwnProperty("duration")?n:function hme(n,e,t){let i,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(dW()),{duration:0,delay:0,easing:""};i=lM(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(s=lM(parseFloat(u),a[4]));const l=a[5];l&&(o=l)}else i=n;if(!t){let a=!1,u=e.length;i<0&&(e.push(function Dge(){return new L(3100,!1)}()),a=!0),s<0&&(e.push(function Age(){return new L(3101,!1)}()),a=!0),a&&e.splice(u,0,dW())}return{duration:i,delay:s,easing:o}}(n,e,t)}function sy(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function EW(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function gl(n,e=new Map,t){if(t)for(let[r,i]of t)e.set(r,i);for(let[r,i]of n)e.set(r,i);return e}function ra(n,e,t){e.forEach((r,i)=>{const s=dM(i);t&&!t.has(i)&&t.set(i,n.style[s]),n.style[s]=r})}function Hc(n,e){e.forEach((t,r)=>{const i=dM(r);n.style[i]=""})}function oy(n){return Array.isArray(n)?1==n.length?n[0]:UU(n):n}const cM=new RegExp("{{\\s*(.+?)\\s*}}","g");function wW(n){let e=[];if("string"==typeof n){let t;for(;t=cM.exec(n);)e.push(t[1]);cM.lastIndex=0}return e}function ay(n,e,t){const r=n.toString(),i=r.replace(cM,(s,o)=>{let a=e[o];return null==a&&(t.push(function Rge(n){return new L(3003,!1)}()),a=""),a.toString()});return i==r?n:i}function VT(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const gme=/-+([a-z0-9])/g;function dM(n){return n.replace(gme,(...e)=>e[1].toUpperCase())}function ws(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Pge(n){return new L(3004,!1)}()}}function TW(n,e){return window.getComputedStyle(n)[e]}const UT="*";function yme(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function vme(n,e,t){if(":"==n[0]){const u=function Eme(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(function qge(n){return new L(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof u)return void e.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return t.push(function Hge(n){return new L(3015,!1)}()),e;const i=r[1],s=r[2],o=r[3];e.push(CW(i,o));"<"==s[0]&&!(i==UT&&o==UT)&&e.push(CW(o,i))}(r,t,e)):t.push(n),t}const BT=new Set(["true","1"]),jT=new Set(["false","0"]);function CW(n,e){const t=BT.has(n)||jT.has(n),r=BT.has(e)||jT.has(e);return(i,s)=>{let o=n==UT||n==i,a=e==UT||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?BT.has(n):jT.has(n)),!a&&r&&"boolean"==typeof s&&(a=s?BT.has(e):jT.has(e)),o&&a}}const Ime=new RegExp("s*:selfs*,?","g");function hM(n,e,t,r){return new wme(n).build(e,t,r)}class wme{constructor(e){this._driver=e}build(e,t,r){const i=new bme(t);return this._resetContextStyleTimingState(i),ws(this,oy(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Mge(){return new L(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const u=a,l=u.name;l.toString().split(/\s*,\s*/).forEach(d=>{u.name=d,s.push(this.visitState(u,t))}),u.name=l}else if(1==a.type){const u=this.visitTransition(a,t);r+=u.queryCount,i+=u.depCount,o.push(u)}else t.errors.push(function xge(){return new L(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(e,t){const r=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(u=>{wW(u).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(VT(s.values()),t.errors.push(function kge(n,e){return new L(3008,!1)}()))}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const r=ws(this,oy(e.animation),t);return{type:1,matchers:yme(e.expr,t.errors),animation:r,queryCount:t.queryCount,depCount:t.depCount,options:qc(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(r=>ws(this,r,t)),options:qc(e.options)}}visitGroup(e,t){const r=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=r;const a=ws(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:qc(e.options)}}visitAnimate(e,t){const r=function Ame(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return fM(LT(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=fM(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=LT(t,e);return fM(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;let i,s=e.styles?e.styles:cm({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};r.easing&&(l.easing=r.easing),o=cm(l)}t.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,t);u.isEmptyStep=a,i=u}return t.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,t){const r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){const r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===La?r.push(a):t.errors.push(new L(3002,!1)):r.push(EW(a));let s=!1,o=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let u of a.values())if(u.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:r,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const r=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;r&&s>0&&(s-=r.duration+r.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,u)=>{const l=t.collectedStyles.get(t.currentQuerySelector),d=l.get(u);let f=!0;d&&(s!=i&&s>=d.startTime&&i<=d.endTime&&(t.errors.push(function Fge(n,e,t,r,i){return new L(3010,!1)}()),f=!1),s=d.startTime),f&&l.set(u,{startTime:s,endTime:i}),t.options&&function pme(n,e,t){const r=e.params||{},i=wW(n);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||t.push(function Sge(n){return new L(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Lge(){return new L(3011,!1)}()),r;let s=0;const o=[];let a=!1,u=!1,l=0;const d=e.steps.map(k=>{const P=this._makeStyleAst(k,t);let O=null!=P.offset?P.offset:function Dme(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(P.styles),q=0;return null!=O&&(s++,q=P.offset=O),u=u||q<0||q>1,a=a||q<l,l=q,o.push(q),P});u&&t.errors.push(function Vge(){return new L(3012,!1)}()),a&&t.errors.push(function Uge(){return new L(3200,!1)}());const f=e.steps.length;let m=0;s>0&&s<f?t.errors.push(function Bge(){return new L(3202,!1)}()):0==s&&(m=1/(f-1));const _=f-1,v=t.currentTime,T=t.currentAnimateTimings,D=T.duration;return d.forEach((k,P)=>{const O=m>0?P==_?1:m*P:o[P],q=O*D;t.currentTime=v+T.delay+q,T.duration=q,this._validateStyleAst(k,t),k.offset=O,r.styles.push(k)}),r}visitReference(e,t){return{type:8,animation:ws(this,oy(e.animation),t),options:qc(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:qc(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:qc(e.options)}}visitQuery(e,t){const r=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Tme(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Ime,"")),n=n.replace(/@\*/g,FT).replace(/@\w+/g,t=>FT+"-"+t.slice(1)).replace(/:animating/g,uM),[n,e]}(e.selector);t.currentQuerySelector=r.length?r+" "+s:s,Is(t.collectedStyles,t.currentQuerySelector,new Map);const a=ws(this,oy(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:qc(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function jge(){return new L(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:LT(e.timings,t.errors,!0);return{type:12,animation:ws(this,oy(e.animation),t),timings:r,options:null}}}class bme{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function qc(n){return n?(n=sy(n)).params&&(n.params=function Cme(n){return n?sy(n):null}(n.params)):n={},n}function fM(n,e,t){return{duration:n,delay:e,easing:t}}function pM(n,e,t,r,i,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class $T{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Pme=new RegExp(":enter","g"),Mme=new RegExp(":leave","g");function gM(n,e,t,r,i,s=new Map,o=new Map,a,u,l=[]){return(new xme).buildKeyframes(n,e,t,r,i,s,o,a,u,l)}class xme{buildKeyframes(e,t,r,i,s,o,a,u,l,d=[]){l=l||new $T;const f=new mM(e,t,l,i,s,d,[]);f.options=u;const m=u.delay?Xa(u.delay):0;f.currentTimeline.delayNextStep(m),f.currentTimeline.setStyles([o],null,f.errors,u),ws(this,r,f);const _=f.timelines.filter(v=>v.containsAnimation());if(_.length&&a.size){let v;for(let T=_.length-1;T>=0;T--){const D=_[T];if(D.element===t){v=D;break}}v&&!v.allowOnlyTimelineStyles()&&v.setStyles([a],null,f.errors,u)}return _.length?_.map(v=>v.buildKeyframes()):[pM(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const r=t.subInstructions.get(t.element);if(r){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,r){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:Xa(ay(s,i?.params??{},t.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,t,r){let s=t.currentTimeline.currentTime;const o=null!=r.duration?Xa(r.duration):null,a=null!=r.delay?Xa(r.delay):null;return 0!==o&&e.forEach(u=>{const l=t.appendInstructionToTimeline(u,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ws(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const r=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=HT);const o=Xa(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ws(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const r=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Xa(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),ws(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const r=e.strValue;return LT(t.params?ay(r,t.params,t.errors):r,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const r=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(r.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const r=t.currentTimeline,i=t.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(s):r.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const r=t.currentAnimateTimings,i=t.currentTimeline.duration,s=r.duration,a=t.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(u=>{a.forwardTime((u.offset||0)*s),a.setStyles(u.styles,u.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const r=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?Xa(i.delay):0;s&&(6===t.previousNode.type||0==r&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=HT);let o=r;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let u=null;a.forEach((l,d)=>{t.currentQueryIndex=d;const f=t.createSubContext(e.options,l);s&&f.delayNextStep(s),l===t.element&&(u=f.currentTimeline),ws(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const r=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let u=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const d=t.currentTimeline;u&&d.delayNextStep(u);const f=d.currentTime;ws(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=i.currentTime-f+(i.startTime-r.currentTimeline.startTime)}}const HT={};class mM{constructor(e,t,r,i,s,o,a,u){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=HT,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new qT(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const r=e;let i=this.options;null!=r.duration&&(i.duration=Xa(r.duration)),null!=r.delay&&(i.delay=Xa(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=ay(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const r=e.params={};Object.keys(t).forEach(i=>{r[i]=t[i]})}}return e}createSubContext(e=null,t,r){const i=t||this.element,s=new mM(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=HT,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},s=new kme(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(Pme,"."+this._enterClassName)).replace(Mme,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=r);0!==r&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!s&&0==a.length&&o.push(function $ge(n){return new L(3014,!1)}()),a}}class qT{constructor(e,t,r,i){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new qT(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||La),this._currentKeyframe.set(t,La);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function Ome(n,e){const t=new Map;let r;return n.forEach(i=>{if("*"===i){r=r||e.keys();for(let s of r)t.set(s,La)}else gl(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,u]of o){const l=ay(u,s,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??La),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{const i=this._styleSummary.get(r);(!i||t.time>i.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,u)=>{const l=gl(a,new Map,this._backFill);l.forEach((d,f)=>{"!"===d?e.add(f):d===La&&t.add(f)}),r||l.set("offset",u/this.duration),i.push(l)});const s=e.size?VT(e.values()):[],o=t.size?VT(t.values()):[];if(r){const a=i[0],u=new Map(a);a.set("offset",0),u.set("offset",1),i=[a,u]}return pM(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class kme extends qT{constructor(e,t,r,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=r+t,a=t/o,u=gl(e[0]);u.set("offset",0),s.push(u);const l=gl(e[0]);l.set("offset",AW(a)),s.push(l);const d=e.length-1;for(let f=1;f<=d;f++){let m=gl(e[f]);const _=m.get("offset");m.set("offset",AW((t+_*r)/o)),s.push(m)}r=o,t=0,i="",e=s}return pM(this.element,e,this.preStyleProps,this.postStyleProps,r,t,i,!0)}}function AW(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class _M{}const Fme=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Lme extends _M{normalizePropertyName(e,t){return dM(e)}normalizeStyleValue(e,t,r,i){let s="";const o=r.toString().trim();if(Fme.has(t)&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function Nge(n,e){return new L(3005,!1)}())}return o+s}}function SW(n,e,t,r,i,s,o,a,u,l,d,f,m){return{type:0,element:n,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:d,totalTime:f,errors:m}}const yM={};class RW{constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,i){return function Vme(n,e,t,r,i){return n.some(s=>s(e,t,r,i))}(this.ast.matchers,e,t,r,i)}buildStyles(e,t,r){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,r):new Map}build(e,t,r,i,s,o,a,u,l,d){const f=[],m=this.ast.options&&this.ast.options.params||yM,v=this.buildStyles(r,a&&a.params||yM,f),T=u&&u.params||yM,D=this.buildStyles(i,T,f),k=new Set,P=new Map,O=new Map,q="void"===i,ue={params:Ume(T,m),delay:this.ast.options?.delay},Te=d?[]:gM(e,t,this.ast.animation,s,o,v,D,ue,l,f);let Ue=0;if(Te.forEach(Ir=>{Ue=Math.max(Ir.duration+Ir.delay,Ue)}),f.length)return SW(t,this._triggerName,r,i,q,v,D,[],[],P,O,Ue,f);Te.forEach(Ir=>{const Yi=Ir.element,KT=Is(P,Yi,new Set);Ir.preStyleProps.forEach(zc=>KT.add(zc));const ly=Is(O,Yi,new Set);Ir.postStyleProps.forEach(zc=>ly.add(zc)),Yi!==t&&k.add(Yi)});const Pt=VT(k.values());return SW(t,this._triggerName,r,i,q,v,D,Te,Pt,P,O,Ue)}}function Ume(n,e){const t=sy(e);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(t[r]=n[r]);return t}class Bme{constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){const r=new Map,i=sy(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=ay(o,i,t));const u=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,u,o,t),r.set(a,o)})}),r}}class $me{constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new Bme(i.style,i.options&&i.options.params||{},r))}),PW(this.states,"true","1"),PW(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new RW(e,i,this.states))}),this.fallbackTransition=function Hme(n,e,t){return new RW(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,i){return this.transitionFactories.find(o=>o.match(e,t,r,i))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}}function PW(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const qme=new $T;class zme{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const r=[],s=hM(this._driver,t,r,[]);if(r.length)throw function Zge(n){return new L(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,r){const i=e.element,s=hW(this._normalizer,e.keyframes,t,r);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=gM(this._driver,t,s,aM,kT,new Map,new Map,r,qme,i),o.forEach(d=>{const f=Is(a,d.element,new Map);d.postStyleProps.forEach(m=>f.set(m,null))})):(i.push(function Qge(){return new L(3300,!1)}()),o=[]),i.length)throw function Yge(n){return new L(3504,!1)}();a.forEach((d,f)=>{d.forEach((m,_)=>{d.set(_,this._driver.computeStyle(f,_,La))})});const l=pl(o.map(d=>{const f=a.get(d.element);return this._buildPlayer(d,new Map,f)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Xge(n){return new L(3301,!1)}();return t}listen(e,t,r,i){const s=iM(t,"","","");return nM(this._getPlayer(e),r,s,i),()=>{}}command(e,t,r,i){if("register"==r)return void this.register(e,i[0]);if("create"==r)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const NW="ng-animate-queued",vM="ng-animate-disabled",Qme=[],MW={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Yme={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},vo="__ng_removed";class EM{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const r=e&&e.hasOwnProperty("value");if(this.value=function t_e(n){return n??null}(r?e.value:e),r){const s=sy(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const r=this.options.params;Object.keys(t).forEach(i=>{null==r[i]&&(r[i]=t[i])})}}}const uy="void",IM=new EM(uy);class Xme{constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Zs(t,this._hostClassName)}listen(e,t,r,i){if(!this._triggers.has(t))throw function Jge(n,e){return new L(3302,!1)}();if(null==r||0==r.length)throw function eme(n){return new L(3303,!1)}();if(!function n_e(n){return"start"==n||"done"==n}(r))throw function tme(n,e){return new L(3400,!1)}();const s=Is(this._elementListeners,e,[]),o={name:t,phase:r,callback:i};s.push(o);const a=Is(this._engine.statesByElement,e,new Map);return a.has(t)||(Zs(e,OT),Zs(e,OT+"-"+t),a.set(t,IM)),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(o);u>=0&&s.splice(u,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function nme(n){return new L(3401,!1)}();return t}trigger(e,t,r,i=!0){const s=this._getTrigger(t),o=new wM(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Zs(e,OT),Zs(e,OT+"-"+t),this._engine.statesByElement.set(e,a=new Map));let u=a.get(t);const l=new EM(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&l.absorbOptions(u.options),a.set(t,l),u||(u=IM),l.value!==uy&&u.value===l.value){if(!function s_e(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(u.params,l.params)){const T=[],D=s.matchStyles(u.value,u.params,T),k=s.matchStyles(l.value,l.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{Hc(e,D),ra(e,k)})}return}const m=Is(this._engine.playersByElement,e,[]);m.forEach(T=>{T.namespaceId==this.id&&T.triggerName==t&&T.queued&&T.destroy()});let _=s.matchTransition(u.value,l.value,e,l.params),v=!1;if(!_){if(!i)return;_=s.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:_,fromState:u,toState:l,player:o,isFallbackTransition:v}),v||(Zs(e,NW),o.onStart(()=>{zf(e,NW)})),o.onDone(()=>{let T=this.players.indexOf(o);T>=0&&this.players.splice(T,1);const D=this._engine.playersByElement.get(e);if(D){let k=D.indexOf(o);k>=0&&D.splice(k,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const r=this._engine.driver.query(e,FT,!0);r.forEach(i=>{if(i[vo])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,r,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((u,l)=>{if(o.set(l,u.value),this._triggers.has(l)){const d=this.trigger(e,l,uy,i);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),r&&pl(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const u=this._triggers.get(o).fallbackTransition,l=r.get(o)||IM,d=new EM(uy),f=new wM(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:u,fromState:l,toState:d,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{const s=e[vo];(!s||s===MW)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){Zs(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){const u=iM(s,r.triggerName,r.fromState.value,r.toState.value);u._data=e,nM(r.player,a.phase,u,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(r)}),this._queue=[],t.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Jme{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){const r=new Xme(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const u=i.get(a);if(u){const l=r.indexOf(u);r.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||r.unshift(e)}else r.push(e);return i.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let i=this._namespaceLookup[e];i&&i.register(t,r)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,r=this.statesByElement.get(e);if(r)for(let i of r.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,r,i){if(zT(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,r,i),!0}return!1}insertNode(e,t,r,i){if(!zT(t))return;const s=t[vo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,r)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Zs(e,vM)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),zf(e,vM))}removeNode(e,t,r){if(zT(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,r)}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,r,i,s){this.collectedLeaveElements.push(t),t[vo]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,r,i,s){return zT(t)?this._fetchNamespace(e).listen(t,r,i,s):()=>{}}_buildInstruction(e,t,r,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,FT,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,uM,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return pl(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[vo];if(t&&t.setForRemoval){if(e[vo]=MW,t.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(vM)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Zs(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{t=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],t.length?pl(t).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw function rme(n){return new L(3402,!1)}()}_flushAnimations(e,t){const r=new $T,i=[],s=new Map,o=[],a=new Map,u=new Map,l=new Map,d=new Set;this.disabledNodes.forEach(Se=>{d.add(Se);const Oe=this.driver.query(Se,".ng-animate-queued",!0);for(let je=0;je<Oe.length;je++)d.add(Oe[je])});const f=this.bodyNode,m=Array.from(this.statesByElement.keys()),_=OW(m,this.collectedEnterElements),v=new Map;let T=0;_.forEach((Se,Oe)=>{const je=aM+T++;v.set(Oe,je),Se.forEach(Mt=>Zs(Mt,je))});const D=[],k=new Set,P=new Set;for(let Se=0;Se<this.collectedLeaveElements.length;Se++){const Oe=this.collectedLeaveElements[Se],je=Oe[vo];je&&je.setForRemoval&&(D.push(Oe),k.add(Oe),je.hasAnimation?this.driver.query(Oe,".ng-star-inserted",!0).forEach(Mt=>k.add(Mt)):P.add(Oe))}const O=new Map,q=OW(m,Array.from(k));q.forEach((Se,Oe)=>{const je=kT+T++;O.set(Oe,je),Se.forEach(Mt=>Zs(Mt,je))}),e.push(()=>{_.forEach((Se,Oe)=>{const je=v.get(Oe);Se.forEach(Mt=>zf(Mt,je))}),q.forEach((Se,Oe)=>{const je=O.get(Oe);Se.forEach(Mt=>zf(Mt,je))}),D.forEach(Se=>{this.processLeaveNode(Se)})});const ue=[],Te=[];for(let Se=this._namespaceList.length-1;Se>=0;Se--)this._namespaceList[Se].drainQueuedTransitions(t).forEach(je=>{const Mt=je.player,kr=je.element;if(ue.push(Mt),this.collectedEnterElements.length){const ci=kr[vo];if(ci&&ci.setForMove){if(ci.previousTriggersValues&&ci.previousTriggersValues.has(je.triggerName)){const Gc=ci.previousTriggersValues.get(je.triggerName),Qs=this.statesByElement.get(je.element);if(Qs&&Qs.has(je.triggerName)){const ZT=Qs.get(je.triggerName);ZT.value=Gc,Qs.set(je.triggerName,ZT)}}return void Mt.destroy()}}const ia=!f||!this.driver.containsElement(f,kr),Ts=O.get(kr),ml=v.get(kr),Un=this._buildInstruction(je,r,ml,Ts,ia);if(Un.errors&&Un.errors.length)return void Te.push(Un);if(ia)return Mt.onStart(()=>Hc(kr,Un.fromStyles)),Mt.onDestroy(()=>ra(kr,Un.toStyles)),void i.push(Mt);if(je.isFallbackTransition)return Mt.onStart(()=>Hc(kr,Un.fromStyles)),Mt.onDestroy(()=>ra(kr,Un.toStyles)),void i.push(Mt);const GW=[];Un.timelines.forEach(ci=>{ci.stretchStartingKeyframe=!0,this.disabledNodes.has(ci.element)||GW.push(ci)}),Un.timelines=GW,r.append(kr,Un.timelines),o.push({instruction:Un,player:Mt,element:kr}),Un.queriedElements.forEach(ci=>Is(a,ci,[]).push(Mt)),Un.preStyleProps.forEach((ci,Gc)=>{if(ci.size){let Qs=u.get(Gc);Qs||u.set(Gc,Qs=new Set),ci.forEach((ZT,bM)=>Qs.add(bM))}}),Un.postStyleProps.forEach((ci,Gc)=>{let Qs=l.get(Gc);Qs||l.set(Gc,Qs=new Set),ci.forEach((ZT,bM)=>Qs.add(bM))})});if(Te.length){const Se=[];Te.forEach(Oe=>{Se.push(function ime(n,e){return new L(3505,!1)}())}),ue.forEach(Oe=>Oe.destroy()),this.reportError(Se)}const Ue=new Map,Pt=new Map;o.forEach(Se=>{const Oe=Se.element;r.has(Oe)&&(Pt.set(Oe,Oe),this._beforeAnimationBuild(Se.player.namespaceId,Se.instruction,Ue))}),i.forEach(Se=>{const Oe=Se.element;this._getPreviousPlayers(Oe,!1,Se.namespaceId,Se.triggerName,null).forEach(Mt=>{Is(Ue,Oe,[]).push(Mt),Mt.destroy()})});const Ir=D.filter(Se=>LW(Se,u,l)),Yi=new Map;kW(Yi,this.driver,P,l,La).forEach(Se=>{LW(Se,u,l)&&Ir.push(Se)});const ly=new Map;_.forEach((Se,Oe)=>{kW(ly,this.driver,new Set(Se),u,"!")}),Ir.forEach(Se=>{const Oe=Yi.get(Se),je=ly.get(Se);Yi.set(Se,new Map([...Oe?.entries()??[],...je?.entries()??[]]))});const zc=[],qW=[],zW={};o.forEach(Se=>{const{element:Oe,player:je,instruction:Mt}=Se;if(r.has(Oe)){if(d.has(Oe))return je.onDestroy(()=>ra(Oe,Mt.toStyles)),je.disabled=!0,je.overrideTotalTime(Mt.totalTime),void i.push(je);let kr=zW;if(Pt.size>1){let Ts=Oe;const ml=[];for(;Ts=Ts.parentNode;){const Un=Pt.get(Ts);if(Un){kr=Un;break}ml.push(Ts)}ml.forEach(Un=>Pt.set(Un,kr))}const ia=this._buildAnimation(je.namespaceId,Mt,Ue,s,ly,Yi);if(je.setRealPlayer(ia),kr===zW)zc.push(je);else{const Ts=this.playersByElement.get(kr);Ts&&Ts.length&&(je.parentPlayer=pl(Ts)),i.push(je)}}else Hc(Oe,Mt.fromStyles),je.onDestroy(()=>ra(Oe,Mt.toStyles)),qW.push(je),d.has(Oe)&&i.push(je)}),qW.forEach(Se=>{const Oe=s.get(Se.element);if(Oe&&Oe.length){const je=pl(Oe);Se.setRealPlayer(je)}}),i.forEach(Se=>{Se.parentPlayer?Se.syncPlayerEvents(Se.parentPlayer):Se.destroy()});for(let Se=0;Se<D.length;Se++){const Oe=D[Se],je=Oe[vo];if(zf(Oe,kT),je&&je.hasAnimation)continue;let Mt=[];if(a.size){let ia=a.get(Oe);ia&&ia.length&&Mt.push(...ia);let Ts=this.driver.query(Oe,uM,!0);for(let ml=0;ml<Ts.length;ml++){let Un=a.get(Ts[ml]);Un&&Un.length&&Mt.push(...Un)}}const kr=Mt.filter(ia=>!ia.destroyed);kr.length?r_e(this,Oe,kr):this.processLeaveNode(Oe)}return D.length=0,zc.forEach(Se=>{this.players.push(Se),Se.onDone(()=>{Se.destroy();const Oe=this.players.indexOf(Se);this.players.splice(Oe,1)}),Se.play()}),zc}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const u=!s||s==uy;a.forEach(l=>{l.queued||!u&&l.triggerName!=i||o.push(l)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,r){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const u of t.timelines){const l=u.element,d=l!==s,f=Is(r,l,[]);this._getPreviousPlayers(l,d,o,a,t.toState).forEach(_=>{const v=_.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),_.destroy(),f.push(_)})}Hc(s,t.fromStyles)}_buildAnimation(e,t,r,i,s,o){const a=t.triggerName,u=t.element,l=[],d=new Set,f=new Set,m=t.timelines.map(v=>{const T=v.element;d.add(T);const D=T[vo];if(D&&D.removedBeforeQueried)return new dm(v.duration,v.delay);const k=T!==u,P=function i_e(n){const e=[];return FW(n,e),e}((r.get(T)||Qme).map(Ue=>Ue.getRealPlayer())).filter(Ue=>!!Ue.element&&Ue.element===T),O=s.get(T),q=o.get(T),ue=hW(this._normalizer,v.keyframes,O,q),Te=this._buildPlayer(v,ue,P);if(v.subTimeline&&i&&f.add(T),k){const Ue=new wM(e,a,T);Ue.setRealPlayer(Te),l.push(Ue)}return Te});l.forEach(v=>{Is(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>function e_e(n,e,t){let r=n.get(e);if(r){if(r.length){const i=r.indexOf(t);r.splice(i,1)}0==r.length&&n.delete(e)}return r}(this.playersByQueriedElement,v.element,v))}),d.forEach(v=>Zs(v,vW));const _=pl(m);return _.onDestroy(()=>{d.forEach(v=>zf(v,vW)),ra(u,t.toStyles)}),f.forEach(v=>{Is(i,v,[]).push(_)}),_}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new dm(e.duration,e.delay)}}class wM{constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r,this._player=new dm,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(i=>nM(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Is(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function zT(n){return n&&1===n.nodeType}function xW(n,e){const t=n.style.display;return n.style.display=e??"none",t}function kW(n,e,t,r,i){const s=[];t.forEach(u=>s.push(xW(u)));const o=[];r.forEach((u,l)=>{const d=new Map;u.forEach(f=>{const m=e.computeStyle(l,f,i);d.set(f,m),(!m||0==m.length)&&(l[vo]=Yme,o.push(l))}),n.set(l,d)});let a=0;return t.forEach(u=>xW(u,s[a++])),o}function OW(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let u=s.get(a);if(u)return u;const l=a.parentNode;return u=t.has(l)?l:i.has(l)?1:o(l),s.set(a,u),u}return e.forEach(a=>{const u=o(a);1!==u&&t.get(u).push(a)}),t}function Zs(n,e){n.classList?.add(e)}function zf(n,e){n.classList?.remove(e)}function r_e(n,e,t){pl(t).onDone(()=>n.processLeaveNode(e))}function FW(n,e){for(let t=0;t<n.length;t++){const r=n[t];r instanceof jU?FW(r.players,e):e.push(r)}}function LW(n,e,t){const r=t.get(n);if(!r)return!1;let i=e.get(n);return i?r.forEach(s=>i.add(s)):e.set(n,r),t.delete(n),!0}class GT{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new Jme(e,t,r),this._timelineEngine=new zme(e,t,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,r,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const u=[],d=hM(this._driver,s,u,[]);if(u.length)throw function Wge(n,e){return new L(3404,!1)}();a=function jme(n,e,t){return new $me(n,e,t)}(i,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,i){this._transitionEngine.insertNode(e,t,r,i)}onRemove(e,t,r){this._transitionEngine.removeNode(e,t,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,i){if("@"==r.charAt(0)){const[s,o]=fW(r);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,r,i)}listen(e,t,r,i,s){if("@"==r.charAt(0)){const[o,a]=fW(r);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,r,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let a_e=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,r,i){this._element=t,this._startStyles=r,this._endStyles=i,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&ra(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ra(this._element,this._initialStyles),this._endStyles&&(ra(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Hc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Hc(this._element,this._endStyles),this._endStyles=null),ra(this._element,this._initialStyles),this._state=3)}}return n})();function TM(n){let e=null;return n.forEach((t,r)=>{(function u_e(n){return"display"===n||"position"===n})(r)&&(e=e||new Map,e.set(r,t))}),e}class VW{constructor(e,t,r,i){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&e.set(i,this._finished?r:TW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class l_e{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return gW(e,t)}getParentElement(e){return sM(e)}query(e,t,r){return mW(e,t,r)}computeStyle(e,t,r){return window.getComputedStyle(e)[t]}animate(e,t,r,i,s,o=[]){const u={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(u.easing=s);const l=new Map,d=o.filter(_=>_ instanceof VW);(function mme(n,e){return 0===n||0===e})(r,i)&&d.forEach(_=>{_.currentSnapshot.forEach((v,T)=>l.set(T,v))});let f=function fme(n){return n.length?n[0]instanceof Map?n:n.map(e=>EW(e)):[]}(t).map(_=>gl(_));f=function _me(n,e,t){if(t.size&&e.length){let r=e[0],i=[];if(t.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,TW(n,a)))}}return e}(e,f,l);const m=function o_e(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=TM(e[0]),e.length>1&&(r=TM(e[e.length-1]))):e instanceof Map&&(t=TM(e)),t||r?new a_e(n,t,r):null}(e,f);return new VW(e,f,u,m)}}let c_e=(()=>{class n extends LU{constructor(t,r){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(r.body,{id:"0",encapsulation:Fi.None,styles:[],data:{animation:[]}})}build(t){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(t)?UU(t):t;return UW(this._renderer,null,r,"register",[i]),new d_e(r,this._renderer)}static#e=this.\u0275fac=function(r){return new(r||n)(W(ug),W(yr))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class d_e extends Une{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new h_e(this._id,e,t||{},this._renderer)}}class h_e{constructor(e,t,r,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return UW(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function UW(n,e,t,r,i){return n.setProperty(e,`@@${t}:${r}`,i)}const BW="@.disabled";let f_e=(()=>{class n{constructor(t,r,i){this.delegate=t,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,r.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,r){const s=this.delegate.createRenderer(t,r);if(!(t&&r&&r.data&&r.data.animation)){let d=this._rendererCache.get(s);return d||(d=new jW("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=r.id,a=r.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const u=d=>{Array.isArray(d)?d.forEach(u):this.engine.registerTrigger(o,a,t,d.name,d)};return r.data.animation.forEach(u),new p_e(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,r,i){t>=0&&t<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(r){return new(r||n)(W(ug),W(GT),W(Tt))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();class jW{constructor(e,t,r,i){this.namespaceId=e,this.delegate=t,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,i=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){"@"==t.charAt(0)&&t==BW?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.delegate.listen(e,t,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class p_e extends jW{constructor(e,t,r,i,s){super(t,r,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&t==BW?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r){if("@"==t.charAt(0)){const i=function g_e(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function m_e(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(e,t,r)}}let __e=(()=>{class n extends GT{constructor(t,r,i,s){super(t.body,r,i)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(r){return new(r||n)(W(yr),W(oM),W(_M),W(Pa))};static#t=this.\u0275prov=ye({token:n,factory:n.\u0275fac})}return n})();const $W=[{provide:LU,useClass:c_e},{provide:_M,useFactory:function y_e(){return new Lme}},{provide:GT,useClass:__e},{provide:ug,useFactory:function v_e(n,e,t){return new f_e(n,e,t)},deps:[mD,GT,Tt]}],CM=[{provide:oM,useFactory:()=>new l_e},{provide:sk,useValue:"BrowserAnimations"},...$W],HW=[{provide:oM,useClass:_W},{provide:sk,useValue:"NoopAnimations"},...$W];let E_e=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?HW:CM}}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n});static#n=this.\u0275inj=Dn({providers:CM,imports:[aV]})}return n})(),I_e=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=rn({type:n,bootstrap:[Hre]});static#n=this.\u0275inj=Dn({imports:[Mne.initializeApp(qre_firebase),Lne,aV,$re,$J,HJ,Ofe,bge,tue,ure.forRoot(),Mre,E_e]})}return n})();kX().bootstrapModule(I_e).catch(n=>console.error(n))},106:(Cs,Zn,ke)=>{ke.d(Zn,{Z:()=>Qn});var A=ke(58),Z=ke(537),F=ke(534),Ae=ke(879);class yt{constructor($e,He){this._delegate=$e,this.firebase=He,(0,F._addComponent)($e,new Z.wA("app-compat",()=>this,"PUBLIC")),this.container=$e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled($e){this._delegate.automaticDataCollectionEnabled=$e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise($e=>{this._delegate.checkDestroyed(),$e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,F.deleteApp)(this._delegate)))}_getService($e,He=F._DEFAULT_ENTRY_NAME){var ir;this._delegate.checkDestroyed();const In=this._delegate.container.getProvider($e);return!In.isInitialized()&&"EXPLICIT"===(null===(ir=In.getComponent())||void 0===ir?void 0:ir.instantiationMode)&&In.initialize(),In.getImmediate({identifier:He})}_removeServiceInstance($e,He=F._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider($e).clearInstance(He)}_addComponent($e){(0,F._addComponent)(this._delegate,$e)}_addOrOverwriteComponent($e){(0,F._addOrOverwriteComponent)(this._delegate,$e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Mn=new A.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),X=function vt(){const ct=function $t(ct){const $e={},He={__esModule:!0,initializeApp:function ot(Xe,se={}){const pt=F.initializeApp(Xe,se);if((0,A.r3)($e,pt.name))return $e[pt.name];const Qt=new ct(pt,He);return $e[pt.name]=Qt,Qt},app:In,registerVersion:F.registerVersion,setLogLevel:F.setLogLevel,onLog:F.onLog,apps:null,SDK_VERSION:F.SDK_VERSION,INTERNAL:{registerComponent:function di(Xe){const se=Xe.name,pt=se.replace("-compat","");if(F._registerComponent(Xe)&&"PUBLIC"===Xe.type){const Qt=(wn=In())=>{if("function"!=typeof wn[pt])throw Mn.create("invalid-app-argument",{appName:se});return wn[pt]()};void 0!==Xe.serviceProps&&(0,A.ZB)(Qt,Xe.serviceProps),He[pt]=Qt,ct.prototype[pt]=function(...wn){return this._getService.bind(this,se).apply(this,Xe.multipleInstances?wn:[])}}return"PUBLIC"===Xe.type?He[pt]:null},removeApp:function ir(Xe){delete $e[Xe]},useAsService:function Bn(Xe,se){return"serverAuth"===se?null:se},modularAPIs:F}};function In(Xe){if(!(0,A.r3)($e,Xe=Xe||F._DEFAULT_ENTRY_NAME))throw Mn.create("no-app",{appName:Xe});return $e[Xe]}return He.default=He,Object.defineProperty(He,"apps",{get:function kt(){return Object.keys($e).map(Xe=>$e[Xe])}}),In.App=ct,He}(yt);return ct.INTERNAL=Object.assign(Object.assign({},ct.INTERNAL),{createFirebaseNamespace:vt,extendNamespace:function $e(He){(0,A.ZB)(ct,He)},createSubscribe:A.ne,ErrorFactory:A.LL,deepExtend:A.ZB}),ct}(),ae=new Ae.Yd("@firebase/app-compat");if((0,A.jU)()&&void 0!==self.firebase){ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const ct=self.firebase.SDK_VERSION;ct&&ct.indexOf("LITE")>=0&&ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Qn=X;!function bt(ct){(0,F.registerVersion)("@firebase/app-compat","0.2.23",ct)}()},534:(Cs,Zn,ke)=>{ke.r(Zn),ke.d(Zn,{FirebaseError:()=>Ae.ZR,SDK_VERSION:()=>ns,_DEFAULT_ENTRY_NAME:()=>es,_addComponent:()=>fi,_addOrOverwriteComponent:()=>pi,_apps:()=>cr,_clearComponents:()=>Cn,_components:()=>hi,_getProvider:()=>Ot,_registerComponent:()=>dr,_removeServiceInstance:()=>Qr,deleteApp:()=>$n,getApp:()=>rs,getApps:()=>Xn,initializeApp:()=>Oi,onLog:()=>Ja,registerVersion:()=>gi,setLogLevel:()=>Eo});var A=ke(861),Z=ke(537),F=ke(879),Ae=ke(58);const yt=(U,x)=>x.some(ie=>U instanceof ie);let Jt,Mn;const X=new WeakMap,ae=new WeakMap,be=new WeakMap,We=new WeakMap,bt=new WeakMap;let $e={get(U,x,ie){if(U instanceof IDBTransaction){if("done"===x)return ae.get(U);if("objectStoreNames"===x)return U.objectStoreNames||be.get(U);if("store"===x)return ie.objectStoreNames[1]?void 0:ie.objectStore(ie.objectStoreNames[0])}return ot(U[x])},set:(U,x,ie)=>(U[x]=ie,!0),has:(U,x)=>U instanceof IDBTransaction&&("done"===x||"store"===x)||x in U};function In(U){return"function"==typeof U?function ir(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function vt(){return Mn||(Mn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...x){return U.apply(kt(this),x),ot(X.get(this))}:function(...x){return ot(U.apply(kt(this),x))}:function(x,...ie){const De=U.call(kt(this),x,...ie);return be.set(De,x.sort?x.sort():[x]),ot(De)}}(U):(U instanceof IDBTransaction&&function ct(U){if(ae.has(U))return;const x=new Promise((ie,De)=>{const Je=()=>{U.removeEventListener("complete",nt),U.removeEventListener("error",L),U.removeEventListener("abort",L)},nt=()=>{ie(),Je()},L=()=>{De(U.error||new DOMException("AbortError","AbortError")),Je()};U.addEventListener("complete",nt),U.addEventListener("error",L),U.addEventListener("abort",L)});ae.set(U,x)}(U),yt(U,function $t(){return Jt||(Jt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,$e):U)}function ot(U){if(U instanceof IDBRequest)return function Qn(U){const x=new Promise((ie,De)=>{const Je=()=>{U.removeEventListener("success",nt),U.removeEventListener("error",L)},nt=()=>{ie(ot(U.result)),Je()},L=()=>{De(U.error),Je()};U.addEventListener("success",nt),U.addEventListener("error",L)});return x.then(ie=>{ie instanceof IDBCursor&&X.set(ie,U)}).catch(()=>{}),bt.set(x,U),x}(U);if(We.has(U))return We.get(U);const x=In(U);return x!==U&&(We.set(U,x),bt.set(x,U)),x}const kt=U=>bt.get(U),Xe=["get","getKey","getAll","getAllKeys","count"],se=["put","add","delete","clear"],pt=new Map;function Qt(U,x){if(!(U instanceof IDBDatabase)||x in U||"string"!=typeof x)return;if(pt.get(x))return pt.get(x);const ie=x.replace(/FromIndex$/,""),De=x!==ie,Je=se.includes(ie);if(!(ie in(De?IDBIndex:IDBObjectStore).prototype)||!Je&&!Xe.includes(ie))return;const nt=function(){var L=(0,A.Z)(function*(xn,...Ce){const st=this.transaction(xn,Je?"readwrite":"readonly");let yl=st.store;return De&&(yl=yl.index(Ce.shift())),(yield Promise.all([yl[ie](...Ce),Je&&st.done]))[0]});return function(Ce){return L.apply(this,arguments)}}();return pt.set(x,nt),nt}!function He(U){$e=U($e)}(U=>({...U,get:(x,ie,De)=>Qt(x,ie)||U.get(x,ie,De),has:(x,ie)=>!!Qt(x,ie)||U.has(x,ie)}));class wn{constructor(x){this.container=x}getPlatformInfoString(){return this.container.getProviders().map(ie=>{if(function Tn(U){const x=U.getComponent();return"VERSION"===x?.type}(ie)){const De=ie.getImmediate();return`${De.library}/${De.version}`}return null}).filter(ie=>ie).join(" ")}}const Xi="@firebase/app",Ze=new F.Yd("@firebase/app"),es="[DEFAULT]",ts={[Xi]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cr=new Map,hi=new Map;function fi(U,x){try{U.container.addComponent(x)}catch(ie){Ze.debug(`Component ${x.name} failed to register with FirebaseApp ${U.name}`,ie)}}function pi(U,x){U.container.addOrOverwriteComponent(x)}function dr(U){const x=U.name;if(hi.has(x))return Ze.debug(`There were multiple attempts to register component ${x}.`),!1;hi.set(x,U);for(const ie of cr.values())fi(ie,U);return!0}function Ot(U,x){const ie=U.container.getProvider("heartbeat").getImmediate({optional:!0});return ie&&ie.triggerHeartbeat(),U.container.getProvider(x)}function Qr(U,x,ie=es){Ot(U,x).clearInstance(ie)}function Cn(){hi.clear()}const nn=new Ae.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class bn{constructor(x,ie,De){this._isDeleted=!1,this._options=Object.assign({},x),this._config=Object.assign({},ie),this._name=ie.name,this._automaticDataCollectionEnabled=ie.automaticDataCollectionEnabled,this._container=De,this.container.addComponent(new Z.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(x){this.checkDestroyed(),this._automaticDataCollectionEnabled=x}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(x){this._isDeleted=x}checkDestroyed(){if(this.isDeleted)throw nn.create("app-deleted",{appName:this._name})}}const ns="10.6.0";function Oi(U,x={}){let ie=U;"object"!=typeof x&&(x={name:x});const De=Object.assign({name:es,automaticDataCollectionEnabled:!1},x),Je=De.name;if("string"!=typeof Je||!Je)throw nn.create("bad-app-name",{appName:String(Je)});if(ie||(ie=(0,Ae.aH)()),!ie)throw nn.create("no-options");const nt=cr.get(Je);if(nt){if((0,Ae.vZ)(ie,nt.options)&&(0,Ae.vZ)(De,nt.config))return nt;throw nn.create("duplicate-app",{appName:Je})}const L=new Z.H0(Je);for(const Ce of hi.values())L.addComponent(Ce);const xn=new bn(ie,De,L);return cr.set(Je,xn),xn}function rs(U=es){const x=cr.get(U);if(!x&&U===es&&(0,Ae.aH)())return Oi();if(!x)throw nn.create("no-app",{appName:U});return x}function Xn(){return Array.from(cr.values())}function $n(U){return Or.apply(this,arguments)}function Or(){return(Or=(0,A.Z)(function*(U){const x=U.name;cr.has(x)&&(cr.delete(x),yield Promise.all(U.container.getProviders().map(ie=>ie.delete())),U.isDeleted=!0)})).apply(this,arguments)}function gi(U,x,ie){var De;let Je=null!==(De=ts[U])&&void 0!==De?De:U;ie&&(Je+=`-${ie}`);const nt=Je.match(/\s|\//),L=x.match(/\s|\//);if(nt||L){const xn=[`Unable to register library "${Je}" with version "${x}":`];return nt&&xn.push(`library name "${Je}" contains illegal characters (whitespace or "/")`),nt&&L&&xn.push("and"),L&&xn.push(`version name "${x}" contains illegal characters (whitespace or "/")`),void Ze.warn(xn.join(" "))}dr(new Z.wA(`${Je}-version`,()=>({library:Je,version:x}),"VERSION"))}function Ja(U,x){if(null!==U&&"function"!=typeof U)throw nn.create("invalid-log-argument");(0,F.Am)(U,x)}function Eo(U){(0,F.Ub)(U)}const sa="firebase-heartbeat-database",Rs=1,N="firebase-heartbeat-store";let S=null;function I(){return S||(S=function di(U,x,{blocked:ie,upgrade:De,blocking:Je,terminated:nt}={}){const L=indexedDB.open(U,x),xn=ot(L);return De&&L.addEventListener("upgradeneeded",Ce=>{De(ot(L.result),Ce.oldVersion,Ce.newVersion,ot(L.transaction),Ce)}),ie&&L.addEventListener("blocked",Ce=>ie(Ce.oldVersion,Ce.newVersion,Ce)),xn.then(Ce=>{nt&&Ce.addEventListener("close",()=>nt()),Je&&Ce.addEventListener("versionchange",st=>Je(st.oldVersion,st.newVersion,st))}).catch(()=>{}),xn}(sa,Rs,{upgrade:(U,x)=>{0===x&&U.createObjectStore(N)}}).catch(U=>{throw nn.create("idb-open",{originalErrorMessage:U.message})})),S}function E(){return(E=(0,A.Z)(function*(U){try{return yield(yield I()).transaction(N).objectStore(N).get(Ie(U))}catch(x){if(x instanceof Ae.ZR)Ze.warn(x.message);else{const ie=nn.create("idb-get",{originalErrorMessage:x?.message});Ze.warn(ie.message)}}})).apply(this,arguments)}function R(U,x){return K.apply(this,arguments)}function K(){return(K=(0,A.Z)(function*(U,x){try{const De=(yield I()).transaction(N,"readwrite");yield De.objectStore(N).put(x,Ie(U)),yield De.done}catch(ie){if(ie instanceof Ae.ZR)Ze.warn(ie.message);else{const De=nn.create("idb-set",{originalErrorMessage:ie?.message});Ze.warn(De.message)}}})).apply(this,arguments)}function Ie(U){return`${U.name}!${U.options.appId}`}class It{constructor(x){this.container=x,this._heartbeatsCache=null;const ie=this.container.getProvider("app").getImmediate();this._storage=new Re(ie),this._heartbeatsCachePromise=this._storage.read().then(De=>(this._heartbeatsCache=De,De))}triggerHeartbeat(){var x=this;return(0,A.Z)(function*(){var ie;const Je=x.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),nt=ge();if(null==(null===(ie=x._heartbeatsCache)||void 0===ie?void 0:ie.heartbeats)&&(x._heartbeatsCache=yield x._heartbeatsCachePromise),x._heartbeatsCache.lastSentHeartbeatDate!==nt&&!x._heartbeatsCache.heartbeats.some(L=>L.date===nt))return x._heartbeatsCache.heartbeats.push({date:nt,agent:Je}),x._heartbeatsCache.heartbeats=x._heartbeatsCache.heartbeats.filter(L=>{const xn=new Date(L.date).valueOf();return Date.now()-xn<=2592e6}),x._storage.overwrite(x._heartbeatsCache)})()}getHeartbeatsHeader(){var x=this;return(0,A.Z)(function*(){var ie;if(null===x._heartbeatsCache&&(yield x._heartbeatsCachePromise),null==(null===(ie=x._heartbeatsCache)||void 0===ie?void 0:ie.heartbeats)||0===x._heartbeatsCache.heartbeats.length)return"";const De=ge(),{heartbeatsToSend:Je,unsentEntries:nt}=function Vt(U,x=1024){const ie=[];let De=U.slice();for(const Je of U){const nt=ie.find(L=>L.agent===Je.agent);if(nt){if(nt.dates.push(Je.date),or(ie)>x){nt.dates.pop();break}}else if(ie.push({agent:Je.agent,dates:[Je.date]}),or(ie)>x){ie.pop();break}De=De.slice(1)}return{heartbeatsToSend:ie,unsentEntries:De}}(x._heartbeatsCache.heartbeats),L=(0,Ae.L)(JSON.stringify({version:2,heartbeats:Je}));return x._heartbeatsCache.lastSentHeartbeatDate=De,nt.length>0?(x._heartbeatsCache.heartbeats=nt,yield x._storage.overwrite(x._heartbeatsCache)):(x._heartbeatsCache.heartbeats=[],x._storage.overwrite(x._heartbeatsCache)),L})()}}function ge(){return(new Date).toISOString().substring(0,10)}class Re{constructor(x){this.app=x,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,A.Z)(function*(){return!!(0,Ae.hl)()&&(0,Ae.eu)().then(()=>!0).catch(()=>!1)})()}read(){var x=this;return(0,A.Z)(function*(){return(yield x._canUseIndexedDBPromise)&&(yield function C(U){return E.apply(this,arguments)}(x.app))||{heartbeats:[]}})()}overwrite(x){var ie=this;return(0,A.Z)(function*(){var De;if(yield ie._canUseIndexedDBPromise){const nt=yield ie.read();return R(ie.app,{lastSentHeartbeatDate:null!==(De=x.lastSentHeartbeatDate)&&void 0!==De?De:nt.lastSentHeartbeatDate,heartbeats:x.heartbeats})}})()}add(x){var ie=this;return(0,A.Z)(function*(){var De;if(yield ie._canUseIndexedDBPromise){const nt=yield ie.read();return R(ie.app,{lastSentHeartbeatDate:null!==(De=x.lastSentHeartbeatDate)&&void 0!==De?De:nt.lastSentHeartbeatDate,heartbeats:[...nt.heartbeats,...x.heartbeats]})}})()}}function or(U){return(0,Ae.L)(JSON.stringify({version:2,heartbeats:U})).length}!function oa(U){dr(new Z.wA("platform-logger",x=>new wn(x),"PRIVATE")),dr(new Z.wA("heartbeat",x=>new It(x),"PRIVATE")),gi(Xi,"0.9.23",U),gi(Xi,"0.9.23","esm2017"),gi("fire-js","")}("")},537:(Cs,Zn,ke)=>{ke.d(Zn,{H0:()=>$t,wA:()=>F,zt:()=>yt});var A=ke(861),Z=ke(58);class F{constructor(X,ae,be){this.name=X,this.instanceFactory=ae,this.type=be,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(X){return this.instantiationMode=X,this}setMultipleInstances(X){return this.multipleInstances=X,this}setServiceProps(X){return this.serviceProps=X,this}setInstanceCreatedCallback(X){return this.onInstanceCreated=X,this}}const Ae="[DEFAULT]";class yt{constructor(X,ae){this.name=X,this.container=ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(X){const ae=this.normalizeInstanceIdentifier(X);if(!this.instancesDeferred.has(ae)){const be=new Z.BH;if(this.instancesDeferred.set(ae,be),this.isInitialized(ae)||this.shouldAutoInitialize())try{const We=this.getOrInitializeService({instanceIdentifier:ae});We&&be.resolve(We)}catch{}}return this.instancesDeferred.get(ae).promise}getImmediate(X){var ae;const be=this.normalizeInstanceIdentifier(X?.identifier),We=null!==(ae=X?.optional)&&void 0!==ae&&ae;if(!this.isInitialized(be)&&!this.shouldAutoInitialize()){if(We)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:be})}catch(bt){if(We)return null;throw bt}}getComponent(){return this.component}setComponent(X){if(X.name!==this.name)throw Error(`Mismatching Component ${X.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=X,this.shouldAutoInitialize()){if(function Mn(vt){return"EAGER"===vt.instantiationMode}(X))try{this.getOrInitializeService({instanceIdentifier:Ae})}catch{}for(const[ae,be]of this.instancesDeferred.entries()){const We=this.normalizeInstanceIdentifier(ae);try{const bt=this.getOrInitializeService({instanceIdentifier:We});be.resolve(bt)}catch{}}}}clearInstance(X=Ae){this.instancesDeferred.delete(X),this.instancesOptions.delete(X),this.instances.delete(X)}delete(){var X=this;return(0,A.Z)(function*(){const ae=Array.from(X.instances.values());yield Promise.all([...ae.filter(be=>"INTERNAL"in be).map(be=>be.INTERNAL.delete()),...ae.filter(be=>"_delete"in be).map(be=>be._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(X=Ae){return this.instances.has(X)}getOptions(X=Ae){return this.instancesOptions.get(X)||{}}initialize(X={}){const{options:ae={}}=X,be=this.normalizeInstanceIdentifier(X.instanceIdentifier);if(this.isInitialized(be))throw Error(`${this.name}(${be}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const We=this.getOrInitializeService({instanceIdentifier:be,options:ae});for(const[bt,Qn]of this.instancesDeferred.entries())be===this.normalizeInstanceIdentifier(bt)&&Qn.resolve(We);return We}onInit(X,ae){var be;const We=this.normalizeInstanceIdentifier(ae),bt=null!==(be=this.onInitCallbacks.get(We))&&void 0!==be?be:new Set;bt.add(X),this.onInitCallbacks.set(We,bt);const Qn=this.instances.get(We);return Qn&&X(Qn,We),()=>{bt.delete(X)}}invokeOnInitCallbacks(X,ae){const be=this.onInitCallbacks.get(ae);if(be)for(const We of be)try{We(X,ae)}catch{}}getOrInitializeService({instanceIdentifier:X,options:ae={}}){let be=this.instances.get(X);if(!be&&this.component&&(be=this.component.instanceFactory(this.container,{instanceIdentifier:(vt=X,vt===Ae?void 0:vt),options:ae}),this.instances.set(X,be),this.instancesOptions.set(X,ae),this.invokeOnInitCallbacks(be,X),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,X,be)}catch{}var vt;return be||null}normalizeInstanceIdentifier(X=Ae){return this.component?this.component.multipleInstances?X:Ae:X}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class $t{constructor(X){this.name=X,this.providers=new Map}addComponent(X){const ae=this.getProvider(X.name);if(ae.isComponentSet())throw new Error(`Component ${X.name} has already been registered with ${this.name}`);ae.setComponent(X)}addOrOverwriteComponent(X){this.getProvider(X.name).isComponentSet()&&this.providers.delete(X.name),this.addComponent(X)}getProvider(X){if(this.providers.has(X))return this.providers.get(X);const ae=new yt(X,this);return this.providers.set(X,ae),ae}getProviders(){return Array.from(this.providers.values())}}},879:(Cs,Zn,ke)=>{ke.d(Zn,{Am:()=>vt,Ub:()=>$t,Yd:()=>Mn,in:()=>Z});const A=[];var Z=function(X){return X[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT",X}(Z||{});const F={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},Ae=Z.INFO,yt={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},Jt=(X,ae,...be)=>{if(ae<X.logLevel)return;const We=(new Date).toISOString(),bt=yt[ae];if(!bt)throw new Error(`Attempted to log a message with an invalid logType (value: ${ae})`);console[bt](`[${We}]  ${X.name}:`,...be)};class Mn{constructor(ae){this.name=ae,this._logLevel=Ae,this._logHandler=Jt,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(ae){if(!(ae in Z))throw new TypeError(`Invalid value "${ae}" assigned to \`logLevel\``);this._logLevel=ae}setLogLevel(ae){this._logLevel="string"==typeof ae?F[ae]:ae}get logHandler(){return this._logHandler}set logHandler(ae){if("function"!=typeof ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(ae){this._userLogHandler=ae}debug(...ae){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...ae),this._logHandler(this,Z.DEBUG,...ae)}log(...ae){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...ae),this._logHandler(this,Z.VERBOSE,...ae)}info(...ae){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...ae),this._logHandler(this,Z.INFO,...ae)}warn(...ae){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...ae),this._logHandler(this,Z.WARN,...ae)}error(...ae){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...ae),this._logHandler(this,Z.ERROR,...ae)}}function $t(X){A.forEach(ae=>{ae.setLogLevel(X)})}function vt(X,ae){for(const be of A){let We=null;ae&&ae.level&&(We=F[ae.level]),be.userLogHandler=null===X?null:(bt,Qn,...ct)=>{const $e=ct.map(He=>{if(null==He)return null;if("string"==typeof He)return He;if("number"==typeof He||"boolean"==typeof He)return He.toString();if(He instanceof Error)return He.message;try{return JSON.stringify(He)}catch{return null}}).filter(He=>He).join(" ");Qn>=(We??bt.logLevel)&&X({level:Z[Qn].toLowerCase(),message:$e,args:ct,type:bt.name})}}}},365:(Cs,Zn,ke)=>{ke.r(Zn);var A=ke(861),Z=ke(106),F=ke(562),Ae=ke(58),Mn=(ke(534),ke(879),ke(537));function $t(){return window}function ae(){return ae=(0,A.Z)(function*(I,C,E){var R;const{BuildInfo:K}=$t();(0,F.au)(C.sessionId,"AuthEvent did not contain a session ID");const Ie=yield function He(I){return ir.apply(this,arguments)}(C.sessionId),ve={};return(0,F.av)()?ve.ibi=K.packageName:(0,F.aw)()?ve.apn=K.packageName:(0,F.ax)(I,"operation-not-supported-in-this-environment"),K.displayName&&(ve.appDisplayName=K.displayName),ve.sessionId=Ie,(0,F.ay)(I,E,C.type,void 0,null!==(R=C.eventId)&&void 0!==R?R:void 0,ve)}),ae.apply(this,arguments)}function We(){return(We=(0,A.Z)(function*(I){const{BuildInfo:C}=$t(),E={};(0,F.av)()?E.iosBundleId=C.packageName:(0,F.aw)()?E.androidPackageName=C.packageName:(0,F.ax)(I,"operation-not-supported-in-this-environment"),yield(0,F.az)(I,E)})).apply(this,arguments)}function ct(){return(ct=(0,A.Z)(function*(I,C,E){const{cordova:R}=$t();let K=()=>{};try{yield new Promise((Ie,ve)=>{let Fe=null;function It(){var Re;Ie();const or=null===(Re=R.plugins.browsertab)||void 0===Re?void 0:Re.close;"function"==typeof or&&or(),"function"==typeof E?.close&&E.close()}function ge(){Fe||(Fe=window.setTimeout(()=>{ve((0,F.aB)(I,"redirect-cancelled-by-user"))},2e3))}function Vt(){"visible"===document?.visibilityState&&ge()}C.addPassiveListener(It),document.addEventListener("resume",ge,!1),(0,F.aw)()&&document.addEventListener("visibilitychange",Vt,!1),K=()=>{C.removePassiveListener(It),document.removeEventListener("resume",ge,!1),document.removeEventListener("visibilitychange",Vt,!1),Fe&&window.clearTimeout(Fe)}})}finally{K()}})).apply(this,arguments)}function ir(){return(ir=(0,A.Z)(function*(I){const C=function In(I){if((0,F.au)(/[0-9a-zA-Z]+/.test(I),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(I);const C=new ArrayBuffer(I.length),E=new Uint8Array(C);for(let R=0;R<I.length;R++)E[R]=I.charCodeAt(R);return E}(I),E=yield crypto.subtle.digest("SHA-256",C);return Array.from(new Uint8Array(E)).map(K=>K.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class kt extends F.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(C=>{this.resolveInialized=C})}addPassiveListener(C){this.passiveListeners.add(C)}removePassiveListener(C){this.passiveListeners.delete(C)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(C){return this.resolveInialized(),this.passiveListeners.forEach(E=>E(C)),super.onEvent(C)}initialized(){var C=this;return(0,A.Z)(function*(){yield C.initPromise})()}}function Xe(I){return se.apply(this,arguments)}function se(){return(se=(0,A.Z)(function*(I){const C=yield wn()._get(Tn(I));return C&&(yield wn()._remove(Tn(I))),C})).apply(this,arguments)}function Qt(){const I=[];for(let E=0;E<20;E++){const R=Math.floor(62*Math.random());I.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(R))}return I.join("")}function wn(){return(0,F.aE)(F.b)}function Tn(I){return(0,F.aF)("authEvent",I.config.apiKey,I.name)}function Ze(I){if(!I?.includes("?"))return{};const[C,...E]=I.split("?");return(0,Ae.zd)(E.join("?"))}const $=class bs{constructor(){this._redirectPersistence=F.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=F.aG,this._overrideRedirectResult=F.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){const R=C._key();let K=E.eventManagers.get(R);return K||(K=new kt(C),E.eventManagers.set(R,K),E.attachCallbackListeners(C,K)),K})()}_openPopup(C){(0,F.ax)(C,"operation-not-supported-in-this-environment")}_openRedirect(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){!function $e(I){var C,E,R,K,Ie,ve,Fe,It,ge,Vt;const Re=$t();(0,F.aC)("function"==typeof(null===(C=Re?.universalLinks)||void 0===C?void 0:C.subscribe),I,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,F.aC)(typeof(null===(E=Re?.BuildInfo)||void 0===E?void 0:E.packageName)<"u",I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,F.aC)("function"==typeof(null===(Ie=null===(K=null===(R=Re?.cordova)||void 0===R?void 0:R.plugins)||void 0===K?void 0:K.browsertab)||void 0===Ie?void 0:Ie.openUrl),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,F.aC)("function"==typeof(null===(It=null===(Fe=null===(ve=Re?.cordova)||void 0===ve?void 0:ve.plugins)||void 0===Fe?void 0:Fe.browsertab)||void 0===It?void 0:It.isAvailable),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,F.aC)("function"==typeof(null===(Vt=null===(ge=Re?.cordova)||void 0===ge?void 0:ge.InAppBrowser)||void 0===Vt?void 0:Vt.open),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(C);const ve=yield Ie._initialize(C);yield ve.initialized(),ve.resetRedirect(),(0,F.aI)(),yield Ie._originValidation(C);const Fe=function di(I,C,E=null){return{type:C,eventId:E,urlResponse:null,sessionId:Qt(),postBody:null,tenantId:I.tenantId,error:(0,F.aB)(I,"no-auth-event")}}(C,R,K);yield function Bn(I,C){return wn()._set(Tn(I),C)}(C,Fe);const It=yield function X(I,C,E){return ae.apply(this,arguments)}(C,Fe,E),ge=yield function bt(I){const{cordova:C}=$t();return new Promise(E=>{C.plugins.browsertab.isAvailable(R=>{let K=null;R?C.plugins.browsertab.openUrl(I):K=C.InAppBrowser.open(I,(0,F.aA)()?"_blank":"_system","location=yes"),E(K)})})}(It);return function Qn(I,C,E){return ct.apply(this,arguments)}(C,ve,ge)})()}_isIframeWebStorageSupported(C,E){throw new Error("Method not implemented.")}_originValidation(C){const E=C._key();return this.originValidationPromises[E]||(this.originValidationPromises[E]=function be(I){return We.apply(this,arguments)}(C)),this.originValidationPromises[E]}attachCallbackListeners(C,E){const{universalLinks:R,handleOpenURL:K,BuildInfo:Ie}=$t(),ve=setTimeout((0,A.Z)(function*(){yield Xe(C),E.onEvent(G())}),500),Fe=function(){var Vt=(0,A.Z)(function*(Re){clearTimeout(ve);const or=yield Xe(C);let oa=null;or&&Re?.url&&(oa=function pt(I,C){var E,R;const K=function Ji(I){const C=Ze(I),E=C.link?decodeURIComponent(C.link):void 0,R=Ze(E).link,K=C.deep_link_id?decodeURIComponent(C.deep_link_id):void 0;return Ze(K).link||K||R||E||I}(C);if(K.includes("/__/auth/callback")){const Ie=Ze(K),ve=Ie.firebaseError?function Xi(I){try{return JSON.parse(I)}catch{return null}}(decodeURIComponent(Ie.firebaseError)):null,Fe=null===(R=null===(E=ve?.code)||void 0===E?void 0:E.split("auth/"))||void 0===R?void 0:R[1],It=Fe?(0,F.aB)(Fe):null;return It?{type:I.type,eventId:I.eventId,tenantId:I.tenantId,error:It,urlResponse:null,sessionId:null,postBody:null}:{type:I.type,eventId:I.eventId,tenantId:I.tenantId,sessionId:I.sessionId,urlResponse:K,postBody:null}}return null}(or,Re.url)),E.onEvent(oa||G())});return function(or){return Vt.apply(this,arguments)}}();typeof R<"u"&&"function"==typeof R.subscribe&&R.subscribe(null,Fe);const It=K,ge=`${Ie.packageName.toLowerCase()}://`;$t().handleOpenURL=function(){var Vt=(0,A.Z)(function*(Re){if(Re.toLowerCase().startsWith(ge)&&Fe({url:Re}),"function"==typeof It)try{It(Re)}catch(or){console.error(or)}});return function(Re){return Vt.apply(this,arguments)}}()}};function G(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,F.aB)("no-auth-event")}}function ce(){var I;return(null===(I=self?.location)||void 0===I?void 0:I.protocol)||null}function de(I=(0,Ae.z$)()){return!("file:"!==ce()&&"ionic:"!==ce()&&"capacitor:"!==ce()||!I.toLowerCase().match(/iphone|ipad|ipod|android/))}function tn(){try{const I=self.localStorage,C=F.aN();if(I)return I.setItem(C,"1"),I.removeItem(C),!function Ht(I=(0,Ae.z$)()){return function Et(){return(0,Ae.w1)()&&11===document?.documentMode}()||function en(I=(0,Ae.z$)()){return/Edge\/\d+/.test(I)}(I)}()||(0,Ae.hl)()}catch{return jn()&&(0,Ae.hl)()}return!1}function jn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Yn(){return(function it(){return"http:"===ce()||"https:"===ce()}()||(0,Ae.ru)()||de())&&!function Ne(){return(0,Ae.b$)()||(0,Ae.UG)()}()&&tn()&&!jn()}function sr(){return de()&&typeof document<"u"}function ki(){return(ki=(0,A.Z)(function*(){return!!sr()&&new Promise(I=>{const C=setTimeout(()=>{I(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(C),I(!0)})})})).apply(this,arguments)}const gt={LOCAL:"local",NONE:"none",SESSION:"session"},As=F.aC,Ss="persistence";function ts(I){return cr.apply(this,arguments)}function cr(){return(cr=(0,A.Z)(function*(I){yield I._initializationPromise;const C=fi(),E=F.aF(Ss,I.config.apiKey,I.name);C&&C.setItem(E,I._getPersistence())})).apply(this,arguments)}function fi(){var I;try{return(null===(I=function Ds(){return typeof window<"u"?window:null}())||void 0===I?void 0:I.sessionStorage)||null}catch{return null}}const pi=F.aC;class dr{constructor(){this.browserResolver=F.aE(F.k),this.cordovaResolver=F.aE($),this.underlyingResolver=null,this._redirectPersistence=F.a,this._completeRedirectFn=F.aG,this._overrideRedirectResult=F.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){return yield E.selectUnderlyingResolver(),E.assertedUnderlyingResolver._initialize(C)})()}_openPopup(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){return yield Ie.selectUnderlyingResolver(),Ie.assertedUnderlyingResolver._openPopup(C,E,R,K)})()}_openRedirect(C,E,R,K){var Ie=this;return(0,A.Z)(function*(){return yield Ie.selectUnderlyingResolver(),Ie.assertedUnderlyingResolver._openRedirect(C,E,R,K)})()}_isIframeWebStorageSupported(C,E){this.assertedUnderlyingResolver._isIframeWebStorageSupported(C,E)}_originValidation(C){return this.assertedUnderlyingResolver._originValidation(C)}get _shouldInitProactively(){return sr()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return pi(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var C=this;return(0,A.Z)(function*(){if(C.underlyingResolver)return;const E=yield function Zr(){return ki.apply(this,arguments)}();C.underlyingResolver=E?C.cordovaResolver:C.browserResolver})()}}function Ot(I){return I.unwrap()}function Cn(I){return nn(I)}function nn(I){const{_tokenResponse:C}=I instanceof Ae.ZR?I.customData:I;if(!C)return null;if(!(I instanceof Ae.ZR)&&"temporaryProof"in C&&"phoneNumber"in C)return F.P.credentialFromResult(I);const E=C.providerId;if(!E||E===F.p.PASSWORD)return null;let R;switch(E){case F.p.GOOGLE:R=F.X;break;case F.p.FACEBOOK:R=F.W;break;case F.p.GITHUB:R=F.Y;break;case F.p.TWITTER:R=F.$;break;default:const{oauthIdToken:K,oauthAccessToken:Ie,oauthTokenSecret:ve,pendingToken:Fe,nonce:It}=C;return Ie||ve||K||Fe?Fe?E.startsWith("saml.")?F.aQ._create(E,Fe):F.N._fromParams({providerId:E,signInMethod:E,pendingToken:Fe,idToken:K,accessToken:Ie}):new F.Z(E).credential({idToken:K,accessToken:Ie,rawNonce:It}):null}return I instanceof Ae.ZR?R.credentialFromError(I):R.credentialFromResult(I)}function bn(I,C){return C.catch(E=>{throw E instanceof Ae.ZR&&function _l(I,C){var E;const R=null===(E=C.customData)||void 0===E?void 0:E._tokenResponse;if("auth/multi-factor-auth-required"===C?.code)C.resolver=new rs(I,F.as(I,C));else if(R){const K=nn(C),Ie=C;K&&(Ie.credential=K,Ie.tenantId=R.tenantId||void 0,Ie.email=R.email||void 0,Ie.phoneNumber=R.phoneNumber||void 0)}}(I,E),E}).then(E=>{const K=E.user;return{operationType:E.operationType,credential:Cn(E),additionalUserInfo:F.aq(E),user:Xn.getOrCreate(K)}})}function ns(I,C){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,A.Z)(function*(I,C){const E=yield C;return{verificationId:E.verificationId,confirm:R=>bn(I,E.confirm(R))}})).apply(this,arguments)}class rs{constructor(C,E){this.resolver=E,this.auth=function Qr(I){return I.wrapped()}(C)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(C){return bn(Ot(this.auth),this.resolver.resolveSignIn(C))}}class Xn{constructor(C){this._delegate=C,this.multiFactor=F.at(C)}static getOrCreate(C){return Xn.USER_MAP.has(C)||Xn.USER_MAP.set(C,new Xn(C)),Xn.USER_MAP.get(C)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(C){return this._delegate.getIdTokenResult(C)}getIdToken(C){return this._delegate.getIdToken(C)}linkAndRetrieveDataWithCredential(C){return this.linkWithCredential(C)}linkWithCredential(C){var E=this;return(0,A.Z)(function*(){return bn(E.auth,F.a2(E._delegate,C))})()}linkWithPhoneNumber(C,E){var R=this;return(0,A.Z)(function*(){return ns(R.auth,F.l(R._delegate,C,E))})()}linkWithPopup(C){var E=this;return(0,A.Z)(function*(){return bn(E.auth,F.d(E._delegate,C,dr))})()}linkWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield ts(F.aJ(E.auth)),F.g(E._delegate,C,dr)})()}reauthenticateAndRetrieveDataWithCredential(C){return this.reauthenticateWithCredential(C)}reauthenticateWithCredential(C){var E=this;return(0,A.Z)(function*(){return bn(E.auth,F.a3(E._delegate,C))})()}reauthenticateWithPhoneNumber(C,E){return ns(this.auth,F.r(this._delegate,C,E))}reauthenticateWithPopup(C){return bn(this.auth,F.e(this._delegate,C,dr))}reauthenticateWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield ts(F.aJ(E.auth)),F.h(E._delegate,C,dr)})()}sendEmailVerification(C){return F.ag(this._delegate,C)}unlink(C){var E=this;return(0,A.Z)(function*(){return yield F.ap(E._delegate,C),E})()}updateEmail(C){return F.al(this._delegate,C)}updatePassword(C){return F.am(this._delegate,C)}updatePhoneNumber(C){return F.u(this._delegate,C)}updateProfile(C){return F.ak(this._delegate,C)}verifyBeforeUpdateEmail(C,E){return F.ah(this._delegate,C,E)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Xn.USER_MAP=new WeakMap;const $n=F.aC;let Or=(()=>{class I{constructor(E,R){if(this.app=E,R.isInitialized())return this._delegate=R.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:K}=E.options;$n(K,"invalid-api-key",{appName:E.name}),$n(K,"invalid-api-key",{appName:E.name});const Ie=typeof window<"u"?dr:void 0;this._delegate=R.initialize({options:{persistence:Ja(K,E.name),popupRedirectResolver:Ie}}),this._delegate._updateErrorMap(F.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Xn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(E){this._delegate.languageCode=E}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(E){this._delegate.tenantId=E}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(E,R){F.K(this._delegate,E,R)}applyActionCode(E){return F.a7(this._delegate,E)}checkActionCode(E){return F.a8(this._delegate,E)}confirmPasswordReset(E,R){return F.a6(this._delegate,E,R)}createUserWithEmailAndPassword(E,R){var K=this;return(0,A.Z)(function*(){return bn(K._delegate,F.aa(K._delegate,E,R))})()}fetchProvidersForEmail(E){return this.fetchSignInMethodsForEmail(E)}fetchSignInMethodsForEmail(E){return F.af(this._delegate,E)}isSignInWithEmailLink(E){return F.ad(this._delegate,E)}getRedirectResult(){var E=this;return(0,A.Z)(function*(){$n(Yn(),E._delegate,"operation-not-supported-in-this-environment");const R=yield F.j(E._delegate,dr);return R?bn(E._delegate,Promise.resolve(R)):{credential:null,user:null}})()}addFrameworkForLogging(E){!function z(I,C){(0,F.aJ)(I)._logFramework(C)}(this._delegate,E)}onAuthStateChanged(E,R,K){const{next:Ie,error:ve,complete:Fe}=gi(E,R,K);return this._delegate.onAuthStateChanged(Ie,ve,Fe)}onIdTokenChanged(E,R,K){const{next:Ie,error:ve,complete:Fe}=gi(E,R,K);return this._delegate.onIdTokenChanged(Ie,ve,Fe)}sendSignInLinkToEmail(E,R){return F.ac(this._delegate,E,R)}sendPasswordResetEmail(E,R){return F.a5(this._delegate,E,R||void 0)}setPersistence(E){var R=this;return(0,A.Z)(function*(){let K;switch(function es(I,C){As(Object.values(gt).includes(C),I,"invalid-persistence-type"),(0,Ae.b$)()?As(C!==gt.SESSION,I,"unsupported-persistence-type"):(0,Ae.UG)()?As(C===gt.NONE,I,"unsupported-persistence-type"):jn()?As(C===gt.NONE||C===gt.LOCAL&&(0,Ae.hl)(),I,"unsupported-persistence-type"):As(C===gt.NONE||tn(),I,"unsupported-persistence-type")}(R._delegate,E),E){case gt.SESSION:K=F.a;break;case gt.LOCAL:K=(yield F.aE(F.i)._isAvailable())?F.i:F.b;break;case gt.NONE:K=F.U;break;default:return F.ax("argument-error",{appName:R._delegate.name})}return R._delegate.setPersistence(K)})()}signInAndRetrieveDataWithCredential(E){return this.signInWithCredential(E)}signInAnonymously(){return bn(this._delegate,F.a0(this._delegate))}signInWithCredential(E){return bn(this._delegate,F.a1(this._delegate,E))}signInWithCustomToken(E){return bn(this._delegate,F.a4(this._delegate,E))}signInWithEmailAndPassword(E,R){return bn(this._delegate,F.ab(this._delegate,E,R))}signInWithEmailLink(E,R){return bn(this._delegate,F.ae(this._delegate,E,R))}signInWithPhoneNumber(E,R){return ns(this._delegate,F.s(this._delegate,E,R))}signInWithPopup(E){var R=this;return(0,A.Z)(function*(){return $n(Yn(),R._delegate,"operation-not-supported-in-this-environment"),bn(R._delegate,F.c(R._delegate,E,dr))})()}signInWithRedirect(E){var R=this;return(0,A.Z)(function*(){return $n(Yn(),R._delegate,"operation-not-supported-in-this-environment"),yield ts(R._delegate),F.f(R._delegate,E,dr)})()}updateCurrentUser(E){return this._delegate.updateCurrentUser(E)}verifyPasswordResetCode(E){return F.a9(this._delegate,E)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return I.Persistence=gt,I})();function gi(I,C,E){let R=I;"function"!=typeof I&&({next:R,error:C,complete:E}=I);const K=R;return{next:ve=>K(ve&&Xn.getOrCreate(ve)),error:C,complete:E}}function Ja(I,C){const E=function hi(I,C){const E=fi();if(!E)return[];const R=F.aF(Ss,I,C);switch(E.getItem(R)){case gt.NONE:return[F.U];case gt.LOCAL:return[F.i,F.a];case gt.SESSION:return[F.a];default:return[]}}(I,C);if(typeof self<"u"&&!E.includes(F.i)&&E.push(F.i),typeof window<"u")for(const R of[F.b,F.a])E.includes(R)||E.push(R);return E.includes(F.U)||E.push(F.U),E}class Eo{constructor(){this.providerId="phone",this._delegate=new F.P(Ot(Z.Z.auth()))}static credential(C,E){return F.P.credential(C,E)}verifyPhoneNumber(C,E){return this._delegate.verifyPhoneNumber(C,E)}unwrap(){return this._delegate}}Eo.PHONE_SIGN_IN_METHOD=F.P.PHONE_SIGN_IN_METHOD,Eo.PROVIDER_ID=F.P.PROVIDER_ID;const sa=F.aC;class Rs{constructor(C,E,R=Z.Z.app()){var K;sa(null===(K=R.options)||void 0===K?void 0:K.apiKey,"invalid-api-key",{appName:R.name}),this._delegate=new F.R(R.auth(),C,E),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function S(I){I.INTERNAL.registerComponent(new Mn.wA("auth-compat",C=>{const E=C.getProvider("app-compat").getImmediate(),R=C.getProvider("auth");return new Or(E,R)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:F.A.EMAIL_SIGNIN,PASSWORD_RESET:F.A.PASSWORD_RESET,RECOVER_EMAIL:F.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:F.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:F.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:F.A.VERIFY_EMAIL}},EmailAuthProvider:F.V,FacebookAuthProvider:F.W,GithubAuthProvider:F.Y,GoogleAuthProvider:F.X,OAuthProvider:F.Z,SAMLAuthProvider:F._,PhoneAuthProvider:Eo,PhoneMultiFactorGenerator:F.m,RecaptchaVerifier:Rs,TwitterAuthProvider:F.$,Auth:Or,AuthCredential:F.L,Error:Ae.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),I.registerVersion("@firebase/auth-compat","0.4.9")}(Z.Z)},861:(Cs,Zn,ke)=>{function A(F,Ae,yt,Jt,Mn,$t,vt){try{var X=F[$t](vt),ae=X.value}catch(be){return void yt(be)}X.done?Ae(ae):Promise.resolve(ae).then(Jt,Mn)}function Z(F){return function(){var Ae=this,yt=arguments;return new Promise(function(Jt,Mn){var $t=F.apply(Ae,yt);function vt(ae){A($t,Jt,Mn,vt,X,"next",ae)}function X(ae){A($t,Jt,Mn,vt,X,"throw",ae)}vt(void 0)})}}ke.d(Zn,{Z:()=>Z})},582:(Cs,Zn,ke)=>{function Ae($,G){var z={};for(var B in $)Object.prototype.hasOwnProperty.call($,B)&&G.indexOf(B)<0&&(z[B]=$[B]);if(null!=$&&"function"==typeof Object.getOwnPropertySymbols){var ee=0;for(B=Object.getOwnPropertySymbols($);ee<B.length;ee++)G.indexOf(B[ee])<0&&Object.prototype.propertyIsEnumerable.call($,B[ee])&&(z[B[ee]]=$[B[ee]])}return z}function be($,G,z,B){return new(z||(z=Promise))(function(Y,ce){function it(Et){try{Ne(B.next(Et))}catch(en){ce(en)}}function de(Et){try{Ne(B.throw(Et))}catch(en){ce(en)}}function Ne(Et){Et.done?Y(Et.value):function ee(Y){return Y instanceof z?Y:new z(function(ce){ce(Y)})}(Et.value).then(it,de)}Ne((B=B.apply($,G||[])).next())})}function ot($){return this instanceof ot?(this.v=$,this):new ot($)}function kt($,G,z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ee,B=z.apply($,G||[]),Y=[];return ee={},ce("next"),ce("throw"),ce("return"),ee[Symbol.asyncIterator]=function(){return this},ee;function ce(Ht){B[Ht]&&(ee[Ht]=function(tn){return new Promise(function(jn,Yn){Y.push([Ht,tn,jn,Yn])>1||it(Ht,tn)})})}function it(Ht,tn){try{!function de(Ht){Ht.value instanceof ot?Promise.resolve(Ht.value.v).then(Ne,Et):en(Y[0][2],Ht)}(B[Ht](tn))}catch(jn){en(Y[0][3],jn)}}function Ne(Ht){it("next",Ht)}function Et(Ht){it("throw",Ht)}function en(Ht,tn){Ht(tn),Y.shift(),Y.length&&it(Y[0][0],Y[0][1])}}function Bn($){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var z,G=$[Symbol.asyncIterator];return G?G.call($):($=function ct($){var G="function"==typeof Symbol&&Symbol.iterator,z=G&&$[G],B=0;if(z)return z.call($);if($&&"number"==typeof $.length)return{next:function(){return $&&B>=$.length&&($=void 0),{value:$&&$[B++],done:!$}}};throw new TypeError(G?"Object is not iterable.":"Symbol.iterator is not defined.")}($),z={},B("next"),B("throw"),B("return"),z[Symbol.asyncIterator]=function(){return this},z);function B(Y){z[Y]=$[Y]&&function(ce){return new Promise(function(it,de){!function ee(Y,ce,it,de){Promise.resolve(de).then(function(Ne){Y({value:Ne,done:it})},ce)}(it,de,(ce=$[Y](ce)).done,ce.value)})}}}ke.d(Zn,{FC:()=>kt,KL:()=>Bn,_T:()=>Ae,mG:()=>be,qq:()=>ot}),"function"==typeof SuppressedError&&SuppressedError}},Cs=>{Cs(Cs.s=838)}]);